title,viewcount,title,body,body,acceptedanswerid
"How do I generate a random int number in C#?","1465948","","<p>How do I generate a random int number in C#?</p>
","<p>The <a href=""https://msdn.microsoft.com/en-us/library/system.random%28v=vs.110%29.aspx"" rel=""noreferrer""><code>Random</code> class</a> is used to create random numbers. (Pseudo-random that is of course.).</p>

<p>Example:</p>

<pre><code>Random rnd = new Random();
int month = rnd.Next(1, 13); // creates a number between 1 and 12
int dice = rnd.Next(1, 7);   // creates a number between 1 and 6
int card = rnd.Next(52);     // creates a number between 0 and 51
</code></pre>

<p>If you are going to create more than one random number, you should keep the <code>Random</code> instance and reuse it. If you create new instances too close in time, they will produce the same series of random numbers as the random generator is seeded from the system clock.</p>
","2706537"
"Password must be 8 characters including 1 uppercase letter, 1 special character, alphanumeric characters","1433346","","<p>I want a regular expression to check that </p>

<blockquote>
  <p>a password must be eight characters including one uppercase letter, one special character and alphanumeric characters.</p>
</blockquote>

<p>And here is my validation expression which is for eight characters including one uppercase letter, one lowercase letter, and one number or special character.</p>

<pre><code>(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$""
</code></pre>

<p>How I can write it for a password that must be eight characters including one uppercase letter, one special character and alphanumeric characters?</p>
","<p>The regular expression you are after will most likely be huge and a nightmare to maintain especially for people who are not that familiar with regular expressions.</p>

<p>I think it would be easier to break your regex down and do it one bit at a time. It might take a bit more to do, but I am pretty sure that maintaining it and debugging it would be easier. This would also allow you to provide more directed error messages to your users (other than just <code>Invalid Password</code>) which should improve user experience.</p>

<p>From what I am seeing you are pretty fluent in regex, so I would presume that giving you the regular expressions to do what you need would be futile.</p>

<p>Seeing your comment, this is how I would go about it:</p>

<ul>
<li><p>Must be eight characters Long: You do not need a regex for this. Using the <code>.Length</code> property should be enough.</p></li>
<li><p>Including one uppercase letter: You can use the <code>[A-Z]+</code> regular expression. If the string contains at least one upper case letter, this regular expression will yield <code>true</code>.</p></li>
<li><p>One special character: You can use either the <code>\W</code> which will match any character which is not a letter or a number or else, you can use something like so <code>[!@#]</code> to specify a custom list of special characters. Note though that characters such as <code>$</code>, <code>^</code>, <code>(</code> and <code>)</code> are special characters in the regular expression language, so they need to be escaped like so: <code>\$</code>. So in short, you might use the <code>\W</code>.</p></li>
<li><p>Alphanumeric characters: Using the <code>\w+</code> should match any letter and number and underscore.</p></li>
</ul>

<p>Take a look at <a href=""http://www.regular-expressions.info/reference.html"" rel=""noreferrer"">this</a> tutorial for more information.</p>
","9478035"
"How do I get a consistent byte representation of strings in C# without manually specifying an encoding?","1111905","","<p>How do I convert a <code>string</code> to a <code>byte[]</code> in .NET (C#) without manually specifying a specific encoding?</p>

<p>I'm going to encrypt the string. I can encrypt it without converting, but I'd still like to know why encoding comes to play here.</p>

<p>Also, why should encoding be taken into consideration? Can't I simply get what bytes the string has been stored in? Why is there a dependency on character encodings?</p>
","<h2>Contrary to the answers here, you DON'T need to worry about encoding <strong><em>if</em></strong> the bytes don't need to be interpreted!</h2>

<p>Like you mentioned, your goal is, simply, to <em>""get what bytes the string has been stored in""</em>.<br>
(And, of course, to be able to re-construct the string from the bytes.)</p>

<h3>For those goals, I honestly do <em>not</em> understand why people keep telling you that you need the encodings. You certainly do NOT need to worry about encodings for this.</h3>

<p>Just do this instead:</p>

<pre><code>static byte[] GetBytes(string str)
{
    byte[] bytes = new byte[str.Length * sizeof(char)];
    System.Buffer.BlockCopy(str.ToCharArray(), 0, bytes, 0, bytes.Length);
    return bytes;
}

static string GetString(byte[] bytes)
{
    char[] chars = new char[bytes.Length / sizeof(char)];
    System.Buffer.BlockCopy(bytes, 0, chars, 0, bytes.Length);
    return new string(chars);
}
</code></pre>

<p>As long as your program (or other programs) don't try to <em>interpret</em> the bytes somehow, which you obviously didn't mention you intend to do, then there is <strong>nothing</strong> wrong with this approach! Worrying about encodings just makes your life more complicated for no real reason.</p>

<h2>Additional benefit to this approach:</h2>

<h3>It doesn't matter if the string contains invalid characters, because you can still get the data and reconstruct the original string anyway!</h3>

<p>It will be encoded and decoded just the same, because you are <em>just looking at the bytes</em>.</p>

<p>If you used a specific encoding, though, it would've given you trouble with encoding/decoding invalid characters.</p>
","10380166"
"What is the best way to iterate over a Dictionary in C#?","1034409","","<p>I've seen a few different ways to iterate over a Dictionary in C#.  Is there a standard way?</p>
","<pre class=""lang-cs prettyprint-override""><code>foreach(KeyValuePair&lt;string, string&gt; entry in myDictionary)
{
    // do something with entry.Value or entry.Key
}
</code></pre>
","141098"
"Adding values to a C# array","995630","","<p>Probably a really simple one this - I'm starting out with C# and need to add values to an array, for example:</p>

<pre><code>int[] terms;

for(int runs = 0; runs &lt; 400; runs++)
{
    terms[] = value;
}
</code></pre>

<p>For those who have used PHP, here's what I'm trying to do in C#:</p>

<pre><code>$arr = array();
for ($i = 0; $i &lt; 10; $i++) {
    $arr[] = $i;
}
</code></pre>
","<p>You can do this way -</p>

<pre><code>int[] terms = new int[400];
for (int runs = 0; runs &lt; 400; runs++)
{
    terms[runs] = value;
}
</code></pre>

<p>Alternatively, you can use Lists - the advantage with lists being, you don't need to know the array size when instantiating the list.</p>

<pre><code>List&lt;int&gt; termsList = new List&lt;int&gt;();
for (int runs = 0; runs &lt; 400; runs++)
{
    termsList.Add(value);
}

// You can convert it back to an array if you would like to
int[] terms = termsList.ToArray();
</code></pre>

<p><strong>Edit:</strong> <a href=""https://stackoverflow.com/a/365658/495455"">a) <strong>for</strong> loops on List&lt;T> are a bit more than 2 times cheaper than <strong>foreach</strong> loops on List&lt;T>, b) Looping on array is around 2 times cheaper than looping on List&lt;T>, c) looping on array using <strong>for</strong> is 5 times cheaper than looping on List&lt;T> using <strong>foreach</strong> (which most of us do).</a></p>
","202854"
"Get int value from enum in C#","991182","","<p>I have a class called <code>Questions</code> (plural). In this class there is an enum called <code>Question</code> (singular) which looks like this.</p>

<pre><code>public enum Question
{
    Role = 2,
    ProjectFunding = 3,
    TotalEmployee = 4,
    NumberOfServers = 5,
    TopBusinessConcern = 6
}
</code></pre>

<p>In the <code>Questions</code> class I have a <code>get(int foo)</code> function that returns a <code>Questions</code> object for that <code>foo</code>. Is there an easy way to get the integer value off the enum so I can do something like this <code>Questions.Get(Question.Role)</code>?</p>
","<p>Just cast the enum eg.</p>

<pre><code>int something = (int)Question.Role;
</code></pre>

<p>The above will work for the vast majority of enums you see in the wild, as the default underlying type for an enum is int.</p>

<p>However as cecilphillip  points out, enums can have different underlying types.
If an enum is declared as an uint, long or ulong then it should be cast to the type of the enum.</p>

<p>e.g. for</p>

<pre><code>enum StarsInMilkyWay:long {Sun = 1, V645Centauri = 2 .. Wolf424B = 2147483649};
</code></pre>

<p>you should use</p>

<pre><code>long something = (long)StarsInMilkyWay.Wolf424B;
</code></pre>
","943407"
"Cast int to enum in C#","921475","","<p>How can an <code>int</code> be cast to an <code>enum</code> in C#?</p>
","<p>From a string:</p>

<pre><code>YourEnum foo = (YourEnum) Enum.Parse(typeof(YourEnum), yourString);
// the foo.ToString().Contains("","") check is necessary for enumerations marked with an [Flags] attribute
if (!Enum.IsDefined(typeof(YourEnum), foo) &amp;&amp; !foo.ToString().Contains("",""))
  throw new InvalidOperationException($""{yourString} is not an underlying value of the YourEnum enumeration."")
</code></pre>

<p>From an int:</p>

<pre><code>YourEnum foo = (YourEnum)yourInt;
</code></pre>

<p><strong>Update:</strong></p>

<p>From number you can also</p>

<pre><code>YourEnum foo = (YourEnum)Enum.ToObject(typeof(YourEnum) , yourInt);
</code></pre>
","29485"
"Convert int to string?","881707","","<p>How can I convert an <code>int</code> datatype into a <code>string</code> datatype in C#?</p>
","<pre><code>string myString = myInt.ToString();
</code></pre>
","3081919"
"C# DateTime to ""YYYYMMDDHHMMSS"" format","874107","","<p>I want to convert a C# DateTime to ""YYYYMMDDHHMMSS"" format. But I don't find a built in method to get this format? Any comments?</p>
","<p><code>DateTime.Now.ToString(""yyyyMMddHHmmss""); // case sensitive</code></p>
","3025389"
"Create Excel (.XLS and .XLSX) file from C#","865799","","<p>How can I create an Excel Spreadsheet with C# without requiring Excel to be installed on the machine that's running the code?</p>
","<p>You can use a library called ExcelLibrary. It's a free, open source library posted on Google Code:</p>

<p><a href=""http://code.google.com/p/excellibrary/"" rel=""noreferrer"">ExcelLibrary</a></p>

<p>This looks to be a port of the PHP ExcelWriter that you mentioned above. It will not write to the new .xlsx format yet, but they are working on adding that functionality in.</p>

<p>It's very simple, small and easy to use. Plus it has a DataSetHelper that lets you use DataSets and DataTables to easily work with Excel data.</p>

<p>ExcelLibrary seems to still only work for the older Excel format (.xls files), but may be adding support in the future for newer 2007/2010 formats. </p>

<p>You can also use <a href=""https://github.com/JanKallman/EPPlus"" rel=""noreferrer"">EPPlus</a>, which works only for Excel 2007/2010 format files (.xlsx files).</p>

<p>There are a few known bugs with each library as noted in the comments. In all, EPPlus seems to be the best choice as time goes on. It seems to be more actively updated and documented as well.</p>

<p>Also, as noted by @АртёмЦарионов below, EPPlus has support for Pivot Tables and ExcelLibrary may have some support (<a href=""http://code.google.com/p/excellibrary/issues/detail?id=98&amp;q=pivot&amp;colspec=ID%20Type%20Status%20Priority%20ReportedBy%20Owner%20Summary%20Opened"" rel=""noreferrer"">Pivot table issue in ExcelLibrary</a>)</p>

<p>Here are a couple links for quick reference:<br/>
<a href=""http://code.google.com/p/excellibrary/"" rel=""noreferrer"">ExcelLibrary</a> - <a href=""http://www.gnu.org/licenses/lgpl.html"" rel=""noreferrer"">GNU Lesser GPL</a><br/>
<a href=""https://github.com/JanKallman/EPPlus"" rel=""noreferrer"">EPPlus</a> - <a href=""https://github.com/JanKallman/EPPlus/blob/master/LICENSE"" rel=""noreferrer"">GNU Lesser General Public License (LGPL)</a></p>

<p><b>Here some example code for ExcelLibrary:</b></p>

<p>Here is an example taking data from a database and creating a workbook from it. Note that the ExcelLibrary code is the single line at the bottom:</p>

<pre><code>//Create the data set and table
DataSet ds = new DataSet(""New_DataSet"");
DataTable dt = new DataTable(""New_DataTable"");

//Set the locale for each
ds.Locale = System.Threading.Thread.CurrentThread.CurrentCulture;
dt.Locale = System.Threading.Thread.CurrentThread.CurrentCulture;

//Open a DB connection (in this example with OleDB)
OleDbConnection con = new OleDbConnection(dbConnectionString);
con.Open();

//Create a query and fill the data table with the data from the DB
string sql = ""SELECT Whatever FROM MyDBTable;"";
OleDbCommand cmd = new OleDbCommand(sql, con);
OleDbDataAdapter adptr = new OleDbDataAdapter();

adptr.SelectCommand = cmd;
adptr.Fill(dt);
con.Close();

//Add the table to the data set
ds.Tables.Add(dt);

//Here's the easy part. Create the Excel worksheet from the data set
ExcelLibrary.DataSetHelper.CreateWorkbook(""MyExcelFile.xls"", ds);
</code></pre>

<p>Creating the Excel file is as easy as that. You can also manually create Excel files, but the above functionality is what really impressed me.</p>
","2603625"
"What is a NullReferenceException, and how do I fix it?","844761","","<p>I have some code and when it executes, it throws a <code>NullReferenceException</code>, saying:</p>

<blockquote>
  <p>Object reference not set to an instance of an object.</p>
</blockquote>

<p>What does this mean, and what can I do to fix this error?</p>
","<h1>What is the cause?</h1>

<h2>Bottom Line</h2>

<p>You are trying to use something that is <code>null</code> (or <code>Nothing</code> in VB.NET). This means you either set it to <code>null</code>, or you never set it to anything at all. </p>

<p>Like anything else, <code>null</code> gets passed around. If it is <code>null</code> <em>in</em> method ""A"", it could be that method ""B"" passed a <code>null</code> <em>to</em> method ""A"".</p>

<p>The rest of this article goes into more detail and shows mistakes that many programmers often make which can lead to a <code>NullReferenceException</code>.</p>

<h2>More Specifically</h2>

<p>The runtime throwing a <code>NullReferenceException</code> <strong>always</strong> means the same thing: you are trying to use a reference, and the reference is not initialized (or it was <em>once</em> initialized, but is <em>no longer</em> initialized). </p>

<p>This means the reference is <code>null</code>, and you cannot access members (such as methods) through a <code>null</code> reference. The simplest case:</p>

<pre><code>string foo = null;
foo.ToUpper();
</code></pre>

<p>This will throw a <code>NullReferenceException</code> at the second line because you can't call the instance method <code>ToUpper()</code> on a <code>string</code> reference pointing to <code>null</code>.</p>

<h1>Debugging</h1>

<p>How do you find the source of a <code>NullReferenceException</code>? Apart from looking at the exception itself, which will be thrown exactly at the location where it occurs, the general rules of debugging in Visual Studio apply: place strategic breakpoints and <a href=""http://msdn.microsoft.com/en-us/library/esta7c62.aspx"" rel=""noreferrer"">inspect your variables</a>, either by hovering the mouse over their names, opening a (Quick)Watch window or using the various debugging panels like Locals and Autos.</p>

<p>If you want to find out where the reference is or isn't set, right-click its name and select ""Find All References"". You can then place a breakpoint at every found location and run your program with the debugger attached. Every time the debugger breaks on such a breakpoint, you need to determine whether you expect the reference to be non-null, inspect the variable and and verify that it points to an instance when you expect it to.</p>

<p>By following the program flow this way, you can find the location where the instance should not be null, and why it isn't properly set.</p>

<h1>Examples</h1>

<p>Some common scenarios where the exception can be thrown:</p>

<h3>Generic</h3>

<pre><code>ref1.ref2.ref3.member
</code></pre>

<p>If ref1 or ref2 or ref3 is null, then you'll get a <code>NullReferenceException</code>. If you want to solve the problem, then find out which one is null by rewriting the expression to its simpler equivalent:</p>

<pre><code>var r1 = ref1;
var r2 = r1.ref2;
var r3 = r2.ref3;
r3.member
</code></pre>

<p>Specifically, in <code>HttpContext.Current.User.Identity.Name</code>, the <code>HttpContext.Current</code> could be null, or the <code>User</code> property could be null, or the <code>Identity</code> property could be null.</p>

<h3>Class instances</h3>

<p>When creating a variable of a reference (class) type, it is by default set to <code>null</code>.</p>

<pre><code>public class Book {
    public string Title { get; set; }
}
public class Example {
    public void Foo() {
        Book b1;
        string title = b1.Title; // You never initialized the b1 variable.
                                    // there is no book to get the title from.
    }
}
</code></pre>

<p>Class type variables must either be initialized or set to an already existing class instance. Initialization is done by using the <code>new</code> keyword.</p>

<pre><code>Book b1 = new Book();
</code></pre>

<h3>Indirect</h3>

<pre><code>public class Person {
    public int Age { get; set; }
}
public class Book {
    public Person Author { get; set; }
}
public class Example {
    public void Foo() {
        Book b1 = new Book();
        int authorAge = b1.Author.Age; // You never initialized the Author property.
                                       // there is no Person to get an Age from.
    }
}
</code></pre>

<p>If you want to avoid the child (Person) null reference, you could initialize it in the parent (Book) object's constructor.</p>

<h3>Nested Object Initializers</h3>

<p>The same applies to nested object initializers:</p>

<pre><code>Book b1 = new Book { Author = { Age = 45 } };
</code></pre>

<p>This translates to</p>

<pre><code>Book b1 = new Book();
b1.Author.Age = 45;
</code></pre>

<p>While the <code>new</code> keyword is used, it only creates a new instance of <code>Book</code>, but not a new instance of <code>Person</code>, so the <code>Author</code> the property is still <code>null</code>.</p>

<h3>Nested Collection Initializers</h3>

<pre><code>public class Person {
    public ICollection&lt;Book&gt; Books { get; set; }
}
public class Book {
    public string Title { get; set; }
}
</code></pre>

<p>The nested collection initializers behave the same:</p>

<pre><code>Person p1 = new Person {
    Books = {
        new Book { Title = ""Title1"" },
        new Book { Title = ""Title2"" },
    }
};
</code></pre>

<p>This translates to</p>

<pre><code>Person p1 = new Person();
p1.Books.Add(new Book { Title = ""Title1"" });
p1.Books.Add(new Book { Title = ""Title2"" });
</code></pre>

<p>The <code>new Person</code> only creates an instance of <code>Person</code>, but the <code>Books</code> collection is still <code>null</code>. The collection initializer syntax does not create a collection
for <code>p1.Books</code>, it only translates to the <code>p1.Books.Add(...)</code> statements.</p>

<h3>Array</h3>

<pre><code>int[] numbers = null;
int n = numbers[0]; // numbers is null. There is no array to index.
</code></pre>

<h3>Array Elements</h3>

<pre><code>Person[] people = new Person[5];
people[0].Age = 20 // people[0] is null. The array was allocated but not
                   // initialized. There is no Person to set the Age for.
</code></pre>

<h3>Jagged Arrays</h3>

<pre><code>long[][] array = new long[1][];
array[0][0] = 3; // is null because only the first dimension is yet initialized.
                 // Use array[0] = new long[2]; first.
</code></pre>

<h3>Collection/List/Dictionary</h3>

<pre><code>Dictionary&lt;string, int&gt; agesForNames = null;
int age = agesForNames[""Bob""]; // agesForNames is null.
                               // There is no Dictionary to perform the lookup.
</code></pre>

<h3>Range Variable (Indirect/Deferred)</h3>

<pre><code>public class Person {
    public string Name { get; set; }
}
var people = new List&lt;Person&gt;();
people.Add(null);
var names = from p in people select p.Name;
string firstName = names.First(); // Exception is thrown here, but actually occurs
                                  // on the line above.  ""p"" is null because the
                                  // first element we added to the list is null.
</code></pre>

<h3>Events</h3>

<pre><code>public class Demo
{
    public event EventHandler StateChanged;

    protected virtual void OnStateChanged(EventArgs e)
    {        
        StateChanged(this, e); // Exception is thrown here 
                               // if no event handlers have been attached
                               // to StateChanged event
    }
}
</code></pre>

<h3>Bad Naming Conventions:</h3>

<p>If you named fields differently from locals, you might have realized that you never initialized the field. </p>

<pre><code>public class Form1 {
    private Customer customer;

    private void Form1_Load(object sender, EventArgs e) {
        Customer customer = new Customer();
        customer.Name = ""John"";
    }

    private void Button_Click(object sender, EventArgs e) {
        MessageBox.Show(customer.Name);
    }
}
</code></pre>

<p>This can be solved by following the convention to prefix fields with an underscore:</p>

<pre><code>private Customer _customer;
</code></pre>

<h3>ASP.NET Page Life cycle:</h3>

<pre><code>public partial class Issues_Edit : System.Web.UI.Page
{
    protected TestIssue myIssue;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // Only called on first load, not when button clicked
            myIssue = new TestIssue(); 
        }
    }

    protected void SaveButton_Click(object sender, EventArgs e)
    {
        myIssue.Entry = ""NullReferenceException here!"";
    }
}
</code></pre>

<h3>ASP.NET Session Values</h3>

<pre><code>// if the ""FirstName"" session value has not yet been set,
// then this line will throw a NullReferenceException
string firstName = Session[""FirstName""].ToString();
</code></pre>

<h3>ASP.NET MVC empty view models</h3>

<p>If the exception occurs when referencing a property of <code>@Model</code> in an ASP.NET MVC view, you need to understand that the <code>Model</code> gets set in your action method, when you <code>return</code> a view. When you return an empty model (or model property) from your controller, the exception occurs when the views access it:</p>

<pre><code>// Controller
public class Restaurant:Controller
{
    public ActionResult Search()
    {
         return View();  // Forgot the provide a Model here.
    }
}

// Razor view 
@foreach (var restaurantSearch in Model.RestaurantSearch)  // Throws.
{
}

&lt;p&gt;@Model.somePropertyName&lt;/p&gt; &lt;!-- Also throws --&gt;
</code></pre>

<h3>WPF Control Creation Order and Events</h3>

<p>WPF controls are created during the call to <code>InitializeComponent</code> in the order they appear in the visual tree.  A <code>NullReferenceException</code> will be raised in the case of early-created controls with event handlers, etc. , that fire during <code>InitializeComponent</code> which reference late-created controls.</p>

<p>For example :</p>

<pre><code>&lt;Grid&gt;
    &lt;!-- Combobox declared first --&gt;
    &lt;ComboBox Name=""comboBox1"" 
              Margin=""10""
              SelectedIndex=""0"" 
              SelectionChanged=""comboBox1_SelectionChanged""&gt;
        &lt;ComboBoxItem Content=""Item 1"" /&gt;
        &lt;ComboBoxItem Content=""Item 2"" /&gt;
        &lt;ComboBoxItem Content=""Item 3"" /&gt;
    &lt;/ComboBox&gt;

    &lt;!-- Label declared later --&gt;
    &lt;Label Name=""label1"" 
           Content=""Label""
           Margin=""10"" /&gt;
&lt;/Grid&gt;
</code></pre>

<p>Here <code>comboBox1</code> is created before <code>label1</code>. If <code>comboBox1_SelectionChanged</code> attempts to reference `label1, it will not yet have been created.</p>

<pre><code>private void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    label1.Content = comboBox1.SelectedIndex.ToString(); // NullReference here!!
}
</code></pre>

<p>Changing the order of the declarations in the XAML (i.e., listing <code>label1</code> before <code>comboBox1</code>, ignoring issues of design philosophy, would at least resolve the <code>NullReferenceException</code> here.</p>

<h3>Cast with <code>as</code></h3>

<pre><code>var myThing = someObject as Thing;
</code></pre>

<p>This doesn't throw an InvalidCastException but returns a <code>null</code> when the cast fails (and when someObject is itself null). So be aware of that.</p>

<h3>LINQ FirstOrDefault() and SingleOrDefault()</h3>

<p>The plain versions <code>First()</code> and <code>Single()</code> throw exceptions when there is nothing. The ""OrDefault"" versions return null in that case. So be aware of that.</p>

<h3>foreach</h3>

<p><code>foreach</code> throws when you try to iterate null collection. Usually caused by unexpected <code>null</code> result from methods that return collections.</p>

<pre><code> List&lt;int&gt; list = null;    
 foreach(var v in list) { } // exception
</code></pre>

<p>More realistic example - select nodes from XML document. Will throw if nodes are not found but initial debugging shows that all properties valid:</p>

<pre><code> foreach (var node in myData.MyXml.DocumentNode.SelectNodes(""//Data""))
</code></pre>

<hr>

<h1>Ways to Avoid</h1>

<h3>Explicitly check for <code>null</code> and ignore null values.</h3>

<p>If you expect the reference sometimes to be null, you can check for it being <code>null</code> before accessing instance members:</p>

<pre><code>void PrintName(Person p) {
    if (p != null) {
        Console.WriteLine(p.Name);
    }
}
</code></pre>

<h3>Explicitly check for <code>null</code> and provide a default value.</h3>

<p>Methods call you expect to return an instance can return <code>null</code>, for example when the object being sought cannot be found. You can choose to return a default value when this is the case:</p>

<pre><code>string GetCategory(Book b) {
    if (b == null)
        return ""Unknown"";
    return b.Category;
}
</code></pre>

<h3>Explicitly check for <code>null</code> from method calls and throw a custom exception.</h3>

<p>You can also throw a custom exception, only to catch it in the calling code:</p>

<pre><code>string GetCategory(string bookTitle) {
    var book = library.FindBook(bookTitle);  // This may return null
    if (book == null)
        throw new BookNotFoundException(bookTitle);  // Your custom exception
    return book.Category;
}
</code></pre>

<h3>Use <code>Debug.Assert</code> if a value should never be <code>null</code>, to catch the problem earlier than the exception occurs.</h3>

<p>When you know during development that a method maybe can, but never should return <code>null</code>, you can use <code>Debug.Assert()</code> to break as soon as possible when it does occur:</p>

<pre><code>string GetTitle(int knownBookID) {
    // You know this should never return null.
    var book = library.GetBook(knownBookID);  

    // Exception will occur on the next line instead of at the end of this method.
    Debug.Assert(book != null, ""Library didn't return a book for known book ID."");

    // Some other code

    return book.Title; // Will never throw NullReferenceException in Debug mode.
}
</code></pre>

<p>Though this check <a href=""https://stackoverflow.com/questions/3021538/debug-assert-appears-in-release-mode"">will not end up in your release build</a>, causing it to throw the <code>NullReferenceException</code> again when <code>book == null</code> at runtime in release mode.</p>

<h3>Use <code>GetValueOrDefault()</code> for nullable value types to provide a default value when they are <code>null</code>.</h3>

<pre><code>DateTime? appointment = null;
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
// Will display the default value provided (DateTime.Now), because appointment is null.

appointment = new DateTime(2022, 10, 20);
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
// Will display the appointment date, not the default
</code></pre>

<h3>Use the null coalescing operator: <code>??</code> [C#] or <code>If()</code> [VB].</h3>

<p>The shorthand to providing a default value when a <code>null</code> is encountered:</p>

<pre><code>IService CreateService(ILogger log, Int32? frobPowerLevel)
{
    var serviceImpl = new MyService(log ?? NullLog.Instance);

    // Note that the above ""GetValueOrDefault()"" can also be rewritten to use
    // the coalesce operator:
    serviceImpl.FrobPowerLevel = frobPowerLevel ?? 5;
}
</code></pre>

<h3>Use the null condition operator: <code>?.</code> (available in C# 6 and VB.NET 14):</h3>

<p>This is also sometimes called the safe navigation or Elvis (after its shape) operator. If the expression on the left side of the operator is null, then the right side will not be evaluated, and null is returned instead. That means cases like this:</p>

<pre><code>var title = person.Title.ToUpper();
</code></pre>

<p>If the person does not have a title, this will throw an exception because it is trying to call <code>ToUpper</code> on a property with a null value.</p>

<p>In C# 5 and below, this can be guarded with:</p>

<pre><code>var title = person.Title == null ? null : person.Title.ToUpper();
</code></pre>

<p>Now the title variable will be null instead of throwing an exception. C# 6 introduces a shorter syntax for this:</p>

<pre><code>var title = person.Title?.ToUpper();
</code></pre>

<p>This will result in the title variable being <code>null</code>, and the call to <code>ToUpper</code> is not made if <code>person.Title</code> is <code>null</code>.</p>

<p>Of course, you <em>still</em> have to check <code>title</code> for null or use the null condition operator together with the null coalescing operator (<code>??</code>) to supply a default value:</p>

<pre><code>// regular null check
int titleLength = 0;
if (title != null)
    titleLength = title.Length; // If title is null, this would throw NullReferenceException

// combining the `?` and the `??` operator
int titleLength = title?.Length ?? 0;
</code></pre>
","4660186"
"How convert byte array to string","824866","","<p>I created a byte array with two strings. How do I convert a byte array to strings?</p>

<pre><code>var binWriter = new BinaryWriter(new MemoryStream());
binWriter.Write(""value1"");
binWriter.Write(""value2"");
binWriter.Seek(0, SeekOrigin.Begin);

byte[] result = reader.ReadBytes((int)binWriter.BaseStream.Length);
</code></pre>

<p>I want to convert <code>result</code> to strings. I can do it using <code>BinaryReader</code>. But I can not use <code>BinaryReader</code> (it does not supported).</p>
","<p>Depending on the encoding you wish to use:</p>

<pre><code>var str = System.Text.Encoding.Default.GetString(result);
</code></pre>
","11654597"
"How to Sort a List<T> by a property in the object","818598","","<p>I have a class called <code>Order</code> which has properties such as <code>OrderId</code>, <code>OrderDate</code>, <code>Quantity</code>, and <code>Total</code>. I have a list of this <code>Order</code> class:</p>

<pre><code>List&lt;Order&gt; objListOrder = new List&lt;Order&gt;();
GetOrderList(objListOrder); // fill list of orders
</code></pre>

<p>Now I want to sort the list based on one property of the <code>Order</code> object, for example I need to sort it by the order date or order id.</p>

<p>How can i do this in C#?</p>
","<p>The easiest way I can think of is to use Linq:</p>

<pre><code>List&lt;Order&gt; SortedList = objListOrder.OrderBy(o=&gt;o.OrderDate).ToList();
</code></pre>
","3309230"
"How can I get the application's path in a .NET console application?","807066","","<p>How do I find the application's path in a console application?</p>

<p>In <a href=""http://en.wikipedia.org/wiki/Windows_Forms"" rel=""noreferrer"">Windows Forms</a>, I can use <code>Application.StartupPath</code> to find the current path, but this doesn't seem to be available in a console application.</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getexecutingassembly.aspx"" rel=""noreferrer""><code>System.Reflection.Assembly.GetExecutingAssembly()</code></a>.<a href=""http://msdn.microsoft.com/en-us/library/system.reflection.assembly.location.aspx"" rel=""noreferrer""><code>Location</code></a><sup>1</sup></p>

<p>Combine that with <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx"" rel=""noreferrer""><code>System.IO.Path.GetDirectoryName</code></a> if all you want is the directory.</p>

<blockquote>
  <p><sup>1</sup><em>As per Mr.Mindor's comment:</em><br>
  <code>System.Reflection.Assembly.GetExecutingAssembly().Location</code> returns where the executing assembly is currently located, which may or may not be where the assembly is located when not executing. In the case of shadow copying assemblies, you will get a path in a temp directory. <a href=""https://msdn.microsoft.com/en-us/library/system.reflection.assembly.codebase(v=vs.110).aspx"" rel=""noreferrer""><code>System.Reflection.Assembly.GetExecutingAssembly().CodeBase</code></a> will return the 'permanent' path of the assembly.</p>
</blockquote>
","837501"
"How do I remedy the ""The breakpoint will not currently be hit. No symbols have been loaded for this document."" warning?","805703","","<p>C# desktop application on express edition. Worked then didn't work 5 seconds later.</p>

<p>I tried the following.</p>

<ul>
<li>Ensure debug configuration, debug flag, and full debug info are set on all assemblies.</li>
<li>Delete all bin and obj folders and all DLLs related to the project from my entire machine.</li>
<li>Recreate projects causing the problem from scratch.</li>
<li>Reboot.</li>
</ul>

<p>I have two WinForms projects in the solution. One of them loads the debug info, one doesn't. They both refer to the assembly I'm trying to get debug info on in exactly the same way in the project file. Any ideas?</p>

<hr>

<p>I want to add in here, mostly for myself when I come back to review this question, that symbols are not loaded until the assembly is loaded, and the assembly is not loaded until it is needed. If the breakpoint is in a library that is only used in one function in your main assembly, the symbols will not be loaded (and it will show the breakpoint as not being hit) until that function is called.</p>
","<p>Start debugging, as soon as you've arrived at a breakpoint or used <code>Debug &gt; Break All</code>, use <code>Debug &gt; Windows &gt; Modules</code>.  You'll see a list of all the assemblies that are loaded into the process.  Locate the one you want to get debug info for.  Right-click it and select Symbol Load Information.  You'll get a dialog that lists all the directories where it looked for the .pdb file for the assembly.  Verify that list against the actual .pdb location.  Make sure it doesn't find an old one.</p>

<p>In normal projects, the assembly and its .pdb file should always have been copied by the IDE into the same folder as your .exe.  The bin\Debug folder of your project.  Make sure you remove one from the GAC if you've been playing with it.</p>
","2155997"
"Group by in LINQ","803266","","<p>Let's suppose if we have a class like</p>

<pre><code>class Person { 
    internal int PersonID; 
    internal string car  ; 
}
</code></pre>

<p>Now I have a list of this class: <code>List&lt;Person&gt; persons;</code></p>

<p>Now this list can have multiple instances with same PersonIDs, for example: </p>

<pre><code>persons[0] = new Person { PersonID = 1, car = ""Ferrari"" }; 
persons[1] = new Person { PersonID = 1, car = ""BMW""     }; 
persons[2] = new Person { PersonID = 2, car = ""Audi""    }; 
</code></pre>

<p>Is there a way I can group by <code>personID</code> and get the list of all the cars he has? </p>

<p>For example, expected result would be </p>

<pre><code>class Result { 
   int PersonID;
   List&lt;string&gt; cars; 
}
</code></pre>

<p>So after grouping, I would get: </p>

<pre><code>results[0].PersonID = 1; 
List&lt;string&gt; cars = results[0].cars; 

result[1].PersonID = 2; 
List&lt;string&gt; cars = result[1].cars;
</code></pre>

<p>From what I have done so far: </p>

<pre><code>var results = from p in persons
              group p by p.PersonID into g
              select new { PersonID = g.Key, // this is where I am not sure what to do
</code></pre>

<p>Could someone please point me in the right direction? </p>
","<p>Absolutely - you basically want:</p>

<pre><code>var results = from p in persons
              group p.car by p.PersonId into g
              select new { PersonId = g.Key, Cars = g.ToList() };
</code></pre>

<p>Or as a non-query expression:</p>

<pre><code>var results = persons.GroupBy(
    p =&gt; p.PersonId, 
    p =&gt; p.car,
    (key, g) =&gt; new { PersonId = key, Cars = g.ToList() });
</code></pre>

<p>Basically the contents of the group (when view as an <code>IEnumerable&lt;T&gt;</code>) is a sequence of whatever values were in the projection (<code>p.car</code> in this case) present for the given key.</p>

<p>For more on how <code>GroupBy</code> works, see my <a href=""http://codeblog.jonskeet.uk/2011/01/01/reimplementing-linq-to-objects-part-21-groupby/"" rel=""noreferrer"">Edulinq post on the topic</a>.</p>

<p>(I've renamed <code>PersonID</code> to <code>PersonId</code> in the above, to follow <a href=""https://msdn.microsoft.com/en-us/library/ms229043(v=vs.110).aspx"" rel=""noreferrer"">.NET naming conventions</a>.)</p>

<p>Alternatively, you could use a <code>Lookup</code>:</p>

<pre><code>var carsByPersonId = persons.ToLookup(p =&gt; p.PersonId, p =&gt; p.car);
</code></pre>

<p>You can then get the cars for each person very easily:</p>

<pre><code>// This will be an empty sequence for any personId not in the lookup
var carsForPerson = carsByPersonId[personId];
</code></pre>
","7325306"
"Object reference not set to an instance of an object.","797489","","<p>I keep getting this error when I run the program.</p>

<blockquote>
  <p>Object reference not set to an instance of an object. 
  Description: An unhandled exception occurred during the execution of the current web request. 
  Please review the stack trace for more information about the error and where it originated in the code. 
  Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.</p>
</blockquote>

<pre><code>Source Error:

Line with error:

Line 156:        if (strSearch == """" || strSearch.Trim().Length == 0)
</code></pre>

<p>What is the correct way it should be written?</p>
","<p><strong>The correct way in .NET 4.0 is:</strong></p>

<pre><code>if (String.IsNullOrWhiteSpace(strSearch))
</code></pre>

<p>The <code>String.IsNullOrWhiteSpace</code> method used above is equivalent to:</p>

<pre><code>if (strSearch == null || strSearch == String.Empty || strSearch.Trim().Length == 0) 
// String.Empty is the same as """"
</code></pre>

<blockquote>
  <p><strong>Reference for IsNullOrWhiteSpace method</strong></p>
  
  <p><a href=""http://msdn.microsoft.com/en-us/library/system.string.isnullorwhitespace.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.string.isnullorwhitespace.aspx</a></p>
  
  <p>Indicates whether a specified string is Nothing, empty, or consists
  only of white-space characters.</p>
</blockquote>

<p><strong>In earlier versions, you could do something like this:</strong></p>

<pre><code>if (String.IsNullOrEmpty(strSearch) || strSearch.Trim().Length == 0)
</code></pre>

<p>The <code>String.IsNullOrEmpty</code> method used above is equivalent to:</p>

<pre><code>if (strSearch == null || strSearch == String.Empty)
</code></pre>

<p>Which means you still need to check for your ""IsWhiteSpace"" case with the <code>.Trim().Length == 0</code> as per the example.</p>

<blockquote>
  <p><strong>Reference for IsNullOrEmpty method</strong></p>
  
  <p><a href=""http://msdn.microsoft.com/en-us/library/system.string.isnullorempty.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.string.isnullorempty.aspx</a></p>
  
  <p>Indicates whether the specified string is Nothing or an Empty string.</p>
</blockquote>

<p><strong>Explanation:</strong></p>

<p>You need to ensure <code>strSearch</code> (or any variable for that matter) is not <code>null</code> before you dereference it using the dot character (<code>.</code>) - i.e. before you do <code>strSearch.SomeMethod()</code> or <code>strSearch.SomeProperty</code> you need to check that <code>strSearch != null</code>.</p>

<p>In your example you want to make sure your string has a value, which means you want to ensure the string:</p>

<ul>
<li>Is not null</li>
<li>Is not the empty string (<code>String.Empty</code> / <code>""""</code>)</li>
<li>Is not just whitespace</li>
</ul>

<p>In the cases above, you must put the ""Is it null?"" case first, so it doesn't go on to check the other cases (and error) when the string is <code>null</code>.</p>
","8206817"
"What is the difference between String and string in C#?","794742","","<p>Example (<em>note the case</em>):</p>

<pre class=""lang-cs prettyprint-override""><code>string s = ""Hello world!"";
String S = ""Hello world!"";
</code></pre>

<p>What are the <strong><em>guidelines</em></strong> for the use of each? And what are the <strong><em>differences</em></strong>?</p>
","<p><a href=""https://msdn.microsoft.com/en-us/library/362314fe.aspx"" rel=""noreferrer""><code>string</code></a> is an alias in C# for <a href=""https://msdn.microsoft.com/en-us/library/system.string.aspx"" rel=""noreferrer""><code>System.String</code></a>.  So technically, there is no difference.  It's like <a href=""https://stackoverflow.com/questions/62503/c-int-or-int32-should-i-care""><code>int</code> <em>vs.</em> <code>System.Int32</code></a>.</p>

<p>As far as guidelines, I think it's generally recommended to use <code>string</code> any time you're referring to an object.  </p>

<p>e.g. </p>

<pre><code>string place = ""world"";
</code></pre>

<p>Likewise, I think it's generally recommended to use <code>String</code> if you need to refer specifically to the class.</p>

<p>e.g.</p>

<pre><code>string greet = String.Format(""Hello {0}!"", place);
</code></pre>

<p>This is the style that Microsoft tends to use in <a href=""http://msdn.microsoft.com/en-us/library/System.String.Format.aspx#Format1_Example"" rel=""noreferrer"">their examples</a>.</p>

<hr>

<p>It appears that the guidance in this area may have changed, as <a href=""https://github.com/StyleCop"" rel=""noreferrer"">StyleCop</a> now enforces the use of the C# specific aliases.</p>
","7077"
"How to convert UTF-8 byte[] to string?","789583","","<p>I have a <code>byte[]</code> array that is loaded from a file that I happen to known contains <a href=""http://en.wikipedia.org/wiki/UTF-8"" rel=""noreferrer"">UTF-8</a>. In some debugging code, I need to convert it to a string. Is there a one liner that will do this? </p>

<p>Under the covers it should be just an allocation and a <em>memcopy</em>, so even if it is not implemented, it should be possible.</p>
","<pre><code>string result = System.Text.Encoding.UTF8.GetString(byteArray);
</code></pre>
","1003289"
"How do I make a textbox that only accepts numbers?","771346","","<p>I have a windows forms app with a textbox control that I want to only accept integer values. In the past I've done this kind of validation by overloading the KeyPress event and just removing characters which didn't fit the specification. I've looked at the MaskedTextBox control but I'd like a more general solution that could work with perhaps a regular expression, or depend on the values of other controls.</p>

<p>Ideally this would behave such that pressing a non numeric character would either produce no result or immediately provide the user with feedback about the invalid character.</p>
","<p>Two options:</p>

<ol>
<li><p>Use a <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.numericupdown(v=vs.110).aspx"" rel=""noreferrer""><code>NumericUpDown</code></a> instead. NumericUpDown does the filtering for you, which is nice. Of course it also gives your users the ability to hit the up and down arrows on the keyboard to increment and decrement the current value.</p></li>
<li><p>Handle the appropriate keyboard events to prevent anything but numeric input. I've had success with this two event handlers on a standard TextBox:</p>

<pre><code>private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (!char.IsControl(e.KeyChar) &amp;&amp; !char.IsDigit(e.KeyChar) &amp;&amp;
        (e.KeyChar != '.'))
    {
            e.Handled = true;
    }

    // only allow one decimal point
    if ((e.KeyChar == '.') &amp;&amp; ((sender as TextBox).Text.IndexOf('.') &gt; -1))
    {
        e.Handled = true;
    }
}
</code></pre></li>
</ol>

<p>You can remove the check for <code>'.'</code> (and the subsequent check for more than one <code>'.'</code>) if your TextBox shouldn't allow decimal places. You could also add a check for <code>'-'</code> if your TextBox should allow negative values.</p>

<p>If you want to limit the user for number of digit, use: <code>textBox1.MaxLength = 2; // this will allow the user to enter only 2 digits</code></p>
","463335"
"How to make HTTP POST web request","770321","","<p>How can I make an HTTP request and send some data using the <code>POST</code> method?
I can do <code>GET</code> request but have no idea how to make a <code>POST</code>.</p>
","<p>There are several ways to perform HTTP <code>GET</code> and <code>POST</code> requests:</p>

<hr>

<p><strong>Method A: HttpClient</strong></p>

<p>Available in: .NET Framework 4.5+, .NET Standard 1.1+, .NET Core 1.0+</p>

<p>Currently the preferred approach. Asynchronous. Portable version for other platforms available via <a href=""https://www.nuget.org/packages/Microsoft.Net.Http"" rel=""noreferrer"">NuGet</a>.</p>

<pre><code>using System.Net.Http;
</code></pre>

<p><em>Setup</em></p>

<p>It is <a href=""https://docs.microsoft.com/en-us/azure/architecture/antipatterns/improper-instantiation/"" rel=""noreferrer"">recommended</a> to instantiate one <code>HttpClient</code> for your application's lifetime and share it.</p>

<pre><code>private static readonly HttpClient client = new HttpClient();
</code></pre>

<p><em>POST</em></p>

<pre><code>var values = new Dictionary&lt;string, string&gt;
{
   { ""thing1"", ""hello"" },
   { ""thing2"", ""world"" }
};

var content = new FormUrlEncodedContent(values);

var response = await client.PostAsync(""http://www.example.com/recepticle.aspx"", content);

var responseString = await response.Content.ReadAsStringAsync();
</code></pre>

<p><em>GET</em></p>

<pre><code>var responseString = await client.GetStringAsync(""http://www.example.com/recepticle.aspx"");
</code></pre>

<hr>

<p><strong>Method B: 3rd-Party Libraries</strong></p>

<p><strong><em><a href=""https://github.com/restsharp/RestSharp"" rel=""noreferrer"">RestSharp</a></em></strong></p>

<p>Tried and tested library for interacting with REST APIs. Portable. Available via <a href=""https://www.nuget.org/packages/RestSharp"" rel=""noreferrer"">NuGet</a>.</p>

<p><strong><em><a href=""http://tmenier.github.io/Flurl/"" rel=""noreferrer"">Flurl.Http</a></em></strong></p>

<p>Newer library sporting a fluent API and testing helpers. HttpClient under the hood. Portable. Available via <a href=""https://www.nuget.org/packages/Flurl.Http"" rel=""noreferrer"">NuGet</a>.</p>

<pre><code>using Flurl.Http;
</code></pre>

<p><em>POST</em></p>

<pre><code>var responseString = await ""http://www.example.com/recepticle.aspx""
    .PostUrlEncodedAsync(new { thing1 = ""hello"", thing2 = ""world"" })
    .ReceiveString();
</code></pre>

<p><em>GET</em></p>

<pre><code>var responseString = await ""http://www.example.com/recepticle.aspx""
    .GetStringAsync();
</code></pre>

<hr>

<p><strong>Method C: Legacy</strong></p>

<p>Available in: .NET Framework 1.1+, .NET Standard 2.0+, .NET Core 1.0+</p>

<pre><code>using System.Net;
using System.Text;  // for class Encoding
using System.IO;    // for StreamReader
</code></pre>

<p><em>POST</em></p>

<pre><code>var request = (HttpWebRequest)WebRequest.Create(""http://www.example.com/recepticle.aspx"");

var postData = ""thing1=hello"";
    postData += ""&amp;thing2=world"";
var data = Encoding.ASCII.GetBytes(postData);

request.Method = ""POST"";
request.ContentType = ""application/x-www-form-urlencoded"";
request.ContentLength = data.Length;

using (var stream = request.GetRequestStream())
{
    stream.Write(data, 0, data.Length);
}

var response = (HttpWebResponse)request.GetResponse();

var responseString = new StreamReader(response.GetResponseStream()).ReadToEnd();
</code></pre>

<p><em>GET</em></p>

<pre><code>var request = (HttpWebRequest)WebRequest.Create(""http://www.example.com/recepticle.aspx"");

var response = (HttpWebResponse)request.GetResponse();

var responseString = new StreamReader(response.GetResponseStream()).ReadToEnd();
</code></pre>

<hr>

<p><strong>Method D: WebClient (Also now legacy)</strong></p>

<p>Available in: .NET Framework 1.1+, .NET Standard 2.0+, .NET Core 2.0+</p>

<pre><code>using System.Net;
using System.Collections.Specialized;
</code></pre>

<p><em>POST</em></p>

<pre><code>using (var client = new WebClient())
{
    var values = new NameValueCollection();
    values[""thing1""] = ""hello"";
    values[""thing2""] = ""world"";

    var response = client.UploadValues(""http://www.example.com/recepticle.aspx"", values);

    var responseString = Encoding.Default.GetString(response);
}
</code></pre>

<p><em>GET</em></p>

<pre><code>using (var client = new WebClient())
{
    var responseString = client.DownloadString(""http://www.example.com/recepticle.aspx"");
}
</code></pre>
","4015346"
"How can I convert String to Int?","766451","","<p>I have</p>

<pre><code>TextBoxD1.Text
</code></pre>

<p>and I want to convert it to 'int' to store it in a database. How can I do this?</p>
","<p>Try this:</p>

<pre><code>int x = Int32.Parse(TextBoxD1.Text);
</code></pre>

<p>or better yet:</p>

<pre><code>int x = 0;

Int32.TryParse(TextBoxD1.Text, out x);
</code></pre>

<p>Also, since <a href=""http://msdn.microsoft.com/en-us/library/f02979c7.aspx"" rel=""noreferrer""><code>Int32.TryParse</code></a> returns a <code>bool</code> you can use its return value to make decisions about the results of the parsing attempt:</p>

<pre><code>int x = 0;

if (Int32.TryParse(TextBoxD1.Text, out x))
{
    // you know that the parsing attempt
    // was successful
}
</code></pre>

<p>If you are curious, the difference between <code>Parse</code> and <code>TryParse</code> is best summed up like this:</p>

<blockquote>
  <p>The TryParse method is like the Parse
  method, except the TryParse method
  does not throw an exception if the
  conversion fails. It eliminates the
  need to use exception handling to test
  for a FormatException in the event
  that s is invalid and cannot be
  successfully parsed. - <a href=""http://msdn.microsoft.com/en-us/library/f02979c7.aspx"" rel=""noreferrer"">MSDN</a></p>
</blockquote>
","1019804"
"Calculate difference between two dates (number of days)?","761264","","<p>I see that this question has been answered for <a href=""https://stackoverflow.com/questions/1555262/"">Java</a>, <a href=""https://stackoverflow.com/questions/1036742/"">JavaScript</a>, and <a href=""https://stackoverflow.com/questions/676824/"">PHP</a>, but not C#. So, how might one calculate the number of days between two dates in C#?</p>
","<p>Assuming <code>StartDate</code> and <code>EndDate</code> are of type <code>DateTime</code>:</p>

<pre><code>(EndDate - StartDate).TotalDays
</code></pre>
","1607352"
"Calling the base constructor in C#","756912","","<p>If I inherit from a base class and want to pass something from the constructor of the inherited class to the constructor of the base class, how do I do that?</p>

<p>For example,</p>

<p>If I inherit from the Exception class I want to do something like this:</p>

<pre><code>class MyExceptionClass : Exception
{
     public MyExceptionClass(string message, string extraInfo)
     {
         //This is where it's all falling apart
         base(message);
     }
}
</code></pre>

<p>Basically what I want is to be able to pass the string message to the base Exception class.</p>
","<p>Modify your constructor to the following so that it calls the base class constructor properly:</p>

<pre><code>public class MyExceptionClass : Exception
{
    public MyExceptionClass(string message, string extrainfo) : base(message)
    {
        //other stuff here
    }
}
</code></pre>

<p>Note that a constructor is not something that you can call anytime within a method. That's the reason you're getting errors in your call in the constructor body.</p>
","12052"
"Turn C# object into a JSON string in .NET 4","736686","","<p>I have classes like these:</p>

<pre><code>class MyDate
{
    int year, month, day;
}

class Lad
{
    string firstName;
    string lastName;
    MyDate dateOfBirth;
}
</code></pre>

<p>And I would like to turn a <code>Lad</code> object into a JSON string like this:</p>

<pre><code>{
    ""firstName"":""Markoff"",
    ""lastName"":""Chaney"",
    ""dateOfBirth"":
    {
        ""year"":""1901"",
        ""month"":""4"",
        ""day"":""30""
    }
}
</code></pre>

<p>(without the formatting). I found <a href=""http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer(v=vs.110).aspx"">this link</a>, but it uses a namespace that's not in .NET 4. I also heard about <a href=""http://james.newtonking.com/projects/json-net.aspx"">JSON.NET</a>, but their site seems to be down at the moment, and I'm not keen on using external DLL files. Are there other options besides manually creating a JSON string writer?</p>
","<p>You could use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx""><code>JavaScriptSerializer</code></a> class (add reference to <code>System.Web.Extensions</code>):</p>

<pre><code>using System.Web.Script.Serialization;
</code></pre>



<pre><code>var json = new JavaScriptSerializer().Serialize(obj);
</code></pre>

<p>A full example:</p>

<pre><code>using System;
using System.Web.Script.Serialization;

public class MyDate
{
    public int year;
    public int month;
    public int day;
}

public class Lad
{
    public string firstName;
    public string lastName;
    public MyDate dateOfBirth;
}

class Program
{
    static void Main()
    {
        var obj = new Lad
        {
            firstName = ""Markoff"",
            lastName = ""Chaney"",
            dateOfBirth = new MyDate
            {
                year = 1901,
                month = 4,
                day = 30
            }
        };
        var json = new JavaScriptSerializer().Serialize(obj);
        Console.WriteLine(json);
    }
}
</code></pre>
","6201609"
"How do I round a decimal value to 2 decimal places (for output on a page)","732100","","<p>When displaying the value of a decimal currently with <code>.ToString()</code>, it's accurate to like 15 decimal places, and since I'm using it to represent dollars and cents, I only want the output to be 2 decimal places. </p>

<p>Do I use a variation of <code>.ToString()</code> for this?</p>
","<pre><code>decimalVar.ToString (""#.##""); // returns """" when decimalVar == 0
</code></pre>

<p>or</p>

<pre><code>decimalVar.ToString (""0.##""); // returns ""0""  when decimalVar == 0
</code></pre>
","164932"
"LINQ query on a DataTable","723337","","<p>I'm trying to perform a LINQ query on a DataTable object and bizarrely I am finding that performing such queries on DataTables is not straightforward. For example:</p>

<pre><code>var results = from myRow in myDataTable
where results.Field(""RowNo"") == 1
select results;
</code></pre>

<p>This is not allowed. How do I get something like this working?</p>

<p>I'm amazed that LINQ queries are not allowed on DataTables!</p>
","<p>You can't query against the <code>DataTable</code>'s <em>Rows</em> collection, since <code>DataRowCollection</code> doesn't implement <code>IEnumerable&lt;T&gt;</code>. You need to use the <code>AsEnumerable()</code> extension for <code>DataTable</code>. Like so:</p>

<pre><code>var results = from myRow in myDataTable.AsEnumerable()
where myRow.Field&lt;int&gt;(""RowNo"") == 1
select myRow;
</code></pre>

<p>And as Keith says, you'll need to add a reference to <a href=""http://msdn.microsoft.com/en-us/library/system.data.datarowextensions.aspx"" rel=""noreferrer"">System.Data.DataSetExtensions</a></p>

<p><code>AsEnumerable()</code> returns <code>IEnumerable&lt;DataRow&gt;</code>. If you need to convert <code>IEnumerable&lt;DataRow&gt;</code> to a <code>DataTable</code>, use the <code>CopyToDataTable()</code> extension.</p>
","11593"
"The located assembly's manifest definition does not match the assembly reference","710013","","<p>I am trying to run some unit tests in a C# Windows Forms application (Visual Studio 2005), and I get the following error:</p>

<blockquote>
  <p>System.IO.FileLoadException: Could not load file or assembly 'Utility, Version=1.2.0.200, Culture=neutral, PublicKeyToken=764d581291d764f7' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)**</p>
  
  <p>at x.Foo.FooGO()</p>
  
  <p>at x.Foo.Foo2(String groupName_) in Foo.cs:line 123</p>
  
  <p>at x.Foo.UnitTests.FooTests.TestFoo() in FooTests.cs:line 98**</p>
  
  <p>System.IO.FileLoadException: Could not load file or assembly 'Utility, Version=1.2.0.203, Culture=neutral, PublicKeyToken=764d581291d764f7' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)</p>
</blockquote>

<p>I look in my references, and I only have a reference to <code>Utility version 1.2.0.203</code> (the other one is old).</p>

<p>Any suggestions on how I figure out what is trying to reference this old version of this DLL file?</p>

<p>Besides, I don't think I even have this old assembly on my hard drive.
Is there any tool to search for this old versioned assembly?</p>
","<p>The .NET Assembly loader is unable to find 1.2.0.203, but did find a 1.2.0.200. This assembly does not match what was requested and therefore you get this error. In simple words, it can't find the assembly that was referenced. Make sure it can find the right assembly by putting it in the GAC or in the application path. Also see <a href=""http://blogs.msdn.com/junfeng/archive/2004/03/25/95826.aspx"" rel=""noreferrer"">http://blogs.msdn.com/junfeng/archive/2004/03/25/95826.aspx</a>.</p>
","215054"
"What is the { get; set; } syntax in C#?","709151","","<p>I am learning ASP.NET MVC, and I can read English documents, But I don't really understand what is happening with this code:</p>

<pre><code>public class Genre
{
    public string Name { get; set; }
}
</code></pre>

<p>What does this mean: <code>{ get; set; }</code>?</p>
","<p>It's a so-called auto property, and is essentially a shorthand for the following (similar code will be generated by the compiler):</p>

<pre><code>private string name;
public string Name
{
    get
    {
        return this.name;
    }
    set
    {
        this.name = value;
    }
}
</code></pre>
","5096967"
"How do I identify if a string is a number?","668684","","<p>If I have these strings:</p>

<ol>
<li><p><code>""abc""</code>  =  <code>false</code></p></li>
<li><p><code>""123""</code>  = <code>true</code></p></li>
<li><p><code>""ab2""</code>  = <code>false</code></p></li>
</ol>

<p>Is there a command, like IsNumeric or something else, that can identify if a string is a valid number?</p>
","<pre><code>int n;
bool isNumeric = int.TryParse(""123"", out n);
</code></pre>

<p><strong>Update</strong> As of C# 7:</p>

<pre><code>var isNumeric = int.TryParse(""123"", out int n);
</code></pre>

<p>The <em>var</em> s can be replaced by their respective types!</p>
","894271"
"Reading settings from app.config or web.config in .net","656033","","<p>I'm working on a C# class library that needs to be able to read settings from the <code>web.config</code> or <code>app.config</code> file (depending on whether the DLL is referenced from an ASP.NET web application or a Windows Forms application).</p>

<p>I've found that</p>

<pre><code>ConfigurationSettings.AppSettings.Get(""MySetting"")
</code></pre>

<p>works, but that code has been marked as deprecated by Microsoft.  </p>

<p>I've read that I should be using: </p>

<pre><code>ConfigurationManager.AppSettings[""MySetting""]
</code></pre>

<p>However, the <code>System.Configuration.ConfigurationManager</code> class doesn't seem to be available from a C# Class Library project.</p>

<p>Does anyone know what the best way to do this is?</p>
","<p>You'll need to <strong>add a reference</strong> to <code>System.Configuration</code> in your project's <strong>references folder</strong>.  </p>

<p>You should definitely be using the <code>ConfigurationManager</code> over the obsolete <code>ConfigurationSettings</code>.</p>
","1189369"
"LINQ Orderby Descending Query","652185","","<p>I'm sure this will be a relatively simple one.</p>

<p>I have a LINQ query that I want to order by the most recently created date.</p>

<p>See:</p>

<pre><code>        var itemList = from t in ctn.Items
                        where !t.Items &amp;&amp; t.DeliverySelection
                        orderby t.Delivery.SubmissionDate descending
                        select t;
</code></pre>

<p>I have also tried:</p>

<pre><code>       var itemList = (from t in ctn.Items
                        where !t.Items &amp;&amp; t.DeliverySelection
                        select t).OrderByDescending();
</code></pre>

<p>but this gives an error :</p>

<blockquote>
  <p>No overload for method
  'OrderByDescending' takes 0 arguments</p>
</blockquote>

<p>From what I've read, I'm fairly sure the first way I've done it should work. I've tried changing descending to ascending just to see if it does anything but it stays the same. </p>

<p>I'd be grateful if someone could take a look at the query and see if I'm doing anything wrong. Thanks :)</p>
","<p>You need to choose a Property to sort by and pass it as a lambda expression to <a href=""https://msdn.microsoft.com/en-us/library/bb534855(v=vs.100).aspx""><code>OrderByDescending</code></a></p>

<p>like:</p>

<pre><code>.OrderByDescending(x =&gt; x.Delivery.SubmissionDate);
</code></pre>

<hr>

<p>Really, though the first version of your LINQ statement should work.  Is <code>t.Delivery.SubmissionDate</code> actually populated with valid dates?  </p>
","5344836"
"Type Checking: typeof, GetType, or is?","649255","","<p>I've seen many people use the following code:</p>

<pre><code>Type t = typeof(obj1);
if (t == typeof(int))
    // Some code here
</code></pre>

<p>But I know you could also do this:</p>

<pre><code>if (obj1.GetType() == typeof(int))
    // Some code here
</code></pre>

<p>Or this:</p>

<pre><code>if (obj1 is int)
    // Some code here
</code></pre>

<p>Personally, I feel the last one is the cleanest, but is there something I'm missing? Which one is the best to use, or is it personal preference?</p>
","<p>All are different.</p>

<ul>
<li><code>typeof</code> takes a type name (which you specify at compile time).</li>
<li><code>GetType</code> gets the runtime type of an instance.</li>
<li><code>is</code> returns true if an instance is in the inheritance tree.</li>
</ul>

<h3>Example</h3>

<pre><code>class Animal { } 
class Dog : Animal { }

void PrintTypes(Animal a) { 
    print(a.GetType() == typeof(Animal)) // false 
    print(a is Animal)                   // true 
    print(a.GetType() == typeof(Dog))    // true
}

Dog spot = new Dog(); 
PrintTypes(spot);
</code></pre>

<hr>

<blockquote>
  <p>What about <code>typeof(T)</code>? Is it also resolved at compile time?</p>
</blockquote>

<p>Yes. T is always what the type of the expression is. Remember, a generic method is basically a whole bunch of methods with the appropriate type. Example:</p>

<pre><code>string Foo&lt;T&gt;(T object) { return typeof(T).Name; }

Animal probably_a_dog = new Dog();
Dog    definitely_a_dog = new Dog();

Foo(probably_a_dog); // this calls Foo&lt;Animal&gt; and returns ""Animal""
Foo&lt;Animal&gt;(probably_a_dog); // this is exactly the same as above
Foo&lt;Dog&gt;(probably_a_dog); // !!! This will not compile. The parameter expects a Dog, you cannot pass in an Animal.

Foo(definitely_a_dog); // this calls Foo&lt;Dog&gt; and returns ""Dog""
Foo&lt;Dog&gt;(definitely_a_dog); // this is exactly the same as above.
Foo&lt;Animal&gt;(definitely_a_dog); // this calls Foo&lt;Animal&gt; and returns ""Animal"". 
Foo((Animal)definitely_a_dog); // this does the same as above, returns ""Animal""
</code></pre>
","983061"
"Adding a newline into a string in C#","648762","","<p>I have a string.</p>

<pre><code>string strToProcess = ""fkdfdsfdflkdkfk@dfsdfjk72388389@kdkfkdfkkl@jkdjkfjd@jjjk@"";
</code></pre>

<p>I need to add a newline after every occurence of ""@"" symbol in the string.</p>

<p>My Output should be like this</p>

<pre><code>fkdfdsfdflkdkfk@
dfsdfjk72388389@
kdkfkdfkkl@
jkdjkfjd@
jjjk@
</code></pre>
","<pre><code>string text = ""fkdfdsfdflkdkfk@dfsdfjk72388389@kdkfkdfkkl@jkdjkfjd@jjjk@"";

text = text.Replace(""@"", ""@"" + System.Environment.NewLine);
</code></pre>
","224244"
"Deep cloning objects","647093","","<p>I want to do something like:</p>

<pre><code>MyObject myObj = GetMyObj(); // Create and fill a new object
MyObject newObj = myObj.Clone();
</code></pre>

<p>And then make changes to the new object that are not reflected in the original object.</p>

<p>I don't often need this functionality, so when it's been necessary, I've resorted to creating a new object and then copying each property individually, but it always leaves me with the feeling that there is a better or more elegant way of handling the situation.</p>

<p>How can I clone or deep copy an object so that the cloned object can be modified without any changes being reflected in the original object?</p>
","<p>Whilst the standard practice is to implement the <a href=""http://msdn.microsoft.com/en-us/library/system.icloneable.aspx"" rel=""noreferrer""><code>ICloneable</code></a> interface (described <a href=""https://stackoverflow.com/questions/78536/cloning-objects-in-c/78568#78568"">here</a>, so I won't regurgitate), here's a nice deep clone object copier I found on <a href=""http://www.codeproject.com/Articles/23832/Implementing-Deep-Cloning-via-Serializing-objects"" rel=""noreferrer"">The Code Project</a> a while ago and incorporated it in our stuff.</p>

<p>As mentioned elsewhere, it does require your objects to be serializable.</p>

<pre><code>using System;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;

/// &lt;summary&gt;
/// Reference Article http://www.codeproject.com/KB/tips/SerializedObjectCloner.aspx
/// Provides a method for performing a deep copy of an object.
/// Binary Serialization is used to perform the copy.
/// &lt;/summary&gt;
public static class ObjectCopier
{
    /// &lt;summary&gt;
    /// Perform a deep Copy of the object.
    /// &lt;/summary&gt;
    /// &lt;typeparam name=""T""&gt;The type of object being copied.&lt;/typeparam&gt;
    /// &lt;param name=""source""&gt;The object instance to copy.&lt;/param&gt;
    /// &lt;returns&gt;The copied object.&lt;/returns&gt;
    public static T Clone&lt;T&gt;(T source)
    {
        if (!typeof(T).IsSerializable)
        {
            throw new ArgumentException(""The type must be serializable."", ""source"");
        }

        // Don't serialize a null object, simply return the default for that object
        if (Object.ReferenceEquals(source, null))
        {
            return default(T);
        }

        IFormatter formatter = new BinaryFormatter();
        Stream stream = new MemoryStream();
        using (stream)
        {
            formatter.Serialize(stream, source);
            stream.Seek(0, SeekOrigin.Begin);
            return (T)formatter.Deserialize(stream);
        }
    }
}
</code></pre>

<p>The idea is that it serializes your object and then deserializes it into a fresh object. The benefit is that you don't have to concern yourself about cloning everything when an object gets too complex.</p>

<p>And with the use of extension methods (also from the originally referenced source):</p>

<p>In case you prefer to use the new <a href=""http://en.wikipedia.org/wiki/Extension_method"" rel=""noreferrer"">extension methods</a> of C# 3.0, change the method to have the following signature:</p>

<pre><code>public static T Clone&lt;T&gt;(this T source)
{
   //...
}
</code></pre>

<p>Now the method call simply becomes <code>objectBeingCloned.Clone();</code>.</p>

<p><strong>EDIT</strong> (January 10 2015) Thought I'd revisit this, to mention I recently started using (Newtonsoft) Json to do this, it <a href=""http://maxondev.com/serialization-performance-comparison-c-net-formats-frameworks-xmldatacontractserializer-xmlserializer-binaryformatter-json-newtonsoft-servicestack-text/"" rel=""noreferrer"">should be</a> lighter, and avoids the overhead of [Serializable] tags. (<strong>NB</strong> @atconway has pointed out in the comments that private members are not cloned using the JSON method)</p>

<pre><code>/// &lt;summary&gt;
/// Perform a deep Copy of the object, using Json as a serialisation method. NOTE: Private members are not cloned using this method.
/// &lt;/summary&gt;
/// &lt;typeparam name=""T""&gt;The type of object being copied.&lt;/typeparam&gt;
/// &lt;param name=""source""&gt;The object instance to copy.&lt;/param&gt;
/// &lt;returns&gt;The copied object.&lt;/returns&gt;
public static T CloneJson&lt;T&gt;(this T source)
{            
    // Don't serialize a null object, simply return the default for that object
    if (Object.ReferenceEquals(source, null))
    {
        return default(T);
    }

    // initialize inner objects individually
    // for example in default constructor some list property initialized with some values,
    // but in 'source' these items are cleaned -
    // without ObjectCreationHandling.Replace default constructor values will be added to result
    var deserializeSettings = new JsonSerializerSettings {ObjectCreationHandling = ObjectCreationHandling.Replace};

    return JsonConvert.DeserializeObject&lt;T&gt;(JsonConvert.SerializeObject(source), deserializeSettings);
}
</code></pre>
","78612"
"C# String enums","633567","","<p>I have the following enumeration:</p>

<pre><code>public enum AuthenticationMethod
{
    FORMS = 1,
    WINDOWSAUTHENTICATION = 2,
    SINGLESIGNON = 3
}
</code></pre>

<p>The problem however is that I need the word ""FORMS"" when I ask for AuthenticationMethod.FORMS and not the id 1.</p>

<p>I have found the following solution for this problem (<a href=""http://www.codeproject.com/Articles/11130/String-Enumerations-in-C"" rel=""noreferrer"">link</a>):</p>

<p>First I need to create a custom attribute called ""StringValue"":</p>

<pre><code>public class StringValue : System.Attribute
{
    private readonly string _value;

    public StringValue(string value)
    {
        _value = value;
    }

    public string Value
    {
        get { return _value; }
    }

}
</code></pre>

<p>Then I can add this attribute to my enumerator:</p>

<pre><code>public enum AuthenticationMethod
{
    [StringValue(""FORMS"")]
    FORMS = 1,
    [StringValue(""WINDOWS"")]
    WINDOWSAUTHENTICATION = 2,
    [StringValue(""SSO"")]
    SINGLESIGNON = 3
}
</code></pre>

<p>And of course I need something to retrieve that StringValue:</p>

<pre><code>public static class StringEnum
{
    public static string GetStringValue(Enum value)
    {
        string output = null;
        Type type = value.GetType();

        //Check first in our cached results...

        //Look for our 'StringValueAttribute' 

        //in the field's custom attributes

        FieldInfo fi = type.GetField(value.ToString());
        StringValue[] attrs =
           fi.GetCustomAttributes(typeof(StringValue),
                                   false) as StringValue[];
        if (attrs.Length &gt; 0)
        {
            output = attrs[0].Value;
        }

        return output;
    }
}
</code></pre>

<p>Good now I've got the tools to get a string value for an enumerator.
I can then use it like this:</p>

<pre><code>string valueOfAuthenticationMethod = StringEnum.GetStringValue(AuthenticationMethod.FORMS);
</code></pre>

<p>Okay now all of these work like a charm but I find it a whole lot of work. I was wondering if there is a better solution for this.</p>

<p>I also tried something with a dictionary and static properties but that wasn't better either.</p>
","<p>Try <a href=""http://www.javacamp.org/designPattern/enum.html"" rel=""noreferrer"">type-safe-enum</a> pattern.</p>

<pre><code>public sealed class AuthenticationMethod {

    private readonly String name;
    private readonly int value;

    public static readonly AuthenticationMethod FORMS = new AuthenticationMethod (1, ""FORMS"");
    public static readonly AuthenticationMethod WINDOWSAUTHENTICATION = new AuthenticationMethod (2, ""WINDOWS"");
    public static readonly AuthenticationMethod SINGLESIGNON = new AuthenticationMethod (3, ""SSN"");        

    private AuthenticationMethod(int value, String name){
        this.name = name;
        this.value = value;
    }

    public override String ToString(){
        return name;
    }

}
</code></pre>

<hr>

<p><strong>Update</strong>
Explicit (or implicit) type conversion can be done by</p>

<ul>
<li><p>adding static field with mapping</p>

<pre><code>private static readonly Dictionary&lt;string, AuthenticationMethod&gt; instance = new Dictionary&lt;string,AuthenticationMethod&gt;();
</code></pre>

<ul>
<li>n.b. In order that the initialisation of the the ""enum member"" fields doesn't throw a NullReferenceException when calling the instance constructor, be sure to put the Dictionary field before the ""enum member"" fields in your class. This is because static field initialisers are called in declaration order, and before the static constructor, creating the weird and necessary but confusing situation that the instance constructor can be called before all static fields have been initialised, and before the static constructor is called.</li>
</ul></li>
<li><p>filling this mapping in instance constructor</p>

<pre><code>instance[name] = this;
</code></pre></li>
<li><p>and adding <a href=""http://msdn.microsoft.com/en-us/library/09479473.aspx"" rel=""noreferrer"">user-defined type conversion operator</a></p>

<pre><code>public static explicit operator AuthenticationMethod(string str)
{
    AuthenticationMethod result;
    if (instance.TryGetValue(str, out result))
        return result;
    else
        throw new InvalidCastException();
}
</code></pre></li>
</ul>
","424414"
"ComboBox: Adding Text and Value to an Item (no Binding Source)","630117","","<p>In C# WinApp, how can I add both Text and Value to the items of my ComboBox?
I did a search and usually the answers are using ""Binding to a source"".. but in my case I do not have a binding source ready in my program...
How can I do something like this:</p>

<pre><code>combo1.Item[1] = ""DisplayText"";
combo1.Item[1].Value = ""useful Value""
</code></pre>
","<p>You must create your own class type and override the ToString() method to return the text you want.  Here is a simple example of a class you can use:</p>

<pre><code>public class ComboboxItem
{
    public string Text { get; set; }
    public object Value { get; set; }

    public override string ToString()
    {
        return Text;
    }
}
</code></pre>

<p>The following is a simple example of its usage:</p>

<pre><code>private void Test()
{
    ComboboxItem item = new ComboboxItem();
    item.Text = ""Item text1"";
    item.Value = 12;

    comboBox1.Items.Add(item);

    comboBox1.SelectedIndex = 0;

    MessageBox.Show((comboBox1.SelectedItem as ComboboxItem).Value.ToString());
}
</code></pre>
","3063421"
"How do you convert a byte array to a hexadecimal string, and vice versa?","627415","","<p>How can you convert a byte array to a hexadecimal string, and vice versa?</p>
","<p>Either:</p>

<pre><code>public static string ByteArrayToString(byte[] ba)
{
  StringBuilder hex = new StringBuilder(ba.Length * 2);
  foreach (byte b in ba)
    hex.AppendFormat(""{0:x2}"", b);
  return hex.ToString();
}
</code></pre>

<p>or:</p>

<pre><code>public static string ByteArrayToString(byte[] ba)
{
  string hex = BitConverter.ToString(ba);
  return hex.Replace(""-"","""");
}
</code></pre>

<p>There are even more variants of doing it, for example <a href=""http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/3928b8cb-3703-4672-8ccd-33718148d1e3/"" rel=""noreferrer"">here</a>.</p>

<p>The reverse conversion would go like this:</p>

<pre><code>public static byte[] StringToByteArray(String hex)
{
  int NumberChars = hex.Length;
  byte[] bytes = new byte[NumberChars / 2];
  for (int i = 0; i &lt; NumberChars; i += 2)
    bytes[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
  return bytes;
}
</code></pre>

<hr>

<p>Using <code>Substring</code> is the best option in combination with <code>Convert.ToByte</code>. See <a href=""https://stackoverflow.com/a/26304129"">this answer</a> for more information. If you need better performance, you must avoid <code>Convert.ToByte</code> before you can drop <code>SubString</code>.</p>
","311179"
"Case insensitive 'Contains(string)'","624391","","<p>Is there a way to make the following return true?</p>

<pre><code>string title = ""ASTRINGTOTEST"";
title.Contains(""string"");
</code></pre>

<p>There doesn't seem to be an overload that allows me to set the case sensitivity.. Currently I UPPERCASE them both, but that's just silly.</p>

<p><strong>UPDATE</strong><br>
The sillyness I refer to is the <a href=""http://en.wikipedia.org/wiki/Internationalization_and_localization"" rel=""noreferrer"">i18n</a> issues that come with up- and down casing.</p>

<p><strong>UPDATE</strong><br>
This question is ancient and since then I have realized I asked for a simple answer for a really vast and difficult topic if you care to investigate it fully.<br>
For most cases, in mono-lingual, English code bases <a href=""https://stackoverflow.com/a/444818/11333"">this</a> answer will suffice. I'm suspecting because most people coming here fall in this category this is the most popular answer.<br>
<a href=""https://stackoverflow.com/a/15464440/11333"">This</a> answer however brings up the inherent problem that we can't compare text case insensitive until we know both texts are the same culture and we know  what that culture is. This is maybe a less popular answer, but I think it is more correct and that's why I marked it as such.</p>
","<p>To test if the string <code>paragraph</code> contains the string <code>word</code> (thanks @QuarterMeister)</p>

<pre><code>culture.CompareInfo.IndexOf(paragraph, word, CompareOptions.IgnoreCase) &gt;= 0
</code></pre>

<p>Where <code>culture</code> is the instance of <a href=""http://msdn.microsoft.com/en-gb/library/system.globalization.cultureinfo(v=vs.110).aspx"" rel=""noreferrer""><code>CultureInfo</code></a> describing the language that the text is written in.</p>

<p>This solution is transparent about <strong>the definition of case-insensitivity, which is language dependent</strong>. For example, the English language uses the characters <code>I</code> and <code>i</code> for the upper and lower case versions of the ninth letter, whereas the Turkish language uses these characters for the <a href=""http://en.wikipedia.org/wiki/Dotted_and_dotless_I"" rel=""noreferrer"">eleventh and twelfth letters</a> of its 29 letter-long alphabet. The Turkish upper case version of 'i' is the unfamiliar character 'İ'.</p>

<p>Thus the strings <code>tin</code> and <code>TIN</code> are the same word <em>in English</em>, but different words <em>in Turkish</em>. As I understand, one means 'spirit' and the other is an onomatopoeia word. (Turks, please correct me if I'm wrong, or suggest a better example)</p>

<p>To summarise, you can only answer the question 'are these two strings the same but in different cases' <em>if you know what language the text is in</em>. If you don't know, you'll have to take a punt. Given English's hegemony in software, you should probably resort to <a href=""https://stackoverflow.com/questions/9760237/what-does-cultureinfo-invariantculture-mean""><code>CultureInfo.InvariantCulture</code></a>, because it'll be wrong in familiar ways.</p>
","15464440"
"Run Command Prompt Commands","607107","","<p>Is there any way to run command prompt commands from within a C# application?  If so how would I do the following:</p>

<pre><code>copy /b Image1.jpg + Archive.rar Image2.jpg
</code></pre>

<p>This basically embeds an RAR file within JPG image.  I was just wondering if there was a way to do this automatically in C#.  Thank you.</p>
","<p>this is all you have to do run shell commands from C#</p>

<pre><code>string strCmdText;
strCmdText= ""/C copy /b Image1.jpg + Archive.rar Image2.jpg"";
System.Diagnostics.Process.Start(""CMD.exe"",strCmdText);
</code></pre>

<p><strong>EDIT:</strong></p>

<p>This is to hide the cmd window.</p>

<pre><code>System.Diagnostics.Process process = new System.Diagnostics.Process();
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
startInfo.FileName = ""cmd.exe"";
startInfo.Arguments = ""/C copy /b Image1.jpg + Archive.rar Image2.jpg"";
process.StartInfo = startInfo;
process.Start();
</code></pre>
","1469790"
"CS0120: An object reference is required for the nonstatic field, method, or property 'foo'","603488","","<p>Consider:</p>

<pre><code>namespace WindowsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            //int[] val = { 0, 0};
            int val;
            if (textBox1.Text == """")
            {
                MessageBox.Show(""Input any no"");
            }
            else
            {
                val = Convert.ToInt32(textBox1.Text);
                Thread ot1 = new Thread(new ParameterizedThreadStart(SumData));
                ot1.Start(val);
            }
        }

        private static void ReadData(object state)
        {
            System.Windows.Forms.Application.Run();
        }

        void setTextboxText(int result)
        {
            if (this.InvokeRequired)
            {
                this.Invoke(new IntDelegate(SetTextboxTextSafe), new object[] { result }); }
            else
            {
                SetTextboxTextSafe(result);
            }
        }

        void SetTextboxTextSafe(int result)
        {
            label1.Text = result.ToString();
        }

        private static void SumData(object state)
        {
            int result;
            //int[] icount = (int[])state;
            int icount = (int)state;

            for (int i = icount; i &gt; 0; i--)
            {
                result += i;
                System.Threading.Thread.Sleep(1000);
            }
            setTextboxText(result);
        }

        delegate void IntDelegate(int result);

        private void button2_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }
    }
}
</code></pre>

<p>Why is this error occurring?</p>

<blockquote>
  <p>An object reference is required for the nonstatic field, method, or property 'WindowsApplication1.Form1.setTextboxText(int)</p>
</blockquote>
","<p>It looks like you are calling a non static property from a static method.  You will need to either make the property static, or create an instance of Form1.</p>

<pre><code>static void SetTextboxTextSafe(int result)
{
    label1.Text = result.ToString();
}
</code></pre>

<p>OR</p>

<pre><code>private static void SumData(object state)
{
    int result;
    //int[] icount = (int[])state;
    int icount = (int)state;

    for (int i = icount; i &gt; 0; i--)
    {
        result += i;
        System.Threading.Thread.Sleep(1000);
    }
    Form1 frm1 = new Form1();
    frm1.setTextboxText(result);
}
</code></pre>

<p>More info about this error can be found <a href=""https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-messages/cs0120"" rel=""nofollow noreferrer"">on MSDN</a>.</p>
","498410"
"Creating a byte array from a stream","599962","","<p>What is the prefered method for creating a byte array from an input stream? </p>

<p>Here is my current solution with .NET 3.5. </p>

<pre><code>Stream s;
byte[] b;

using (BinaryReader br = new BinaryReader(s))
{
    b = br.ReadBytes((int)s.Length);
}
</code></pre>

<p>Is it still a better idea to read and write chunks of the stream?</p>
","<p>It really depends on whether or not you can trust <code>s.Length</code>. For many streams, you just don't know how much data there will be. In such cases - and before .NET 4 - I'd use code like this:</p>

<pre><code>public static byte[] ReadFully(Stream input)
{
    byte[] buffer = new byte[16*1024];
    using (MemoryStream ms = new MemoryStream())
    {
        int read;
        while ((read = input.Read(buffer, 0, buffer.Length)) &gt; 0)
        {
            ms.Write(buffer, 0, read);
        }
        return ms.ToArray();
    }
}
</code></pre>

<p>With .NET 4 and above, I'd use <a href=""https://msdn.microsoft.com/en-us/library/system.io.stream.copyto"" rel=""noreferrer""><code>Stream.CopyTo</code></a>, which is basically equivalent to the loop in my code - create the <code>MemoryStream</code>, call <code>stream.CopyTo(ms)</code> and then return <code>ms.ToArray()</code>. Job done.</p>

<p>I should perhaps explain why my answer is longer than the others. <a href=""http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx"" rel=""noreferrer""><code>Stream.Read</code></a> doesn't guarantee that it will read everything it's asked for. If you're reading from a network stream, for example, it may read one packet's worth and then return, even if there will be more data soon. <a href=""http://msdn.microsoft.com/en-us/library/system.io.binaryreader.read.aspx"" rel=""noreferrer""><code>BinaryReader.Read</code></a> will keep going until the end of the stream or your specified size, but you still have to know the size to start with.</p>

<p>The above method will keep reading (and copying into a MemoryStream) until it runs out of data. It then asks the MemoryStream to return a copy of the data in an array. If you know the size to start with - or <em>think</em> you know the size, without being sure - you can construct the MemoryStream to be that size to start with. Likewise you can put a check at the end, and if the length of the stream is the same size as the buffer (returned by <a href=""http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx"" rel=""noreferrer"">MemoryStream.GetBuffer</a>) then you can just return the buffer. So the above code isn't quite optimised, but will at least be correct. It doesn't assume any responsibility for closing the stream - the caller should do that.</p>

<p>See <a href=""http://www.yoda.arachsys.com/csharp/readbinary.html"" rel=""noreferrer"">this article</a> for more info (and an alternative implementation).</p>
","221941"
"Multiple cases in switch statement","598715","","<p>Is there a way to fall through multiple case statements without stating <code>case value:</code> repeatedly?</p>

<p>I know this works:</p>

<pre><code>switch (value)
{
   case 1:
   case 2:
   case 3:
      //do some stuff
      break;
   case 4:
   case 5:
   case 6:
      //do some different stuff
      break;
   default:
       //default stuff
      break;
}
</code></pre>

<p>but I'd like to do something like this:</p>

<pre><code>switch (value)
{
   case 1,2,3:
      //Do Something
      break;
   case 4,5,6:
      //Do Something
      break;
   default:
      //Do the Default
      break;
}
</code></pre>

<p>Is this syntax I'm thinking of from a different language, or am I missing something?</p>
","<p>There is no syntax in C++ nor C# for the second method you mentioned. </p>

<p>There's nothing wrong with your first method.  If however you have very big ranges, just use a series of if statements.</p>
","68611"
"How do I create a message box with ""Yes"", ""No"" choices and a DialogResult?","570132","","<p>I want to make simple Yes/No choiced MessageBox, but I think it is nonsense to design a form for that. I thought I could use MessageBox, add buttons, etc. to accomplish this. It is simple, but since there is no DialogResult returned, how do I retrieve the result?</p>
","<p>This should do it:</p>

<pre><code>DialogResult dialogResult = MessageBox.Show(""Sure"", ""Some Title"", MessageBoxButtons.YesNo);
if(dialogResult == DialogResult.Yes)
{
    //do something
}
else if (dialogResult == DialogResult.No)
{
    //do something else
}
</code></pre>
","3036880"
"The type or namespace name could not be found","568808","","<p>I have a <code>C#</code> solution with several projects in <code>Visual Studio 2010</code>.
One is a test project (I'll call it ""<em>PrjTest</em>""), the other is a <code>Windows Forms Application</code> project (I'll call it ""<em>PrjForm</em>"").  There is also a third project referenced by PrjForm, which it is able to reference and use successfully.</p>

<p><em>PrjForm</em> references <em>PrjTest</em>, and <em>PrjForm</em> has a class with a <code>using</code> statement:</p>

<pre><code>using PrjTest;
</code></pre>

<ol>
<li>Reference has been correctly added</li>
<li><code>using</code> statement is correctly in place</li>
<li>Spelling is correct</li>
<li>PrjTest builds successfully</li>
<li>PrjForm almost builds, but breaks on the <code>using PrjTest;</code> line with the error:</li>
</ol>

<p><strong><em>The type or namespace name 'PrjTest' could not be found (are you missing a using directive or an assembly reference?)</em></strong></p>

<p>I've tried the following to resolve this:</p>

<ol>
<li>Removed Resharper (since Resharper had no trouble recognizing the referenced project, I thought it might be worth a shot) </li>
<li>Removed and re-added the reference and using statement</li>
<li>Recreated PrjForm from scratch</li>
<li>PrjForm currently resides inside the PrjTest folder, I tried moving it to an outside folder</li>
<li>Loaded the solution on a different computer with a fresh copy of <code>VS 2010</code></li>
</ol>

<p>I have done my homework and spent far too long looking for an answer online, none of the solutions has helped yet.</p>

<p>What else could I try?</p>
","<p>See <a href=""https://stackoverflow.com/questions/4286599/referenced-project-gets-lost-at-compile-time"">this question</a>.</p>

<p>Turns out this was a client profiling issue.</p>

<p>PrjForm was set to "".Net Framework 4 Client Profile""
I changed it to "".Net Framework 4"", and now I have a successful build.</p>

<p>Thanks everyone! 
I guess it figures that after all that time spent searching online, I find the solution minutes after posting, I guess the trick is knowing the right question to ask..</p>
","4765076"
"C# loop - break vs. continue","562318","","<p>In a C# (feel free to answer for other languages) loop, what's the difference between break and continue as a means to leave the structure of the loop, and go to the next iteration?</p>

<p>Example:</p>

<pre><code>foreach (DataRow row in myTable.Rows)
{
    if (someConditionEvalsToTrue)
    {
        break; //what's the difference between this and continue ?
        //continue;
    }
}
</code></pre>
","<p><code>break</code> will exit the loop completely, <code>continue</code> will just <strong>skip</strong> the current iteration.</p>

<p>For example:</p>

<pre><code>for (int i = 0; i &lt; 10; i++) {
    if (i == 0) {
        break;
    }

    DoSomeThingWith(i);
}
</code></pre>

<p>The break will cause the loop to exit on the first iteration - <code>DoSomeThingWith</code> will never be executed. This here:</p>

<pre><code>for (int i = 0; i &lt; 10; i++) {
    if(i == 0) {
        continue;
    }

    DoSomeThingWith(i);
}
</code></pre>

<p>Will not execute <code>DoSomeThingWith</code> for <code>i = 0</code>, but the loop will <strong>continue</strong> and <code>DoSomeThingWith</code> will be executed for <code>i = 1</code> to <code>i = 9</code>.</p>
","6417"
"How do I enumerate an enum?","558487","","<p>How can you enumerate an <code>enum</code> in C#?</p>

<p>E.g. the following code does not compile:</p>

<pre class=""lang-cs prettyprint-override""><code>public enum Suit 
{
    Spades,
    Hearts,
    Clubs,
    Diamonds
}

public void EnumerateAllSuitsDemoMethod() 
{
    foreach (Suit suit in Suit) 
    {
        DoSomething(suit);
    }
}
</code></pre>

<p>And gives the following compile-time error:</p>

<blockquote>
  <p>'Suit' is a 'type' but is used like a 'variable'</p>
</blockquote>

<p>It fails on the <code>Suit</code> keyword, the second one.</p>
","<pre><code>foreach (Suit suit in Enum.GetValues(typeof(Suit)))
{
    // ...
}
</code></pre>
","105402"
"How to add a new row to datagridview programmatically","551398","","<p>if add row to <code>DataTable</code></p>

<pre><code>DataRow row = datatable1.NewRow();
row[""column2""]=""column2"";
row[""column6""]=""column6"";
datatable1.Rows.Add(row);
</code></pre>

<p>How about <code>DataGridView</code>??</p>
","<p>You can do:</p>

<pre><code>DataGridViewRow row = (DataGridViewRow)yourDataGridView.Rows[0].Clone();
row.Cells[0].Value = ""XYZ"";
row.Cells[1].Value = 50.2;
yourDataGridView.Rows.Add(row);
</code></pre>

<p>or:</p>

<pre><code>DataGridViewRow row = (DataGridViewRow)yourDataGridView.Rows[0].Clone();
row.Cells[""Column2""].Value = ""XYZ"";
row.Cells[""Column6""].Value = 50.2;
yourDataGridView.Rows.Add(row);
</code></pre>

<p>Another way: </p>

<pre><code>this.dataGridView1.Rows.Add(""five"", ""six"", ""seven"",""eight"");
this.dataGridView1.Rows.Insert(0, ""one"", ""two"", ""three"", ""four"");
</code></pre>

<p>From: <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rows.aspx"">http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rows.aspx</a></p>
","10063825"
"Regex for numbers only","549444","","<p>I haven't used regular expressions at all, so I'm having difficulty troubleshooting. I want the regex to match only when the contained string is all numbers; but with the two examples below it is matching a string that contains all numbers plus an equals sign like ""1234=4321"". I'm sure there's a way to change this behavior, but as I said, I've never really done much with regular expressions.</p>

<pre><code>string compare = ""1234=4321"";
Regex regex = new Regex(@""[\d]"");

if (regex.IsMatch(compare))
{ 
    //true
}

regex = new Regex(""[0-9]"");

if (regex.IsMatch(compare))
{ 
    //true
}
</code></pre>

<p>In case it matters, I'm using C# and .NET2.0.</p>
","<p>Use the beginning and end anchors.</p>

<pre><code>Regex regex = new Regex(@""^\d$"");
</code></pre>

<p>Use <code>""^\d+$""</code> if you need to match more than one digit.</p>

<hr>

<p>Note that <code>""\d""</code> will match <code>[0-9]</code> and other digit characters like the Eastern Arabic numerals <code>٠١٢٣٤٥٦٧٨٩</code>.  Use <code>""^[0-9]+$""</code> to restrict matches to just the Arabic numerals 0 - 9.</p>

<hr>

<p>If you need to include any numeric representations other than just digits (like decimal values for starters), then see <a href=""https://stackoverflow.com/users/471272/tchrist"">@tchrist</a>'s <a href=""https://stackoverflow.com/a/4247184/1288"">comprehensive guide to parsing numbers with regular expressions</a>.</p>
","273144"
"How do you give a C# Auto-Property a default value?","547315","","<p>How do you give a C# Auto-Property a default value?  I either use the constructor, or revert to the old syntax. </p>

<p><strong> Using the Constructor:</strong></p>

<pre><code>class Person 
{
    public Person()
    {
        Name = ""Default Name"";
    }
    public string Name { get; set; }
}
</code></pre>

<p><strong>Using normal property syntax</strong>  (with a default value)</p>

<pre><code>private string name = ""Default Name"";
public string Name 
{
    get 
    {
        return name;
    }
    set
    {
        name = value;
    }
}
</code></pre>

<p>Is there a better way?</p>
","<p>In C# 5 and earlier, to give auto implemented properties a default value, you have to do it in a constructor.</p>

<p>The ability to have auto property initializers is included since C# 6.0. The syntax is:</p>

<pre><code>public int X { get; set; } = x; // C# 6 or higher
</code></pre>
","40754"
"Convert DateTime to string format(""yyyyMMdd"")","544180","","<p>I am having a problem converting a datetime which is in string format but I am not able to convert it to yyyyMMdd format.</p>

<p>my code is:</p>

<pre><code>string tpoc = refSubClaim.BenefitsFolder.BenefitFolderIdNumber.ToString();
string[] tpocinfo = Regex.Split(tpoc,"";"");

for (int i = 0; i &lt; tpocinfo.Length; i++)
{
    switch (i)
    {
        case 0:
        {
            string[] tpoc2 = Regex.Split(tpocinfo[0], "","");
            claimantAuxillaryRecord.TPOCDate2 = tpoc2[0].ToString();
            claimantAuxillaryRecord.TPOCAmount2 = Convert.ToDecimal(tpoc2[1]);
            claimantAuxillaryRecord.FundingDelayedBeyondTPOCStartDate2 = tpoc2[2].ToString();
        }
        break;
</code></pre>
","<p>if you have a date in a string with the format ""ddMMyyyy"" and want to convert it to ""yyyyMMdd"" you could do like this:</p>

<pre><code>DateTime dt = DateTime.ParseExact(dateString, ""ddMMyyyy"", 
                                  CultureInfo.InvariantCulture);
dt.ToString(""yyyyMMdd"");
</code></pre>
","3477821"
"How do you get the index of the current iteration of a foreach loop?","540998","","<p>Is there some rare language construct I haven't encountered (like the few I've learned recently, some on Stack Overflow) in C# to get a value representing the current iteration of a foreach loop?</p>

<p>For instance, I currently do something like this depending on the circumstances:</p>

<pre><code>int i=0;
foreach (Object o in collection)
{
    // ...
    i++;
}
</code></pre>
","<p>The <code>foreach</code> is for iterating over collections that implement <a href=""http://msdn.microsoft.com/en-us/library/9eekhta0%28v=vs.110%29.aspx"" rel=""noreferrer""><code>IEnumerable</code></a>. It does this by calling <a href=""http://msdn.microsoft.com/en-us/library/s793z9y2(v=vs.110).aspx"" rel=""noreferrer""><code>GetEnumerator</code></a> on the collection, which will return an <a href=""http://msdn.microsoft.com/en-us/library/78dfe2yb(v=vs.110).aspx"" rel=""noreferrer""><code>Enumerator</code></a>.</p>

<p>This Enumerator has a method and a property:</p>

<ul>
<li>MoveNext()</li>
<li>Current</li>
</ul>

<p><code>Current</code> returns the object that Enumerator is currently on, <code>MoveNext</code> updates <code>Current</code> to the next object.</p>

<p>Obviously, the concept of an index is foreign to the concept of enumeration, and cannot be done.</p>

<p>Because of that, most collections are able to be traversed using an indexer and the for loop construct.</p>

<p>I greatly prefer using a for loop in this situation compared to tracking the index with a local variable.</p>
","43029"
"Could not establish trust relationship for SSL/TLS secure channel -- SOAP","538055","","<p>I have a simple web service call, generated by a .NET (C#) 2.0 windows app, via the web service proxy generated by Visual Studio, for a web service also written in C# (2.0). This has worked for several years, and continues to do so at the dozen or so places where it is running.</p>

<p>A new installation at a new site is running into a problem. When attempting to invoke the web service, it fails with the message saying:</p>

<blockquote>
  <p>Could not establish a trust relationship for the SSL/TLS secure
  channel</p>
</blockquote>

<p>The URL of the web service uses SSL (https://) -- but this has been working for a long time (and continues to do so) from many other locations. </p>

<p>Where do I look? Could this be a security issue between Windows and .NET that is unique to this install? If so, where do I set up trust relationships? I'm lost!</p>
","<p>Thoughts (based on pain in the past):</p>

<ul>
<li>do you have DNS and line-of-sight to the server?</li>
<li>are you using the correct name from the certificate?</li>
<li>is the certificate still valid?</li>
<li>is a badly configured load balancer messing things up?</li>
<li>does the new <s>server</s> machine have the clock set correctly (i.e. so that the UTC time is correct [ignore local time, it is largely irrelevent]) - this certainly matters for WCF, so may impact regular SOAP?</li>
<li>is there a certificate trust chain issue? if you browse from the server to the soap service, can you get SSL?</li>
<li>related to the above - has the certificate been installed to the correct location? (you may need a copy in Trusted Root Certification Authorities)</li>
<li>is the server's machine-level proxy set correctly? (which different to the user's proxy); see proxycfg for XP / 2003 (not sure about Vista etc)</li>
</ul>
","703285"
"LINQ's Distinct() on a particular property","537968","","<p>I am playing with LINQ to learn about it, but I can't figure out how to use Distinct when I do not have a simple list (a simple list of integers is pretty easy to do, this is not the question). What I if want to use <a href=""https://msdn.microsoft.com/library/system.linq.enumerable.distinct%28v=vs.100%29.aspx"" rel=""noreferrer"">Distinct</a> on a list of an Object on <em>one</em> or <em>more</em> properties of the object?</p>

<p>Example: If an object is <code>Person</code>, with Property <code>Id</code>. How can I get all Person and use <code>Distinct</code> on them with the property <code>Id</code> of the object?</p>

<pre><code>Person1: Id=1, Name=""Test1""
Person2: Id=1, Name=""Test1""
Person3: Id=2, Name=""Test2""
</code></pre>

<p>How can I get just Person1 and Person3? Is that possible?</p>

<p>If it's not possible with LINQ, what would be the best way to have a list of <code>Person</code> depending on some of its properties in .NET 3.5?</p>
","<p><strong>EDIT</strong>: This is now part of <a href=""https://github.com/morelinq/MoreLINQ"" rel=""noreferrer"">MoreLINQ</a>.</p>

<p>What you need is a ""distinct-by"" effectively. I don't believe it's part of LINQ as it stands, although it's fairly easy to write:</p>

<pre><code>public static IEnumerable&lt;TSource&gt; DistinctBy&lt;TSource, TKey&gt;
    (this IEnumerable&lt;TSource&gt; source, Func&lt;TSource, TKey&gt; keySelector)
{
    HashSet&lt;TKey&gt; seenKeys = new HashSet&lt;TKey&gt;();
    foreach (TSource element in source)
    {
        if (seenKeys.Add(keySelector(element)))
        {
            yield return element;
        }
    }
}
</code></pre>

<p>So to find the distinct values using just the <code>Id</code> property, you could use:</p>

<pre><code>var query = people.DistinctBy(p =&gt; p.Id);
</code></pre>

<p>And to use multiple properties, you can use anonymous types, which implement equality appropriately:</p>

<pre><code>var query = people.DistinctBy(p =&gt; new { p.Id, p.Name });
</code></pre>

<p>Untested, but it should work (and it now at least compiles).</p>

<p>It assumes the default comparer for the keys though - if you want to pass in an equality comparer, just pass it on to the <code>HashSet</code> constructor.</p>
","489421"
"List<> OrderBy Alphabetical Order","537416","","<p>I'm using C# on Framework 3.5.  I'm looking to quickly sort a Generic <code>List&lt;&gt;</code>.  For the sake of this example lets say I have a List of a Person type with a property of lastname.  How would I sort this List using a lambda expression?</p>

<pre><code>List&lt;Person&gt; people = PopulateList();
people.OrderBy(???? =&gt; ?????)
</code></pre>
","<p>If you mean an in-place sort (i.e. the list is updated):</p>

<pre><code>people.Sort((x, y) =&gt; string.Compare(x.LastName, y.LastName));
</code></pre>

<p>If you mean a new list:</p>

<pre><code>var newList = people.OrderBy(x=&gt;x.LastName).ToList(); // ToList optional
</code></pre>
","188155"
"Checking if an object is null in C#","536415","","<p>I would like to prevent further processing on an object if it is null.</p>

<p>In the following code I check if the object is null by either:</p>

<pre><code>if (!data.Equals(null))
</code></pre>

<p>and</p>

<pre><code>if (data != null)
</code></pre>

<p>However, I receive a <code>NullReferenceException</code> at <code>dataList.Add(data)</code>. If the object was null, it should never have even entered the <code>if</code>-statement!</p>

<p>Thus, I'm asking if this is proper way of checking if an object is null:</p>

<pre><code>public List&lt;Object&gt; dataList;
public  bool AddData(ref Object data)
    bool success = false;
    try
    {
        // I've also used ""if (data != null)"" which hasn't worked either
        if (!data.Equals(null))
        {
           //NullReferenceException occurs here ...
           dataList.Add(data);
           success = doOtherStuff(data);
        }
    }
    catch (Exception e)
    {
        throw new Exception(e.ToString());
    }
    return success;
}
</code></pre>

<p>If this is the proper way of checking if the object is null, what am I doing wrong (how can I prevent further processing on the object to avoid the NullReferenceException)?</p>
","<p>It's not <code>data</code> that is <code>null</code>, but <code>dataList</code>.</p>

<p>You need to create one with</p>

<pre><code>public List&lt;Object&gt; dataList = new List&lt;Object&gt;();
</code></pre>

<p>Even better: since it's a field, make it <code>private</code>. And if there's nothing preventing you, make it also <code>readonly</code>. Just good practice.</p>

<p><strong>Aside</strong></p>

<p>The correct way to check for nullity is <code>if(data != null)</code>. This kind of check is ubiquitous for reference types; even <code>Nullable&lt;T&gt;</code> overrides the equality operator to be a more convenient way of expressing <code>nullable.HasValue</code> when checking for nullity.</p>

<p>If you do <code>if(!data.Equals(null))</code> then you will get a <code>NullReferenceException</code> if <code>data == null</code>. Which is kind of comical since avoiding this exception was the goal in the first place.</p>

<p>You are also doing this:</p>

<pre><code>catch (Exception e)
{
    throw new Exception(e.ToString());
}
</code></pre>

<p>This is definitely not good. I can imagine that you put it there just so you can break into the debugger while still inside the method, in which case ignore this paragraph. Otherwise, don't catch exceptions for nothing. And if you do, rethrow them using just <code>throw;</code>.</p>
","6417912"
"HTML.ActionLink method","532780","","<p>Let's say I have a class</p>

<pre><code>public class ItemController:Controller
{
    public ActionResult Login(int id)
    {
        return View(""Hi"", id);
    }
}
</code></pre>

<p>On a page that is not located at the Item folder, where <code>ItemController</code> resides, I want to create a link to the <code>Login</code> method. So which <code>Html.ActionLink</code> method I should use and what parameters should I pass?</p>

<p>Specifically, I am looking for the replacement of the method </p>

<pre><code>Html.ActionLink(article.Title,
    new { controller = ""Articles"", action = ""Details"",
          id = article.ArticleID })
</code></pre>

<p>that has been retired in the recent ASP.NET MVC incarnation. </p>
","<p>I think what you want is this:</p>

<h2>ASP.NET MVC1</h2>

<pre><code>Html.ActionLink(article.Title, 
                ""Login"",  // &lt;-- Controller Name.
                ""Item"",   // &lt;-- ActionMethod
                new { id = article.ArticleID }, // &lt;-- Route arguments.
                null  // &lt;-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                )
</code></pre>

<p>This uses the following method ActionLink signature:</p>

<pre><code>public static string ActionLink(this HtmlHelper htmlHelper, 
                                string linkText,
                                string controllerName,
                                string actionName,
                                object values, 
                                object htmlAttributes)
</code></pre>

<h2>ASP.NET MVC2</h2>

<p><em>two arguments have been switched around</em></p>

<pre><code>Html.ActionLink(article.Title, 
                ""Item"",   // &lt;-- ActionMethod
                ""Login"",  // &lt;-- Controller Name.
                new { id = article.ArticleID }, // &lt;-- Route arguments.
                null  // &lt;-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                )
</code></pre>

<p>This uses the following method ActionLink signature:</p>

<pre><code>public static string ActionLink(this HtmlHelper htmlHelper, 
                                string linkText,
                                string actionName,
                                string controllerName,
                                object values, 
                                object htmlAttributes)
</code></pre>

<h2>ASP.NET MVC3+</h2>

<p><em>arguments are in the same order as MVC2, however the id value is no longer required:</em></p>

<pre><code>Html.ActionLink(article.Title, 
                ""Item"",   // &lt;-- ActionMethod
                ""Login"",  // &lt;-- Controller Name.
                new { article.ArticleID }, // &lt;-- Route arguments.
                null  // &lt;-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                )
</code></pre>

<p>This avoids hard-coding any routing logic into the link.</p>

<pre><code> &lt;a href=""/Item/Login/5""&gt;Title&lt;/a&gt; 
</code></pre>

<p>This will give you the following html output, assuming:</p>

<ol>
<li><code>article.Title = ""Title""</code></li>
<li><code>article.ArticleID = 5</code></li>
<li>you still have the following route defined</li>
</ol>

<p>.
.</p>

<pre><code>routes.MapRoute(
    ""Default"",     // Route name
    ""{controller}/{action}/{id}"",                           // URL with parameters
    new { controller = ""Home"", action = ""Index"", id = """" }  // Parameter defaults
);
</code></pre>
","201341"
"Could not load file or assembly or one of its dependencies","532460","","<p>I'm having another of these ""Could not load file or assembly or one of its dependencies"" problems.</p>

<blockquote>
  <p>Additional information: Could not load
  file or assembly
  'Microsoft.Practices.Unity,
  Version=1.2.0.0, Culture=neutral,
  PublicKeyToken=31bf3856ad364e35' or
  one of its dependencies. The located
  assembly's manifest definition does
  not match the assembly reference.
  (Exception from HRESULT: 0x80131040)</p>
</blockquote>

<p>I have no idea what is causing this or how I could debug it to find the cause.</p>

<p>I've done a search in my solution catalogs .csproj files, and every where I have Unity I have:</p>

<blockquote>
  <p>Reference
  Include=""Microsoft.Practices.Unity,
  Version=2.0.414.0, Culture=neutral,
  PublicKeyToken=31bf3856ad364e35,
  processorArchitecture=MSIL""</p>
</blockquote>

<p>Can't find any reference anywhere which goes against 1.2.0.0 in any of my projects.</p>

<p>Any ideas how I should go about solving this?</p>

<p>I would also appreciate tips on how to debug problems like this in general.</p>
","<ol>
<li><p>Check if you are referencing an assembly which in turn referencing an old version of unity. For example let's say you have an assembly called <code>ServiceLocator.dll</code> which needs an old version of Unity assembly, now when you reference the <code>ServiceLocator</code> you should provide it with the old version of Unity, and that makes the problem.</p></li>
<li><p>May be the output folder where all projects build their assemblies, has an old version of unity.</p></li>
</ol>

<p>You can use <a href=""https://docs.microsoft.com/en-us/dotnet/framework/tools/fuslogvw-exe-assembly-binding-log-viewer"" rel=""noreferrer"">FusLogVw</a> to find out who is loading the old assemblies, just define a path for the log, and run your solution, then check (in FusLogvw) the first line where the Unity assembly is loaded, double click it and see the calling assembly, and here you go.</p>
","4470042"
"What is the difference between Public, Private, Protected, and Nothing?","527163","","<p>All my college years I have been using <code>public</code>, and would like to know the difference between <code>public</code>, <code>private</code>, and <code>protected</code>?</p>

<p>Also what does <code>static</code> do as opposed to having nothing?</p>
","<h2>Access modifiers</h2>

<blockquote>
  <p><strong>public</strong></p>
  
  <blockquote>
    <p>The type or member can be accessed by any other code in the same assembly or another assembly that references it.</p>
  </blockquote>
  
  <p><strong>private</strong></p>
  
  <blockquote>
    <p>The type or member can only be accessed by code in the same class or struct.</p>
  </blockquote>
  
  <p><strong>protected</strong></p>
  
  <blockquote>
    <p>The type or member can only be accessed by code in the same class or struct, or in a derived class.</p>
  </blockquote>
  
  <p><strong>internal</strong></p>
  
  <blockquote>
    <p>The type or member can be accessed by any code in the same assembly, but not from another assembly.</p>
  </blockquote>
  
  <p><strong>protected internal</strong></p>
  
  <blockquote>
    <p>The type or member can be accessed by any code in the same assembly, or by any derived class in another assembly. </p>
  </blockquote>
</blockquote>

<p>When <strong>no access modifier</strong> is set, a default access modifier is used. So there is always some form of access modifier even if it's not set.</p>

<p><strong>Static</strong></p>

<blockquote>
  <p>The static modifier on a class means that the class cannot be instantiated, and that all of its members are static. A static member has one version regardless of how many instances of its enclosing type are created.</p>
  
  <p>A static class is basically the same as a non-static class, but there is one difference: a static class cannot be externally instantiated. In other words, you cannot use the new keyword to create a variable of the class type. Because there is no instance variable, you access the members of a static class by using the class name itself.</p>
  
  <p>However, there is a such thing as a <a href=""http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=vs.80%29.aspx"" rel=""noreferrer"">static constructor</a>. Any class can have one of these, including static classes. They cannot be called directly &amp; cannot have parameters (other than any type parameters on the class itself). A static constructor is called automatically to initialize the class before the first instance is created or any static members are referenced. Looks like this:</p>
</blockquote>

<pre><code>static class Foo()
{
    static Foo()
    {
        Bar = ""fubar"";
    }

    public static string Bar { get; set; }
}
</code></pre>

<p>Static classes are often used as services, you can use them like so:</p>

<pre><code>MyStaticClass.ServiceMethod(...);
</code></pre>
","614844"
"Send e-mail via SMTP using C#","518731","","<p>I can't understand why this code is not working. I get an error saying property can not be assigned</p>

<pre><code>MailMessage mail = new MailMessage();
SmtpClient client = new SmtpClient();            
client.Port = 25;
client.DeliveryMethod = SmtpDeliveryMethod.Network;
client.UseDefaultCredentials = false;
client.Host = ""smtp.gmail.com"";
mail.To = ""user@hotmail.com""; // &lt;-- this one
mail.From = ""you@yourcompany.com"";
mail.Subject = ""this is a test email."";
mail.Body = ""this is my test email body"";
client.Send(mail);
</code></pre>
","<p><code>mail.To</code> and <code>mail.From</code> are readonly.  Move them to the constructor.</p>

<pre><code>using System.Net.Mail;

...

MailMessage mail = new MailMessage(""you@yourcompany.com"", ""user@hotmail.com"");
SmtpClient client = new SmtpClient();
client.Port = 25;
client.DeliveryMethod = SmtpDeliveryMethod.Network;
client.UseDefaultCredentials = false;
client.Host = ""smtp.gmail.com"";
mail.Subject = ""this is a test email."";
mail.Body = ""this is my test email body"";
client.Send(mail);
</code></pre>
","9201317"
"Find an item in List by LINQ?","516968","","<p>Here I have a simple example to find an item in a list of strings. Normally I use for loop or anonymous delegate to do it like this:</p>

<pre><code>int GetItemIndex(string search)
{
   int found = -1;
   if ( _list != null )
   {
     foreach (string item in _list) // _list is an instance of List&lt;string&gt;
     { 
        found++;
        if ( string.Equals(search, item) )
        {
           break;
        }
      }
      /* use anonymous delegate
      string foundItem = _list.Find( delegate(string item) {
         found++;
         return string.Equals(search, item);
      });
      */
   }
   return found;
}
</code></pre>

<p>LINQ is new for me. I am curious if I can use LINQ to find item in list? How if possible?</p>
","<p>There's a few ways (note this is <em>not</em> a complete list).</p>

<p>1) <a href=""http://msdn.microsoft.com/en-us/library/bb535118.aspx"" rel=""noreferrer""><strong>Single</strong></a> will return a single result, but will throw an exception if it finds none or more than one (which may or may not be what you want):</p>

<pre><code>string search = ""lookforme"";
List&lt;string&gt; myList = new List&lt;string&gt;();
string result = myList.Single(s =&gt; s == search);
</code></pre>

<p>Note <code>SingleOrDefault()</code> will behave the same, except it will return null for reference types, or the default value for value types, instead of throwing an exception.</p>

<p>2) <a href=""http://msdn.microsoft.com/en-us/library/bb534803.aspx"" rel=""noreferrer""><strong>Where</strong></a> will return all items which match your criteria, so you may get an IEnumerable with one element:</p>

<pre><code>IEnumerable&lt;string&gt; results = myList.Where(s =&gt; s == search);
</code></pre>

<p>3) <a href=""http://msdn.microsoft.com/en-us/library/bb535050.aspx"" rel=""noreferrer""><strong>First</strong></a> will return the first item which matches your criteria:</p>

<pre><code>string result = myList.First(s =&gt; s == search);
</code></pre>

<p>Note <code>FirstOrDefault()</code> will behave the same, except it will return null for reference types, or the default value for value types, instead of throwing an exception.</p>
","1175662"
"The requested page cannot be accessed because the related configuration data for the page is invalid error","513457","","<p>I want to upload my own asp.net website on the IIS through <code>IIS manager</code>. But when I do this I get the following error  </p>

<blockquote>
  <p>HTTP Error 500.19 - Internal Server Error The requested page cannot be
  accessed because the related configuration data for the page is
  invalid</p>
</blockquote>

<pre><code>Module  IIS Web Core
Notification    Unknown
Handler Not yet determined
Error Code  0x80070005
Config Error    Cannot read configuration file due to insufficient permissions
Config File \\?\C:\Users\Yasso\Documents\Visual Studio 2008\WebSites\WebSite5\web.config
</code></pre>

<p>I searched many times for a solution for this error but none of the solutions solved the error.</p>

<p>I have a problem in IUSR account. I can't see this account in the ""group or user names"" in the properties of the <code>web.config</code>.</p>

<p>What is the problem?</p>
","<p>The message is saying that your configuration file is corrupt in some way. However it also says that it can't actually access the config file. So I'd ignore the original message about corruption/lack of validity as this is most likely just the effect of not being able to read the file due to a lack of authorization.</p>

<p>The reason it cannot read the config file is because the process running your web app does not have permission to access the file/directory. So you need to give the process running your web app those permissions. </p>

<p>The access rights should be fairly straightforward, i.e. at least <em>Read</em>, and, depending on your app, maybe <em>Write</em>.</p>

<p>Above, you mention <em>IUSR</em> etc. not being in the properties for <code>web.config</code>. If by that you mean that <em>IUSR</em> is not listed in the security tab of the file then it's a good thing. One doesn't want to give <em>IUSR</em> any kind of permission to <em>web.config</em>. The role <em>IUSR</em> is an anonymous internet user.</p>

<p>The file <em>web.config</em> should <strong>only</strong> be accessible through your application.</p>

<p>The problem is you haven't said which OS and IIS version you are using so it's difficult to advise which steps to take.</p>

<p>I.e. in IIS 7.5, the error message you're quoting is likely to occur due to your <em>ApplicationPoolIdentity</em> not being assigned the permissions. Your web application belongs to an application pool and so you need to give the permissions to the OS account that your web application's application pool runs under. Often this is something like <em>NetworkService</em> but you may have customized it to run under a purpose made account. Without more info it's difficult to help you.</p>
","10570506"
"How to add a string to a string[] array? There's no .Add function","508555","","<pre><code>private string[] ColeccionDeCortes(string Path)
{
    DirectoryInfo X = new DirectoryInfo(Path);
    FileInfo[] listaDeArchivos = X.GetFiles();
    string[] Coleccion;

    foreach (FileInfo FI in listaDeArchivos)
    {
        //Add the FI.Name to the Coleccion[] array, 
    }

    return Coleccion;
}
</code></pre>

<p>I'd like to convert the <code>FI.Name</code> to a string and then add it to my array. How can I do this?</p>
","<p>You can't add items to an array, since it has fixed length, what you're looking for is a <code>List&lt;string&gt;</code>, which can later be turned to an array using <code>list.ToArray()</code>.</p>
","1440274"
"Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding. The statement has been terminated","505954","","<p>I have many users on my web site (20000-60000 per day), which is a download site for mobile files.  I have remote access to my server (windows server 2008-R2). <br/>  I've received <em>""Server is unavailable""</em> errors before, but am now seeing a connection timeout error.
<br/>  I'm not familiar with this - why does it occur and how can I fix it? </p>

<p>The full error is below:</p>

<blockquote>
  <p>Server Error in '/' Application. Timeout expired.  The timeout period
  elapsed prior to completion of the operation or the server is not
  responding. The statement has been terminated. Description: An
  unhandled exception occurred during the execution of the current web
  request. Please review the stack trace for more information about the
  error and where it originated in the code.</p>
  
  <p>Exception Details: System.Data.SqlClient.SqlException: Timeout
  expired.  The timeout period elapsed prior to completion of the
  operation or the server is not responding. The statement has been
  terminated.</p>
  
  <p>Source Error:</p>
  
  <p>An unhandled exception was generated during the execution of the
  current web request. Information regarding the origin and location of
  the exception can be identified using the exception stack trace below.</p>
  
  <p>Stack Trace:</p>
  
  <p>[SqlException (0x80131904): Timeout expired.  The timeout period
  elapsed prior to completion of the operation or the server is not
  responding. The statement has been terminated.]<br>
  System.Data.SqlClient.SqlConnection.OnError(SqlException exception,
  Boolean breakConnection) +404<br>
  System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412<br>
  System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior,
  SqlCommand cmdHandler, SqlDataReader dataStream,
  BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject
  stateObj) +1363<br>
  System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds,
  RunBehavior runBehavior, String resetOptionsString) +6387741<br>
  System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior
  cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean
  async) +6389442<br>
  System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior
  cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String
  method, DbAsyncResult result) +538<br>
  System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult
  result, String methodName, Boolean sendToPipe) +689<br>
  System.Data.SqlClient.SqlCommand.ExecuteNonQuery() +327<br>
  NovinMedia.Data.DbObject.RunProcedure(String storedProcName,
  IDataParameter[] parameters, Int32&amp; rowsAffected) +209<br>
  DataLayer.OnlineUsers.Update_SessionEnd_And_Online(Object Session_End,
  Boolean Online) +440<br>
  NiceFileExplorer.Global.Application_Start(Object sender, EventArgs e)
  +163</p>
  
  <p>[HttpException (0x80004005): Timeout expired.  The timeout period
  elapsed prior to completion of the operation or the server is not
  responding. The statement has been terminated.]<br>
  System.Web.HttpApplicationFactory.EnsureAppStartCalledForIntegratedMode(HttpContext
  context, HttpApplication app) +4052053<br>
  System.Web.HttpApplication.RegisterEventSubscriptionsWithIIS(IntPtr
  appContext, HttpContext context, MethodInfo[] handlers) +191<br>
  System.Web.HttpApplication.InitSpecial(HttpApplicationState state,
  MethodInfo[] handlers, IntPtr appContext, HttpContext context) +352<br>
  System.Web.HttpApplicationFactory.GetSpecialApplicationInstance(IntPtr
  appContext, HttpContext context) +407<br>
  System.Web.Hosting.PipelineRuntime.InitializeApplication(IntPtr
  appContext) +375</p>
  
  <p>[HttpException (0x80004005): Timeout expired.  The timeout period
  elapsed prior to completion of the operation or the server is not
  responding. The statement has been terminated.]<br>
  System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11686928
  System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context)
  +141    System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest
  wr, HttpContext context) +4863749</p>
</blockquote>

<hr>

<p><strong>EDIT AFTER ANSWERS:</strong><br>
my <code>Application_Start</code> in <code>Global.asax</code> is like below:  </p>

<pre><code>protected void Application_Start(object sender, EventArgs e)
{
    Application[""OnlineUsers""] = 0;

    OnlineUsers.Update_SessionEnd_And_Online(
        DateTime.Now,
        false);

    AddTask(""DoStuff"", 10);
}
</code></pre>

<p>The stored procedure being called is:</p>

<pre><code>ALTER Procedure [dbo].[sp_OnlineUsers_Update_SessionEnd_And_Online]
    @Session_End datetime,
    @Online bit
As
Begin
    Update OnlineUsers
    SET
        [Session_End] = @Session_End,
        [Online] = @Online

End
</code></pre>

<p>I have two methods for getting online users:</p>

<ol>
<li>using <code>Application[""OnlineUsers""] = 0;</code>  </li>
<li>the other one using database</li>
</ol>

<p>So, for method #2 I reset all OnlineUsers at <code>Application_Start</code>.   There are over 482,751 records in that table.  </p>
","<p>Looks like you have a query that is taking longer than it should.
From your stack trace and your code you should be able to determine exactly what query that is.</p>

<p>This type of timeout can have three causes; </p>

<ol>
<li>There's a deadlock somewhere</li>
<li>The database's statistics and/or query plan cache are incorrect</li>
<li>The query is too complex and needs to be tuned</li>
</ol>

<p>A deadlock can be difficult to fix, but it's easy to determine whether that is the case. Connect to your database with Sql Server Management Studio. In the left pane right-click on the server node and select <em>Activity Monitor</em>. Take a look at the running processes.
Normally most will be idle or running. When the problem occurs you can identify any blocked process by the process state. If you right-click on the process and select <em>details</em> it'll show you the last query executed by the process.</p>

<p>The second issue will cause the database to use a sub-optimal query plan. It can be resolved by clearing the statistics:</p>

<pre><code>exec sp_updatestats
</code></pre>

<p>If that doesn't work you could also try</p>

<pre><code>dbcc freeproccache
</code></pre>

<p>You should not do this when your server is under heavy load because it will temporarily incur a big performace hit as all stored procs and queries are recompiled when first executed. 
However, since you state the issue occurs <em>sometimes</em>, and the stack trace indicates your application is starting up, I think you're running a query that is only run on occasionally. You may be better off by forcing SQL Server not to reuse a previous query plan. See <a href=""https://stackoverflow.com/a/8590152/64096"">this answer</a> for details on how to do that.</p>

<p>I've already touched on the third issue, but you can easily determine whether the query needs tuning by executing the query manually, for example using Sql Server Management Studio. If the query takes too long to complete, even after resetting the statistics you'll probably need to tune it. For help with that, you should post the exact query in a new question.</p>
","8603111"
"Deserializing JSON to .NET object using Newtonsoft (or LINQ to JSON maybe?)","502089","","<p>I know there are a few posts about Newtonsoft so hopefully this isn't exactly a repeat...I'm trying to convert JSON data returned by Kazaa's API into a nice object of some kind</p>

<pre><code>WebClient client = new WebClient();
Stream stream = client.OpenRead(""http://api.kazaa.com/api/v1/search.json?q=muse&amp;type=Album"");
StreamReader reader = new StreamReader(stream);

List&lt;string&gt; list = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;List&lt;string&gt;&gt;(reader.Read().ToString());

foreach (string item in list)
{
    Console.WriteLine(item);
}

//Console.WriteLine(reader.ReadLine());
stream.Close();
</code></pre>

<p>That JsonConvert line is just the most recent one I was trying...I'm not quite getting it and was hoping to eliminate some footwork by asking you guys. I was originally trying to convert it into a Dictionary or something...and actually, I just need to snag a couple of values in there so judging by the documentation, maybe Newtonsoft's LINQ to JSON might be a better choice? Thoughts/Links?</p>

<p>Here is an example of the JSON return data:</p>

<pre><code>{
  ""page"": 1,
  ""total_pages"": 8,
  ""total_entries"": 74,
  ""q"": ""muse"",
  ""albums"": [
    {
      ""name"": ""Muse"",
      ""permalink"": ""Muse"",
      ""cover_image_url"": ""http://image.kazaa.com/images/69/01672812 1569/Yaron_Herman_Trio/Muse/Yaron_Herman_Trio-Muse_1.jpg"",
      ""id"": 93098,
      ""artist_name"": ""Yaron Herman Trio""
    },
    {
      ""name"": ""Muse"",
      ""permalink"": ""Muse"",
      ""cover_image_url"": ""htt p://image.kazaa.com/images/54/888880301154/Candy_Lo/Muse/Candy_Lo-Muse_1.jpg"",
      ""i d"": 102702,
      ""artist_name"": ""\u76e7\u5de7\u97f3""
    },
    {
      ""name"": ""Absolution"",
      ""permalink"": "" Absolution"",
      ""cover_image_url"": ""http://image.kazaa.com/images/65/093624873365/Mus e/Absolution/Muse-Absolution_1.jpg"",
      ""id"": 48896,
      ""artist_name"": ""Muse""
    },
    {
      ""name"": ""Ab solution"",
      ""permalink"": ""Absolution-2"",
      ""cover_image_url"": ""http://image.kazaa.com/i mages/20/825646911820/Muse/Absolution/Muse-Absolution_1.jpg"",
      ""id"": 118573,
      ""artist _name"": ""Muse""
    },
    {
      ""name"": ""Black Holes And Revelations"",
      ""permalink"": ""Black-Holes-An d-Revelations"",
      ""cover_image_url"": ""http://image.kazaa.com/images/66/093624428466/ Muse/Black_Holes_And_Revelations/Muse-Black_Holes_And_Revelations_1.jpg"",
      ""id"": 48813,
      ""artist_name"": ""Muse""
    },
    {
      ""name"": ""Black Holes And Revelations"",
      ""permalink"": ""Bla ck-Holes-And-Revelations-2"",
      ""cover_image_url"": ""http://image.kazaa.com/images/86/ 825646911486/Muse/Black_Holes_And_Revelations/Muse-Black_Holes_And_Revelations_1 .jpg"",
      ""id"": 118543,
      ""artist_name"": ""Muse""
    },
    {
      ""name"": ""Origin Of Symmetry"",
      ""permalink"": ""Origin-Of-Symmetry"",
      ""cover_image_url"": ""http://image.kazaa.com/images/29/825646 912629/Muse/Origin_Of_Symmetry/Muse-Origin_Of_Symmetry_1.jpg"",
      ""id"": 120491,
      ""artis t_name"": ""Muse""
    },
    {
      ""name"": ""Showbiz"",
      ""permalink"": ""Showbiz"",
      ""cover_image_url"": ""http: //image.kazaa.com/images/68/825646182268/Muse/Showbiz/Muse-Showbiz_1.jpg"",
      ""id"": 60444,
      ""artist_name"": ""Muse""
    },
    {
      ""name"": ""Showbiz"",
      ""permalink"": ""Showbiz-2"",
      ""cover_imag e_url"": ""http://image.kazaa.com/images/50/825646912650/Muse/Showbiz/Muse-Showbiz_ 1.jpg"",
      ""id"": 118545,
      ""artist_name"": ""Muse""
    },
    {
      ""name"": ""The Resistance"",
      ""permalink"": ""T he-Resistance"",
      ""cover_image_url"": ""http://image.kazaa.com/images/36/825646864836/ Muse/The_Resistance/Muse-The_Resistance_1.jpg"",
      ""id"": 121171,
      ""artist_name"": ""Muse""
    }
  ],
  ""per_page"": 10
}
</code></pre>

<hr>

<p>I did some more reading and found Newtonsoft's LINQ to JSON is exactly what I wanted...using WebClient, Stream, StreamReader, and Newtonsoft...I can hit Kazaa for JSON data, extract a URL, download the file, and do it all in like seven lines of code! I love it.</p>

<pre><code>WebClient client = new WebClient();
Stream stream = client.OpenRead(""http://api.kazaa.com/api/v1/search.json?q=muse&amp;type=Album"");
StreamReader reader = new StreamReader(stream);

Newtonsoft.Json.Linq.JObject jObject = Newtonsoft.Json.Linq.JObject.Parse(reader.ReadLine());

// Instead of WriteLine, 2 or 3 lines of code here using WebClient to download the file
Console.WriteLine((string)jObject[""albums""][0][""cover_image_url""]);
stream.Close();
</code></pre>

<hr>

<p>This post gets so many hits I thought it might be helpful to include the ""using"" bits that are discussed in the comments.</p>

<pre><code>using(var client = new WebClient())
using(var stream = client.OpenRead(""http://api.kazaa.com/api/v1/search.json?q=muse&amp;type=Album""))
using (var reader = new StreamReader(stream))
{
    var jObject = Newtonsoft.Json.Linq.JObject.Parse(reader.ReadLine());
    Console.WriteLine((string) jObject[""albums""][0][""cover_image_url""]);
}
</code></pre>
","<p>If you just need to get a few items from the JSON object, I would use Json.NET's LINQ to JSON <code>JObject</code> class. For example:</p>

<pre><code>JToken token = JObject.Parse(stringFullOfJson);

int page = (int)token.SelectToken(""page"");
int totalPages = (int)token.SelectToken(""total_pages"");
</code></pre>

<p>I like this approach because you don't need to fully deserialize the JSON object. This comes in handy with APIs that can sometimes surprise you with missing object properties, like Twitter.</p>

<p>Documentation: <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm"" rel=""noreferrer""><strong>Serializing and Deserializing JSON with Json.NET</strong></a> and <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/LINQtoJSON.htm"" rel=""noreferrer""><strong>LINQ to JSON with Json.NET</strong></a></p>
","4749755"
".NET String.Format() to add commas in thousands place for a number","501155","","<p>I want to add a comma in the thousands place for a number. <code>String.Format()</code>?</p>
","<pre><code>String.Format(""{0:n}"", 1234); //Output: 1,234.00

string.Format(""{0:n0}"", 9876); // no digits after the decimal point. Output: 9,876
</code></pre>
","105793"
"How do I update the GUI from another thread in C#?","499762","","<p>What is the simplest way to update a <code>Label</code> from another thread?</p>

<p>I have a <code>Form</code> on <code>thread1</code>, and from that I'm starting another thread (<code>thread2</code>). While <code>thread2</code> is processing some files I would like to update a <code>Label</code> on the <code>Form</code> with the current status of <code>thread2</code>'s work.</p>

<p>How can I do that?</p>
","<p>For .NET 2.0, here's a nice bit of code I wrote that does exactly what you want, and works for any property on a <code>Control</code>:</p>

<pre><code>private delegate void SetControlPropertyThreadSafeDelegate(
    Control control, 
    string propertyName, 
    object propertyValue);

public static void SetControlPropertyThreadSafe(
    Control control, 
    string propertyName, 
    object propertyValue)
{
  if (control.InvokeRequired)
  {
    control.Invoke(new SetControlPropertyThreadSafeDelegate               
    (SetControlPropertyThreadSafe), 
    new object[] { control, propertyName, propertyValue });
  }
  else
  {
    control.GetType().InvokeMember(
        propertyName, 
        BindingFlags.SetProperty, 
        null, 
        control, 
        new object[] { propertyValue });
  }
}
</code></pre>

<p>Call it like this:</p>

<pre><code>// thread-safe equivalent of
// myLabel.Text = status;
SetControlPropertyThreadSafe(myLabel, ""Text"", status);
</code></pre>

<p>If you're using .NET 3.0 or above, you could rewrite the above method as an extension method of the <code>Control</code> class, which would then simplify the call to:</p>

<pre><code>myLabel.SetPropertyThreadSafe(""Text"", status);
</code></pre>

<p><strong>UPDATE 05/10/2010:</strong></p>

<p>For .NET 3.0 you should use this code:</p>

<pre><code>private delegate void SetPropertyThreadSafeDelegate&lt;TResult&gt;(
    Control @this, 
    Expression&lt;Func&lt;TResult&gt;&gt; property, 
    TResult value);

public static void SetPropertyThreadSafe&lt;TResult&gt;(
    this Control @this, 
    Expression&lt;Func&lt;TResult&gt;&gt; property, 
    TResult value)
{
  var propertyInfo = (property.Body as MemberExpression).Member 
      as PropertyInfo;

  if (propertyInfo == null ||
      !@this.GetType().IsSubclassOf(propertyInfo.ReflectedType) ||
      @this.GetType().GetProperty(
          propertyInfo.Name, 
          propertyInfo.PropertyType) == null)
  {
    throw new ArgumentException(""The lambda expression 'property' must reference a valid property on this Control."");
  }

  if (@this.InvokeRequired)
  {
      @this.Invoke(new SetPropertyThreadSafeDelegate&lt;TResult&gt; 
      (SetPropertyThreadSafe), 
      new object[] { @this, property, value });
  }
  else
  {
      @this.GetType().InvokeMember(
          propertyInfo.Name, 
          BindingFlags.SetProperty, 
          null, 
          @this, 
          new object[] { value });
  }
}
</code></pre>

<p>which uses LINQ and lambda expressions to allow much cleaner, simpler and safer syntax:</p>

<pre><code>myLabel.SetPropertyThreadSafe(() =&gt; myLabel.Text, status); // status has to be a string or this will fail to compile
</code></pre>

<p>Not only is the property name now checked at compile time, the property's type is as well, so it's impossible to (for example) assign a string value to a boolean property, and hence cause a runtime exception.</p>

<p>Unfortunately this doesn't stop anyone from doing stupid things such as passing in another <code>Control</code>'s property and value, so the following will happily compile:</p>

<pre><code>myLabel.SetPropertyThreadSafe(() =&gt; aForm.ShowIcon, false);
</code></pre>

<p>Hence I added the runtime checks to ensure that the passed-in property does actually belong to the <code>Control</code> that the method's being called on. Not perfect, but still a lot better than the .NET 2.0 version.</p>

<p>If anyone has any further suggestions on how to improve this code for compile-time safety, please comment!</p>
","661706"
"How do I make calls to a REST api using c#?","496687","","<p>This is the code I have so far:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System;
using System.Net.Http;
using System.Web;
using System.Net;
using System.IO;

namespace ConsoleProgram
{
    public class Class1
    {
        private const string URL = ""https://sub.domain.com/objects.json?api_key=123"";
        private const string DATA = @""{""""object"""":{""""name"""":""""Name""""}}"";

        static void Main(string[] args)
        {
            Class1.CreateObject();
        }

        private static void CreateObject()
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);
            request.Method = ""POST"";
            request.ContentType = ""application/json""; 
            request.ContentLength = DATA.Length;
            StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII);
            requestWriter.Write(DATA);
            requestWriter.Close();

             try {
                WebResponse webResponse = request.GetResponse();
                Stream webStream = webResponse.GetResponseStream();
                StreamReader responseReader = new StreamReader(webStream);
                string response = responseReader.ReadToEnd();
                Console.Out.WriteLine(response);
                responseReader.Close();
            } catch (Exception e) {
                Console.Out.WriteLine(""-----------------"");
                Console.Out.WriteLine(e.Message);
            }

        }
    }
}
</code></pre>

<p>The problem is that I think the exception block is being triggered (because when I remove the try-catch, I get a server error (500) message.  But I don't see the Console.Out lines I put in the catch block.</p>

<p>My Console:</p>

<pre><code>The thread 'vshost.NotifyLoad' (0x1a20) has exited with code 0 (0x0).
The thread '&lt;No Name&gt;' (0x1988) has exited with code 0 (0x0).
The thread 'vshost.LoadReference' (0x1710) has exited with code 0 (0x0).
'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\l. preston sego iii\documents\visual studio 11\Projects\ConsoleApplication1\ConsoleApplication1\bin\Debug\ConsoleApplication1.exe', Symbols loaded.
'ConsoleApplication1.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
A first chance exception of type 'System.Net.WebException' occurred in System.dll
The thread 'vshost.RunParkingWindow' (0x184c) has exited with code 0 (0x0).
The thread '&lt;No Name&gt;' (0x1810) has exited with code 0 (0x0).
The program '[2780] ConsoleApplication1.vshost.exe: Program Trace' has exited with code 0 (0x0).
The program '[2780] ConsoleApplication1.vshost.exe: Managed (v4.0.30319)' has exited with code 0 (0x0).
</code></pre>

<p>I'm using Visual Studio 2011 Beta, and .NET 4.5 Beta.</p>
","<p>The ASP.Net Web API has replaced the WCF Web API previously mentioned.</p>

<p>I thought I'd post an updated answer since most of these responses are from early 2012, and this thread is one of the top results when doing a Google search for ""call restful service c#"".</p>

<p>Current guidance from Microsoft is to use the Microsoft ASP.NET Web API Client Libraries to consume a RESTful service. This is available as a NuGet package, Microsoft.AspNet.WebApi.Client.</p>

<p>Here's how your example would look when implemented using the ASP.Net Web API Client Library:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Net.Http;
using System.Net.Http.Headers;

namespace ConsoleProgram
{
    public class DataObject
    {
        public string Name { get; set; }
    }

    public class Class1
    {
        private const string URL = ""https://sub.domain.com/objects.json"";
        private string urlParameters = ""?api_key=123"";

        static void Main(string[] args)
        {
            HttpClient client = new HttpClient();
            client.BaseAddress = new Uri(URL);

            // Add an Accept header for JSON format.
            client.DefaultRequestHeaders.Accept.Add(
            new MediaTypeWithQualityHeaderValue(""application/json""));

            // List data response.
            HttpResponseMessage response = client.GetAsync(urlParameters).Result;  // Blocking call!
            if (response.IsSuccessStatusCode)
            {
                // Parse the response body. Blocking!
                var dataObjects = response.Content.ReadAsAsync&lt;IEnumerable&lt;DataObject&gt;&gt;().Result;
                foreach (var d in dataObjects)
                {
                    Console.WriteLine(""{0}"", d.Name);
                }
            }
            else
            {
                Console.WriteLine(""{0} ({1})"", (int)response.StatusCode, response.ReasonPhrase);
            }  
        }
    }
}
</code></pre>

<p>For more details, including other examples, go here: <a href=""http://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client"">http://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client</a></p>

<p>This blog post may also be useful: <a href=""http://johnnycode.com/2012/02/23/consuming-your-own-asp-net-web-api-rest-service/"">http://johnnycode.com/2012/02/23/consuming-your-own-asp-net-web-api-rest-service/</a></p>
","17459045"
"Calling JavaScript Function From CodeBehind","496516","","<p>I am new to JavaScript Programming and C# Programming.
Can someone provide good examples of calling a Javascript function From CodeBehind and ViceVersa.</p>

<p>Thank You</p>
","<p>You may try this :</p>

<pre><code>Page.ClientScript.RegisterStartupScript(this.GetType(),""CallMyFunction"",""MyFunction()"",true);
</code></pre>
","13141587"
"How to Deserialize XML document","490319","","<p>How do I Deserialize this XML document:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;Cars&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1020&lt;/StockNumber&gt;
    &lt;Make&gt;Nissan&lt;/Make&gt;
    &lt;Model&gt;Sentra&lt;/Model&gt;
  &lt;/Car&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1010&lt;/StockNumber&gt;
    &lt;Make&gt;Toyota&lt;/Make&gt;
    &lt;Model&gt;Corolla&lt;/Model&gt;
  &lt;/Car&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1111&lt;/StockNumber&gt;
    &lt;Make&gt;Honda&lt;/Make&gt;
    &lt;Model&gt;Accord&lt;/Model&gt;
  &lt;/Car&gt;
&lt;/Cars&gt;
</code></pre>

<p>I have this:</p>

<pre><code>[Serializable()]
public class Car
{
    [System.Xml.Serialization.XmlElementAttribute(""StockNumber"")]
    public string StockNumber{ get; set; }

    [System.Xml.Serialization.XmlElementAttribute(""Make"")]
    public string Make{ get; set; }

    [System.Xml.Serialization.XmlElementAttribute(""Model"")]
    public string Model{ get; set; }
}
</code></pre>

<p>.</p>

<pre><code>[System.Xml.Serialization.XmlRootAttribute(""Cars"", Namespace = """", IsNullable = false)]
public class Cars
{
    [XmlArrayItem(typeof(Car))]
    public Car[] Car { get; set; }

}
</code></pre>

<p>.</p>

<pre><code>public class CarSerializer
{
    public Cars Deserialize()
    {
        Cars[] cars = null;
        string path = HttpContext.Current.ApplicationInstance.Server.MapPath(""~/App_Data/"") + ""cars.xml"";

        XmlSerializer serializer = new XmlSerializer(typeof(Cars[]));

        StreamReader reader = new StreamReader(path);
        reader.ReadToEnd();
        cars = (Cars[])serializer.Deserialize(reader);
        reader.Close();

        return cars;
    }
}
</code></pre>

<p>that don't seem to work :-(</p>
","<p>Here's a working version.  I changed the XmlElementAttribute labels to XmlElement because in the xml the StockNumber, Make and Model values are elements, not attributes.  Also I removed the reader.ReadToEnd(); (that <a href=""http://msdn.microsoft.com/en-us/library/system.io.streamreader.readtoend.aspx"" rel=""noreferrer"">function</a> reads the whole stream and returns a string, so the Deserialze() function couldn't use the reader anymore...the position was at the end of the stream).  I also took a few liberties with the naming :).</p>

<p>Here are the classes:</p>

<pre><code>[Serializable()]
public class Car
{
    [System.Xml.Serialization.XmlElement(""StockNumber"")]
    public string StockNumber { get; set; }

    [System.Xml.Serialization.XmlElement(""Make"")]
    public string Make { get; set; }

    [System.Xml.Serialization.XmlElement(""Model"")]
    public string Model { get; set; }
}


[Serializable()]
[System.Xml.Serialization.XmlRoot(""CarCollection"")]
public class CarCollection
{
    [XmlArray(""Cars"")]
    [XmlArrayItem(""Car"", typeof(Car))]
    public Car[] Car { get; set; }
}
</code></pre>

<p>The Deserialize function:</p>

<pre><code>CarCollection cars = null;
string path = ""cars.xml"";

XmlSerializer serializer = new XmlSerializer(typeof(CarCollection));

StreamReader reader = new StreamReader(path);
cars = (CarCollection)serializer.Deserialize(reader);
reader.Close();
</code></pre>

<p>And the slightly tweaked xml (I needed to add a new element to wrap &lt;Cars&gt;...Net is picky about deserializing arrays):</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;CarCollection&gt;
&lt;Cars&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1020&lt;/StockNumber&gt;
    &lt;Make&gt;Nissan&lt;/Make&gt;
    &lt;Model&gt;Sentra&lt;/Model&gt;
  &lt;/Car&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1010&lt;/StockNumber&gt;
    &lt;Make&gt;Toyota&lt;/Make&gt;
    &lt;Model&gt;Corolla&lt;/Model&gt;
  &lt;/Car&gt;
  &lt;Car&gt;
    &lt;StockNumber&gt;1111&lt;/StockNumber&gt;
    &lt;Make&gt;Honda&lt;/Make&gt;
    &lt;Model&gt;Accord&lt;/Model&gt;
  &lt;/Car&gt;
&lt;/Cars&gt;
&lt;/CarCollection&gt;
</code></pre>
","364401"
"Validation failed for one or more entities. See 'EntityValidationErrors' property for more details","487912","","<p>I am having this error when seeding my database with code first approach.</p>

<blockquote>
  <p>Validation failed for one or more entities. See 'EntityValidationErrors' property for more details.</p>
</blockquote>

<p>To be honest I don't know how to check the content of the validation errors. Visual Studio shows me that it's an array with 8 objects, so 8 validation errors.</p>

<p>This was working with my previous model, but I made a few changes that I explain below:</p>

<ul>
<li>I had an enum called Status, I changed it to a class called Status</li>
<li>I changed the class ApplicantsPositionHistory to have 2 foreign key to the same table</li>
</ul>

<p>Excuse me for the long code, but I have to paste it all.  The exception is thrown in the last line of the following code.</p>

<pre><code>namespace Data.Model
{  
    public class Position
    {
        [DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)]   
        public int PositionID { get; set; }

        [Required(ErrorMessage = ""Position name is required."")]
        [StringLength(20, MinimumLength = 3, ErrorMessage = ""Name should not be longer than 20 characters."")]
        [Display(Name = ""Position name"")]              
        public string name { get; set; }

        [Required(ErrorMessage = ""Number of years is required"")] 
        [Display(Name = ""Number of years"")]        
        public int yearsExperienceRequired { get; set; }

        public virtual ICollection&lt;ApplicantPosition&gt; applicantPosition { get; set; }
    }

    public class Applicant
    {
        [DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)]      
        public int ApplicantID { get; set; }

        [Required(ErrorMessage = ""Name is required"")] 
        [StringLength(20, MinimumLength = 3, ErrorMessage=""Name should not be longer than 20 characters."")]
        [Display(Name = ""First and LastName"")]
        public string name { get; set; }

        [Required(ErrorMessage = ""Telephone number is required"")] 
        [StringLength(10, MinimumLength = 3, ErrorMessage = ""Telephone should not be longer than 20 characters."")]
        [Display(Name = ""Telephone Number"")]
        public string telephone { get; set; }

        [Required(ErrorMessage = ""Skype username is required"")] 
        [StringLength(10, MinimumLength = 3, ErrorMessage = ""Skype user should not be longer than 20 characters."")]
        [Display(Name = ""Skype Username"")]
        public string skypeuser { get; set; }

        public byte[] photo { get; set; }

        public virtual ICollection&lt;ApplicantPosition&gt; applicantPosition { get; set; }
    }

    public class ApplicantPosition
    {
        [Key]
        [Column(""ApplicantID"", Order = 0)]
        public int ApplicantID { get; set; }

        [Key]
        [Column(""PositionID"", Order = 1)]
        public int PositionID { get; set; }

        public virtual Position Position { get; set; }

        public virtual Applicant Applicant { get; set; }

        [Required(ErrorMessage = ""Applied date is required"")] 
        [DisplayFormat(DataFormatString = ""{0:d}"", ApplyFormatInEditMode = true)]
        [Display(Name = ""Date applied"")]     
        public DateTime appliedDate { get; set; }

        [Column(""StatusID"", Order = 0)]
        public int StatusID { get; set; }

        public Status CurrentStatus { get; set; }

        //[NotMapped]
        //public int numberOfApplicantsApplied
        //{
        //    get
        //    {
        //        int query =
        //             (from ap in Position
        //              where ap.Status == (int)Status.Applied
        //              select ap
        //                  ).Count();
        //        return query;
        //    }
        //}
    }

    public class Address
    {
        [StringLength(20, MinimumLength = 3, ErrorMessage = ""Country should not be longer than 20 characters."")]
        public string Country { get; set; }

        [StringLength(20, MinimumLength = 3, ErrorMessage = ""City  should not be longer than 20 characters."")]
        public string City { get; set; }

        [StringLength(50, MinimumLength = 3, ErrorMessage = ""Address  should not be longer than 50 characters."")]
        [Display(Name = ""Address Line 1"")]     
        public string AddressLine1 { get; set; }

        [Display(Name = ""Address Line 2"")]
        public string AddressLine2 { get; set; }   
    }

    public class ApplicationPositionHistory
    {
        [DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)]
        public int ApplicationPositionHistoryID { get; set; }

        public ApplicantPosition applicantPosition { get; set; }

        [Column(""oldStatusID"")]
        public int oldStatusID { get; set; }

        [Column(""newStatusID"")]
        public int newStatusID { get; set; }

        public Status oldStatus { get; set; }

        public Status newStatus { get; set; }

        [StringLength(500, MinimumLength = 3, ErrorMessage = ""Comments  should not be longer than 500 characters."")]
        [Display(Name = ""Comments"")]
        public string comments { get; set; }

        [DisplayFormat(DataFormatString = ""{0:d}"", ApplyFormatInEditMode = true)]
        [Display(Name = ""Date"")]     
        public DateTime dateModified { get; set; }
    }

    public class Status
    {
        [DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)]
        public int StatusID { get; set; }

        [StringLength(20, MinimumLength = 3, ErrorMessage = ""Status  should not be longer than 20 characters."")]
        [Display(Name = ""Status"")]
        public string status { get; set; }
    }
}
</code></pre>

<p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.Entity;
using System.IO;

namespace Data.Model
{
    public class HRContextInitializer : DropCreateDatabaseAlways&lt;HRContext&gt;
    {
        protected override void Seed(HRContext context)
        {
            #region Status
            Status applied = new Status() { status = ""Applied"" };
            Status reviewedByHR = new Status() { status = ""Reviewed By HR"" };
            Status approvedByHR = new Status() { status = ""Approved by HR"" };
            Status rejectedByHR = new Status() { status = ""Rejected by HR"" };
            Status assignedToTechnicalDepartment = new Status() { status = ""Assigned to Technical Department"" };
            Status approvedByTechnicalDepartment = new Status() { status = ""Approved by Technical Department"" };
            Status rejectedByTechnicalDepartment = new Status() { status = ""Rejected by Technical Department"" };

            Status assignedToGeneralManager = new Status() { status = ""Assigned to General Manager"" };
            Status approvedByGeneralManager = new Status() { status = ""Approved by General Manager"" };
            Status rejectedByGeneralManager = new Status() { status = ""Rejected by General Manager"" };

            context.Status.Add(applied);
            context.Status.Add(reviewedByHR);
            context.Status.Add(approvedByHR);
            context.Status.Add(rejectedByHR);
            context.Status.Add(assignedToTechnicalDepartment);
            context.Status.Add(approvedByTechnicalDepartment);
            context.Status.Add(rejectedByTechnicalDepartment);
            context.Status.Add(assignedToGeneralManager);
            context.Status.Add(approvedByGeneralManager);
            context.Status.Add(rejectedByGeneralManager); 
            #endregion    

            #region Position
            Position netdeveloper = new Position() { name = "".net developer"", yearsExperienceRequired = 5 };
            Position javadeveloper = new Position() { name = ""java developer"", yearsExperienceRequired = 5 };
            context.Positions.Add(netdeveloper);
            context.Positions.Add(javadeveloper); 
            #endregion

            #region Applicants
            Applicant luis = new Applicant()
            {
                name = ""Luis"",
                skypeuser = ""le.valencia"",
                telephone = ""0491732825"",
                photo = File.ReadAllBytes(@""C:\Users\LUIS.SIMBIOS\Documents\Visual Studio 2010\Projects\SlnHR\HRRazorForms\Content\pictures\1.jpg"")
            };

            Applicant john = new Applicant()
            {
                name = ""John"",
                skypeuser = ""jo.valencia"",
                telephone = ""3435343543"",
                photo = File.ReadAllBytes(@""C:\Users\LUIS.SIMBIOS\Documents\Visual Studio 2010\Projects\SlnHR\HRRazorForms\Content\pictures\2.jpg"")
            };

            context.Applicants.Add(luis);
            context.Applicants.Add(john); 
            #endregion

            #region ApplicantsPositions
            ApplicantPosition appicantposition = new ApplicantPosition()
            {
                Applicant = luis,
                Position = netdeveloper,
                appliedDate = DateTime.Today,
                StatusID = 1
            };

            ApplicantPosition appicantposition2 = new ApplicantPosition()
            {
                Applicant = john,
                Position = javadeveloper,
                appliedDate = DateTime.Today,
                StatusID = 1
            };        

            context.ApplicantsPositions.Add(appicantposition);            
            context.ApplicantsPositions.Add(appicantposition2); 
            #endregion

            context.SaveChanges(); ---&gt;&gt; Error here
        }
    }
}
</code></pre>
","<blockquote>
  <p>To be honest I don't know how to check the content of the validation errors. Visual Studio shows me that it's an array with 8 objects, so 8 validation errors.</p>
</blockquote>

<p>Actually you should see the errors if you drill into that array in Visual studio during debug. But you can also catch the exception and then write out the errors to some logging store or the console:</p>

<pre><code>try
{
    // Your code...
    // Could also be before try if you know the exception occurs in SaveChanges

    context.SaveChanges();
}
catch (DbEntityValidationException e)
{
    foreach (var eve in e.EntityValidationErrors)
    {
        Console.WriteLine(""Entity of type \""{0}\"" in state \""{1}\"" has the following validation errors:"",
            eve.Entry.Entity.GetType().Name, eve.Entry.State);
        foreach (var ve in eve.ValidationErrors)
        {
            Console.WriteLine(""- Property: \""{0}\"", Error: \""{1}\"""",
                ve.PropertyName, ve.ErrorMessage);
        }
    }
    throw;
}
</code></pre>

<p><code>EntityValidationErrors</code> is a collection which represents the entities which couldn't be validated successfully, and the inner collection <code>ValidationErrors</code> per entity is a list of errors on property level.</p>

<p>These validation messages are usually helpful enough to find the source of the problem. </p>

<p><strong>Edit</strong></p>

<p>A few slight improvements:</p>

<p>The <em>value</em> of the offending property can be included in the inner loop like so:</p>

<pre><code>        foreach (var ve in eve.ValidationErrors)
        {
            Console.WriteLine(""- Property: \""{0}\"", Value: \""{1}\"", Error: \""{2}\"""",
                ve.PropertyName,
                eve.Entry.CurrentValues.GetValue&lt;object&gt;(ve.PropertyName),
                ve.ErrorMessage);
        }
</code></pre>

<p>While debugging <code>Debug.Write</code> might be preferable over <code>Console.WriteLine</code> as it works in all kind of applications, not only console applications (thanks to @Bart for his note in the comments below).</p>

<p>For web applications that are in production and that use <strong>Elmah</strong> for exception logging it turned out to be very useful for me to create a custom exception and overwrite <code>SaveChanges</code> in order to throw this new exception.</p>

<p>The custom exception type looks like this:</p>

<pre><code>public class FormattedDbEntityValidationException : Exception
{
    public FormattedDbEntityValidationException(DbEntityValidationException innerException) :
        base(null, innerException)
    {
    }

    public override string Message
    {
        get
        {
            var innerException = InnerException as DbEntityValidationException;
            if (innerException != null)
            {
                StringBuilder sb = new StringBuilder();

                sb.AppendLine();
                sb.AppendLine();
                foreach (var eve in innerException.EntityValidationErrors)
                {
                    sb.AppendLine(string.Format(""- Entity of type \""{0}\"" in state \""{1}\"" has the following validation errors:"",
                        eve.Entry.Entity.GetType().FullName, eve.Entry.State));
                    foreach (var ve in eve.ValidationErrors)
                    {
                        sb.AppendLine(string.Format(""-- Property: \""{0}\"", Value: \""{1}\"", Error: \""{2}\"""",
                            ve.PropertyName,
                            eve.Entry.CurrentValues.GetValue&lt;object&gt;(ve.PropertyName),
                            ve.ErrorMessage));
                    }
                }
                sb.AppendLine();

                return sb.ToString();
            }

            return base.Message;
        }
    }
}
</code></pre>

<p>And <code>SaveChanges</code> can be overwritten the following way:</p>

<pre><code>public class MyContext : DbContext
{
    // ...

    public override int SaveChanges()
    {
        try
        {
            return base.SaveChanges();
        }
        catch (DbEntityValidationException e)
        {
            var newException = new FormattedDbEntityValidationException(e);
            throw newException;
        }
    }
}
</code></pre>

<p>A few remarks:</p>

<ul>
<li><p>The yellow error screen that Elmah shows in the web interface or in the sent emails (if you have configured that) now displays the validation details directly at the top of the message.</p></li>
<li><p>Overwriting the <code>Message</code> property in the custom exception instead of overwriting <code>ToString()</code> has the benefit that the standard ASP.NET ""Yellow screen of death (YSOD)"" displays this message as well. In contrast to Elmah the YSOD apparently doesn't use <code>ToString()</code>, but both display the <code>Message</code> property.</p></li>
<li><p>Wrapping the original <code>DbEntityValidationException</code> as inner exception ensures that the original stack trace will still be available and is displayed in Elmah and the YSOD.</p></li>
<li><p>By setting a breakpoint on the line <code>throw newException;</code> you can simply inspect the <code>newException.Message</code> property as a text instead of drilling into the validation collections which is a bit awkward and doesn't seem to work easily for everyone (see comments below).</p></li>
</ul>
","7798264"
"Can you loop through all enum values?","482685","","<blockquote>
  <p><strong>This question already has an answer here:</strong><br>
  <a href=""https://stackoverflow.com/questions/105372/how-to-enumerate-an-enum"">How to enumerate an enum?</a>  <em>14 answers</em></p>
</blockquote>



<pre><code>public enum Foos
{
    A,
    B,
    C
}
</code></pre>

<p>Is there a way to loop through the possible values of <code>Foos</code>?</p>

<p>Basically?</p>

<pre><code>foreach(Foo in Foos)
</code></pre>
","<p>Yes you can use the GetValues method</p>

<pre><code>var values = Enum.GetValues(typeof(Foos));
</code></pre>

<p>Or the typed version</p>

<pre><code>var values = Enum.GetValues(typeof(Foos)).Cast&lt;Foos&gt;();
</code></pre>

<p>I long ago added a helper function to my private library for just such an occasion</p>

<pre><code>public static class EnumUtil {
  public static IEnumerable&lt;T&gt; GetValues&lt;T&gt;() {
    return Enum.GetValues(typeof(T)).Cast&lt;T&gt;();
  }
}
</code></pre>

<p>Usage:</p>

<pre><code>var values = EnumUtil.GetValues&lt;Foos&gt;();
</code></pre>
","972323"
"C# Joins/Where with Linq and Lambda","481250","","<p>I'm having trouble with a query written in Linq and Lambda. So far, I'm getting a lot of errors here's my code:</p>

<pre><code>int id = 1;
var query = database.Posts.Join(database.Post_Metas,
                                post =&gt; database.Posts.Where(x =&gt; x.ID == id),
                                meta =&gt; database.Post_Metas.Where(x =&gt; x.Post_ID == id),
                                (post, meta) =&gt; new { Post = post, Meta = meta });
</code></pre>

<p>I'm new to using Linq, so I'm not sure if this query is correct.</p>
","<p>I find that if you're familiar with SQL syntax, using the LINQ query syntax is much clearer, more natural, and makes it easier to spot errors:</p>

<pre><code>var id = 1;
var query =
   from post in database.Posts
   join meta in database.Post_Metas on post.ID equals meta.Post_ID
   where post.ID == id
   select new { Post = post, Meta = meta };
</code></pre>

<p>If you're really stuck on using lambdas though, your syntax is quite a bit off. Here's the same query, using the LINQ extension methods:</p>

<pre><code>var id = 1;
var query = database.Posts    // your starting point - table in the ""from"" statement
   .Join(database.Post_Metas, // the source table of the inner join
      post =&gt; post.ID,        // Select the primary key (the first part of the ""on"" clause in an sql ""join"" statement)
      meta =&gt; meta.Post_ID,   // Select the foreign key (the second part of the ""on"" clause)
      (post, meta) =&gt; new { Post = post, Meta = meta }) // selection
   .Where(postAndMeta =&gt; postAndMeta.Post.ID == id);    // where statement
</code></pre>
","2767742"
"'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine","480336","","<p>I'm trying to get data from an Excel file on a button click event. My connection string is:</p>

<pre><code> string connString = ""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\source\\SiteCore65\\Individual-Data.xls;Extended Properties=Excel 8.0;"";
</code></pre>

<p>When I click on the button, I got the following error:</p>

<blockquote>
  <p>The 'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine.</p>
</blockquote>

<p>I have no clue how to fix this. My operating system is Windows 7.</p>
","<p>Well, you need to install it. You're looking for:</p>

<ul>
<li>The <a href=""https://www.microsoft.com/en-us/download/details.aspx?id=23734"" rel=""noreferrer"">2007 Office System Driver: Data Connectivity Components</a>.</li>
</ul>
","6649413"
"If a folder does not exist, create it","478996","","<p>I use a FileUploader control in my application. I want to save a file in a specified folder. Now I want, if this folder does not exist, to first create it, and then save my file to this folder.  If the folder already exists, then just save the file in it.</p>

<p>How I can do this?</p>
","<p>As others have said, use <code>System.IO.Directory.CreateDirectory</code></p>

<p>But, you don't need to check if it exists first.  From the <a href=""http://msdn.microsoft.com/en-us/library/54a0at6s.aspx"">docs</a></p>

<blockquote>
  <p>Any and all directories specified in path are created, unless they
  already exist or unless some part of path is invalid. The path
  parameter specifies a directory path, not a file path. If the
  directory already exists, this method does nothing.</p>
</blockquote>
","9065716"
"Select distinct using linq","478230","","<p>I have a class list of class</p>

<pre><code>public class LinqTest
{
public int id { get; set; }
public string value { get; set; }
}


List&lt;LinqTest&gt; myList = new List&lt;LinqTest&gt;();
myList.Add(new LinqTest() { id = 1, value = ""a"" });
myList.Add(new LinqTest() { id = 1, value = ""b"" });
myList.Add(new LinqTest() { id = 2, value = ""c"" });
</code></pre>

<p>I need to select only the distinct id's from that list.
ie, my resultant list should only contain</p>

<pre><code>[{id=1,value=""a""},{ id = 2, value = ""c"" }]
</code></pre>

<p>How can I do this with linq?</p>

<p><strong>Edit</strong></p>

<p>Input,</p>

<pre><code>id      value
1        a
1        b
2        c
3        d
3        e
</code></pre>

<p>Out put should be,</p>

<pre><code>id      value
1        a
2        c
3        d
</code></pre>

<p>ie, if there is a repetition of <code>id</code>, result should take the first occurrence only.</p>
","<pre><code>myList.GroupBy(test =&gt; test.id)
      .Select(grp =&gt; grp.First());
</code></pre>

<p>Edit: as getting this <code>IEnumerable&lt;&gt;</code> into a <code>List&lt;&gt;</code> seems to be a mystery to many people, you can simply write:</p>

<pre><code>var result = myList.GroupBy(test =&gt; test.id)
                   .Select(grp =&gt; grp.First())
                   .ToList();
</code></pre>

<p>But one is often better off working with the <code>IEnumerable</code> rather than <code>IList</code> as the Linq above is lazily evaluated: it doesn't actually do all of the work until the enumerable is iterated. When you call <code>ToList</code> it actually walks the entire enumerable forcing all of the work to be done up front. (And may take a little while if your enumerable is infinitely long.)</p>

<p>The flipside to this advice is that each time you enumerate such an <code>IEnumerable</code> the work to evaluate it has to be done afresh. So you need to decide for each case whether it is better to work with the lazily evaluated <code>IEnumerable</code> or to realize it into a <code>List</code>, <code>Set</code>, <code>Dictionary</code> or whatnot.</p>
","19406319"
"What is the difference between an abstract function and a virtual function?","474336","","<p>In which cases is it recommended to use virtual or abstract? Which is the more correct approach? </p>
","<p><strong>An abstract function cannot have functionality.</strong> You're basically saying, any child class MUST give their own version of this method, however it's too general to even try to implement in the parent class. </p>

<p><strong>A virtual function</strong>, is basically saying look, here's the functionality that may or may not be good enough for the child class. So if it is good enough, use this method, if not, then override me, and provide your own functionality.</p>
","391492"
"How do I get the path of the assembly the code is in?","473488","","<p>Is there a way to get the path for the assembly in which the current code resides?  I do not want the path of the calling assembly, just the one containing the code. </p>

<p>Basically my unit test needs to read some xml test files which are located relative to the  dll.  I want the path to always resolve correctly regardless of whether the testing dll is run from TestDriven.NET, the MbUnit GUI or something else.</p>

<p><strong>Edit</strong>: People seem to be misunderstanding what I'm asking.</p>

<p>My test library is located in say </p>

<blockquote>
  <p>C:\projects\myapplication\daotests\bin\Debug\daotests.dll</p>
</blockquote>

<p>and I would like to get this path:</p>

<blockquote>
  <p>C:\projects\myapplication\daotests\bin\Debug\</p>
</blockquote>

<p>The three suggestions so far fail me when I run from the MbUnit Gui:</p>

<ul>
<li><p><code>Environment.CurrentDirectory</code>
gives <em>c:\Program Files\MbUnit</em></p></li>
<li><p><code>System.Reflection.Assembly.GetAssembly(typeof(DaoTests)).Location</code>
gives <em>C:\Documents and
Settings\george\Local
Settings\Temp\ ....\DaoTests.dll</em></p></li>
<li><p><code>System.Reflection.Assembly.GetExecutingAssembly().Location</code>
gives the same as the previous.</p></li>
</ul>
","<p>I've defined the following property as we use this often in unit testing. </p>

<pre><code>public static string AssemblyDirectory
{
    get
    {
        string codeBase = Assembly.GetExecutingAssembly().CodeBase;
        UriBuilder uri = new UriBuilder(codeBase);
        string path = Uri.UnescapeDataString(uri.Path);
        return Path.GetDirectoryName(path);
    }
}
</code></pre>

<p>The <code>Assembly.Location</code> property sometimes gives you some funny results when using NUnit (where assemblies run from a temporary folder), so I prefer to use <code>CodeBase</code> which gives you the path in URI format, then <code>UriBuild.UnescapeDataString</code> removes the <code>File://</code> at the beginning, and <code>GetDirectoryName</code> changes it to the normal windows format.</p>
","283917"
"Get property value from string using reflection in C#","473286","","<p>I am trying implement the <a href=""http://geekswithblogs.net/shahed/archive/2008/07/24/123998.aspx"" rel=""noreferrer"">Data transformation using Reflection</a><sup>1</sup> example in my code.</p>

<p>The <code>GetSourceValue</code> function has a switch comparing various types, but I want to remove these types and properties and have <code>GetSourceValue</code> get the value of the property using only a single string as the parameter. I want to pass a class and property in the string and resolve the value of the property.</p>

<p>Is this possible?</p>

<p><sup>1</sup> <sub><a href=""https://web.archive.org/web/20130815002453/http://msmvps.com/blogs/shahed/archive/2008/07/24/c-reflection-tips-data-transformation-using-reflection.aspx"" rel=""noreferrer"">Web Archive version of original blog post</a></sub></p>
","<pre><code> public static object GetPropValue(object src, string propName)
 {
     return src.GetType().GetProperty(propName).GetValue(src, null);
 }
</code></pre>

<p>Of course, you will want to add validation and whatnot, but that is the gist of it.</p>
","1197004"
"How and When to use `async` and `await`","469614","","<p>From my understanding one of the main things that <a href=""https://docs.microsoft.com/en-us/dotnet/csharp/async"" rel=""noreferrer""><code>async</code> and <code>await</code></a> do is to make code easy to write and read - but is using them equal to spawning background threads to perform long duration logic?</p>

<p>I'm currently trying out the most basic example. I've added some comments inline. Can you clarify it for me?</p>

<pre><code>// I don't understand why this method must be marked as `async`.
private async void button1_Click(object sender, EventArgs e)
{
    Task&lt;int&gt; access = DoSomethingAsync();
    // task independent stuff here

    // this line is reached after the 5 seconds sleep from 
    // DoSomethingAsync() method. Shouldn't it be reached immediately? 
    int a = 1; 

    // from my understanding the waiting should be done here.
    int x = await access; 
}

async Task&lt;int&gt; DoSomethingAsync()
{
    // is this executed on a background thread?
    System.Threading.Thread.Sleep(5000);
    return 1;
}
</code></pre>
","<p>When using <code>async</code> and <code>await</code> the compiler generates a state machine in the background.</p>

<p>Here's an example on which I hope I can explain some of the high-level details that are going on: </p>

<pre><code>public async Task MyMethodAsync()
{
    Task&lt;int&gt; longRunningTask = LongRunningOperationAsync();
    // independent work which doesn't need the result of LongRunningOperationAsync can be done here

    //and now we call await on the task 
    int result = await longRunningTask;
    //use the result 
    Console.WriteLine(result);
}

public async Task&lt;int&gt; LongRunningOperationAsync() // assume we return an int from this long running operation 
{
    await Task.Delay(1000); // 1 second delay
    return 1;
}
</code></pre>

<p>OK, so what happens here:</p>

<ol>
<li><p><code>Task&lt;int&gt; longRunningTask = LongRunningOperationAsync();</code> starts executing <code>LongRunningOperation</code></p></li>
<li><p>Independent work is done on let's assume the Main Thread (Thread ID = 1) then <code>await longRunningTask</code> is reached. </p>

<p>Now, if the <code>longRunningTask</code> hasn't finished and it is still running, <code>MyMethodAsync()</code> will return to its calling method, thus the main thread doesn't get blocked. When the <code>longRunningTask</code> is done then a thread from the ThreadPool (can be any thread) will return to <code>MyMethodAsync()</code> in its previous context and continue execution (in this case printing the result to the console). </p></li>
</ol>

<p>A second case would be that the <code>longRunningTask</code> has already finished its execution and the result is available. When reaching the <code>await longRunningTask</code> we already have the result so the code will continue executing on the very same thread. (in this case printing result to console). Of course this is not the case for the above example, where there's a <code>Task.Delay(1000)</code> involved. </p>
","19985988"
"How to remove time portion of date in C# in DateTime object only?","468698","","<p>I need to remove time portion of date time or probably have the date in following format in <code>object</code> form not in the form of <code>string</code>.</p>

<pre><code>06/26/2009 00:00:00:000
</code></pre>

<p>I can not use any <code>string</code> conversion methods as I need the date in <code>object</code> form.</p>

<p>I tried first converting the <code>DateTime</code> to a <code>string</code>, remove the time specific date from it, but it adds <code>12:00:00 AM</code> as soon as I convert it back to <code>DateTime</code> <code>object</code> back again.</p>
","<p>Use the <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx"" rel=""noreferrer"">Date</a> property:</p>

<pre><code>var dateAndTime = DateTime.Now;
var date = dateAndTime.Date;
</code></pre>

<p>The <code>date</code> variable will contain the date, the time part will be <code>00:00:00</code>.</p>
","6121309"
"Deserialize JSON into C# dynamic object?","464447","","<p>Is there a way to deserialize JSON content into a C# 4 dynamic type? It would be nice to skip creating a bunch of classes in order to use the DataContractJsonSerializer. </p>
","<p>If you are happy to have a dependency upon the <code>System.Web.Helpers</code> assembly, then you can use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.helpers.json(v=vs.111).aspx"" rel=""noreferrer""><code>Json</code></a> class:</p>

<pre><code>dynamic data = Json.Decode(json);
</code></pre>

<p>It is included with the MVC framework as an <a href=""https://stackoverflow.com/q/8037895/24874"">additional download</a> to the .NET 4 framework. Be sure to give Vlad an upvote if that's helpful! However if you cannot assume the client environment includes this DLL, then read on.</p>

<hr>

<p>An alternative deserialisation approach is suggested <a href=""http://www.drowningintechnicaldebt.com/ShawnWeisfeld/archive/2010/08/22/using-c-4.0-and-dynamic-to-parse-json.aspx"" rel=""noreferrer"">here</a>.  I modified the code slightly to fix a bug and suit my coding style.  All you need is this code and a reference to <code>System.Web.Extensions</code> from your project:</p>

<pre><code>using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Dynamic;
using System.Linq;
using System.Text;
using System.Web.Script.Serialization;

public sealed class DynamicJsonConverter : JavaScriptConverter
{
    public override object Deserialize(IDictionary&lt;string, object&gt; dictionary, Type type, JavaScriptSerializer serializer)
    {
        if (dictionary == null)
            throw new ArgumentNullException(""dictionary"");

        return type == typeof(object) ? new DynamicJsonObject(dictionary) : null;
    }

    public override IDictionary&lt;string, object&gt; Serialize(object obj, JavaScriptSerializer serializer)
    {
        throw new NotImplementedException();
    }

    public override IEnumerable&lt;Type&gt; SupportedTypes
    {
        get { return new ReadOnlyCollection&lt;Type&gt;(new List&lt;Type&gt;(new[] { typeof(object) })); }
    }

    #region Nested type: DynamicJsonObject

    private sealed class DynamicJsonObject : DynamicObject
    {
        private readonly IDictionary&lt;string, object&gt; _dictionary;

        public DynamicJsonObject(IDictionary&lt;string, object&gt; dictionary)
        {
            if (dictionary == null)
                throw new ArgumentNullException(""dictionary"");
            _dictionary = dictionary;
        }

        public override string ToString()
        {
            var sb = new StringBuilder(""{"");
            ToString(sb);
            return sb.ToString();
        }

        private void ToString(StringBuilder sb)
        {
            var firstInDictionary = true;
            foreach (var pair in _dictionary)
            {
                if (!firstInDictionary)
                    sb.Append("","");
                firstInDictionary = false;
                var value = pair.Value;
                var name = pair.Key;
                if (value is string)
                {
                    sb.AppendFormat(""{0}:\""{1}\"""", name, value);
                }
                else if (value is IDictionary&lt;string, object&gt;)
                {
                    new DynamicJsonObject((IDictionary&lt;string, object&gt;)value).ToString(sb);
                }
                else if (value is ArrayList)
                {
                    sb.Append(name + "":["");
                    var firstInArray = true;
                    foreach (var arrayValue in (ArrayList)value)
                    {
                        if (!firstInArray)
                            sb.Append("","");
                        firstInArray = false;
                        if (arrayValue is IDictionary&lt;string, object&gt;)
                            new DynamicJsonObject((IDictionary&lt;string, object&gt;)arrayValue).ToString(sb);
                        else if (arrayValue is string)
                            sb.AppendFormat(""\""{0}\"""", arrayValue);
                        else
                            sb.AppendFormat(""{0}"", arrayValue);

                    }
                    sb.Append(""]"");
                }
                else
                {
                    sb.AppendFormat(""{0}:{1}"", name, value);
                }
            }
            sb.Append(""}"");
        }

        public override bool TryGetMember(GetMemberBinder binder, out object result)
        {
            if (!_dictionary.TryGetValue(binder.Name, out result))
            {
                // return null to avoid exception.  caller can check for null this way...
                result = null;
                return true;
            }

            result = WrapResultObject(result);
            return true;
        }

        public override bool TryGetIndex(GetIndexBinder binder, object[] indexes, out object result)
        {
            if (indexes.Length == 1 &amp;&amp; indexes[0] != null)
            {
                if (!_dictionary.TryGetValue(indexes[0].ToString(), out result))
                {
                    // return null to avoid exception.  caller can check for null this way...
                    result = null;
                    return true;
                }

                result = WrapResultObject(result);
                return true;
            }

            return base.TryGetIndex(binder, indexes, out result);
        }

        private static object WrapResultObject(object result)
        {
            var dictionary = result as IDictionary&lt;string, object&gt;;
            if (dictionary != null)
                return new DynamicJsonObject(dictionary);

            var arrayList = result as ArrayList;
            if (arrayList != null &amp;&amp; arrayList.Count &gt; 0)
            {
                return arrayList[0] is IDictionary&lt;string, object&gt; 
                    ? new List&lt;object&gt;(arrayList.Cast&lt;IDictionary&lt;string, object&gt;&gt;().Select(x =&gt; new DynamicJsonObject(x))) 
                    : new List&lt;object&gt;(arrayList.Cast&lt;object&gt;());
            }

            return result;
        }
    }

    #endregion
}
</code></pre>

<p>You can use it like this:</p>

<pre><code>string json = ...;

var serializer = new JavaScriptSerializer();
serializer.RegisterConverters(new[] { new DynamicJsonConverter() });

dynamic obj = serializer.Deserialize(json, typeof(object));
</code></pre>

<p>So, given a JSON string:</p>

<pre><code>{
  ""Items"":[
    { ""Name"":""Apple"", ""Price"":12.3 },
    { ""Name"":""Grape"", ""Price"":3.21 }
  ],
  ""Date"":""21/11/2010""
}
</code></pre>

<p>The following code will work at runtime:</p>

<pre><code>dynamic data = serializer.Deserialize(json, typeof(object));

data.Date; // ""21/11/2010""
data.Items.Count; // 2
data.Items[0].Name; // ""Apple""
data.Items[0].Price; // 12.3 (as a decimal)
data.Items[1].Name; // ""Grape""
data.Items[1].Price; // 3.21 (as a decimal)
</code></pre>
","3806407"
"How can you use optional parameters in C#?","463645","","<p><sup><strong>Note:</strong> This question was asked at a time when C# did not yet support optional parameters (i.e. before C# 4).</sup></p>

<p>We're building a web API that's programmatically generated from a C# class. The class has method <code>GetFooBar(int a, int b)</code> and the API has a method <code>GetFooBar</code> taking query params like <code>&amp;a=foo &amp;b=bar</code>. </p>

<p>The classes needs to support optional parameters, which isn't supported in C# the language. What's the best approach?</p>
","<p>Surprised no one mentioned C# 4.0 optional parameters that work like this:</p>

<pre><code>public void SomeMethod(int a, int b = 0)
{
   //some code
}
</code></pre>

<p><strong>Edit:</strong> I know that at the time the question was asked, C# 4.0 didn't exist. But this question still ranks #1 in Google for ""C# optional arguments"" so I thought - this answer worth being here. Sorry.</p>
","3343769"
"How to get the type of T from a member of a generic class or method?","461161","","<p>Let say I have a generic member in a class or method, so:</p>

<pre><code>public class Foo&lt;T&gt;
{
    public List&lt;T&gt; Bar { get; set; }

    public void Baz()
    {
        // get type of T
    }   
}
</code></pre>

<p>When I instantiate the class, the <code>T</code> becomes <code>MyTypeObject1</code>, so the class has a generic list property: <code>List&lt;MyTypeObject1&gt;</code>. The same applies to a generic method in a non-generic class:</p>

<pre><code>public class Foo
{
    public void Bar&lt;T&gt;()
    {
        var baz = new List&lt;T&gt;();

        // get type of T
    }
}
</code></pre>

<p>I would like to know, what type of objects the list of my class contains. So the list property called <code>Bar</code> or the local variable <code>baz</code>, contains what type of <code>T</code>? </p>

<p>I cannot do <code>Bar[0].GetType()</code>, because the list might contain zero elements. How can I do it?</p>
","<p>If I understand correctly, your list has the same type parameter as the container class itself. If this is the case, then:</p>

<pre><code>Type typeParameterType = typeof(T);
</code></pre>

<p>If you are in the lucky situation of having <code>object</code> as a type parameter, see <a href=""https://stackoverflow.com/a/557349/3649914"">Marc's answer</a>.</p>
","557355"
"How do you sort a dictionary by value?","459924","","<p>I often have to sort a dictionary, consisting of keys &amp; values, by value. For example, I have a hash of words and respective frequencies, that I want to order by frequency.</p>

<p>There is a <code>SortedList</code> which is good for a single value (say frequency), that I want to map it back to the word.</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/f7fta44c.aspx"" rel=""noreferrer"">SortedDictionary</a> orders by key, not value. Some resort to a <a href=""http://www.codeproject.com/KB/recipes/lookupcollection.aspx"" rel=""noreferrer"">custom class</a>, but is there a cleaner way?</p>
","<p>Use:</p>

<pre><code>using System.Linq.Enumerable;
...
List&lt;KeyValuePair&lt;string, string&gt;&gt; myList = aDictionary.ToList();

myList.Sort(
    delegate(KeyValuePair&lt;string, string&gt; pair1,
    KeyValuePair&lt;string, string&gt; pair2)
    {
        return pair1.Value.CompareTo(pair2.Value);
    }
);
</code></pre>

<p>Since you're targeting .NET 2.0 or above, you can simplify this into lambda syntax -- it's equivalent, but shorter. If you're targeting .NET 2.0 you can only use this syntax if you're using the compiler from Visual&nbsp;Studio&nbsp;2008 (or above).</p>

<pre><code>var myList = aDictionary.ToList();

myList.Sort((pair1,pair2) =&gt; pair1.Value.CompareTo(pair2.Value));
</code></pre>
","298"
"How to select distinct rows in a datatable and store into an array","457970","","<p>I have a dataset objds. objds contains a table named Table1. Table1 contains column named ProcessName. This ProcessName contains repeated names.So i want to select only distinct names.Is this possible.</p>

<pre><code>  intUniqId[i] = (objds.Tables[0].Rows[i][""ProcessName""].ToString());
</code></pre>
","<pre><code>DataView view = new DataView(table);
DataTable distinctValues = view.ToTable(true, ""Column1"", ""Column2"" ...);
</code></pre>
","1199956"
"How to delete all files and folders in a directory?","453578","","<p>Using C#, how can I delete all files and folders from a directory, but still keep the root directory?</p>
","<pre><code>System.IO.DirectoryInfo di = new DirectoryInfo(""YourPath"");

foreach (FileInfo file in di.GetFiles())
{
    file.Delete(); 
}
foreach (DirectoryInfo dir in di.GetDirectories())
{
    dir.Delete(true); 
}
</code></pre>
","1288747"
"C# convert integer to hex and back again","450887","","<p>How can I convert the following?</p>

<p>2934 (integer)  to   B76 (hex)</p>

<p>Let me explain what I am trying to do. I have User IDs in my database that are stored as integers. Rather than having users reference their IDs I want to let them use the hex value. The main reason is because it's shorter.</p>

<p>So not only do I need to go from integer to hex but I also need to go from hex to integer.</p>

<p>Is there an easy way to do this in C#?</p>
","<pre><code>// Store integer 182
int intValue = 182;
// Convert integer 182 as a hex in a string variable
string hexValue = intValue.ToString(""X"");
// Convert the hex string back to the number
int intAgain = int.Parse(hexValue, System.Globalization.NumberStyles.HexNumber);
</code></pre>

<p>from <a href=""http://www.geekpedia.com/KB8_How-do-I-convert-from-decimal-to-hex-and-hex-to-decimal.html"" rel=""noreferrer"">http://www.geekpedia.com/KB8_How-do-I-convert-from-decimal-to-hex-and-hex-to-decimal.html</a></p>
","1139975"
"How would you count occurrences of a string within a string?","449203","","<p>I am doing something where I realised I wanted to count how many <code>/</code>s I could find in a string, and then it struck me, that there were several ways to do it, but couldn't decide on what the best (or easiest) was.</p>

<p>At the moment I'm going with something like:</p>

<pre><code>string source = ""/once/upon/a/time/"";
int count = source.Length - source.Replace(""/"", """").Length;
</code></pre>

<p>But I don't like it at all, any takers?</p>

<p>I don't really want to dig out <code>RegEx</code> for this, do I?</p>

<p>I know my string is going to have the term I'm searching for, so you can assume that...</p>

<p>Of course for strings <em>where</em> <strong>length > 1</strong>,</p>

<pre><code>string haystack = ""/once/upon/a/time"";
string needle = ""/"";
int needleCount = ( haystack.Length - haystack.Replace(needle,"""").Length ) / needle.Length;
</code></pre>
","<p>If you're using .NET 3.5 you can do this in a one-liner with LINQ:</p>

<pre><code>int count = source.Count(f =&gt; f == '/');
</code></pre>

<p>If you don't want to use LINQ you can do it with:</p>

<pre><code>int count = source.Split('/').Length - 1;
</code></pre>

<hr>

<p>You might be surprised to learn that your original technique seems to be about 30% faster than either of these! I've just done a quick benchmark with ""/once/upon/a/time/"" and the results are as follows:</p>

<blockquote>
  <p>Your original = 12s<br>
  source.Count = 19s<br>
  source.Split = 17s<br>
  foreach (<a href=""https://stackoverflow.com/a/541976/662581"">from bobwienholt's answer</a>) = 10s </p>
</blockquote>

<p>(The times are for 50,000,000 iterations so you're unlikely to notice much difference in the real world.)</p>
","541994"
"Binding WPF ComboBox to a Custom List","448521","","<p>I have a ComboBox that doesn't seem to update the SelectedItem/SelectedValue.</p>

<p>The ComboBox ItemsSource is bound to a property on a ViewModel class that lists a bunch of RAS phonebook entries as a CollectionView, then I've bound (at separate times) both the <code>SelectedItem</code> or <code>SelectedValue</code> to another property of the ViewModel. I have added a MessageBox into the save command to debug the values set by the databinding, but the <code>SelectedItem</code>/<code>SelectedValue</code> binding is not being set.</p>

<p>The ViewModel class looks something like this:</p>

<pre><code>public ConnectionViewModel
{
    private readonly CollectionView _phonebookEntries;
    private string _phonebookeEntry;

    public CollectionView PhonebookEntries
    {
        get { return _phonebookEntries; }
    }

    public string PhonebookEntry
    {
        get { return _phonebookEntry; }
        set
        {
            if (_phonebookEntry == value) return;
            _phonebookEntry = value;
            OnPropertyChanged(""PhonebookEntry"");
        }
    }
}
</code></pre>

<p>The _phonebookEntries collection is being initialised in the constructor from a business object. The ComboBox XAML looks something like this:</p>

<pre><code>&lt;ComboBox ItemsSource=""{Binding Path=PhonebookEntries}"" 
    DisplayMemberPath=""Name"" 
    SelectedValuePath=""Name"" 
    SelectedValue=""{Binding Path=PhonebookEntry}"" /&gt;
</code></pre>

<p>I am only interested in the actual string value displayed in the ComboBox, not any other properties of the object as this is the value I need to pass across to RAS when I want to make the VPN connection, hence <code>DisplayMemberPath</code> and <code>SelectedValuePath</code> are both the Name property of the ConnectionViewModel. The ComboBox is in a <code>DataTemplate</code> applied to an <code>ItemsControl</code> on a Window who's DataContext  has been set to a ViewModel instance.</p>

<p>The ComboBox displays the list of items correctly, and I can select one in the UI with no problem. However when I display the message box from the command, the PhonebookEntry property still has the initial value in it, not the selected value from the ComboBox. Other TextBox instances are updating fine and displaying in the MessageBox.</p>

<p>What am I missing with databinding the ComboBox? I've done a lot of searching and can't seem to find anything that I'm doing wrong.</p>

<hr>

<p>This is the behaviour I'm seeing, however it's not working for some reason in my particular context.</p>

<p>I have a MainWindowViewModel which has a <code>CollectionView</code> of ConnectionViewModels. In the MainWindowView.xaml file code-behind, I set the DataContext to the MainWindowViewModel. The MainWindowView.xaml has an <code>ItemsControl</code> bound to the collection of ConnectionViewModels. I have a DataTemplate that holds the ComboBox as well as some other TextBoxes. The TextBoxes are bound directly to properties of the ConnectionViewModel using <code>Text=""{Binding Path=ConnectionName}""</code>. </p>

<pre><code>public class ConnectionViewModel : ViewModelBase
{
    public string Name { get; set; }
    public string Password { get; set; }
}

public class MainWindowViewModel : ViewModelBase
{
    // List&lt;ConnectionViewModel&gt;...
    public CollectionView Connections { get; set; }
}
</code></pre>

<p>The XAML code-behind:</p>

<pre><code>public partial class Window1
{
    public Window1()
    {
        InitializeComponent();
        DataContext = new MainWindowViewModel();
    }
}
</code></pre>

<p><strong>Then XAML:</strong></p>

<pre><code>&lt;DataTemplate x:Key=""listTemplate""&gt;
    &lt;Grid&gt;
        &lt;ComboBox ItemsSource=""{Binding Path=PhonebookEntries}"" 
            DisplayMemberPath=""Name"" 
            SelectedValuePath=""Name"" 
            SelectedValue=""{Binding Path=PhonebookEntry}"" /&gt;
        &lt;TextBox Text=""{Binding Path=Password}"" /&gt;
    &lt;/Grid&gt;
&lt;/DataTemplate&gt;

&lt;ItemsControl ItemsSource=""{Binding Path=Connections}"" 
    ItemTemplate=""{StaticResource listTemplate}"" /&gt;
</code></pre>

<p>The TextBoxes all bind correctly, and data moves between them and the ViewModel with no trouble. It's only the ComboBox that isn't working.</p>

<p>You are correct in your assumption regarding the PhonebookEntry class. </p>

<p>The assumption I am making is that the DataContext used by my DataTemplate is automatically set through the binding hierarchy, so that I don't have to explicitly set it for each item in the <code>ItemsControl</code>. That would seem a bit silly to me.</p>

<hr>

<p>Here is a test implementation that demonstrates the problem, based on the example above.</p>

<p><strong>XAML:</strong></p>

<pre><code>&lt;Window x:Class=""WpfApplication7.Window1""
    xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
    xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""
    Title=""Window1"" Height=""300"" Width=""300""&gt;
    &lt;Window.Resources&gt;
        &lt;DataTemplate x:Key=""itemTemplate""&gt;
            &lt;StackPanel Orientation=""Horizontal""&gt;
                &lt;TextBox Text=""{Binding Path=Name}"" Width=""50"" /&gt;
                &lt;ComboBox ItemsSource=""{Binding Path=PhonebookEntries}"" 
                    DisplayMemberPath=""Name"" 
                    SelectedValuePath=""Name"" 
                    SelectedValue=""{Binding Path=PhonebookEntry}""
                    Width=""200""/&gt;
            &lt;/StackPanel&gt;
        &lt;/DataTemplate&gt;
    &lt;/Window.Resources&gt;
    &lt;Grid&gt;
        &lt;ItemsControl ItemsSource=""{Binding Path=Connections}"" 
            ItemTemplate=""{StaticResource itemTemplate}"" /&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>

<p>The <strong>Code-behind</strong>:</p>

<pre><code>namespace WpfApplication7
{
    /// &lt;summary&gt;
    /// Interaction logic for Window1.xaml
    /// &lt;/summary&gt;
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
            DataContext = new MainWindowViewModel();
        }
    }

    public class PhoneBookEntry
    {
        public string Name { get; set; }
        public PhoneBookEntry(string name)
        {
            Name = name;
        }
    }

    public class ConnectionViewModel : INotifyPropertyChanged
    {

        private string _name;

        public ConnectionViewModel(string name)
        {
            _name = name;
            IList&lt;PhoneBookEntry&gt; list = new List&lt;PhoneBookEntry&gt;
                                             {
                                                 new PhoneBookEntry(""test""),
                                                 new PhoneBookEntry(""test2"")
                                             };
            _phonebookEntries = new CollectionView(list);
        }
        private readonly CollectionView _phonebookEntries;
        private string _phonebookEntry;

        public CollectionView PhonebookEntries
        {
            get { return _phonebookEntries; }
        }

        public string PhonebookEntry
        {
            get { return _phonebookEntry; }
            set
            {
                if (_phonebookEntry == value) return;
                _phonebookEntry = value;
                OnPropertyChanged(""PhonebookEntry"");
            }
        }

        public string Name
        { 
            get { return _name; }
            set
            {
                if (_name == value) return;
                _name = value;
                OnPropertyChanged(""Name"");
            }
        }
        private void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
        public event PropertyChangedEventHandler PropertyChanged;
    }

    public class MainWindowViewModel
    {
        private readonly CollectionView _connections;

        public MainWindowViewModel()
        {
            IList&lt;ConnectionViewModel&gt; connections = new List&lt;ConnectionViewModel&gt;
                                                          {
                                                              new ConnectionViewModel(""First""),
                                                              new ConnectionViewModel(""Second""),
                                                              new ConnectionViewModel(""Third"")
                                                          };
            _connections = new CollectionView(connections);
        }

        public CollectionView Connections
        {
            get { return _connections; }
        }
    }
}
</code></pre>

<p>If you run that example, you will get the behaviour I'm talking about. The TextBox updates its binding fine when you edit it, but the ComboBox does not. Very confusing seeing as really the only thing I've done is introduce a parent ViewModel.</p>

<p>I am currently labouring under the impression that an item bound to the child of a DataContext has that child as it's DataContext. I can't find any documentation that clears this up one way or the other.</p>

<p>I.e, </p>

<p>Window -> DataContext = MainWindowViewModel<br>
..Items -> Bound to DataContext.PhonebookEntries<br>
....Item -> DataContext = PhonebookEntry (implicitly associated)  </p>

<p>I don't know if that explains my assumption any better?</p>

<hr>

<p>To confirm my assumption, change the binding of the TextBox to be</p>

<pre><code>&lt;TextBox Text=""{Binding Mode=OneWay}"" Width=""50"" /&gt;
</code></pre>

<p>And this will show the TextBox binding root (which I'm comparing to the DataContext) is the ConnectionViewModel instance.</p>
","<p>You set the DisplayMemberPath and the SelectedValuePath to ""Name"", so I assume that you have a class PhoneBookEntry with a public property Name.</p>

<p>Have you set the DataContext to your ConnectionViewModel object?</p>

<p>I copied you code and made some minor modifications, and it seems to work fine.
I can set the viewmodels PhoneBookEnty property and the selected item in the combobox changes, and I can change the selected item in the combobox and the view models PhoneBookEntry property is set correctly.</p>

<p>Here is my xaml:</p>

<pre><code>&lt;Window x:Class=""WpfApplication6.Window1""
xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""
Title=""Window1"" Height=""300"" Width=""300""&gt;
&lt;Grid&gt;

    &lt;StackPanel&gt;
        &lt;Button Click=""Button_Click""&gt;asdf&lt;/Button&gt;
        &lt;ComboBox ItemsSource=""{Binding Path=PhonebookEntries}""
                  DisplayMemberPath=""Name""
                  SelectedValuePath=""Name""
                  SelectedValue=""{Binding Path=PhonebookEntry}"" /&gt;
    &lt;/StackPanel&gt;
&lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>

<p>And here is my code behind:</p>

<pre><code>namespace WpfApplication6
{
/// &lt;summary&gt;
/// Interaction logic for Window1.xaml
/// &lt;/summary&gt;
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
        ConnectionViewModel vm = new ConnectionViewModel();
        DataContext = vm;
    }
    private void Button_Click(object sender, RoutedEventArgs e)
    {
        ((ConnectionViewModel)DataContext).PhonebookEntry = ""test"";
    }
}
public class PhoneBookEntry
{
    public string Name { get; set; }
    public PhoneBookEntry(string name)
    {
        Name = name;
    }
    public override string ToString() 
    {
        return Name;
    }
}
public class ConnectionViewModel : INotifyPropertyChanged
{
    public ConnectionViewModel()
    {
        IList&lt;PhoneBookEntry&gt; list = new List&lt;PhoneBookEntry&gt;();
        list.Add(new PhoneBookEntry(""test""));
        list.Add(new PhoneBookEntry(""test2""));
        _phonebookEntries = new CollectionView(list);
    }
    private readonly CollectionView _phonebookEntries;
    private string _phonebookEntry;

    public CollectionView PhonebookEntries
    {
        get { return _phonebookEntries; }
    }

    public string PhonebookEntry
    {
        get { return _phonebookEntry; }
        set
        {
            if (_phonebookEntry == value) return;
            _phonebookEntry = value;
            OnPropertyChanged(""PhonebookEntry"");
        }
    }
    private void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
    public event PropertyChangedEventHandler PropertyChanged;
}
}
</code></pre>

<p><strong>Edit:</strong> Geoffs second example does not seem to work, which seems a bit odd to me. If I <strong>change the PhonebookEntries property on the ConnectionViewModel to be of type ReadOnlyCollection</strong>, the TwoWay binding of the SelectedValue property on the combobox works fine.</p>

<p>Maybe there is an issue with the CollectionView? I noticed a warning the the ouput console:
""System.Windows.Data Warning: 50 : Using CollectionView directly is not fully supported.  The basic features work, although with some inefficiencies, but advanced features may encounter known bugs.  Consider using a derived class to avoid these problems.""</p>

<p><strong>Edit2(.Net 4.5):</strong> The content of the DropDownList can be based on ToString() and not of DisplayMemberPath, while DisplayMemberPath specifies the member for the selected and displayed item only.</p>
","561427"
"Why is Dictionary preferred over Hashtable?","447956","","<p>In most programming languages, dictionaries are preferred over hashtables.
What are the reasons behind that?</p>
","<p>For what it's worth, a Dictionary <strong>is</strong> (conceptually) a hash table.</p>

<p>If you meant ""why do we use the <code>Dictionary&lt;TKey, TValue&gt;</code> class instead of the <code>Hashtable</code> class?"", then it's an easy answer: <code>Dictionary&lt;TKey, TValue&gt;</code> is a generic type, <code>Hashtable</code> is not. That means you get type safety with <code>Dictionary&lt;TKey, TValue&gt;</code>, because you can't insert any random object into it, and you don't have to cast the values you take out.</p>

<p>Interestingly, the <code>Dictionary&lt;TKey, TValue&gt;</code> implementation in the .NET Framework is based on the <code>Hashtable</code>, as you can tell from this comment in its source code:</p>

<blockquote>
  <p>The generic Dictionary was copied from Hashtable's source</p>
</blockquote>

<p><a href=""http://referencesource.microsoft.com/#mscorlib/system/collections/hashtable.cs"" rel=""noreferrer"">Source</a> </p>
","301384"
"How to get a user's client IP address in ASP.NET?","446441","","<p>We have <code>Request.UserHostAddress</code> to get the IP address in ASP.NET, but this is usually the user's ISP's IP address, not exactly the user's machine IP address who for example clicked a link. How can I get the real IP Address?</p>

<p>For example, in a Stack Overflow user profile it is: <strong>""Last account activity: 4 hours ago from 86.123.127.8""</strong>, but my machine IP address is a bit different. How does Stack Overflow get this address? </p>

<p>In some web systems there is an IP address check for some purposes. For example, with a certain IP address, for every 24 hours can the user just have only 5 clicks on download links? This IP address should be unique, not for an ISP that has a huge range of clients or Internet users.</p>

<p>Did I understand well?</p>
","<p>As others have said you can't do what you are asking. If you describe the problem you are trying to solve maybe someone can help? E.g. are you trying to uniquely identify your users? Could you use a cookie, or the session ID perhaps instead of the IP address?</p>

<p><strong>Edit</strong> The address you see on the server shouldn't be the ISP's address, as you say that would be a huge range. The address for a home user on broadband will be the address at their router, so every device inside the house will appear on the outside to be the same, but the router uses NAT to ensure that traffic is routed to each device correctly. For users accessing from an office environment the address may well be the same for all users. Sites that use IP address for ID run the risk of getting it very wrong - the examples you give are good ones and they often fail. For example my office is in the UK, the breakout point (where I ""appear"" to be on the internet) is in another country where our main IT facility is, so from my office my IP address appears to be not in the UK. For this reason I can't access UK only web content, such as the BBC iPlayer). At any given time there would be hundreds, or even thousands, of people at my company who appear to be accessing the web from the same IP address.</p>

<p>When you are writing server code you can never be sure what the IP address you see is referring to. Some users like it this way. Some people deliberately use a proxy or VPN to further confound you.</p>

<p>When you say your machine address is different to the IP address shown on StackOverflow, how are you finding out your machine address? If you are just looking locally using <code>ipconfig</code> or something like that I would expect it to be different for the reasons I outlined above. If you want to double check what the outside world thinks have a look at <a href=""http://whatismyipaddress.com/"" rel=""noreferrer"">whatismyipaddress.com/</a>.</p>

<p>This <a href=""http://en.wikipedia.org/wiki/Network_address_translation"" rel=""noreferrer"">Wikipedia link on NAT</a> will provide you some background on this.</p>
","735420"
"Regex that accepts only numbers (0-9) and NO characters","442843","","<p>I need a regex that will accept only digits from 0-9 and nothing else. No letters, no characters.</p>

<p>I thought this would work:</p>

<pre><code>^[0-9]
</code></pre>

<p>or even </p>

<pre><code>\d+
</code></pre>

<p>but these are accepting the characters : ^,$,(,), etc</p>

<p>I thought that both the regexes above would do the trick and I'm not sure why its accepting those characters.</p>

<p>EDIT:</p>

<p>This is exactly what I am doing:</p>

<pre><code> private void OnTextChanged(object sender, EventArgs e)
    {

   if (!System.Text.RegularExpressions.Regex.IsMatch(""^[0-9]"", textbox.Text))
        {
            textbox.Text = string.Empty;
        }
    }
</code></pre>

<p>This is allowing the characters I mentioned above.</p>
","<p>Your regex <code>^[0-9]</code> matches anything <em>beginning</em> with a digit, including strings like ""1A"". To avoid a partial match, append a <code>$</code> to the end:</p>

<pre><code>^[0-9]*$
</code></pre>

<p>This accepts any number of digits, including none. To accept one or more digits, change the <code>*</code> to <code>+</code>. To accept exactly one digit, just remove the <code>*</code>.</p>

<p><strong>UPDATE:</strong> You mixed up the arguments to <code>IsMatch</code>. The pattern should be the second argument, not the first:</p>

<pre><code>if (!System.Text.RegularExpressions.Regex.IsMatch(textbox.Text, ""^[0-9]*$""))
</code></pre>

<p><strong>CAUTION:</strong> In JavaScript, <code>\d</code> is equivalent to <code>[0-9]</code>, but in .NET, <code>\d</code> by default matches any <a href=""http://graphemica.com/categories/decimal-digit-number"">Unicode decimal digit</a>, including exotic fare like ႒ (Myanmar 2) and ߉ (N'Ko 9). Unless your app is prepared to deal with these characters, stick with <code>[0-9]</code> (or supply the <a href=""https://msdn.microsoft.com/en-us/library/yd1hzczs(v=vs.110).aspx#Anchor_10"">RegexOptions.ECMAScript</a> flag).</p>
","19715367"
"Best way to reverse a string","441967","","<p>I've just had to write a string reverse function in C# 2.0 (i.e. LINQ not available) and came up with this:</p>

<pre><code>public string Reverse(string text)
{
    char[] cArray = text.ToCharArray();
    string reverse = String.Empty;
    for (int i = cArray.Length - 1; i &gt; -1; i--)
    {
        reverse += cArray[i];
    }
    return reverse;
}
</code></pre>

<p>Personally I'm not crazy about the function and am convinced that there's a better way to do it. Is there?</p>
","<pre><code>public static string Reverse( string s )
{
    char[] charArray = s.ToCharArray();
    Array.Reverse( charArray );
    return new string( charArray );
}
</code></pre>
","228060"
"Sending email in .NET through Gmail","440502","","<p>Instead of relying on my host to send email, I was thinking of sending the email messages using my Gmail account. The emails are personalized emails to the bands I play on my show. Is it possible to do?</p>
","<p>Be sure to use <code>System.Net.Mail</code>, not the deprecated <code>System.Web.Mail</code>. Doing SSL with <code>System.Web.Mail</code> is a gross mess of hacky extensions.</p>

<pre><code>using System.Net;
using System.Net.Mail;

var fromAddress = new MailAddress(""from@gmail.com"", ""From Name"");
var toAddress = new MailAddress(""to@example.com"", ""To Name"");
const string fromPassword = ""fromPassword"";
const string subject = ""Subject"";
const string body = ""Body"";

var smtp = new SmtpClient
{
    Host = ""smtp.gmail.com"",
    Port = 587,
    EnableSsl = true,
    DeliveryMethod = SmtpDeliveryMethod.Network,
    UseDefaultCredentials = false,
    Credentials = new NetworkCredential(fromAddress.Address, fromPassword)
};
using (var message = new MailMessage(fromAddress, toAddress)
{
    Subject = subject,
    Body = body
})
{
    smtp.Send(message);
}
</code></pre>
","32336"
"Multidimensional Array [][] vs [,]","440242","","<pre><code>double[][] ServicePoint = new double[10][9]; // &lt;-- gives an error (1)
double[,] ServicePoint = new double[10,9]; // &lt;-- ok (2)
</code></pre>

<p>What's their difference? <em>(1)</em> yields an error, what's the reason?</p>

<p>And</p>

<pre><code>double d = new double[9]
ServicePoint[0] = d;
</code></pre>

<p>using <em>(2)</em> will prompt an error. Why?</p>
","<p>One is an array of arrays, and one is a 2d array.  The former can be jagged, the latter is uniform.</p>

<p>That is, a <code>double[][]</code> can validly be:</p>

<pre><code>double[][] x = new double[5][];

x[0] = new double[10];
x[1] = new double[5];
x[2] = new double[3];
x[3] = new double[100];
x[4] = new double[1];
</code></pre>

<p>Because each entry in the array is a reference to an array of <code>double</code>. With a jagged array, you can do an assignment to an array like you want in your second example:</p>

<pre><code>x[0] = new double[13];
</code></pre>

<p>On the second item, because it is a uniform 2d array, you can't assign a 1d array to a row or column, because you must index both the row and column, which gets you down to a single <code>double</code>:</p>

<pre><code>double[,] ServicePoint = new double[10,9];

ServicePoint[0]... // &lt;-- meaningless, a 2d array can't use just one index.
</code></pre>

<p><strong>UPDATE</strong>:</p>

<p>To clarify based on your question, the reason your #1 had a syntax error is because you had this:</p>

<pre><code>double[][] ServicePoint = new double[10][9];
</code></pre>

<p>And you can't specify the second index at the time of construction.  The key is that ServicePoint is <em>not</em> a 2d array, but an 1d array (of arrays) and thus since you are creating a 1d array (of arrays), you specify only one index:</p>

<pre><code>double[][] ServicePoint = new double[10][];
</code></pre>

<p>Then, when you create each item in the array, each of those are also arrays, so <em>then</em> you can specify their dimensions (which can be different, hence the term <em>jagged</em> array):</p>

<pre><code>ServicePoint[0] = new double[13];
ServicePoint[1] = new double[20];
</code></pre>

<p>Hope that helps!</p>
","12567378"
"String was not recognized as a valid DateTime "" format dd/MM/yyyy""","438956","","<p>I am trying to convert my string formatted value to date type with format <code>dd/MM/yyyy</code>.</p>

<pre><code>this.Text=""22/11/2009"";

DateTime date = DateTime.Parse(this.Text);
</code></pre>

<p>What is the problem ?
It has a second override which asks for <code>IFormatProvider</code>. What is this? <em>Do</em> I need to pass this also? If Yes how to use it for this case?</p>

<p><strong>Edit</strong> </p>

<p>What are the differences between <code>Parse</code> and <code>ParseExact</code>?</p>

<p><strong>Edit 2</strong></p>

<p>Both answers of Slaks and Sam are working for me, currently user is giving the input but this will be assured by me that they are valid by using maskTextbox.</p>

<p>Which answer is better considering all aspects like type saftey, performance or something you feel like</p>
","<p>Use <code>DateTime.ParseExact</code>.</p>

<pre><code>this.Text=""22/11/2009"";

DateTime date = DateTime.ParseExact(this.Text, ""dd/MM/yyyy"", null);
</code></pre>
","2193037"
"What is the syntax for an inner join in LINQ to SQL?","438823","","<p>I'm writing a LINQ to SQL statement, and I'm after the standard syntax for a normal inner join with an <code>ON</code> clause in C#.</p>

<p>How do you represent the following in LINQ to SQL:</p>

<pre><code>select DealerContact.*
from Dealer 
inner join DealerContact on Dealer.DealerID = DealerContact.DealerID
</code></pre>
","<p>It goes something like:</p>

<pre><code>from t1 in db.Table1
join t2 in db.Table2 on t1.field equals t2.field
select new { t1.field2, t2.field3}
</code></pre>

<p>It would be nice to have sensible names and fields for your tables for a better example. :)</p>

<p><strong>Update</strong></p>

<p>I think for your query this might be more appropriate:</p>

<pre><code>var dealercontacts = from contact in DealerContact
                     join dealer in Dealer on contact.DealerId equals dealer.ID
                     select contact;
</code></pre>

<p>Since you are looking for the contacts, not the dealers.</p>
","37332"
"when & why to use delegates?","436151","","<p>I'm relatively new in C#, &amp; I'm wondering <strong>when to use Delegates appropriately</strong>.
they are widely used in events declaration , but when should I use them in my own code and <strong>why are they useful?</strong> <strong>why not to use something else?</strong></p>

<p>I'm also wondering <strong>when I have to use delegates and I have no other alternative</strong>.</p>

<p>Thank you for the help!</p>

<p>EDIT: I think I've found a <strong>necessary use of Delegates</strong> <a href=""https://stackoverflow.com/questions/1999282/do-this-without-using-an-if-ifs-value1-else-ifs-value2/1999364#1999364"">here</a></p>
","<p>I agree with everything that is said already, just trying to put some other words on it.</p>

<p>A delegate can be seen as a placeholder for a/some method(s).</p>

<p>By defining a delegate, you are saying to the user of your class, ""<em>Please feel free to assign, any method that matches this signature, to the delegate and it will be called each time my delegate is called</em>"".</p>

<p>Typical use is of course events. All the OnEventX <em>delegate</em> to the methods the user defines.</p>

<p>Delegates are useful to offer to the <strong>user</strong> of your objects some ability to customize their behavior.
Most of the time, you can use other ways to achieve the same purpose and I do not believe you can ever be <strong>forced</strong> to create delegates. It is just the easiest way in some situations to get the thing done.</p>
","2019542"
"How do I clone a generic list in C#?","433235","","<p>I have a generic list of objects in C#, and wish to clone the list. The items within the list are cloneable, but there doesn't seem to be an option to do <code>list.Clone()</code>.</p>

<p>Is there an easy way around this?</p>
","<p>You can use an extension method.</p>

<pre><code>static class Extensions
{
    public static IList&lt;T&gt; Clone&lt;T&gt;(this IList&lt;T&gt; listToClone) where T: ICloneable
    {
        return listToClone.Select(item =&gt; (T)item.Clone()).ToList();
    }
}
</code></pre>
","222640"
"Remove duplicates from a List<T> in C#","431350","","<p>Anyone have a quick method for de-duplicating a generic List in C#?</p>
","<p>Perhaps you should consider using a <a href=""http://msdn.microsoft.com/en-us/library/bb359438.aspx"" rel=""noreferrer"">HashSet</a>.</p>

<p>From the MSDN link:</p>

<pre><code>using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        HashSet&lt;int&gt; evenNumbers = new HashSet&lt;int&gt;();
        HashSet&lt;int&gt; oddNumbers = new HashSet&lt;int&gt;();

        for (int i = 0; i &lt; 5; i++)
        {
            // Populate numbers with just even numbers.
            evenNumbers.Add(i * 2);

            // Populate oddNumbers with just odd numbers.
            oddNumbers.Add((i * 2) + 1);
        }

        Console.Write(""evenNumbers contains {0} elements: "", evenNumbers.Count);
        DisplaySet(evenNumbers);

        Console.Write(""oddNumbers contains {0} elements: "", oddNumbers.Count);
        DisplaySet(oddNumbers);

        // Create a new HashSet populated with even numbers.
        HashSet&lt;int&gt; numbers = new HashSet&lt;int&gt;(evenNumbers);
        Console.WriteLine(""numbers UnionWith oddNumbers..."");
        numbers.UnionWith(oddNumbers);

        Console.Write(""numbers contains {0} elements: "", numbers.Count);
        DisplaySet(numbers);
    }

    private static void DisplaySet(HashSet&lt;int&gt; set)
    {
        Console.Write(""{"");
        foreach (int i in set)
        {
            Console.Write("" {0}"", i);
        }
        Console.WriteLine("" }"");
    }
}

/* This example produces output similar to the following:
 * evenNumbers contains 5 elements: { 0 2 4 6 8 }
 * oddNumbers contains 5 elements: { 1 3 5 7 9 }
 * numbers UnionWith oddNumbers...
 * numbers contains 10 elements: { 0 2 4 6 8 1 3 5 7 9 }
 */
</code></pre>
","47757"
"How do I calculate someone's age in C#?","429783","","<p>Given a <code>DateTime</code> representing a person's birthday, how do I calculate their age in years?  </p>
","<p>An easy to understand and simple solution.</p>

<pre><code>// Save today's date.
var today = DateTime.Today;
// Calculate the age.
var age = today.Year - birthdate.Year;
// Go back to the year the person was born in case of a leap year
if (birthdate &gt; today.AddYears(-age)) age--;
</code></pre>

<p>However, this assumes you are looking for the <em>western</em> idea of age and not using <a href=""http://en.wikipedia.org/wiki/East_Asian_age_reckoning"" rel=""noreferrer""><em>East Asian reckoning</em></a>.</p>
","1404"
"MSSQL Error 'The underlying provider failed on Open'","427470","","<p>I was using an <code>.mdf</code> for connecting to a <code>database</code> and <code>entityClient</code>. Now I want to change the connection string so that there will be no <code>.mdf</code> file.</p>

<p>Is the following <code>connectionString</code> correct?</p>

<pre><code>&lt;connectionStrings&gt;
   &lt;!--&lt;add name=""conString"" connectionString=""metadata=res://*/conString.csdl|res://*/conString.ssdl|res://*/conString.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;Data Source=.\SQL2008;AttachDbFilename=|DataDirectory|\NData.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True;MultipleActiveResultSets=True&amp;quot;"" providerName=""System.Data.EntityClient"" /&gt;--&gt;
   &lt;add name=""conString"" connectionString=""metadata=res://*/conString.csdl|res://*/conString.ssdl|res://*/conString.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;Data Source=.\SQL2008;Initial Catalog=NData;Integrated Security=True;Connect Timeout=30;User Instance=True;MultipleActiveResultSets=True&amp;quot;"" providerName=""System.Data.EntityClient"" /&gt;
</code></pre>

<p></p>

<p>Because I always get the error:</p>

<blockquote>
  <p>The underlying provider failed on Open</p>
</blockquote>
","<p>I had this error and found a few solutions:</p>

<p>Looking at your connection string, it looks valid.  I found <a href=""http://th2tran.blogspot.com/2009/06/underlying-provider-failed-on-open.html"" rel=""noreferrer"">this blog post</a>, the problem here is that they were using <a href=""http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.integratedsecurity.aspx"" rel=""noreferrer"">Integrated Security</a>.  If you are running on IIS, your IIS user needs access to the database.</p>

<p>If you are using <a href=""http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx"" rel=""noreferrer"">Entity Framework</a> <a href=""https://stackoverflow.com/questions/452129/entity-framework-using-transactions-and-rollbacks-possible"">with Transactions</a>, Entity Framework automatically opens and closes a connection with each database call.  So when using transactions, you are attempting to spread a transaction out over multiple connections.  This elevates to <a href=""http://en.wikipedia.org/wiki/Distributed_Transaction_Coordinator"" rel=""noreferrer"">MSDTC</a>.</p>

<p>(<a href=""http://msdn.microsoft.com/en-us/library/bb738698.aspx"" rel=""noreferrer"">See this reference for more information.</a>)</p>

<p>Changing my code to the following fixed it:</p>

<pre><code>using (DatabaseEntities context = new DatabaseEntities())
{
    context.Connection.Open();
    // the rest
}
</code></pre>
","3081776"
"Pass Method as Parameter using C#","426566","","<p>I have several methods all with the same signature (parameters and return values) but different names and the internals of the methods are different.  I want to pass the name of the method to run to another method that will invoke the passed in method.</p>

<pre><code>public int Method1(string)
{
    ... do something
    return myInt;
}

public int Method2(string)
{
    ... do something different
    return myInt;
}

public bool RunTheMethod([Method Name passed in here] myMethodName)
{
    ... do stuff
    int i = myMethodName(""My String"");
    ... do more stuff
    return true;
}

public bool Test()
{
    return RunTheMethod(Method1);
}
</code></pre>

<p>This code does not work but this is what I am trying to do.  What I don't understand is how to write the RunTheMethod code since I need to define the parameter.</p>
","<p>You can use the Func delegate in .net 3.5 as the parameter in your RunTheMethod method. The Func delegate allows you to specify a method that takes a number of parameters of a specific type and returns a single argument of a specific type. Here is an example that should work:</p>

<pre><code>public class Class1
{
    public int Method1(string input)
    {
        //... do something
        return 0;
    }

    public int Method2(string input)
    {
        //... do something different
        return 1;
    }

    public bool RunTheMethod(Func&lt;string, int&gt; myMethodName)
    {
        //... do stuff
        int i = myMethodName(""My String"");
        //... do more stuff
        return true;
    }

    public bool Test()
    {
        return RunTheMethod(Method1);
    }
}
</code></pre>
","2082650"
"URL Encoding using C#","425889","","<p>I have an application which I've developed for a friend. It sends a POST request to the VB forum software and logs someone in (with out setting cookies or anything).</p>

<p>Once the user is logged in I create a variable that creates a path on their local machine.</p>

<p>c:\tempfolder\date\username</p>

<p>The problem is that some usernames are throwing ""Illegal chars"" exception. For example if my username was <code>mas|fenix</code> it would throw an exception..</p>

<pre><code>Path.Combine( _      
  Environment.GetFolderPath(System.Environment.SpecialFolder.CommonApplicationData), _
  DateTime.Now.ToString(""ddMMyyhhmm"") + ""-"" + form1.username)
</code></pre>

<p>I don't want to remove it from the string, but a folder with their username is created through FTP on a server. And this leads to my second question. If I am creating a folder on the server can I leave the ""illegal chars"" in? I only ask this because the server is Linux based, and I am not sure if Linux accepts it or not..</p>

<p><strong>EDIT: It seems that URL encode is NOT what I want.. Here's what I want to do:</strong></p>

<pre><code>old username = mas|fenix
new username = mas%xxfenix
</code></pre>

<p>Where %xx is the ASCII value or any other value that would easily identify the character.</p>
","<p><strong>Edit: Note that this answer is now out of date. See <a href=""https://stackoverflow.com/a/7427556/21539"">Siarhei Kuchuk's answer below</a> for a better fix</strong></p>

<p>UrlEncoding will do what you are suggesting here. With C#, you simply use <code>HttpUtility</code>, as mentioned. </p>

<p>You can also Regex the illegal characters and then replace, but this gets far more complex, as you will have to have some form of state machine (switch ... case, for example) to replace with the correct characters. Since <code>UrlEncode</code> does this up front, it is rather easy.</p>

<p>As for Linux versus windows, there are some characters that are acceptable in Linux that are not in Windows, but I would not worry about that, as the folder name can be returned by decoding the Url string, using <code>UrlDecode</code>, so you can round trip the changes.</p>
","575765"
"Replace Line Breaks in a String C#","425555","","<p>How can I replace Line Breaks within a string in C#?</p>
","<p>Use replace with <code>Environment.NewLine</code></p>

<pre><code>myString = myString.Replace(System.Environment.NewLine, ""replacement text"")
</code></pre>

<p>As mentioned in other posts, if the string comes from another environment (OS) then you'd need to replace that particular environments implementation of <a href=""http://en.wikipedia.org/wiki/Newline"" rel=""noreferrer"">new line control characters</a>.</p>
","238020"
"How can I generate random alphanumeric strings in C#?","425007","","<p>How can I generate random 8 character alphanumeric strings in C#?</p>
","<p>I heard LINQ is the new black, so here's my attempt using LINQ:</p>

<pre><code>private static Random random = new Random();
public static string RandomString(int length)
{
    const string chars = ""ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"";
    return new string(Enumerable.Repeat(chars, length)
      .Select(s =&gt; s[random.Next(s.Length)]).ToArray());
}
</code></pre>

<p><sup>(<em>Note:</em> The use of the Random class makes this unsuitable for anything security related, such as creating passwords or tokens.<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use the RNGCryptoServiceProvider class if you need a strong random number generator.)</sup></p>
","1344242"
"Using LINQ to remove elements from a List<T>","420747","","<p>Say that I have LINQ query such as:</p>

<pre><code>var authors = from x in authorsList
              where x.firstname == ""Bob""
              select x;
</code></pre>

<p>Given that <code>authorsList</code> is of type <code>List&lt;Author&gt;</code>, how can I delete the <code>Author</code> elements from <code>authorsList</code> that are returned by the query into <code>authors</code>?</p>

<p>Or, put another way, how can I delete all of the firstname's equalling Bob from <code>authorsList</code>?</p>

<p>Note: This is a simplified example for the purposes of the question.</p>
","<p>Well, it would be easier to exclude them in the first place:</p>

<pre><code>authorsList = authorsList.Where(x =&gt; x.FirstName != ""Bob"").ToList();
</code></pre>

<p>However, that would just change the value of <code>authorsList</code> instead of removing the authors from the previous collection. Alternatively, you can use <a href=""http://msdn.microsoft.com/en-us/library/wdka673a.aspx"" rel=""noreferrer""><code>RemoveAll</code></a>:</p>

<pre><code>authorsList.RemoveAll(x =&gt; x.FirstName == ""Bob"");
</code></pre>

<p>If you really need to do it based on another collection, I'd use a HashSet, RemoveAll and Contains:</p>

<pre><code>var setToRemove = new HashSet&lt;Author&gt;(authors);
authorsList.RemoveAll(x =&gt; setToRemove.Contains(x));
</code></pre>
","853551"
"Creating a comma separated list from IList<string> or IEnumerable<string>","420342","","<p>What is the cleanest way to create a comma-separated list of string values from an <code>IList&lt;string&gt;</code> or <code>IEnumerable&lt;string&gt;</code>?</p>

<p><code>String.Join(...)</code> operates on a <code>string[]</code> so can be cumbersome to work with when types such as <code>IList&lt;string&gt;</code> or <code>IEnumerable&lt;string&gt;</code> cannot easily be converted into a string array.</p>
","<p><strong>.NET 4+</strong></p>

<pre><code>IList&lt;string&gt; strings = new List&lt;string&gt;{""1"",""2"",""testing""};
string joined = string.Join("","", strings);
</code></pre>

<p><strong>Detail &amp; Pre .Net 4.0 Solutions</strong></p>

<p><code>IEnumerable&lt;string&gt;</code> can be converted into a string array <em>very</em> easily with LINQ (.NET 3.5):</p>

<pre><code>IEnumerable&lt;string&gt; strings = ...;
string[] array = strings.ToArray();
</code></pre>

<p>It's easy enough to write the equivalent helper method if you need to:</p>

<pre><code>public static T[] ToArray(IEnumerable&lt;T&gt; source)
{
    return new List&lt;T&gt;(source).ToArray();
}
</code></pre>

<p>Then call it like this:</p>

<pre><code>IEnumerable&lt;string&gt; strings = ...;
string[] array = Helpers.ToArray(strings);
</code></pre>

<p>You can then call <code>string.Join</code>. Of course, you don't <em>have</em> to use a helper method:</p>

<pre><code>// C# 3 and .NET 3.5 way:
string joined = string.Join("","", strings.ToArray());
// C# 2 and .NET 2.0 way:
string joined = string.Join("","", new List&lt;string&gt;(strings).ToArray());
</code></pre>

<p>The latter is a bit of a mouthful though :)</p>

<p>This is likely to be the simplest way to do it, and quite performant as well - there are other questions about exactly what the performance is like, including (but not limited to) <a href=""https://stackoverflow.com/questions/219519/whats-the-c-method-syntax-for-converting-an-array-to-a-simple-string"">this one</a>.</p>

<p>As of .NET 4.0, there are more overloads available in <a href=""http://msdn.microsoft.com/en-us/library/system.string.join"" rel=""noreferrer""><code>string.Join</code></a>, so you can actually just write:</p>

<pre><code>string joined = string.Join("","", strings);
</code></pre>

<p>Much simpler :)</p>
","799454"
"Writing to output window of Visual Studio?","420141","","<p>I am trying to write a message to the output window for debugging purposes. I searched for a function like Java's <code>system.out.println("""")</code>. I tried <code>Debug.Write</code>, <code>Console.Write</code>, and <code>Trace.Write</code>. It does not give an error, but it does not print anything either.</p>

<p>""Define DEBUG constant"" and ""Define TRACE constant"" options are checked.</p>

<p>Menu <em>Tools</em> → <em>Options</em> → <em>Debugging</em> → <em>""Redirect all Output Window text to the Immediate Window""</em> option is not checked.</p>

<p>Configuration: Active (Debug)</p>

<p>Note: I created a project with the wizard as ""Windows Forms Application"" if relevant. I have no idea where to look.</p>
","<p>Add the <code>System.Diagnostics</code> namespace, and then you can use <code>Debug.WriteLine()</code> to quickly print a message to the output window of the IDE. For more details, please refer to these:</p>

<ul>
<li><em><a href=""http://support.microsoft.com/kb/815788"" rel=""noreferrer"">How to trace and debug in Visual C#</a></em></li>
<li><em><a href=""http://www.codeproject.com/Articles/3008/A-Treatise-on-Using-Debug-and-Trace-classes-includ"" rel=""noreferrer"">A Treatise on Using Debug and Trace classes, including Exception Handling</a></em></li>
</ul>
","9466908"
"Using String Format to show decimal up to 2 places or simple integer","418201","","<p>I have got a price field to display which sometimes can be either 100 or 100.99 or 100.9, What I want is to display the price in 2 decimal places only if the decimals are entered for that price , for instance if its 100 so it should only show 100 not 100.00 and if the price is 100.2 it should display 100.20 similarly for 100.22 should be same .
I googled and came across some examples but they didn't match exactly what i wanted :</p>

<pre><code>// just two decimal places
String.Format(""{0:0.00}"", 123.4567);      // ""123.46""
String.Format(""{0:0.00}"", 123.4);         // ""123.40""
String.Format(""{0:0.00}"", 123.0);         // ""123.00""
</code></pre>
","<p>An inelegant way would be:</p>

<pre><code>var my = DoFormat(123.0);
</code></pre>

<p>With <code>DoFormat</code> being something like:</p>

<pre><code>public static string DoFormat( double myNumber )
{
    var s = string.Format(""{0:0.00}"", myNumber);

    if ( s.EndsWith(""00"") )
    {
        return ((int)myNumber).ToString();
    }
    else
    {
        return s;
    }
}
</code></pre>

<p>Not elegant but working for me in similar situations in some projects.</p>
","6951366"
"Inserting a tab character into text using C#","417591","","<p>I'm building an application where I should capture several values and build a text with them: <code>Name</code>, <code>Age</code>, etc. </p>

<p>The output will be a plain text into a <code>TextBox</code>.</p>

<p>I am trying to make those information appear in kind of <code>columns</code>, therefore I am trying to separate them with <code>tab</code> to make it clearer.</p>

<p>For example, instead of having:</p>

<pre><code>Ann 26
Sarah 29
Paul 45
</code></pre>

<p>I would like it to show as:</p>

<p>Ann <em>tab</em> 26 Sarah <em>tab</em> 29 Paul <em>tab</em> 45</p>

<p>Any tip on how to <code>insert</code> the tabs into my text?</p>
","<p>Try using the <code>\t</code> character in your strings</p>
","366126"
"How do I encode and decode a base64 string?","416729","","<ol>
<li><p>How do I return a base64 encoded string given a string?</p></li>
<li><p>How do I decode a base64 encoded string into a string?</p></li>
</ol>
","<h3>Encode</h3>

<pre><code>
public static string Base64Encode(string plainText) {
  var plainTextBytes = System.Text.Encoding.UTF8.GetBytes(plainText);
  return System.Convert.ToBase64String(plainTextBytes);
}
</code></pre>

<h3>Decode</h3>

<pre><code>
public static string Base64Decode(string base64EncodedData) {
  var base64EncodedBytes = System.Convert.FromBase64String(base64EncodedData);
  return System.Text.Encoding.UTF8.GetString(base64EncodedBytes);
}
</code></pre>
","11743162"
"Call a stored procedure with parameter in c#","415994","","<p>I can do a delete, insert and update in my program and I try to do an insert by call a created stored procedure from my database.  </p>

<p>This a button insert I make work well.</p>

<pre><code>private void btnAdd_Click(object sender, EventArgs e)
{
        SqlConnection con = new SqlConnection(dc.Con);
        SqlCommand cmd = new SqlCommand(""Command String"", con);

        da.InsertCommand = new SqlCommand(""INSERT INTO tblContacts VALUES (@FirstName, @LastName)"", con);
        da.InsertCommand.Parameters.Add(""@FirstName"", SqlDbType.VarChar).Value = txtFirstName.Text;
        da.InsertCommand.Parameters.Add(""@LastName"", SqlDbType.VarChar).Value = txtLastName.Text;

        con.Open();
        da.InsertCommand.ExecuteNonQuery();
        con.Close();

        dt.Clear();
        da.Fill(dt);
    } 
</code></pre>

<p>This is the start of the button  to call the procedure named <code>sp_Add_contact</code> to add a contact. The two parameters for <code>sp_Add_contact(@FirstName,@LastName)</code>. I searched on google for some good example but I found nothing interesting.</p>

<pre><code>private void button1_Click(object sender, EventArgs e)
{
        SqlConnection con = new SqlConnection(dc.Con);
        SqlCommand cmd = new SqlCommand(""Command String"", con);
        cmd.CommandType = CommandType.StoredProcedure;

        ???

        con.Open();
        da. ???.ExecuteNonQuery();
        con.Close();

        dt.Clear();
        da.Fill(dt);
    }
</code></pre>
","<p>It's pretty much the same as running a query. In your original code you are creating a command object, putting it in the <code>cmd</code> variable, and never use it. Here, however, you will use that instead of <code>da.InsertCommand</code>.</p>

<p>Also, use a <code>using</code> for all disposable objects, so that you are sure that they are disposed properly:</p>

<pre><code>private void button1_Click(object sender, EventArgs e) {
  using (SqlConnection con = new SqlConnection(dc.Con)) {
    using (SqlCommand cmd = new SqlCommand(""sp_Add_contact"", con)) {
      cmd.CommandType = CommandType.StoredProcedure;

      cmd.Parameters.Add(""@FirstName"", SqlDbType.VarChar).Value = txtFirstName.Text;
      cmd.Parameters.Add(""@LastName"", SqlDbType.VarChar).Value = txtLastName.Text;

      con.Open();
      cmd.ExecuteNonQuery();
    }
  }
}
</code></pre>
","7542564"
"How can I return multiple values from a function in C#?","414440","","<p>I read the <a href=""https://stackoverflow.com/questions/321068/returning-multiple-values-from-a-c-function"">C++ version of this question</a> but didn't really understand it.</p>

<p>Can someone please explain clearly if it can be done and how?</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.tuple.aspx"" rel=""noreferrer"">.NET 4.0+'s Tuple</a>:</p>

<p>For Example:</p>

<pre><code>public Tuple&lt;int, int&gt; GetMultipleValue()
{
     return Tuple.Create(1,2);
}
</code></pre>

<p>Tuples with two values have <code>Item1</code> and <code>Item2</code> as properties.</p>
","10278769"
"How to create JSON string in C#","412574","","<p>I just used the XmlWriter to create some XML to send back in an HTTP response.  How would you create a JSON string.  I assume you would just use a stringbuilder to build the JSON string and them format your response as JSON?</p>
","<p>You could use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx"" rel=""noreferrer"">JavaScriptSerializer class</a>, check <a href=""http://weblogs.asp.net/scottgu/archive/2007/10/01/tip-trick-building-a-tojson-extension-method-using-net-3-5.aspx"" rel=""noreferrer"">this article</a> to build an useful extension method.</p>

<p>Code from article:</p>

<pre><code>namespace ExtensionMethods
{
    public static class JSONHelper
    {
        public static string ToJSON(this object obj)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            return serializer.Serialize(obj);
        }

        public static string ToJSON(this object obj, int recursionDepth)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            serializer.RecursionLimit = recursionDepth;
            return serializer.Serialize(obj);
        }
    }
}
</code></pre>

<p>Usage:</p>

<pre><code>using ExtensionMethods;

...

List&lt;Person&gt; people = new List&lt;Person&gt;{
                   new Person{ID = 1, FirstName = ""Scott"", LastName = ""Gurthie""},
                   new Person{ID = 2, FirstName = ""Bill"", LastName = ""Gates""}
                   };


string jsonString = people.ToJSON();
</code></pre>
","1056127"
"Entity Framework 5 Updating a Record","406391","","<p>I have been exploring different methods of editing/updating a record within Entity Framework 5 in an ASP.NET MVC3 environment, but so far none of them tick all of the boxes I need. I'll explain why.</p>

<p>I have found three methods to which I'll mention the pros and cons:</p>

<p><strong>Method 1 - Load original record, update each property</strong></p>

<pre><code>var original = db.Users.Find(updatedUser.UserId);

if (original != null)
{
    original.BusinessEntityId = updatedUser.BusinessEntityId;
    original.Email = updatedUser.Email;
    original.EmployeeId = updatedUser.EmployeeId;
    original.Forename = updatedUser.Forename;
    original.Surname = updatedUser.Surname;
    original.Telephone = updatedUser.Telephone;
    original.Title = updatedUser.Title;
    original.Fax = updatedUser.Fax;
    original.ASPNetUserId = updatedUser.ASPNetUserId;
    db.SaveChanges();
}    
</code></pre>

<p><em>Pros</em></p>

<ul>
<li>Can specify which properties change</li>
<li>Views don't need to contain every property</li>
</ul>

<p><em>Cons</em></p>

<ul>
<li>2 x queries on database to load original then update it</li>
</ul>

<p><strong>Method 2 - Load original record, set changed values</strong></p>

<pre><code>var original = db.Users.Find(updatedUser.UserId);

if (original != null)
{
    db.Entry(original).CurrentValues.SetValues(updatedUser);
    db.SaveChanges();
}
</code></pre>

<p><em>Pros</em></p>

<ul>
<li>Only modified properties are sent to database</li>
</ul>

<p><em>Cons</em></p>

<ul>
<li>Views need to contain every property</li>
<li>2 x queries on database to load original then update it</li>
</ul>

<p><strong>Method 3 - Attach updated record and set state to EntityState.Modified</strong></p>

<pre><code>db.Users.Attach(updatedUser);
db.Entry(updatedUser).State = EntityState.Modified;
db.SaveChanges();
</code></pre>

<p><em>Pros</em></p>

<ul>
<li>1 x query on database to update</li>
</ul>

<p><em>Cons</em></p>

<ul>
<li>Can't specify which properties change</li>
<li>Views must contain every property</li>
</ul>

<p><strong>Question</strong></p>

<p>My question to you guys; is there a clean way that I can achieve this set of goals?</p>

<ul>
<li>Can specify which properties change</li>
<li>Views don't need to contain every property (such as password!)</li>
<li>1 x query on database to update</li>
</ul>

<p>I understand this is quite a minor thing to point out but I may be missing a simple solution to this. If not method one will prevail ;-)</p>
","<p>You are looking for:</p>

<pre><code>db.Users.Attach(updatedUser);
var entry = db.Entry(updatedUser);
entry.Property(e =&gt; e.Email).IsModified = true;
// other changed properties
db.SaveChanges();
</code></pre>
","15339512"
"How can I convert a Unix timestamp to DateTime and vice versa?","403241","","<p>There is this example code, but then it starts talking about millisecond / nanosecond problems.</p>

<p>The same question is on MSDN, <em><a href=""http://blogs.msdn.com/brada/archive/2004/03/20/93332.aspx"" rel=""nofollow noreferrer"">Seconds since the Unix epoch in C#</a></em>.</p>

<p>This is what I've got so far:</p>

<pre><code>public Double CreatedEpoch
{
  get
  {
    DateTime epoch = new DateTime(1970, 1, 1, 0, 0, 0, 0).ToLocalTime();
    TimeSpan span = (this.Created.ToLocalTime() - epoch);
    return span.TotalSeconds;
  }
  set
  {
    DateTime epoch = new DateTime(1970, 1, 1, 0, 0, 0, 0).ToLocalTime();
    this.Created = epoch.AddSeconds(value);
  }
}
</code></pre>
","<p>Here's what you need:</p>

<pre><code>public static DateTime UnixTimeStampToDateTime( double unixTimeStamp )
{
    // Unix timestamp is seconds past epoch
    System.DateTime dtDateTime = new DateTime(1970,1,1,0,0,0,0,System.DateTimeKind.Utc);
    dtDateTime = dtDateTime.AddSeconds( unixTimeStamp ).ToLocalTime();
    return dtDateTime;
}
</code></pre>

<p>Or, for Java (which is different because the timestamp is in milliseconds, not seconds):</p>

<pre><code>public static DateTime JavaTimeStampToDateTime( double javaTimeStamp )
{
    // Java timestamp is milliseconds past epoch
    System.DateTime dtDateTime = new DateTime(1970,1,1,0,0,0,0,System.DateTimeKind.Utc);
    dtDateTime = dtDateTime.AddMilliseconds( javaTimeStamp ).ToLocalTime();
    return dtDateTime;
}
</code></pre>
","250400"
"Reading Excel files from C#","401676","","<p>Is there a free or open source library to read Excel files (.xls) directly from a C# program? </p>

<p>It does not need to be too fancy, just to select a worksheet and read the data as strings. So far, I've been using Export to Unicode text function of Excel, and parsing the resulting (tab-delimited) file, but I'd like to eliminate the manual step.</p>
","<pre><code>var fileName = string.Format(""{0}\\fileNameHere"", Directory.GetCurrentDirectory());
var connectionString = string.Format(""Provider=Microsoft.Jet.OLEDB.4.0; data source={0}; Extended Properties=Excel 8.0;"", fileName);

var adapter = new OleDbDataAdapter(""SELECT * FROM [workSheetNameHere$]"", connectionString);
var ds = new DataSet();

adapter.Fill(ds, ""anyNameHere"");

DataTable data = ds.Tables[""anyNameHere""];
</code></pre>

<p>This is what I usually use.  It is a little different because I usually stick a AsEnumerable() at the edit of the tables: </p>

<pre><code>var data = ds.Tables[""anyNameHere""].AsEnumerable();
</code></pre>

<p>as this lets me use LINQ to search and build structs from the fields.</p>

<pre><code>var query = data.Where(x =&gt; x.Field&lt;string&gt;(""phoneNumber"") != string.Empty).Select(x =&gt;
                new MyContact
                    {
                        firstName= x.Field&lt;string&gt;(""First Name""),
                        lastName = x.Field&lt;string&gt;(""Last Name""),
                        phoneNumber =x.Field&lt;string&gt;(""Phone Number""),
                    });
</code></pre>
","16051"
"Collection was modified; enumeration operation may not execute","399022","","<p>I can't get to the bottom of this error, because when the debugger is attached, it does not seem to occur. Below is the code.</p>

<p>This is a WCF server in a Windows service. The method NotifySubscribers is called by the service whenever there is a data event (at random intervals, but not very often - about 800 times per day).</p>

<p>When a Windows Forms client subscribes, the subscriber ID is added to the subscribers dictionary, and when the client unsubscribes, it is deleted from the dictionary. The error happens when (or after) a client unsubscribes. It appears that the next time the NotifySubscribers() method is called, the foreach() loop fails with the error in the subject line. The method writes the error into the application log as shown in the code below. When a debugger is attached and a client unsubscribes, the code executes fine.</p>

<p>Do you see a problem with this code? Do I need to make the dictionary thread-safe?</p>

<pre><code>[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single)]
public class SubscriptionServer : ISubscriptionServer
{
    private static IDictionary&lt;Guid, Subscriber&gt; subscribers;

    public SubscriptionServer()
    {            
        subscribers = new Dictionary&lt;Guid, Subscriber&gt;();
    }

    public void NotifySubscribers(DataRecord sr)
    {
        foreach(Subscriber s in subscribers.Values)
        {
            try
            {
                s.Callback.SignalData(sr);
            }
            catch (Exception e)
            {
                DCS.WriteToApplicationLog(e.Message, 
                  System.Diagnostics.EventLogEntryType.Error);

                UnsubscribeEvent(s.ClientId);
            }
        }
    }


    public Guid SubscribeEvent(string clientDescription)
    {
        Subscriber subscriber = new Subscriber();
        subscriber.Callback = OperationContext.Current.
                GetCallbackChannel&lt;IDCSCallback&gt;();

        subscribers.Add(subscriber.ClientId, subscriber);

        return subscriber.ClientId;
    }


    public void UnsubscribeEvent(Guid clientId)
    {
        try
        {
            subscribers.Remove(clientId);
        }
        catch(Exception e)
        {
            System.Diagnostics.Debug.WriteLine(""Unsubscribe Error "" + 
                    e.Message);
        }
    }
}
</code></pre>
","<p>What's likely happening is that SignalData is indirectly changing the subscribers dictionary under the hood during the loop and leading to that message.  You can verify this by changing </p>

<pre><code>foreach(Subscriber s in subscribers.Values)
</code></pre>

<p>To </p>

<pre><code>foreach(Subscriber s in subscribers.Values.ToList())
</code></pre>

<p>If I'm right, the problem will dissapear</p>
","604843"
"Converting dd/mm/yyyy formatted string to Datetime","398715","","<p>I am new to DotNet and C#. I want to convert a string in <code>mm/dd/yyyy</code> format to <code>DateTime</code> object. I tried the parse function like below but it is throwing a runtime error.</p>

<pre><code>DateTime dt=DateTime.Parse(""24/01/2013"");
</code></pre>

<p>Any ideas on how may I convert it to datetime?</p>
","<p>You need to use <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx""><code>DateTime.ParseExact</code></a> with format <code>""dd/MM/yyyy""</code></p>

<pre><code>DateTime dt=DateTime.ParseExact(""24/01/2013"", ""dd/MM/yyyy"", CultureInfo.InvariantCulture);
</code></pre>

<p>Its safer if you use <code>d/M/yyyy</code> for the format, since that will handle both single digit and double digits day/month. But that really depends if you are expecting single/double digit values. </p>

<hr>

<p>Your date  format <code>day/Month/Year</code> might be an acceptable date format for some cultures. For example for Canadian Culture <code>en-CA</code> <code>DateTime.Parse</code> would work like:</p>

<pre><code>DateTime dt = DateTime.Parse(""24/01/2013"", new CultureInfo(""en-CA""));
</code></pre>

<p>Or </p>

<pre><code>System.Threading.Thread.CurrentThread.CurrentCulture = new CultureInfo(""en-CA"");
DateTime dt = DateTime.Parse(""24/01/2013""); //uses the current Thread's culture
</code></pre>

<p>Both the above lines would work because the the string's format is acceptable for <code>en-CA</code> culture. Since you are not supplying any culture to your <code>DateTime.Parse</code> call, your current culture is used for parsing which doesn't support the date format. Read more about it at <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.parse(v=vs.110).aspx"">DateTime.Parse</a>. </p>

<hr>

<p>Another method for parsing is using <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.tryparse(v=vs.110).aspx""><code>DateTime.TryParseExact</code></a></p>

<pre><code>DateTime dt;
if (DateTime.TryParseExact(""24/01/2013"", 
                            ""d/M/yyyy"", 
                            CultureInfo.InvariantCulture, 
                            DateTimeStyles.None,
    out dt))
{
    //valid date
}
else
{
    //invalid date
}
</code></pre>

<p>The <code>TryParse</code> group of methods in .Net framework doesn't throw exception on invalid values, instead they return a <code>bool</code> value indicating success or failure in parsing. </p>

<p><strong>Notice</strong> that I have used single <code>d</code> and <code>M</code> for day and month respectively. Single <code>d</code> and <code>M</code> works for both single/double digits day and month. So for the format <code>d/M/yyyy</code> valid values could be:</p>

<ul>
<li>""24/01/2013""</li>
<li>""24/1/2013""</li>
<li>""4/12/2013"" //4 December 2013</li>
<li>""04/12/2013""</li>
</ul>

<p>For further reading you should see: <a href=""http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx"">Custom Date and Time Format Strings</a></p>
","15738613"
"Dynamic array in C#","397232","","<p>Is there any method for creating a dynamic array in C#? </p>
","<p>Take a look at <a href=""http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx"" rel=""noreferrer"">Generic Lists</a>.</p>
","594858"
"How do I decompile a .NET EXE into readable C# source code?","396540","","<p>I wrote a C# application for a client a couple of years ago, but I no longer have the source code.  All I have is the EXE that I deployed on the client's PC.  Is there a way I can generate C# source code from the EXE?</p>
","<p><a href=""http://www.red-gate.com/products/reflector/index.htm"" rel=""noreferrer"">Reflector</a> and its add-in <a href=""http://www.denisbauer.com/Home/ReflectorFileDisassembler"" rel=""noreferrer"">FileDisassembler</a>.</p>

<p>Reflector will allow to see the source code. FileDisassembler will allow you to convert it into a VS solution.</p>
","179744"
"How do I get the current username in .NET using C#?","395358","","<p>How do I get the current username in .NET using C#?</p>
","<pre><code>string userName = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
</code></pre>
","1240379"
"Encrypting & Decrypting a String in C#","389966","","<p>What is the most modern (best) way of satisfying the following in C#?</p>

<pre><code>string encryptedString = SomeStaticClass.Encrypt(sourceString);

string decryptedString = SomeStaticClass.Decrypt(encryptedString);
</code></pre>

<p>BUT with a minimum of fuss involving salts, keys, mucking about with byte[], etc.</p>

<p>Been Googling and confused at what I'm finding (you can see the list of similar SO Qs to see this is a deceptive question to ask).</p>
","<p><strong>UPDATE 23/Dec/2015: Since this answer seems to be getting a lot of upvotes, I've updated it to fix silly bugs and to generally improve the code based upon comments and feedback.  See the end of the post for a list of specific improvements.</strong></p>

<p>As other people have said, Cryptography is not simple so it's best to avoid ""rolling your own"" encryption algorithm.</p>

<p>You can, however, ""roll your own"" wrapper class around something like the built-in <a href=""http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx"" rel=""noreferrer""><code>RijndaelManaged</code></a> cryptography class.</p>

<p>Rijndael is the algorithmic name of the current <a href=""http://en.wikipedia.org/wiki/Advanced_Encryption_Standard"" rel=""noreferrer"">Advanced Encryption Standard</a>, so you're certainly using an algorithm that could be considered ""best practice"".</p>

<p>The <a href=""http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx"" rel=""noreferrer""><code>RijndaelManaged</code></a> class does indeed normally require you to ""muck about"" with byte arrays, salts, keys, initialization vectors etc. but this is precisely the kind of detail that can be somewhat abstracted away within your ""wrapper"" class.</p>

<p>The following class is one I wrote a while ago to perform exactly the kind of thing you're after, a simple single method call to allow some string-based plaintext to be encrypted with a string-based password, with the resulting encrypted string also being represented as a string.  Of course, there's an equivalent method to decrypt the encrypted string with the same password.</p>

<p>Unlike the first version of this code, which used the exact same salt and IV values every time, this newer version will generate random salt and IV values each time.  Since salt and IV must be the same between the encryption and decryption of a given string, the salt and IV is prepended to the cipher text upon encryption and extracted from it again in order to perform the decryption.  The result of this is that encrypting the exact same plaintext with the exact same password gives and entirely different ciphertext result each time.</p>

<p>The ""strength"" of using this comes from using the <a href=""http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx"" rel=""noreferrer""><code>RijndaelManaged</code></a> class to perform the encryption for you, along with using the <a href=""https://msdn.microsoft.com/en-gb/library/system.security.cryptography.rfc2898derivebytes%28v=vs.110%29.aspx"" rel=""noreferrer"">Rfc2898DeriveBytes</a> function of the <code>System.Security.Cryptography</code> namespace which will generate your encryption key using a standard and secure algorithm (specifically, <a href=""https://en.wikipedia.org/wiki/PBKDF2"" rel=""noreferrer"">PBKDF2</a>) based upon the string-based password you supply.  (Note this is an improvement of the first version's use of the older PBKDF1 algorithm).</p>

<p>Finally, it's important to note that this is still <em>unauthenticated</em> encryption.  Encryption alone provides only privacy (i.e. message is unknown to 3rd parties), whilst authenticated encryption aims to provide both privacy and authenticity (i.e. recipient knows message was sent by the sender).  </p>

<p>Without knowing your exact requirements, it's difficult to say whether the code here is sufficiently secure for your needs, however, it has been produced to deliver a good balance between relative simplicity of implementation vs ""quality"".  For example, if your ""receiver"" of an encrypted string is receiving the string directly from a trusted ""sender"", then authentication <a href=""https://crypto.stackexchange.com/a/12192/698"">may not even be necessary</a>.</p>

<p>If you require something more complex, and which offers authenticated encryption, check out <a href=""https://stackoverflow.com/questions/202011/encrypt-and-decrypt-a-string/10366194#10366194"">this post</a> for an implementation.</p>

<p>Here's the code:</p>

<pre><code>using System;
using System.Text;
using System.Security.Cryptography;
using System.IO;
using System.Linq;

namespace EncryptStringSample
{
    public static class StringCipher
    {
        // This constant is used to determine the keysize of the encryption algorithm in bits.
        // We divide this by 8 within the code below to get the equivalent number of bytes.
        private const int Keysize = 256;

        // This constant determines the number of iterations for the password bytes generation function.
        private const int DerivationIterations = 1000;

        public static string Encrypt(string plainText, string passPhrase)
        {
            // Salt and IV is randomly generated each time, but is preprended to encrypted cipher text
            // so that the same Salt and IV values can be used when decrypting.  
            var saltStringBytes = Generate256BitsOfRandomEntropy();
            var ivStringBytes = Generate256BitsOfRandomEntropy();
            var plainTextBytes = Encoding.UTF8.GetBytes(plainText);
            using (var password = new Rfc2898DeriveBytes(passPhrase, saltStringBytes, DerivationIterations))
            {
                var keyBytes = password.GetBytes(Keysize / 8);
                using (var symmetricKey = new RijndaelManaged())
                {
                    symmetricKey.BlockSize = 256;
                    symmetricKey.Mode = CipherMode.CBC;
                    symmetricKey.Padding = PaddingMode.PKCS7;
                    using (var encryptor = symmetricKey.CreateEncryptor(keyBytes, ivStringBytes))
                    {
                        using (var memoryStream = new MemoryStream())
                        {
                            using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write))
                            {
                                cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);
                                cryptoStream.FlushFinalBlock();
                                // Create the final bytes as a concatenation of the random salt bytes, the random iv bytes and the cipher bytes.
                                var cipherTextBytes = saltStringBytes;
                                cipherTextBytes = cipherTextBytes.Concat(ivStringBytes).ToArray();
                                cipherTextBytes = cipherTextBytes.Concat(memoryStream.ToArray()).ToArray();
                                memoryStream.Close();
                                cryptoStream.Close();
                                return Convert.ToBase64String(cipherTextBytes);
                            }
                        }
                    }
                }
            }
        }

        public static string Decrypt(string cipherText, string passPhrase)
        {
            // Get the complete stream of bytes that represent:
            // [32 bytes of Salt] + [32 bytes of IV] + [n bytes of CipherText]
            var cipherTextBytesWithSaltAndIv = Convert.FromBase64String(cipherText);
            // Get the saltbytes by extracting the first 32 bytes from the supplied cipherText bytes.
            var saltStringBytes = cipherTextBytesWithSaltAndIv.Take(Keysize / 8).ToArray();
            // Get the IV bytes by extracting the next 32 bytes from the supplied cipherText bytes.
            var ivStringBytes = cipherTextBytesWithSaltAndIv.Skip(Keysize / 8).Take(Keysize / 8).ToArray();
            // Get the actual cipher text bytes by removing the first 64 bytes from the cipherText string.
            var cipherTextBytes = cipherTextBytesWithSaltAndIv.Skip((Keysize / 8) * 2).Take(cipherTextBytesWithSaltAndIv.Length - ((Keysize / 8) * 2)).ToArray();

            using (var password = new Rfc2898DeriveBytes(passPhrase, saltStringBytes, DerivationIterations))
            {
                var keyBytes = password.GetBytes(Keysize / 8);
                using (var symmetricKey = new RijndaelManaged())
                {
                    symmetricKey.BlockSize = 256;
                    symmetricKey.Mode = CipherMode.CBC;
                    symmetricKey.Padding = PaddingMode.PKCS7;
                    using (var decryptor = symmetricKey.CreateDecryptor(keyBytes, ivStringBytes))
                    {
                        using (var memoryStream = new MemoryStream(cipherTextBytes))
                        {
                            using (var cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read))
                            {
                                var plainTextBytes = new byte[cipherTextBytes.Length];
                                var decryptedByteCount = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length);
                                memoryStream.Close();
                                cryptoStream.Close();
                                return Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount);
                            }
                        }
                    }
                }
            }
        }

        private static byte[] Generate256BitsOfRandomEntropy()
        {
            var randomBytes = new byte[32]; // 32 Bytes will give us 256 bits.
            using (var rngCsp = new RNGCryptoServiceProvider())
            {
                // Fill the array with cryptographically secure random bytes.
                rngCsp.GetBytes(randomBytes);
            }
            return randomBytes;
        }
    }
}
</code></pre>

<p>The above class can be used quite simply with code similar to the following:</p>

<pre><code>using System;

namespace EncryptStringSample
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(""Please enter a password to use:"");
            string password = Console.ReadLine();
            Console.WriteLine(""Please enter a string to encrypt:"");
            string plaintext = Console.ReadLine();
            Console.WriteLine("""");

            Console.WriteLine(""Your encrypted string is:"");
            string encryptedstring = StringCipher.Encrypt(plaintext, password);
            Console.WriteLine(encryptedstring);
            Console.WriteLine("""");

            Console.WriteLine(""Your decrypted string is:"");
            string decryptedstring = StringCipher.Decrypt(encryptedstring, password);
            Console.WriteLine(decryptedstring);
            Console.WriteLine("""");

            Console.WriteLine(""Press any key to exit..."");
            Console.ReadLine();
        }
    }
}
</code></pre>

<p>(You can download a simple VS2013 sample solution (which includes a few unit tests) <a href=""https://www.dropbox.com/s/avh5zvspe9pp12s/EncryptStringSample.zip?dl=0"" rel=""noreferrer"">here</a>).</p>

<p><strong>UPDATE 23/Dec/2015:</strong>
The list of specific improvements to the code are:  </p>

<ul>
<li>Fixed a silly bug where encoding was different between encrypting and
decrypting.  As the mechanism by which salt &amp; IV values are generated has changed, encoding is no longer necessary.</li>
<li>Due to the salt/IV change, the previous code comment that incorrectly indicated that UTF8 encoding a 16 character string produces 32 bytes is no longer applicable (as encoding is no longer necessary).</li>
<li>Usage of the superseded PBKDF1 algorithm has been replaced with usage of the more modern PBKDF2 algorithm.</li>
<li>The password derivation is now properly salted whereas previously it wasn't salted at all (another silly bug squished).</li>
</ul>
","10177020"
"Best way to parse command line arguments in C#?","388464","","<p>When building console applications that take parameters, you can use the arguments passed to <code>Main(string[] args)</code>. </p>

<p>In the past I've simply indexed/looped that array and done a few regular expressions to extract the values. However, when the commands get more complicated, the parsing can get pretty ugly.  </p>

<p>So I'm interested in:</p>

<ul>
<li>Libraries that you use</li>
<li>Patterns that you use</li>
</ul>

<p>Assume the commands always adhere to common standards such as <a href=""https://stackoverflow.com/questions/108728/suggestions-for-implemetation-of-a-commnd-line-application-interface"">answered here</a>.</p>
","<p>I would strongly suggest using <a href=""http://www.ndesk.org/Options"" rel=""noreferrer"">NDesk.Options</a> (<a href=""http://www.ndesk.org/doc/ndesk-options/"" rel=""noreferrer"">Documentation</a>) and/or <a href=""https://github.com/mono/mono/blob/master/mcs/class/Mono.Options/Mono.Options/Options.cs"" rel=""noreferrer"">Mono.Options</a> (same API, different namespace).  An <a href=""http://www.ndesk.org/doc/ndesk-options/NDesk.Options/OptionSet.html#T:NDesk.Options.OptionSet:Docs:Example:1"" rel=""noreferrer"">example from the documentation</a>:</p>

<pre><code>bool show_help = false;
List&lt;string&gt; names = new List&lt;string&gt; ();
int repeat = 1;

var p = new OptionSet () {
    { ""n|name="", ""the {NAME} of someone to greet."",
       v =&gt; names.Add (v) },
    { ""r|repeat="", 
       ""the number of {TIMES} to repeat the greeting.\n"" + 
          ""this must be an integer."",
        (int v) =&gt; repeat = v },
    { ""v"", ""increase debug message verbosity"",
       v =&gt; { if (v != null) ++verbosity; } },
    { ""h|help"",  ""show this message and exit"", 
       v =&gt; show_help = v != null },
};

List&lt;string&gt; extra;
try {
    extra = p.Parse (args);
}
catch (OptionException e) {
    Console.Write (""greet: "");
    Console.WriteLine (e.Message);
    Console.WriteLine (""Try `greet --help' for more information."");
    return;
}
</code></pre>
","2067916"
"The name 'ConfigurationManager' does not exist in the current context","387596","","<p>I am trying to access <code>connectionStrings</code> from the config file. The code is ASP.NET + C#. I have added <code>System.Configuration</code> to reference and also mentioned with using. But still it wouldn't accept the assembly.</p>

<p>I am using VSTS 2008. Any idea what could be the reason? </p>

<p>Another weird thing is the assembly name shown as ""System.configuration"", a lower case c which is not how names are displayed for other System assemblies.</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Configuration;

namespace Utility
{
    public class CommonVariables
    {
        public static String ConnectionString
        {
            get { return ConfigurationManager.ConnectionStrings[""EmployeeEntities""].ConnectionString; }
        }  
    }  
}
</code></pre>

<p>Config:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name=""qbankEntities"" connectionString=""metadata=res://*/qbankModel.csdl|res://*/qbankModel.ssdl|res://*/qbankModel.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;Data Source=localhost;Initial Catalog=qbank;Persist Security Info=True;User ID=**;Password=****;MultipleActiveResultSets=True&amp;quot;"" providerName=""System.Data.EntityClient"" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</code></pre>
","<p>Ok.. it worked after restarting the VSTS. The <a href=""http://social.msdn.microsoft.com/Forums/en-US/winformsapplications/thread/82fcd001-243f-4604-bec4-02de92c4f568"" rel=""noreferrer"">link</a> suggested the solution for the same problem. Wish i could have seen it before. :)</p>
","1275635"
"Format code shortcut for Visual Studio?","387217","","<p>In eclipse there is a shortcut <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>F</kbd> that re-indents code and fixes comments and blank lines. Is there an equivalent for Visual Studio 2010?</p>
","<p><strong>Visual Studio WITH C# KEY BINDINGS</strong></p>

<p>To answer the specific question, in C# you are likely to be using the C# keyboard mapping scheme, which will use these hotkeys by default:</p>

<p><kbd>Ctrl</kbd>+<kbd>E</kbd>, <kbd>Ctrl</kbd>+<kbd>D</kbd> to format the entire document.</p>

<p><kbd>Ctrl</kbd>+<kbd>E</kbd>, <kbd>Ctrl</kbd>+<kbd>F</kbd> to format the selection.</p>

<p>You can change these in Tools > Options > Environment -> Keyboard (either by selecting a different ""keyboard mapping scheme"", or binding individual keys to the commands ""Edit.FormatDocument"" and ""Edit.FormatSelection"").</p>

<p>If you have not chosen to use the C# keyboard mapping scheme, then <strong>you may find the key shortcuts are different</strong>. For example, if you are not using the C# bindings, the keys are likely to be:</p>

<p><kbd>Ctrl</kbd> + <kbd>K</kbd> + <kbd>D</kbd> (Entire document)</p>

<p><kbd>Ctrl</kbd> + <kbd>K</kbd> + <kbd>F</kbd> (Selection only)</p>

<p>To find out which key bindings apply in <strong>YOUR</strong> copy of Visual Studio, look in the Edit > Advanced menu - the keys are displayed to the right of the menu items, so it's easy to discover what they are on your system.</p>

<hr>

<p><em>(Please do not edit this answer to change the key bindings above to what <strong>your</strong> system has!)</em></p>
","4942145"
"Save and load MemoryStream to/from a file","387175","","<p>I am serializing an structure into a <code>MemoryStream</code> and I want to save and load the serialized structure.</p>

<p>So, How to Save a <code>MemoryStream</code> into a file and also load it back from file?</p>
","<p>You may use <code>MemoryStream.WriteTo</code> or <code>Stream.CopyTo</code> (supported in framework version 4.5.2, 4.5.1, 4.5, 4) methods to write content of memory stream to another stream.</p>

<pre><code>memoryStream.WriteTo(fileStream);
</code></pre>

<p>Update:</p>

<pre><code>fileStream.CopyTo(memoryStream);
memoryStream.CopyTo(fileStream);
</code></pre>
","8624114"
"All possible C# array initialization syntaxes","386970","","<p>What are all the possible array init syntaxes that are possible with C#?</p>

<p>It gets really confusing to know if it is an array initializer or a separate declaration.</p>

<p>Note: I've searched MSDN, googled it, but there isn't an all-in-one guide.</p>

<p>I'm using .NET 3.5 and C#.</p>
","<p>These are the current declaration and initialization methods for a simple array.</p>

<pre><code>string[] array = new string[2]; // creates array of length 2, default values
string[] array = new string[] { ""A"", ""B"" }; // creates populated array of length 2
string[] array = { ""A"" , ""B"" }; // creates populated array of length 2
</code></pre>

<p>Note that other techniques of obtaining arrays exist, such as the Linq <code>ToArray()</code> extensions on <code>IEnumerable&lt;T&gt;</code>.</p>

<p>Also note that in the declarations above, the first two could replace the <code>string[]</code> on the left with <code>var</code> (C# 3+), as the information on the right is enough to infer the proper type. The third line must be written as displayed, as array initialization syntax alone is not enough to satisfy the compiler's demands. So if you're into the whole brevity thing, the above could be written as</p>

<pre><code>var array = new string[2]; // creates array of length 2, default values
var array = new string[] { ""A"", ""B"" }; // creates populated array of length 2
string[] array = { ""A"" , ""B"" }; // creates populated array of length 2
</code></pre>
","5678244"
"Metadata file '.dll' could not be found","386351","","<p>I am working on a WPF, C# 3.0 Project and I am getting this error:</p>

<pre><code>Error 1 Metadata file
'WORK=- \Tools\VersionManagementSystem\BusinessLogicLayer\bin\Debug
\BusinessLogicLayer.dll' could not be found C:\-=WORK=- \Tools
\VersionManagementSystem\VersionManagementSystem\CSC VersionManagementSystem
</code></pre>

<p><strong>EDIT:</strong></p>

<p>This is how I reference my usercontrols</p>

<pre><code>xmlns:vms=""clr-namespace:VersionManagementSystem""
&lt;vms:SignOffProjectListing Margin=""5""/&gt;
</code></pre>

<p>It happens after every failed build. The only way I can get the solution to compile is to comment out all my user controls and re-build the project, then I uncomment the usercontrols and everything is fine.</p>

<p>I have checked build orders, dependencies configurations.</p>

<p>As you can see it seems to have truncated the dll's absolute path... I have read that there is a bug with the length. Is this a possible problem?</p>

<p>It's very annoying and having to comment, build, uncomment, build is becoming extremely tiresome.</p>
","<p>I just had the same problem. Visual Studio isn't building the project that's being referenced.</p>

<ol>
<li>Right click on the solution and click Properties.</li>
<li>Click Configuration on the left.</li>
<li>Make sure the check box under ""Build"" for the project it can't find is checked. If it is already checked, uncheck, hit apply and check the boxes again.</li>
</ol>
","17723774"
"How to Convert JSON object to Custom C# object?","385354","","<p>Is there an easy way to populate my C# Object with the JSON object passed via AJAX?</p>

<p>//This is the JSON Object passed to C# WEBMETHOD from the page using JSON.stringify</p>

<pre><code>{
    ""user"" : {
                 ""name"" : ""asdf"",
                 ""teamname"" : ""b"",
                 ""email"" : ""c"",
                 ""players"" : [""1"",
                              ""2""]
             }
}
</code></pre>

<p>//C# WebMetod That receives the JSON Object</p>

<pre><code>[WebMethod]
public static void SaveTeam(Object user)
{

}
</code></pre>

<p>//C# Class that represents the object structure of JSON Object passed in to the WebMethod</p>

<pre><code>public class User
{
    public string name { get; set; }
    public string teamname { get; set; }
    public string email { get; set; }
    public Array players { get; set; }
}
</code></pre>
","<p>A good way to use JSON in C# is with <a href=""http://www.codeplex.com/Json"" rel=""noreferrer"">JSON.NET</a></p>

<p><a href=""http://james.newtonking.com/projects/json/help/"" rel=""noreferrer"">Quick Starts &amp; API Documentation</a> from  <a href=""http://james.newtonking.com/pages/json-net.aspx"" rel=""noreferrer"">JSON.NET - Official site</a> help you work with it.</p>

<p>An example of how to use it:</p>

<pre><code>public class User
{
    public User(string json)
    {
        JObject jObject = JObject.Parse(json);
        JToken jUser = jObject[""user""];
        name = (string) jUser[""name""];
        teamname = (string) jUser[""teamname""];
        email = (string) jUser[""email""];
        players = jUser[""players""].ToArray();
    }

    public string name { get; set; }
    public string teamname { get; set; }
    public string email { get; set; }
    public Array players { get; set; }
}

// Use
private void Run()
{
    string json = @""{""""user"""":{""""name"""":""""asdf"""",""""teamname"""":""""b"""",""""email"""":""""c"""",""""players"""":[""""1"""",""""2""""]}}"";
    User user = new User(json);

    Console.WriteLine(""Name : "" + user.name);
    Console.WriteLine(""Teamname : "" + user.teamname);
    Console.WriteLine(""Email : "" + user.email);
    Console.WriteLine(""Players:"");

    foreach (var player in user.players)
        Console.WriteLine(player);
 }
</code></pre>
","2246724"
"How do you set the Content-Type header for an HttpClient request?","384940","","<p>I'm trying to set the <code>Content-Type</code> header of an <code>HttpClient</code> object as required by an API I am calling.</p>

<p>I tried setting the <code>Content-Type</code> like below:</p>

<pre><code>using (var httpClient = new HttpClient())
{
    httpClient.BaseAddress = new Uri(""http://example.com/"");
    httpClient.DefaultRequestHeaders.Add(""Accept"", ""application/json"");
    httpClient.DefaultRequestHeaders.Add(""Content-Type"", ""application/json"");
    // ...
}
</code></pre>

<p>It allows me to add the <code>Accept</code> header but when I try to add <code>Content-Type</code> it throws the following exception:</p>

<blockquote>
  <p>Misused header name. Make sure request headers are used with
  <code>HttpRequestMessage</code>, response headers with <code>HttpResponseMessage</code>, and
  content headers with <code>HttpContent</code> objects.</p>
</blockquote>

<p>How can I set the <code>Content-Type</code> header in a <code>HttpClient</code> request?</p>
","<p>The content type is a header of the content, not of the request, which is why this is failing. <code>AddWithoutValidation</code> as suggested by Robert Levy may work, but you can also use set the content type when creating the request content itself (note that code snippet adds ""application/json"" in two places-for Accept and Content-Type headers):</p>

<pre><code>HttpClient client = new HttpClient();
client.BaseAddress = new Uri(""http://example.com/"");
client.DefaultRequestHeaders
      .Accept
      .Add(new MediaTypeWithQualityHeaderValue(""application/json""));//ACCEPT header

HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, ""relativeAddress"");
request.Content = new StringContent(""{\""name\"":\""John Doe\"",\""age\"":33}"",
                                    Encoding.UTF8, 
                                    ""application/json"");//CONTENT-TYPE header

client.SendAsync(request)
      .ContinueWith(responseTask =&gt;
      {
          Console.WriteLine(""Response: {0}"", responseTask.Result);
      });
</code></pre>
","10679340"
"How do I get the color from a hexadecimal color code using .NET?","384176","","<p>How can I get a color from a hexadecimal color code (e.g. <code>#FFDFD991</code>)?</p>

<p>I am reading a file and am getting a hexadecimal color code. I need to create the corresponding <code>System.Windows.Media.Color</code> instance for the hexadecimal color code. Is there an inbuilt method in the framework to do this?</p>
","<p>I'm assuming that's an ARGB code... Are you referring to <code>System.Drawing.Color</code> or <code>System.Windows.Media.Color</code>? The latter is used in WPF for example. I haven't seen anyone mention it yet, so just in case you were looking for it:</p>

<pre><code>using System.Windows.Media;

Color color = (Color)ColorConverter.ConvertFromString(""#FFDFD991"");
</code></pre>
","2109938"
"Creating a copy of an object in C#","383222","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/129389/how-do-you-do-a-deep-copy-an-object-in-net-c-specifically"">How do you do a deep copy an object in .Net (C# specifically)?</a>  </p>
</blockquote>



<p>Please have a look at the code below (excerpt from a C# book):</p>

<pre><code>namespace Example {
    class MyClass {
        public int val;
    }

    struct myStruct {
        public int val;
    }

    class Program {
        static void Main(string[] args) {
            MyClass objectA = new MyClass();
            MyClass objectB = objectA;
            objectA.val = 10;
            objectB.val = 20;
            myStruct structA = new myStruct();
            myStruct structB = structA;
            structA.val = 30;
            structB.val = 40;
            Console.WriteLine(""objectA.val = {0}"", objectA.val);
            Console.WriteLine(""objectB.val = {0}"", objectB.val);
            Console.WriteLine(""structA.val = {0}"", structA.val);
            Console.WriteLine(""structB.val = {0}"", structB.val);
            Console.ReadKey();
        }
    }
}
</code></pre>

<p>I understands it produces the output below</p>

<pre><code>objectA.val = 20
objectB.val = 20
structA.val = 30
structB.val = 40
</code></pre>

<p>The last two lines of the output I have no problem with, but the first two tell me that <code>objectA</code> and <code>objectB</code> are pointing to the same memory block (since in C#, objects are reference types).</p>

<p>The question is how do make <code>objectB</code>, a copy of <code>objectA</code> so that it points to a different area in memory. I understand that trying to assign their members may not work since those members may be references, too. So how do I go about making <code>objectB</code> a completely different entity from <code>objectA</code>? </p>

<p>Thanks</p>
","<p>There is no built-in way. You can have MyClass implement the <code>IClonable</code> interface (but it is sort of deprecated) or just write your own Copy/Clone method. In either case you will have to write some code. </p>

<p>For big objects you could consider Serialization + Deserialization (through a MemoryStream), just to reuse existing code. </p>

<p>Whatever the method, think carefully about what ""a copy"" means exactly. How deep should it go, are there Id fields to be excepted etc. </p>
","6569524"
"When to use .First and when to use .FirstOrDefault with LINQ?","382401","","<p>I've searched around and haven't really found a clear answer as to when you'd want to use <code>.First</code> and when you'd want to use <code>.FirstOrDefault</code> with LINQ.</p>

<ul>
<li><p>When would you want to use <code>.First</code>? Only when you'd want to catch the exception if no results where returned?</p>

<pre><code>var result = List.Where(x =&gt; x == ""foo"").First();
</code></pre></li>
<li><p>And when would you want to use <code>.FirstOrDefault</code>? When you'd always want the default type if no result?</p>

<pre><code>var result = List.Where(x =&gt; x == ""foo"").FirstOrDefault();
</code></pre></li>
<li><p>And for that matter, what about Take?</p>

<pre><code>var result = List.Where(x =&gt; x == ""foo"").Take(1);
</code></pre></li>
</ul>
","<p>I would use <code>First()</code> when I know or expect the sequence to have at least one element. In other words, when it is an exceptional occurrence that the sequence is empty.</p>

<p>Use <code>FirstOrDefault()</code> when you know that you will need to check whether there was an element or not. In other words, when it is legal for the sequence to be empty. You should not rely on exception handling for the check. (It is bad practice and might hurt performance).</p>

<p>Finally, the difference between <code>First()</code> and <code>Take()</code> is that <code>First()</code> returns the element itself, while <code>Take()</code> returns a sequence of elements that contains exactly one element. (If you pass 1 as the parameter).</p>
","1024577"
"Load image from resources area of project in C#","382283","","<p>I have an image in my project stored at Resources/myimage.jpg.  How can I dynamically load this image into Bitmap object?</p>
","<p>Are you using Windows Forms? If you've added the image using the Properties/Resources UI, you get access to the image from generated code, so you can simply do this:</p>

<pre><code>var bmp = new Bitmap(WindowsFormsApplication1.Properties.Resources.myimage);
</code></pre>
","1192071"
"Catch multiple exceptions at once?","382068","","<p>It is discouraged to simply catch <code>System.Exception</code>. Instead, only the ""known"" exceptions should be caught.</p>

<p>Now, this sometimes leads to unneccessary repetitive code, for example:</p>

<pre><code>try
{
    WebId = new Guid(queryString[""web""]);
}
catch (FormatException)
{
    WebId = Guid.Empty;
}
catch (OverflowException)
{
    WebId = Guid.Empty;
}
</code></pre>

<p>I wonder: Is there a way to catch both exceptions and only call the <code>WebId = Guid.Empty</code> call once?</p>

<p>The given example is rather simple, as it's only a <a href=""http://en.wikipedia.org/wiki/Globally_unique_identifier"" rel=""noreferrer""><code>GUID</code></a>. But imagine code where you modify an object multiple times, and if one of the manipulations fail in an expected way, you want to ""reset"" the <code>object</code>. However, if there is an unexpected exception, I still want to throw that higher.</p>
","<p>Catch <code>System.Exception</code> and switch on the types</p>

<pre><code>catch (Exception ex)            
{                
    if (ex is FormatException || ex is OverflowException)
    {
        WebId = Guid.Empty;
        return;
    }

    throw;
}
</code></pre>
","136092"
"How can I split a string with a string delimiter?","381428","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/1126915/how-do-i-split-a-string-by-a-multi-character-delimiter-in-c"">How do I split a string by a multi-character delimiter in C#?</a>  </p>
</blockquote>



<p>I have this string :</p>

<pre><code>My name is Marco and I'm from Italy
</code></pre>

<p>I'd like to split it, with delimiter <code>is Marco and</code>, so I should get an array with </p>

<ul>
<li><code>My name</code> at [0] and </li>
<li><code>I'm from Italy</code> at [1].</li>
</ul>

<p>How can I do it with C#? </p>

<p>Tried with </p>

<pre><code>.Split(""is Marco and"")
</code></pre>

<p>but it wants only a single char.</p>
","<pre><code>string[] tokens = str.Split(new[] { ""is Marco and"" }, StringSplitOptions.None);
</code></pre>

<p>If you have a single character delimiter (like for instance <code>,</code>), you can reduce that to (note the single quotes):</p>

<pre><code>string[] tokens = str.Split(',');
</code></pre>
","8928665"
".NET: Simplest way to send POST with data and read response","379889","","<p>To my surprise, I can't do anything nearly as simple as this, from what I can tell, in the .NET BCL:</p>

<pre><code>byte[] response = Http.Post
(
    url: ""http://dork.com/service"",
    contentType: ""application/x-www-form-urlencoded"",
    contentLength: 32,
    content: ""home=Cosby&amp;favorite+flavor=flies""
);
</code></pre>

<p>This hypothetical code above makes an HTTP POST, with data, and returns the response from a <code>Post</code> method on a static class <code>Http</code>.</p>

<p>Since we're left without something this easy, what's the next best solution?</p>

<p>How do I send an HTTP POST with data AND get the response's content?</p>
","<pre><code>   using (WebClient client = new WebClient())
   {

       byte[] response =
       client.UploadValues(""http://dork.com/service"", new NameValueCollection()
       {
           { ""home"", ""Cosby"" },
           { ""favorite+flavor"", ""flies"" }
       });

       string result = System.Text.Encoding.UTF8.GetString(response);
   }
</code></pre>

<p>You will need these includes:</p>

<pre><code>using System;
using System.Collections.Specialized;
using System.Net;
</code></pre>

<p>If you're insistent on using a static method/class:</p>

<pre><code>public static class Http
{
    public static byte[] Post(string uri, NameValueCollection pairs)
    {
        byte[] response = null;
        using (WebClient client = new WebClient())
        {
            response = client.UploadValues(uri, pairs);
        }
        return response;
    }
}
</code></pre>

<p>Then simply:</p>

<pre><code>var response = Http.Post(""http://dork.com/service"", new NameValueCollection() {
    { ""home"", ""Cosby"" },
    { ""favorite+flavor"", ""flies"" }
});
</code></pre>
","4088699"
"How to set session timeout in web.config","378823","","<p>I have tried very hard but cannot find a solution on how to set session timeout value for in-process session for an ASP.Net web application.</p>

<p>I am using VSTS 2008 + .Net 3.5 + C#. Here is what I wrote by myself to set timeout to be 1 minute, is it correct?</p>

<p>I wrote under system.web section in the <code>web.config</code></p>

<pre><code>&lt;sessionState timeout=""1"" mode=""InProc"" /&gt;
</code></pre>
","<p>If you want to set the timeout to 20 minutes, use something like this:</p>

<pre><code>&lt;configuration&gt;
  &lt;system.web&gt;
     &lt;sessionState timeout=""20""&gt;&lt;/sessionState&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;
</code></pre>

<p>should see you right</p>
","1205854"
"How to read embedded resource text file","378249","","<p>How do I read an embedded resource (text file) using <code>StreamReader</code> and return it as a string?  My current script uses a Windows form and textbox that allows the user to find and replace text in a text file that is not embedded. </p>

<pre><code>private void button1_Click(object sender, EventArgs e)
{
    StringCollection strValuesToSearch = new StringCollection();
    strValuesToSearch.Add(""Apple"");
    string stringToReplace;
    stringToReplace = textBox1.Text;

    StreamReader FileReader = new StreamReader(@""C:\MyFile.txt"");
    string FileContents;
    FileContents = FileReader.ReadToEnd();
    FileReader.Close();
    foreach (string s in strValuesToSearch)
    {
        if (FileContents.Contains(s))
            FileContents = FileContents.Replace(s, stringToReplace);
    }
    StreamWriter FileWriter = new StreamWriter(@""MyFile.txt"");
    FileWriter.Write(FileContents);
    FileWriter.Close();
}
</code></pre>
","<p>You can use the <a href=""http://msdn.microsoft.com/en-us/library/xc4235zt(v=VS.85).aspx"" rel=""noreferrer""><strong><code>Assembly.GetManifestResourceStream</code></strong> Method</a>:</p>

<ol>
<li><p>Add the following using</p>

<pre><code>using System.Reflection;
</code></pre></li>
<li><p>Set property of relevant file:<br>
Parameter <code>Build Action</code> with value <code>Embedded Resource</code></p></li>
<li><p>Use the following code</p></li>
</ol>

<p>

<pre><code>var assembly = Assembly.GetExecutingAssembly();
var resourceName = ""MyCompany.MyProduct.MyFile.txt"";

using (Stream stream = assembly.GetManifestResourceStream(resourceName))
using (StreamReader reader = new StreamReader(stream))
{
    string result = reader.ReadToEnd();
}
</code></pre>

<p><code>resourceName</code> is the name of one of the resources embedded in <code>assembly</code>.
For example, if you embed a text file named <code>""MyFile.txt""</code> that is placed in the root of a project with default namespace <code>""MyCompany.MyProduct""</code>, then <code>resourceName</code> is <code>""MyCompany.MyProduct.MyFile.txt""</code>.
You can get a list of all resources in an assembly using the <a href=""http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcenames%28v=vs.85%29.aspx"" rel=""noreferrer""><strong><code>Assembly.GetManifestResourceNames</code></strong> Method</a>.</p>
","3314213"
"How To: Execute command line in C#, get STD OUT results","377219","","<p>How do I execute a command-line program from C# and get back the STD OUT results.  Specifically, I want to execute DIFF on two files that are programmatically selected and write the results to a text box.  Yes, I could figure this out for myself, but surely someone else has done something like it and I'm lazy...</p>
","<pre><code>// Start the child process.
 Process p = new Process();
 // Redirect the output stream of the child process.
 p.StartInfo.UseShellExecute = false;
 p.StartInfo.RedirectStandardOutput = true;
 p.StartInfo.FileName = ""YOURBATCHFILE.bat"";
 p.Start();
 // Do not wait for the child process to exit before
 // reading to the end of its redirected stream.
 // p.WaitForExit();
 // Read the output stream first and then wait.
 string output = p.StandardOutput.ReadToEnd();
 p.WaitForExit();
</code></pre>

<p>Code is from <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx"" rel=""noreferrer"">MSDN</a>.</p>
","206347"
"Convert JSON String To C# Object","376111","","<p>Trying to convert a JSON string into an object in C#. Using a really simple test case:</p>

<pre><code>JavaScriptSerializer json_serializer = new JavaScriptSerializer();
object routes_list = json_serializer.DeserializeObject(""{ \""test\"":\""some data\"" }"");
</code></pre>

<p>The problem is that routes_list never gets set; it's an undefined object. Any ideas?</p>
","<p>It looks like you're trying to deserialize to a raw object.  You could create a Class that represents the object that you're converting to.  This would be most useful in cases where you're dealing with larger objects or JSON Strings.</p>

<p>For instance:</p>

<pre><code>  class Test {

      String test; 

      String getTest() { return test; }
      void setTest(String test) { this.test = test; }

  }
</code></pre>

<p>Then your deserialization code would be:</p>

<pre><code>   JavaScriptSerializer json_serializer = new JavaScriptSerializer();
   Test routes_list = 
          (Test)json_serializer.DeserializeObject(""{ \""test\"":\""some data\"" }"");
</code></pre>

<p>More information can be found in this tutorial:
<a href=""http://www.codeproject.com/Tips/79435/Deserialize-JSON-with-Csharp.aspx"" rel=""noreferrer"">http://www.codeproject.com/Tips/79435/Deserialize-JSON-with-Csharp.aspx</a></p>
","4611085"
"Best way to get application folder path","374882","","<p>I see that there are some ways to get the application folder path:</p>

<ol>
<li><code>Application.StartupPath</code></li>
<li><code>System.IO.Path.GetDirectoryName(
System.Reflection.Assembly.GetExecutingAssembly().Location)</code></li>
<li><code>AppDomain.CurrentDomain.BaseDirectory</code></li>
<li><code>System.IO.Directory.GetCurrentDirectory()</code></li>
<li><code>Environment.CurrentDirectory</code></li>
<li><code>System.IO.Path.GetDirectoryName(
System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase)</code></li>
<li><code>System.IO.Path.GetDirectory(Application.ExecutablePath)</code></li>
</ol>

<p>What is the best way depending on the situation?</p>
","<p><code>AppDomain.CurrentDomain.BaseDirectory</code> is probably the most useful for accessing files whose location is relative to the application install directory.</p>

<p>In an ASP.NET application, this will be the application root directory, not the bin subfolder - which is probably what you usually want. In a client application, it will be the directory containing the main executable.</p>

<p>In a VSTO 2005 application, it will be the directory containing the VSTO managed assemblies for your application, not, say, the path to the Excel executable.</p>

<p>The others may return different directories depending on your environment - for example see @Vimvq1987's answer.</p>

<p><code>CodeBase</code> is the place where a file was found and can be a URL beginning with http://. In which case <code>Location</code> will probably be the assembly download cache. CodeBase is not guaranteed to be set for assemblies in the <a href=""http://en.wikipedia.org/wiki/Global_Assembly_Cache"">GAC</a>.</p>
","6041505"
"How to initialize a C# string list (List<string>) with many string values","373683","","<p>How is it possible to initialize (with a C# initializer) a list of strings? I have tried with the example below but it's not working.</p>

<pre><code>List&lt;string&gt; optionList = new List&lt;string&gt;
{
    ""AdditionalCardPersonAdressType"",""AutomaticRaiseCreditLimit"",""CardDeliveryTimeWeekDay""
}();
</code></pre>
","<pre><code>List&lt;string&gt; mylist = new List&lt;string&gt;(new string[] { ""element1"", ""element2"", ""element3"" });
</code></pre>

<p>I shall refrain from being worried about some of the details in the OP's list... :)</p>
","3139278"
"When to use static classes in C#","373106","","<p>Here's what <a href=""http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx"" rel=""noreferrer"">MSDN has to say under <em>When to Use Static Classes</em></a>:</p>

<blockquote>
<pre><code>static class CompanyInfo
{
    public static string GetCompanyName() { return ""CompanyName""; }
    public static string GetCompanyAddress() { return ""CompanyAddress""; }
    //...
}
</code></pre>
  
  <p>Use a static class as a unit of
  organization for methods not
  associated with particular objects.
  Also, a static class can make your
  implementation simpler and faster
  because you do not have to create an
  object in order to call its methods.
  It is useful to organize the methods
  inside the class in a meaningful way,
  such as the methods of the Math class
  in the System namespace.</p>
</blockquote>

<p>To me, that example doesn't seem to cover very many possible usage scenarios for static classes. In the past I've used static classes for stateless suites of related functions, but that's about it. So, under what circumstances should (and shouldn't) a class be declared static?  </p>
","<p>I wrote my thoughts of static classes in an earlier Stack Overflow answer:
<em><a href=""https://stackoverflow.com/questions/205689/class-with-single-method-best-approach#206481"">Class with single method -- best approach?</a></em></p>

<p>I used to love utility classes filled up with static methods. They made a great consolidation of helper methods that would otherwise lie around causing redundancy and maintenance hell. They're very easy to use, no instantiation, no disposal, just fire'n'forget. I guess this was my first unwitting attempt at creating a service-oriented architecture - lots of stateless services that just did their job and nothing else. As a system grows however, dragons be coming.</p>

<p><strong>Polymorphism</strong></p>

<p>Say we have the method UtilityClass.SomeMethod that happily buzzes along. Suddenly we need to change the functionality slightly. Most of the functionality is the same, but we have to change a couple of parts nonetheless. Had it not been a static method, we could make a derivate class and change the method contents as needed. As it's a static method, we can't. Sure, if we just need to add functionality either before or after the old method, we can create a new class and call the old one inside of it - but that's just gross.</p>

<p><strong>Interface woes</strong></p>

<p>Static methods cannot be defined through interfaces for logic reasons. And since we can't override static methods, static classes are useless when we need to pass them around by their interface. This renders us unable to use static classes as part of a strategy pattern. We might patch some issues up by <a href=""http://blogs.msdn.com/kirillosenkov/archive/2008/02/06/how-to-override-static-methods.aspx"" rel=""noreferrer"">passing delegates instead of interfaces</a>.</p>

<p><strong>Testing</strong></p>

<p>This basically goes hand in hand with the interface woes mentioned above. As our ability of interchanging implementations is very limited, we'll also have trouble replacing production code with test code. Again, we can wrap them up, but it'll require us to change large parts of our code just to be able to accept wrappers instead of the actual objects.</p>

<p><strong>Fosters blobs</strong></p>

<p>As static methods are usually used as utility methods and utility methods usually will have different purposes, we'll quickly end up with a large class filled up with non-coherent functionality - ideally, each class should have a single purpose within the system. I'd much rather have a five times the classes as long as their purposes are well defined.</p>

<p><strong>Parameter creep</strong></p>

<p>To begin with, that little cute and innocent static method might take a single parameter. As functionality grows, a couple of new parameters are added. Soon further parameters are added that are optional, so we create overloads of the method (or just add default values, in languages that support them). Before long, we have a method that takes 10 parameters. Only the first three are really required, parameters 4-7 are optional. But if parameter 6 is specified, 7-9 are required to be filled in as well... Had we created a class with the single purpose of doing what this static method did, we could solve this by taking in the required parameters in the constructor, and allowing the user to set optional values through properties, or methods to set multiple interdependent values at the same time. Also, if a method has grown to this amount of complexity, it most likely needs to be in its own class anyway.</p>

<p><strong>Demanding consumers to create an instance of classes for no reason</strong></p>

<p>One of the most common arguments is: Why demand that consumers of our class create an instance for invoking this single method, while having no use for the instance afterwards? Creating an instance of a class is a very very cheap operation in most languages, so speed is not an issue. Adding an extra line of code to the consumer is a low cost for laying the foundation of a much more maintainable solution in the future. And finally, if you want to avoid creating instances, simply create a singleton wrapper of your class that allows for easy reuse - although this does make the requirement that your class is stateless. If it's not stateless, you can still create static wrapper methods that handle everything, while still giving you all the benefits in the long run. Finally, you could also make a class that hides the instantiation as if it was a singleton: MyWrapper.Instance is a property that just returns <code>new MyClass();</code></p>

<p><strong>Only a Sith deals in absolutes</strong></p>

<p>Of course, there are exceptions to my dislike of static methods. True utility classes that do not pose any risk to bloat are excellent cases for static methods - System.Convert as an example. If your project is a one-off with no requirements for future maintenance, the overall architecture really isn't very important - static or non static, doesn't really matter - development speed does, however.</p>

<p><strong>Standards, standards, standards!</strong></p>

<p>Using instance methods does not inhibit you from also using static methods, and vice versa. As long as there's reasoning behind the differentiation and it's standardised. There's nothing worse than looking over a business layer sprawling with different implementation methods.</p>
","241372"
"WPF image resources","372292","","<p>I come from a mostly web and a little bit Windows Forms background. For a new project, we will be using WPF. The WPF application will need 10 - 20 small icons and images for illustrative purposes. I am thinking about storing these in the assembly as embedded resources. Is that the right way to go ? </p>

<p>How do I specify in XAML that an Image control should load the image from an embedded resource ? </p>
","<p>If you will use the image in multiple places, then it's worth loading the image data only once into memory and then sharing it between all <code>Image</code> elements.</p>

<p>To do this, create a <a href=""http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource.aspx"" rel=""noreferrer""><code>BitmapSource</code></a>  as a resource somewhere:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;BitmapImage x:Key=""MyImageSource"" UriSource=""../Media/Image.png"" /&gt;
</code></pre>

<p>Then, in your code, use something like:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;Image Source=""{StaticResource MyImageSource}"" /&gt;
</code></pre>

<p>In my case, I found that I had to set the <code>Image.png</code> file to have a build action of <code>Resource</code> rather than just <code>Content</code>.  This causes the image to be carried within your compiled assembly.</p>
","606986"
"Using C# to check if string contains a string in string array","372251","","<p>I want to use C# to check if a string value contains a word in a string array. For example,</p>

<pre><code>string stringToCheck = ""text1text2text3"";

string[] stringArray = { ""text1"", ""someothertext"", etc... };

if(stringToCheck.contains stringArray) //one of the items?
{

}
</code></pre>

<p>How can I check if the string value for 'stringToCheck' contains a word in the  array?</p>
","<p>here is how you can do it:</p>

<pre><code>string stringToCheck = ""text1"";
string[] stringArray = { ""text1"", ""testtest"", ""test1test2"", ""test2text1"" };
foreach (string x in stringArray)
{
    if (stringToCheck.Contains(x))
    {
        // Process...
    }
}
</code></pre>

<p><strong>UPDATE:</strong> May be you are looking for a better solution.. refer to @Anton Gogolev's answer below which makes use of LINQ.</p>
","2912507"
"Deserialize JSON with C#","370920","","<p>I'm trying to deserialize a Facebook friends graph API call into a list of objects. The JSON object looks like:</p>

<pre><code>{""data"":[{""id"":""518523721"",""name"":""ftyft""},
         {""id"":""527032438"",""name"":""ftyftyf""},
         {""id"":""527572047"",""name"":""ftgft""},
         {""id"":""531141884"",""name"":""ftftft""},
         {""id"":""532652067"",""name""... 

List&lt;EFacebook&gt; facebooks = new JavaScriptSerializer().Deserialize&lt;List&lt;EFacebook&gt;&gt;(result);
</code></pre>

<p>It's not working because the primitive object is invalid.<br>
How can I deserialize this?</p>
","<p>You need to create a structure like this:</p>

<pre><code>public class Friends
{

    public List&lt;FacebookFriend&gt; data {get;set;}
}

public class FacebookFriend
{

    public string id {get;set;}
    public string name {get;set;}
}
</code></pre>

<p>Then you should be able to do: </p>

<pre><code>Friends facebookFriends = new JavaScriptSerializer().Deserialize&lt;Friends&gt;(result);
</code></pre>

<p>Names of my classes are just an example. You should use proper names. </p>

<p>Adding sample test:</p>

<pre><code>string json=
    @""{""""data"""":[{""""id"""":""""518523721"""",""""name"""":""""ftyft""""}, {""""id"""":""""527032438"""",""""name"""":""""ftyftyf""""}, {""""id"""":""""527572047"""",""""name"""":""""ftgft""""}, {""""id"""":""""531141884"""",""""name"""":""""ftftft""""}]}"";


Friends facebookFriends = new System.Web.Script.Serialization.JavaScriptSerializer().Deserialize&lt;Friends&gt;(json);

foreach(var item in facebookFriends.data)
{
   Console.WriteLine(""id: {0}, name: {1}"",item.id,item.name);
}
</code></pre>

<p>Produces:</p>

<pre><code>id: 518523721, name: ftyft
id: 527032438, name: ftyftyf
id: 527572047, name: ftgft
id: 531141884, name: ftftft
</code></pre>
","7895168"
"How do I generate a stream from a string?","369686","","<p>I need to write a unit test for a method that takes a stream which comes from a text file. I would like to do do something like this:</p>

<pre><code>Stream s = GenerateStreamFromString(""a,b \n c,d"");
</code></pre>
","<pre><code>public static Stream GenerateStreamFromString(string s)
{
    MemoryStream stream = new MemoryStream();
    StreamWriter writer = new StreamWriter(stream);
    writer.Write(s);
    writer.Flush();
    stream.Position = 0;
    return stream;
}
</code></pre>

<p>Don't forget to use Using:</p>

<pre><code>using (Stream s = GenerateStreamFromString(""a,b \n c,d""))
{
    // ... Do stuff to stream
}
</code></pre>

<hr>

<p>About the <code>StreamWriter</code> not being disposed. <code>StreamWriter</code> is just a wrapper around the base stream, and doesn't use any resources that need to be disposed. The <code>Dispose</code> method will close the underlying <code>Stream</code> that <code>StreamWriter</code> is writing to. In this case that is the <code>MemoryStream</code> we want to return.</p>

<p>In .NET 4.5 there is now an overload for <code>StreamWriter</code> that keeps the underlying stream open after the writer is disposed of, but this code does the same thing and works with other versions of .NET too.</p>

<p>See <a href=""https://stackoverflow.com/questions/2666888/is-there-any-way-to-close-a-streamwriter-without-closing-its-basestream"">Is there any way to close a StreamWriter without closing its BaseStream?</a></p>
","1879470"
"Is there a way to check if a file is in use?","369561","","<p>I'm writing a program in C# that needs to repeatedly access 1 image file. Most of the time it works, but if my computer's running fast, it will try to access the file before it's been saved back to the filesystem and throw an error: <em>""File in use by another process""</em>.</p>

<p>I would like to find a way around this, but all my Googling has only yielded creating checks by using exception handling. This is against my religion, so I was wondering if anyone has a better way of doing it?</p>
","<p><strong>Updated NOTE on this solution</strong>: Checking with <code>FileAccess.ReadWrite</code> will fail for Read-Only files so the solution has been modified to check with <code>FileAccess.Read</code>. While this solution works because trying to check with <code>FileAccess.Read</code> will fail if the file has a Write or Read lock on it, however, this solution will not work if the file doesn't have a Write or Read lock on it, i.e. it has been opened (for reading or writing) with FileShare.Read or FileShare.Write access.</p>

<p><strong>ORIGINAL:</strong>
I've used this code for the past several years, and I haven't had any issues with it.</p>

<p>Understand your hesitation about using exceptions, but you can't avoid them all of the time:</p>

<pre><code>protected virtual bool IsFileLocked(FileInfo file)
{
    FileStream stream = null;

    try
    {
        stream = file.Open(FileMode.Open, FileAccess.Read, FileShare.None);
    }
    catch (IOException)
    {
        //the file is unavailable because it is:
        //still being written to
        //or being processed by another thread
        //or does not exist (has already been processed)
        return true;
    }
    finally
    {
        if (stream != null)
            stream.Close();
    }

    //file is not locked
    return false;
}
</code></pre>
","937558"
"How do you convert a DataTable into a generic list?","368757","","<p>Currently, I'm using:</p>

<pre><code>DataTable dt = CreateDataTableInSomeWay();

List&lt;DataRow&gt; list = new List&lt;DataRow&gt;(); 
foreach (DataRow dr in dt.Rows)
{
    list.Add(dr);
}
</code></pre>

<p>Is there a better/magic way?</p>
","<p>If you're using .NET 3.5, you can use <a href=""http://msdn.microsoft.com/en-us/library/system.data.datatableextensions.asenumerable.aspx"" rel=""noreferrer""><code>DataTableExtensions.AsEnumerable</code></a> (an extension method) and then if you really need a <code>List&lt;DataRow&gt;</code> instead of just <code>IEnumerable&lt;DataRow&gt;</code> you can call <a href=""http://msdn.microsoft.com/en-us/library/bb342261.aspx"" rel=""noreferrer""><code>Enumerable.ToList</code></a>:</p>

<pre><code>IEnumerable&lt;DataRow&gt; sequence = dt.AsEnumerable();
</code></pre>

<p>or</p>

<pre><code>using System.Linq;
...
List&lt;DataRow&gt; list = dt.AsEnumerable().ToList();
</code></pre>
","208683"
"How should I convert a string to an enum in C#?","368095","","<p>What's the best way to convert a string to an enumeration value in C#?</p>

<p>I have an HTML select tag containing the values of an enumeration. When the page is posted, I want to pick up the value (which will be in the form of a string) and convert it to the enumeration value.</p>

<p>In an ideal world, I could do something like this:</p>

<pre><code>StatusEnum MyStatus = StatusEnum.Parse(""Active"");
</code></pre>

<p>but that isn't a valid code.</p>
","<p>In .NET Core and .NET >4 <a href=""https://msdn.microsoft.com/en-us/library/dd783499%28v=vs.110%29.aspx"" rel=""noreferrer"">there is a generic parse method</a>:</p>

<pre><code>Enum.TryParse(""Active"", out StatusEnum myStatus);
</code></pre>

<p>This also includes C#7's new inline <code>out</code> variables, so this does the try-parse, conversion to the explicit enum type and initialises+populates the <code>myStatus</code> variable.</p>

<p>If you have access to C#7 and the latest .NET this is the best way.</p>

<h2>Original Answer</h2>

<p>In .NET it's rather ugly (until 4 or above):</p>

<pre><code>StatusEnum MyStatus = (StatusEnum) Enum.Parse(typeof(StatusEnum), ""Active"", true);
</code></pre>

<p>I tend to simplify this with:</p>

<pre><code>public static T ParseEnum&lt;T&gt;(string value)
{
    return (T) Enum.Parse(typeof(T), value, true);
}
</code></pre>

<p>Then I can do:</p>

<pre><code>StatusEnum MyStatus = EnumUtil.ParseEnum&lt;StatusEnum&gt;(""Active"");
</code></pre>

<p>One option suggested in the comments is to add an extension, which is simple enough:</p>

<pre><code>public static T ToEnum&lt;T&gt;(this string value)
{
    return (T) Enum.Parse(typeof(T), value, true);
}

StatusEnum MyStatus = ""Active"".ToEnum&lt;StatusEnum&gt;();
</code></pre>

<p>Finally, you may want to have a default enum to use if the string cannot be parsed:</p>

<pre><code>public static T ToEnum&lt;T&gt;(this string value, T defaultValue) 
{
    if (string.IsNullOrEmpty(value))
    {
        return defaultValue;
    }

    T result;
    return Enum.TryParse&lt;T&gt;(value, true, out result) ? result : defaultValue;
}
</code></pre>

<p>Which makes this the call:</p>

<pre><code>StatusEnum MyStatus = ""Active"".ToEnum(StatusEnum.None);
</code></pre>

<p>However, I would be careful adding an extension method like this to <code>string</code> as (without namespace control) it will appear on all instances of <code>string</code> whether they hold an enum or not (so <code>1234.ToString().ToEnum(StatusEnum.None)</code> would be valid but nonsensical) . It's often be best to avoid cluttering Microsoft's core classes with extra methods that only apply in very specific contexts unless your entire development team has a very good understanding of what those extensions do. </p>
","16104"
"How do I convert byte[] to stream in C#?","366896","","<p>How can I convert <code>byte[]</code> array to stream in C#?</p>
","<p>The easiest way to convert a byte array to a stream is using the <a href=""http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx""><code>MemoryStream</code></a> class:</p>

<pre><code>Stream stream = new MemoryStream(byteArray);
</code></pre>
","4769610"
"Multiline String Literal in C#","365468","","<p>Is there an easy way to create a multiline string literal in C#?</p>

<p>Here's what I have now:</p>

<pre><code>string query = ""SELECT foo, bar""
+ "" FROM table""
+ "" WHERE id = 42"";
</code></pre>

<p>I know PHP has</p>

<pre><code>&lt;&lt;&lt;BLOCK

BLOCK;
</code></pre>

<p>Does C# have something similar?</p>
","<p>You can use the <code>@</code> symbol in front of a <code>string</code> to form a <a href=""http://dotnetslackers.com/CSharp/re-51752_The_Chash_String_Literal.aspx"" rel=""noreferrer"">verbatim string literal</a>:</p>

<pre><code>string query = @""SELECT foo, bar
FROM table
WHERE id = 42"";
</code></pre>

<p>You also <a href=""http://www.peachpit.com/articles/article.aspx?p=31938&amp;seqNum=10"" rel=""noreferrer"">do not have to escape special characters</a> when you use this method, except for double quotes as shown in Jon Skeet's answer.</p>
","1100265"
"A generic error occurred in GDI+, JPEG Image to MemoryStream","363356","","<p>This seems to be a bit of an infamous error all over the web. So much so that I have been unable to find an answer to my problem as my scenario doesn't fit. An exception gets thrown when I save the image to the stream.</p>

<p>Weirdly this works perfectly with a png but gives the above error with jpg and gif which is rather confusing.</p>

<p>Most similar problem out there relate to saving images to files without permissions. Ironically the solution is to use a memory stream as I am doing....</p>

<pre><code>public static byte[] ConvertImageToByteArray(Image imageToConvert)
{
    using (var ms = new MemoryStream())
    {
        ImageFormat format;
        switch (imageToConvert.MimeType())
        {
            case ""image/png"":
                format = ImageFormat.Png;
                break;
            case ""image/gif"":
                format = ImageFormat.Gif;
                break;
            default:
                format = ImageFormat.Jpeg;
                break;
        }

        imageToConvert.Save(ms, format);
        return ms.ToArray();
    }
}
</code></pre>

<p>More detail to the exception. The reason this causes so many issues is the lack of explanation :(</p>

<pre><code>System.Runtime.InteropServices.ExternalException was unhandled by user code
Message=""A generic error occurred in GDI+.""
Source=""System.Drawing""
ErrorCode=-2147467259
StackTrace:
   at System.Drawing.Image.Save(Stream stream, ImageCodecInfo encoder, EncoderParameters    encoderParams)
   at System.Drawing.Image.Save(Stream stream, ImageFormat format)
   at Caldoo.Infrastructure.PhotoEditor.ConvertImageToByteArray(Image imageToConvert) in C:\Users\Ian\SVN\Caldoo\Caldoo.Coordinator\PhotoEditor.cs:line 139
   at Caldoo.Web.Controllers.PictureController.Croppable() in C:\Users\Ian\SVN\Caldoo\Caldoo.Web\Controllers\PictureController.cs:line 132
   at lambda_method(ExecutionScope , ControllerBase , Object[] )
   at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;InvokeActionMethodWithFilters&gt;b__7()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
 InnerException: 
</code></pre>

<p>OK things I have tried so far. </p>

<ol>
<li>Cloning the image and working on that.</li>
<li>Retrieving the encoder for that MIME passing that with jpeg quality setting.</li>
</ol>
","<p>OK I seem to have found the cause just by sheer luck and its nothing wrong with that particular method, it's further back up the call stack.</p>

<p>Earlier I resize the image and as part of that method I return the resized object as follows. I have inserted two calls to the above method and a direct save to a file.</p>

<pre><code>// At this point the new bitmap has no MimeType
// Need to output to memory stream
using (var m = new MemoryStream())
{
       dst.Save(m, format);

       var img = Image.FromStream(m);

       //TEST
       img.Save(""C:\\test.jpg"");
       var bytes = PhotoEditor.ConvertImageToByteArray(img);


       return img;
 }
</code></pre>

<p>It appears that the memory stream that the object was created on <strong>has</strong> to be open at the time the object is saved. I am not sure why this is. Is anyone able to enlighten me and how I can get around this. </p>

<p>I only return from a stream because after using the resize code similar to <a href=""https://stackoverflow.com/questions/30569/resize-transparent-images-using-c"">this</a> the destination file has an unknown mime type (img.RawFormat.Guid) and Id like the Mime type to be correct on all image objects as it makes it hard write generic handling code otherwise.</p>

<p><strong>EDIT</strong></p>

<p>This didn't come up in my initial search but <a href=""https://stackoverflow.com/questions/336387/image-save-throws-a-gdi-exception-because-the-memory-stream-is-closed"">here's</a> the answer from Jon Skeet</p>
","1053123"
"Easiest way to split a string on newlines in .NET?","363101","","<p>I need to split a string into newlines in .NET and the only way I know of to split strings is with the <a href=""https://msdn.microsoft.com/en-us/library/system.string.split%28v=vs.110%29.aspx"" rel=""noreferrer"">Split</a> method. However that will not allow me to (easily) split on a newline, so what is the best way to do it?</p>
","<p>To split on a string you need to use the overload that takes an array of strings:</p>

<pre><code>string[] lines = theText.Split(
    new[] { Environment.NewLine },
    StringSplitOptions.None
);
</code></pre>

<p>Edit:<br>
If you want to handle different types of line breaks in a text, you can use the ability to match more than one string. This will correctly split on either type of line break, and preserve empty lines and spacing in the text:</p>

<pre><code>string[] lines = theText.Split(
    new[] { ""\r\n"", ""\r"", ""\n"" },
    StringSplitOptions.None
);
</code></pre>
","1547483"
"How to post JSON to the server?","358861","","<p>Here's the code I'm using:</p>

<pre><code>// create a request
HttpWebRequest request = (HttpWebRequest)
WebRequest.Create(url); request.KeepAlive = false;
request.ProtocolVersion = HttpVersion.Version10;
request.Method = ""POST"";


// turn our request string into a byte stream
byte[] postBytes = Encoding.UTF8.GetBytes(json);

// this is important - make sure you specify type this way
request.ContentType = ""application/json; charset=UTF-8"";
request.Accept = ""application/json"";
request.ContentLength = postBytes.Length;
request.CookieContainer = Cookies;
request.UserAgent = currentUserAgent;
Stream requestStream = request.GetRequestStream();

// now send it
requestStream.Write(postBytes, 0, postBytes.Length);
requestStream.Close();

// grab te response and print it out to the console along with the status code
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
string result;
using (StreamReader rdr = new StreamReader(response.GetResponseStream()))
{
    result = rdr.ReadToEnd();
}

return result;
</code></pre>

<p>When I'm running this, I'm always getting 500 internal server error.</p>

<p>What am I doing wrong?</p>
","<p>The way I do it and is working is:</p>

<pre><code>var httpWebRequest = (HttpWebRequest)WebRequest.Create(""http://url"");
httpWebRequest.ContentType = ""application/json"";
httpWebRequest.Method = ""POST"";

using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))
{
    string json = ""{\""user\"":\""test\"","" +
                  ""\""password\"":\""bla\""}"";

    streamWriter.Write(json);
    streamWriter.Flush();
    streamWriter.Close();
}

var httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();
using (var streamReader = new StreamReader(httpResponse.GetResponseStream()))
{
    var result = streamReader.ReadToEnd();
}
</code></pre>

<p>I wrote a library to perform this task in a simpler way, it is here: <a href=""https://github.com/ademargomes/JsonRequest"" rel=""noreferrer"">https://github.com/ademargomes/JsonRequest</a></p>

<p>Hope it helps.</p>
","10027534"
"Access to the path is denied","358844","","<p>I know this question was asked many times here, but I can't find a solution to my problem.
I'm trying to save image to the folder in .net c# but get this exception:</p>

<pre><code>Access to the path 'C:\inetpub\wwwroot\mysite\images\savehere' is denied.The error occured at mscorlib because    at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)
at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
at System.IO.FileStream..ctor(String path, FileMode mode)
</code></pre>

<p>I gave full control to this folder (savehere) to <code>network service</code> and <code>iis_iusrs</code>, even gave full control to <code>everyone</code> but still getting this exception.
I tried to give access via explorer and via IIS manager, still no luck</p>

<p>I'm doing it on Windows server 2008 R2 and IIS 7.5, Who do I need to give access? </p>

<p>Thanks</p>
","<p>You need to find out from the application pool for the website what is the identity it is running under (by default this is <code>Application Pool Identity</code>) and grant that the correct permissions.</p>
","4877761"
"MVVM: Tutorial from start to finish?","357644","","<p>I'm a C#/Windows Forms programmer with more than 5 years experience. I've been investigating WPF using the MVVM (Model-View-ViewModel) design pattern. I have searched the Internet for tutorials. I have even watched the entirety of Jason Dolinger's awesome video. Although I have found many, I have not found one that takes me from start to finish. What I really want is a tutorial that doesn't assume any previous WPF knowledge.</p>

<p>What are your favorite WPF-MVVM tutorials that helped you to learn?</p>
","<p>Your question really seems to be asking 2 questions:</p>

<ol>
<li>Where are some good tutorials on WPF, assuming I have no previous WPF experience?</li>
<li>Where are some good tutorials on learning MVVM?</li>
</ol>

<p>Some of these resources may be duplicated in previous answers...</p>

<p><strong>Tutorials on WPF</strong><br /></p>

<ul>
<li><p><a href=""http://joshsmithonwpf.wordpress.com/a-guided-tour-of-wpf/"" rel=""nofollow noreferrer"">A Guided Tour of WPF by Josh Smith</a></p>

<blockquote>
  <p>I wrote a series of introductory WPF articles on <a href=""http://en.wikipedia.org/wiki/The_Code_Project"" rel=""nofollow noreferrer"">The Code Project</a>.  The goal of those articles is to bring someone with no WPF experience up-to-speed enough so that (s)he can fully understand how the series’ demo application works.</p>
</blockquote></li>
<li><p><a href=""http://bea.stollnitz.com/blog/?page_id=47"" rel=""nofollow noreferrer"">Bea Stollnitz</a> (link is to her archives) has a number of great articles on WPF.</p></li>
<li><p><a href=""http://www.codeproject.com/KB/WPF/BeginWPF1.aspx"" rel=""nofollow noreferrer"">WPF: A Beginner's Guide - Part 1 of n</a> by Sacha Barber</p></li>
<li><p><a href=""http://windowsclient.net/learn/videos_wpf.aspx"" rel=""nofollow noreferrer"">WindowsClient.net WPF Training Videos</a></p></li>
</ul>

<p><strong>MVVM Tutorials</strong><br /></p>

<ul>
<li><p><a href=""http://msdn.microsoft.com/en-us/magazine/dd419663.aspx"" rel=""nofollow noreferrer"">WPF Apps With The Model-View-ViewModel Design Pattern</a> by Josh Smith (duplicate link already provided by Yacoder)</p></li>
<li><p><a href=""http://blog.lab49.com/archives/2650"" rel=""nofollow noreferrer"">Jason Dolinger's presentation on the Model-View-ViewModel</a> (link to video embedded in article)</p></li>
<li><p><a href=""http://blogs.msdn.com/dancre/archive/2006/10/11/datamodel-view-viewmodel-pattern-series.aspx"" rel=""nofollow noreferrer"">Dan Crevier's DataModel-View-ViewModel pattern series</a> (similar to MVVM)</p></li>
</ul>

<p><strong>Composite WPF (Prism) Resources</strong><br />
Though not exactly what you asked, it is the natural progression with WPF and MVVM.</p>

<ul>
<li><p><a href=""http://compositewpf.codeplex.com/"" rel=""nofollow noreferrer"">Codeplex: Composite WPF (Prism)</a></p></li>
<li><p><a href=""http://development-guides.silverbaylabs.org/home/VideosOnly"" rel=""nofollow noreferrer"">Silver Bay Labs has a number of great videos on learning Prism</a></p></li>
<li><p><a href=""http://channel9.msdn.com/posts/mtaulty/Prism--Silverlight-Part-1-Taking-Sketched-Code-Towards-Unity/"" rel=""nofollow noreferrer"">Channel 9: 10 step-by-step videos on using Silverlight and Prism</a></p></li>
<li><p><a href=""http://www.codeproject.com/KB/WPF/IntroductionCompositeWPF.aspx"" rel=""nofollow noreferrer"">Codeplex: Introduction to Composite WPF (CAL, Prism): Part 1</a> (of n)</p></li>
</ul>
","2034333"
"MetadataException: Unable to load the specified metadata resource","357612","","<p>All of a sudden I keep getting a <code>MetadataException</code> on instantiating my generated <code>ObjectContext</code> class. The connection string in App.Config looks correct - hasn't changed since last it worked - and I've tried regenerating a new model (edmx-file) from the underlying database with no change.</p>

<p>Anyone have any ideas?</p>

<p>Further details: I haven't changed any properties, I haven't changed the name of any output assemblies, I haven't tried to embed the EDMX in the assembly. I've merely waited 10 hours from leaving work until I got back. And then it wasn't working anymore.</p>

<p>I've tried recreating the EDMX. I've tried recreating the project. I've even tried recreating the database, from scratch. No luck, whatsoever.</p>
","<p>This means that the application is unable to load the EDMX. There are several things which can cause this.</p>

<ul>
<li>You might have changed the MetadataArtifactProcessing property of the model to Copy to Output Directory.</li>
<li>The connection string could be wrong. I know you say you haven't changed it, but if you have changed other things (say, the name of an assembly), it could still be wrong.</li>
<li>You might be using a post-compile task to embed the EDMX in the assembly, which is no longer working for some reason.</li>
</ul>

<p>In short, there is not really enough detail in your question to give an accurate answer, but hopefully these ideas should get you on the right track.</p>

<p><strong>Update:</strong> I've written <a href=""http://www.craigstuntz.com/posts/2010-08-13-troubleshooting-entity-framework-connection-strings.html"" rel=""nofollow noreferrer"">a blog post with more complete steps for troubleshooting</a>.</p>
","689505"
"How can I add an item to a IEnumerable<T> collection?","357347","","<p>My question as title above. For example, </p>

<pre><code>IEnumerable&lt;T&gt; items = new T[]{new T(""msg"")};
items.ToList().Add(new T(""msg2""));
</code></pre>

<p>but after all it only has 1 item inside.</p>

<p>Can we have a method like <code>items.Add(item)</code>?</p>

<p>like the <code>List&lt;T&gt;</code></p>
","<p>You cannot, because <code>IEnumerable&lt;T&gt;</code> does not necessarily represent a collection to which items can be added. In fact, it does not necessarily represent a collection at all! For example:</p>

<pre><code>IEnumerable&lt;string&gt; ReadLines()
{
     string s;
     do
     {
          s = Console.ReadLine();
          yield return s;
     } while (s != """");
}

IEnumerable&lt;string&gt; lines = ReadLines();
lines.Add(""foo"") // so what is this supposed to do??
</code></pre>

<p>What you can do, however, is create a <em>new</em> <code>IEnumerable</code> object (of unspecified type), which, when enumerated, will provide all items of the old one, plus some of your own. You use <code>Enumerable.Concat</code> for that:</p>

<pre><code> items = items.Concat(new[] { ""foo"" });
</code></pre>

<p>This <em>will not change the array object</em> (you cannot insert items into to arrays, anyway). But it will create a new object that will list all items in the array, and then ""Foo"". Furthermore, that new object will <em>keep track of changes in the array</em> (i.e. whenever you enumerate it, you'll see the current values of items).</p>
","1210318"
"LINQ to read XML","356146","","<p>I got this XML file</p>

<pre><code>&lt;root&gt;
    &lt;level1 name=""A""&gt;
        &lt;level2 name=""A1"" /&gt;
        &lt;level2 name=""A2"" /&gt;
    &lt;/level1&gt;
    &lt;level1 name=""B""&gt;
        &lt;level2 name=""B1"" /&gt;
        &lt;level2 name=""B2"" /&gt;
    &lt;/level1&gt;
    &lt;level1 name=""C"" /&gt;
&lt;/root&gt;
</code></pre>

<p>Could someone give me a C# code using LINQ, the simplest way to print this result:<br>
(Note the extra space if it is a level2 node)</p>

<pre><code>A
  A1
  A2
B
  B1
  B2
C
</code></pre>

<p>Currently I got this code</p>

<pre><code>XDocument xdoc = XDocument.Load(""data.xml""));
var lv1s = from lv1 in xdoc.Descendants(""level1"")
           select lv1.Attribute(""name"").Value;

foreach (var lv1 in lv1s)
{
    result.AppendLine(lv1);

    var lv2s = from lv2 in xdoc...???
}
</code></pre>
","<p>Try this.</p>

<pre><code>void Main()
{
    StringBuilder result = new StringBuilder();

    //Load xml
    XDocument xdoc = XDocument.Load(""data.xml"");

    //Run query
    var lv1s = from lv1 in xdoc.Descendants(""level1"")
               select new { 
                   Header = lv1.Attribute(""name"").Value,
                   Children = lv1.Descendants(""level2"")
               };

    //Loop through results
    foreach (var lv1 in lv1s){
            result.AppendLine(lv1.Header);
            foreach(var lv2 in lv1.Children)
                 result.AppendLine(""     "" + lv2.Attribute(""name"").Value);
    }

    Console.WriteLine(result);
}
</code></pre>
","670569"
"How to convert an Stream into a byte[] in C#?","355428","","<p>Is there a simple way or method to convert an <code>Stream</code> into a <code>byte[]</code> in C#?</p>
","<p>Call next function like  </p>

<pre><code>byte[] m_Bytes = StreamHelper.ReadToEnd (mystream);
</code></pre>

<p>Function:</p>

<pre><code>public static byte[] ReadToEnd(System.IO.Stream stream)
    {
        long originalPosition = 0;

        if(stream.CanSeek)
        {
             originalPosition = stream.Position;
             stream.Position = 0;
        }

        try
        {
            byte[] readBuffer = new byte[4096];

            int totalBytesRead = 0;
            int bytesRead;

            while ((bytesRead = stream.Read(readBuffer, totalBytesRead, readBuffer.Length - totalBytesRead)) &gt; 0)
            {
                totalBytesRead += bytesRead;

                if (totalBytesRead == readBuffer.Length)
                {
                    int nextByte = stream.ReadByte();
                    if (nextByte != -1)
                    {
                        byte[] temp = new byte[readBuffer.Length * 2];
                        Buffer.BlockCopy(readBuffer, 0, temp, 0, readBuffer.Length);
                        Buffer.SetByte(temp, totalBytesRead, (byte)nextByte);
                        readBuffer = temp;
                        totalBytesRead++;
                    }
                }
            }

            byte[] buffer = readBuffer;
            if (readBuffer.Length != totalBytesRead)
            {
                buffer = new byte[totalBytesRead];
                Buffer.BlockCopy(readBuffer, 0, buffer, 0, totalBytesRead);
            }
            return buffer;
        }
        finally
        {
            if(stream.CanSeek)
            {
                 stream.Position = originalPosition; 
            }
        }
    }
</code></pre>
","1080445"
"DateTime ""null"" value","353617","","<p>I've been searching a lot but couldn't find a solution. How do you deal with a DateTime that should be able to contain an uninitialized value (equivalent to null)? I have a class which might have a DateTime property value set or not. I was thinking of initializing the property holder to DateTime.MinValue, which then could easily be checked. I guess this is a quite common question, how do you do that?</p>
","<p>For normal DateTimes,  if you don't initialize them at all then they will match <code>DateTime.MinValue</code>, because it is a value type rather than a reference type.</p>

<p>You can also use a nullable DateTime, like this:</p>

<pre><code>DateTime? MyNullableDate;
</code></pre>

<p>Or the longer form:</p>

<pre><code>Nullable&lt;DateTime&gt; MyNullableDate;
</code></pre>

<p>And, finally, there's a built in way to reference the default of any type.  This returns <code>null</code> for reference types, but for our DateTime example it will return the same as <code>DateTime.MinValue</code>:</p>

<pre><code>default(DateTime)
</code></pre>
","221740"
"C++ performance vs. Java/C#","352600","","<p>My understanding is that C/C++ produces native code to run on a particular machine architecture.  Conversely, languages like Java and C# run on top of a virtual machine which abstracts away the native architecture.  Logically it would seem impossible for Java or C# to match the speed of C++ because of this intermediate step, however I've been told that the latest compilers (""hot spot"") can attain this speed or even exceed it.</p>

<p>Perhaps this is more of a compiler question than a language question, but can anyone explain in plain English how it is possible for one of these virtual machine languages to perform better than a native language?</p>
","<p>Generally, C# and Java can be just as fast or faster because the JIT compiler -- a compiler that compiles your IL the first time it's executed -- can make optimizations that a C++ compiled program cannot because it can query the machine. It can determine if the machine is Intel or AMD; Pentium 4, Core Solo, or Core Duo; or if supports SSE4, etc.</p>

<p>A C++ program has to be compiled beforehand usually with mixed optimizations so that it runs decently well on all machines, but is not optimized as much as it could be for a single configuration (i.e. processor, instruction set, other hardware).</p>

<p>Additionally certain language features allow the compiler in C# and Java to make assumptions about your code that allows it to optimize certain parts away that just aren't safe for the C/C++ compiler to do. When you have access to pointers there's a lot of optimizations that just aren't safe.</p>

<p>Also Java and C# can do heap allocations more efficiently than C++ because the layer of abstraction between the garbage collector and your code allows it to do all of its heap compression at once (a fairly expensive operation).</p>

<p>Now I can't speak for Java on this next point, but I know that C# for example will actually remove methods and method calls when it knows the body of the method is empty. And it will use this kind of logic throughout your code.</p>

<p>So as you can see, there are lots of reasons why certain C# or Java implementations will be faster.</p>

<p>Now this all said, specific optimizations can be made in C++ that will blow away anything that you could do with C#, especially in the graphics realm and anytime you're close to the hardware. Pointers do wonders here.</p>

<p>So depending on what you're writing I would go with one or the other. But if you're writing something that isn't hardware dependent (driver, video game, etc), I wouldn't worry about the performance of C# (again can't speak about Java). It'll do just fine.</p>

<p>One the Java side, <a href=""https://stackoverflow.com/users/12682/swati"">@Swati</a> points out a good article:</p>

<p><a href=""https://www.ibm.com/developerworks/library/j-jtp09275/"" rel=""nofollow noreferrer"">https://www.ibm.com/developerworks/library/j-jtp09275</a></p>
","145122"
"Reading/writing an INI file","351915","","<p>Is there any class in the .NET framework that can read/write standard .ini files:</p>

<pre><code>[Section]
&lt;keyname&gt;=&lt;value&gt;
...
</code></pre>

<p>Delphi has the <code>TIniFile</code> component and I want to know if there is anything similar for C#? </p>
","<p>The creators of the .NET framework want you to use XML-based config files, rather than INI files. So no, there is no built-in mechanism for reading them.</p>

<p>There are third party solutions available, though.</p>

<ul>
<li>INI handlers can be obtained as <a href=""https://www.nuget.org/packages?q=ini"" rel=""noreferrer"">NuGet packages</a>, such as <a href=""https://www.nuget.org/packages/ini-parser/"" rel=""noreferrer"">INI Parser</a>.</li>
<li>You can write your own INI handler, which is the old-school, laborious way. It gives you more control over the implementation, which you can use for bad or good. See e.g. <a href=""http://www.codeproject.com/KB/cs/cs_ini.aspx"" rel=""noreferrer"">an INI file handling class using C#, P/Invoke and Win32</a>.</li>
</ul>
","217910"
"Sending email through Gmail SMTP server with C#","351632","","<p>For some reason neither the accepted answer nor any others work for me for ""<a href=""https://stackoverflow.com/questions/32260/sending-email-in-c-net-through-gmail"">Sending email in .NET through Gmail</a>"". Why would they not work?</p>

<p>UPDATE: I have tried all the answers (accepted and otherwise) in the other question, but none of them work.</p>

<p>I would just like to know if it works for anyone else, otherwise Google may have changed something (which has happened before).</p>

<p>When I try the piece of code that uses <code>SmtpDeliveryMethod.Network</code>, I quickly receive an SmtpException on Send(message). The message is </p>

<blockquote>
  <p>The SMTP server requires a secure connection or the client was not authenticated. </p>
</blockquote>

<p>The server response was: </p>

<blockquote>
  <p>5.5.1 Authentication Required. Learn more at"" &lt;-- seriously, it ends there.</p>
</blockquote>

<p><strong>UPDATE:</strong></p>

<p>This is a question that I asked a long time ago, and the accepted answer is code that I've used many, many times on different projects.</p>

<p>I've taken some of the ideas in this post and other EmailSender projects to create an <a href=""http://emailsender.codeplex.com/"" rel=""noreferrer"">EmailSender project at Codeplex</a>. It's designed for testability and supports my favourite SMTP services such as GoDaddy and Gmail. </p>
","<p>CVertex, make sure to review your code, and, if that doesn't reveal anything, post it. I was just enabling this on a test ASP.NET site I was working on, and it works. </p>

<p>Actually, at some point I had an issue on my code. I didn't spot it until I had a simpler version on a console program and saw it was working (no change on the Gmail side as you were worried about). The below code works just like the samples you referred to:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Mail;
using System.Net;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            var client = new SmtpClient(""smtp.gmail.com"", 587)
            {
                Credentials = new NetworkCredential(""myusername@gmail.com"", ""mypwd""),
                EnableSsl = true
            };
            client.Send(""myusername@gmail.com"", ""myusername@gmail.com"", ""test"", ""testbody"");
            Console.WriteLine(""Sent"");
            Console.ReadLine();
        }
    }
}
</code></pre>

<p>I also got it working using a combination of web.config, <a href=""http://msdn.microsoft.com/en-us/library/w355a94k.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/w355a94k.aspx</a> and code (because there is no matching <code>EnableSsl</code> in the configuration file :( ).</p>
","707892"
"How can I convert a hex string to a byte array?","349936","","<p>Can we convert a hex string to a byte array using a built-in function in C# or do I have to make a custom method for this?</p>
","<p>Here's a nice fun LINQ example.</p>

<pre><code>public static byte[] StringToByteArray(string hex) {
    return Enumerable.Range(0, hex.Length)
                     .Where(x =&gt; x % 2 == 0)
                     .Select(x =&gt; Convert.ToByte(hex.Substring(x, 2), 16))
                     .ToArray();
}
</code></pre>
","321404"
"How to edit a JavaScript alert box title?","349453","","<p>I'm generating a JavaScript alert with following code in C# .NET page:</p>

<pre><code>Response.Write(""&lt;script language=JavaScript&gt; alert('Hi select a valid date'); &lt;/script&gt;"");
</code></pre>

<p>It displays an alert box with the heading title as ""Message from webpage"".</p>

<p>Is it possible to modify the title?</p>
","<p>Sigh...no you can't.</p>

<p>Its a security/anti-phishing feature.</p>
","1905340"
"How do I get the directory from a file's full path?","347695","","<p>What is the simplest way to get the directory that a file is in? I'm using this to set a working directory.</p>

<pre><code>string filename = @""C:\MyDirectory\MyFile.bat"";
</code></pre>

<p>In this example, I should get ""C:\MyDirectory"".</p>
","<p>If you've definitely got an absolute path, use <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx"" rel=""noreferrer""><code>Path.GetDirectoryName(path)</code></a>.</p>

<p>If you might only get a relative name, use <code>new FileInfo(path).Directory.FullName</code>.</p>

<p>Note that <code>Path</code> and <code>FileInfo</code> are both found in the namespace <code>System.IO</code>.</p>
","674495"
"How does one parse XML files?","347672","","<p>Is there a simple method of parsing XML files in C#? If so, what?</p>
","<p>I'd use <a href=""https://msdn.microsoft.com/en-us/library/mt693062.aspx"" rel=""noreferrer"">LINQ to XML</a> if you're in .NET 3.5 or higher.</p>
","55829"
"""The Controls collection cannot be modified because the control contains code blocks""","347600","","<p>I am trying to create a simple user control that is a slider.  When I add a AjaxToolkit SliderExtender to the user control I get this (*&amp;$#()@# error:</p>

<pre>
    Server Error in '/' Application. The Controls collection cannot be modified because the control contains code blocks (i.e. ``). Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

    Exception Details: System.Web.HttpException: The Controls collection cannot be modified because the control contains code blocks (i.e. ``).

    Source Error:

    An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

    Stack Trace:

    [HttpException (0x80004005): The Controls collection cannot be modified because the control contains code blocks (i.e. ``).]    System.Web.UI.ControlCollection.Add(Control child) +8677431    AjaxControlToolkit.ScriptObjectBuilder.RegisterCssReferences(Control control) in d:\E\AjaxTk-AjaxControlToolkit\Release\AjaxControlToolkit\ExtenderBase\ScriptObjectBuilder.cs:293 AjaxControlToolkit.ExtenderControlBase.OnLoad(EventArgs e) in d:\E\AjaxTk-AjaxControlToolkit\Release\AjaxControlToolkit\ExtenderBase\ExtenderControlBase.cs:306 System.Web.UI.Control.LoadRecursive()
    +50    System.Web.UI.Control.LoadRecursive()
    +141    System.Web.UI.Control.LoadRecursive()
    +141    System.Web.UI.Control.LoadRecursive()
    +141    System.Web.UI.Control.LoadRecursive()             
    +141    System.Web.UI.Control.LoadRecursive()
    +141    System.Web.UI.Control.LoadRecursive()
    +141    System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627


    Version Information: Microsoft .NET Framework Version:2.0.50727.3074; ASP.NET Version:2.0.50727.3074
</pre>

<p>I have tried putting a placeholder in the user control and adding the textbox and slider extender to the placeholder programmatically and I still get the error.</p>

<p>Here is the simple code:</p>

<pre><code>&lt;table cellpadding=""0"" cellspacing=""0"" style=""width:100%""&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;asp:Label ID=""lblMaxValue"" runat=""server"" Text=""Maximum"" CssClass=""float_right"" /&gt;
                &lt;asp:Label ID=""lblMinValue"" runat=""server"" Text=""Minimum"" /&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td style=""width:60%;""&gt;
                &lt;asp:CheckBox ID=""chkOn"" runat=""server"" /&gt;&lt;asp:Label ID=""lblPrefix"" runat=""server"" /&gt;:&amp;nbsp;&lt;asp:Label ID=""lblSliderValue"" runat=""server"" /&gt;&amp;nbsp;&lt;asp:Label ID=""lblSuffix"" runat=""server"" /&gt;
            &lt;/td&gt;
            &lt;td style=""text-align:right;width:40%;""&gt;                

                    &lt;asp:TextBox ID=""txtSlider"" runat=""server"" Text=""50"" style=""display:none;"" /&gt;
                    &lt;ajaxToolkit:SliderExtender ID=""seSlider"" runat=""server"" 
                        BehaviorID=""seSlider"" 
                        TargetControlID=""txtSlider"" 
                        BoundControlID=""lblSliderValue"" 
                        Orientation=""Horizontal"" 
                        EnableHandleAnimation=""true"" 
                        Length=""200"" 
                        Minimum=""0"" 
                        Maximum=""100"" 
                        Steps=""1"" /&gt;

            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
</code></pre>

<p>What is the problem?</p>
","<p>First, start the code block with &lt;%#  instead of &lt;%=  :</p>

<pre><code>&lt;head id=""head1"" runat=""server""&gt;
  &lt;title&gt;My Page&lt;/title&gt;
  &lt;link href=""css/common.css"" rel=""stylesheet"" type=""text/css"" /&gt;
  &lt;script type=""text/javascript"" src=""&lt;%# ResolveUrl(""~/javascript/leesUtils.js"") %&gt;""&gt;&lt;/script&gt;
&lt;/head&gt;
</code></pre>

<p>This changes the code block from a Response.Write code block to a databinding expression.<br>
Since <code>&lt;%# ... %&gt;</code> databinding expressions aren't code blocks, the CLR won't complain. Then in the code for the master page, you'd add the following:</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{
  Page.Header.DataBind();    
}
</code></pre>
","1176779"
"Gmail Error :The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required","347189","","<p>I am using following code to send email. The Code works correctly in my local Machine. But on Production server i am getting the error message</p>

<pre><code>        var fromAddress = new MailAddress(""mymailid@gmail.com"");
        var fromPassword = ""xxxxxx"";
        var toAddress = new MailAddress(""yourmailid@yourdoamain.com"");

        string subject = ""subject"";
        string body = ""body"";

        System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient
        {
            Host = ""smtp.gmail.com"",
            Port = 587,
            EnableSsl = true,
            DeliveryMethod = System.Net.Mail.SmtpDeliveryMethod.Network,
            UseDefaultCredentials = false,
            Credentials = new NetworkCredential(fromAddress.Address, fromPassword)

        };

        using (var message = new MailMessage(fromAddress, toAddress)
        {
            Subject = subject,
            Body = body
        })


        smtp.Send(message);
</code></pre>

<p>And on my Gmail A/c I have received the following email after i ran the code from production server</p>

<blockquote>
  <p>Hi , </p>
  
  <p>Someone recently used your password to try to sign in to your Google
  Account mymailid@gmail.com. This person was using an application such
  as an email, client or mobile device. </p>
  
  <p>We prevented the sign-in attempt in case this was a hijacker trying to
  access your account. Please review the details of the sign-in attempt:</p>
  
  <p>Friday, 3 January 2014 13:56:08 o'clock UTC  IP Address: xxx.xx.xx.xxx
  (abcd.net.)  Location: Philadelphia PA, Philadelphia, PA, USA</p>
  
  <p>If you do not recognise this sign-in attempt, someone else might be
  trying to access your account. You should sign in to your account and
  reset your password immediately. </p>
  
  <p>Reset password  </p>
  
  <p>If this was you and you are having trouble accessing your account,
  complete the troubleshooting steps listed at
  <a href=""http://support.google.com/mail?p=client_login"">http://support.google.com/mail?p=client_login</a> </p>
  
  <p>Yours sincerely, The Google Accounts team</p>
</blockquote>
","<p>This generally happens when you try login from different time zone or IP Address Computer. Your production server and the mail id you have used both are in different time zone. Choose any of the one solution:</p>

<p>1) Log in to production server via remote access, and sign in to gmail once with your credentials. They will ask for the confirmation, confirm it and log out.</p>

<p>Or 2) log in gmail to your local computer, Follow this <a href=""https://support.google.com/accounts/answer/1144110?hl=en"" rel=""noreferrer"">Link</a> and choose <a href=""https://security.google.com/settings/security/activity"" rel=""noreferrer"">review this activity</a> and take proper actions.</p>
","20906573"
"DropDownList in MVC 4 with Razor","345648","","<p>I'm trying to create a <code>DropDownList</code> on a razor view.</p>

<p>Would someone help me with this?</p>

<p><strong>Normal HTML5 code:</strong></p>

<pre><code>&lt;select id=""dropdowntipo""&gt;
    &lt;option value=""Exemplo1""&gt;Exemplo1&lt;/option&gt;
    &lt;option value=""Exemplo2""&gt;Exemplo2&lt;/option&gt;
    &lt;option value=""Exemplo3""&gt;Exemplo3&lt;/option&gt;
&lt;/select&gt;
</code></pre>

<p>I tried this:</p>

<pre><code>@{
    var listItems = new List&lt;ListItem&gt; { 
        new ListItem { Text = ""Exemplo1"", Value = ""Exemplo1"" }, 
        new ListItem { Text = ""Exemplo2"", Value = ""Exemplo2"" }, 
        new ListItem { Text = ""Exemplo3"", Value = ""Exemplo3"" } 
    };
}

@Html.DropDownListFor(model =&gt; 
    model.tipo, 
    new SelectList(listItems), 
    ""-- Select Status --""
)
</code></pre>
","<pre><code>@{
   List&lt;SelectListItem&gt; listItems= new List&lt;SelectListItem&gt;();
   listItems.Add(new SelectListItem
        {
          Text = ""Exemplo1"",
          Value = ""Exemplo1""
        });
   listItems.Add(new SelectListItem
        {
            Text = ""Exemplo2"",
            Value = ""Exemplo2"",
            Selected = true
        });
   listItems.Add(new SelectListItem
        {
            Text = ""Exemplo3"",
            Value = ""Exemplo3""
        });
}

@Html.DropDownListFor(model =&gt; model.tipo, listItems, ""-- Select Status --"")
</code></pre>
","17727558"
"Rename a file in C#","344955","","<p>How do I rename a file using C#?</p>
","<p>Take a look at <a href=""http://msdn.microsoft.com/en-us/library/system.io.file.move.aspx"" rel=""noreferrer"">System.IO.File.Move</a>, ""move"" the file to a new name.</p>

<pre><code>System.IO.File.Move(""oldfilename"", ""newfilename"");
</code></pre>
","3218923"
"Can I escape a double quote in a verbatim string literal?","344065","","<p>In a verbatim string literal (@""foo"") in C#, backslashes aren't treated as escapes, so doing \"" to get a double quote doesn't work. Is there any way to get a double quote in a verbatim string literal?</p>

<p>This understandably doesn't work:</p>

<pre><code>string foo = @""this \""word\"" is escaped"";
</code></pre>
","<p>Use a duplicated double quote.</p>

<pre><code>@""this """"word"""" is escaped"";
</code></pre>

<p>outputs:</p>

<pre class=""lang-none prettyprint-override""><code>this ""word"" is escaped
</code></pre>
","1928916"
"Showing Difference between two datetime values in hours","343733","","<p>I am retrieving two date time values from the database. Once the value is retrieved, I need the difference between the two values.
For that, I create a timespan variable to store the difference of the 2 date values.</p>

<pre><code>TimeSpan? variable = datevalue1 - datevalue2;
</code></pre>

<p>Now i need to show the difference which is stored in the Timespan variable in terms of number of hours.
I referred to <a href=""http://msdn.microsoft.com/en-us/library/system.timespan.totalhours.aspx"">TimeSpan.TotalHours</a> but couldn't apply the same for some reason.
How do I do that?
I am using C# on a MVC project. I simple need to show the difference value in hours?</p>

<p><strong>EDIT:
Since timespan was nullable, i couldn't use the total hours property. Now I can use it by doing TimeSpanVal.Value.TotalHours</strong>;</p>
","<p>I think you're confused because you haven't declared a <code>TimeSpan</code> you've declared a <code>TimeSpan?</code> which is a <a href=""http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.80).aspx"" rel=""noreferrer"">nullable</a> <code>TimeSpan</code>. Either remove the question mark if you don't need it to be nullable or use <code>variable.Value.TotalHours</code>.</p>
","4946390"
"How to solve Object reference not set to an instance of an object.?","343041","","<p>In my asp.net program.I set one protected list.And i add a value in list.But it shows Object reference not set to an instance of an object error</p>

<pre><code>protected List&lt;string&gt; list;
protected void Page_Load(object sender, EventArgs e)
{
     list.Add(""hai"");
}
</code></pre>

<p>How to solve this error?</p>
","<p>You need to initialize the list first:</p>

<pre><code>protected List&lt;string&gt; list = new List&lt;string&gt;();
</code></pre>
","20140076"
"Get a new object instance from a Type","342866","","<p>One may not always know the Type of an object at compile-time, but may need to create an instance of the Type.  How do you get a new object instance from a Type?</p>
","<p>The <code>Activator</code> class within the root <code>System</code> namespace is pretty powerful.</p>

<p>There are a lot of overloads for passing parameters to the constructor and such. Check out the documentation at: </p>

<blockquote>
  <p><a href=""http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx</a></p>
</blockquote>

<p>or (new path)</p>

<blockquote>
  <p><a href=""https://docs.microsoft.com/en-us/dotnet/api/system.activator.createinstance"" rel=""noreferrer"">https://docs.microsoft.com/en-us/dotnet/api/system.activator.createinstance</a></p>
</blockquote>

<p>Here are some simple examples:</p>

<pre><code>ObjectType instance = (ObjectType)Activator.CreateInstance(objectType);

ObjectType instance = (ObjectType)Activator.CreateInstance(""MyAssembly"",""MyNamespace.ObjectType"");
</code></pre>
","755"
"Best practice to save application settings in a Windows Forms Application","341533","","<p>What I want to achieve is very simple: I have a Windows Forms (.NET 3.5) application that uses a path for reading information. This path can be modified by the user, by using the options form I provide.</p>

<p>Now, I want to save the path value to a file for later use. This would be one of the many settings saved to this file. This file would sit directly in the application folder.</p>

<p>I understand three options are available:</p>

<ul>
<li>ConfigurationSettings file (appname.exe.config)</li>
<li>Registry</li>
<li>Custom XML file</li>
</ul>

<p>I read that the .NET configuration file is not foreseen for saving values back to it.
As for the registry, I would like to get as far away from it as possible.</p>

<p>Does this mean that I should use a custom XML file to save configuration settings?
If so, I would like to see code example of that (C#).</p>

<p>I have seen other discussions on this subject, but it is still not clear to me.</p>
","<p>If you work with Visual Studio then it is pretty easy to get persistable settings. Right click on the project in Solution Explorer, choose Properties. Select the Settings tab, click on the hyperlink if settings doesn't exist. Use the Settings tab to create application settings. Visual Studio creates the files <code>Settings.settings</code> and <code>Settings.Designer.settings</code> that contain the singleton class <code>Settings</code> inherited from  <a href=""http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.aspx"" rel=""noreferrer"">ApplicationSettingsBase</a>. You can access this class from your code to read/write application settings:</p>

<pre><code>Properties.Settings.Default[""SomeProperty""] = ""Some Value"";
Properties.Settings.Default.Save(); // Saves settings in application configuration file
</code></pre>

<p>This technique is applicable both for console, Windows Forms and other project types.</p>

<p>Note that you need to set the <em>scope</em> property of your settings. If you select Application scope then Settings.Default.&lt; your property > will be read-only.</p>
","453230"
"get dictionary key by value","341212","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/255341/getting-key-of-value-of-a-generic-dictionary"">Getting key of value of a generic Dictionary?</a>  </p>
</blockquote>



<p>How do I get a Dictionary key by value in C#?</p>

<pre><code>Dictionary&lt;string, string&gt; types = new Dictionary&lt;string, string&gt;()
{
            {""1"", ""one""},
            {""2"", ""two""},
            {""3"", ""three""}
};
</code></pre>

<p>I want something like this:</p>

<pre><code>getByValueKey(string value);
</code></pre>

<p><code>getByValueKey(""one"")</code> must be return <code>""1""</code>.</p>

<p>What is the best way do this? Maybe HashTable, SortedLists?</p>
","<p>Values not necessarily have to be unique so you have to do a lookup. You can do something like this:</p>

<pre><code>var myKey = types.FirstOrDefault(x =&gt; x.Value == ""one"").Key;
</code></pre>

<p>If values are unique and are inserted less frequently than read, then create an inverse dictionary where values are keys and keys are values.</p>
","2444064"
"How to stop C# console applications from closing automatically?","338839","","<p>My console applications on Visual Studio are closing automatically, so I'd like to use something like C's <code>system(""PAUSE"")</code> to ""pause"" the applications at the end of its execution, how can I achieve that? </p>
","<pre><code>Console.ReadLine();
</code></pre>

<p>or </p>

<pre><code>Console.ReadKey();
</code></pre>

<p><a href=""http://www.google.at/url?sa=t&amp;rct=j&amp;q=msdn%20console.readline&amp;source=web&amp;cd=1&amp;ved=0CF0QFjAA&amp;url=http://msdn.microsoft.com/en-us/library/system.console.readline.aspx&amp;ei=TYcEULiaJrP44QTu67yvCA&amp;usg=AFQjCNFMXhCW9ehvUKRE3oSY4hDHnpeX8Q"" rel=""noreferrer""><code>ReadLine()</code></a> waits for <kbd>↩</kbd>, <a href=""http://www.google.at/url?sa=t&amp;rct=j&amp;q=msdn%20console.readkey&amp;source=web&amp;cd=1&amp;ved=0CFkQFjAA&amp;url=http://msdn.microsoft.com/en-us/library/system.console.readkey.aspx&amp;ei=f4cEUPfwCcOn4gTJrt2TCA&amp;usg=AFQjCNEzY4-zX-qXR8RLKZW-9_xbT2uxxQ"" rel=""noreferrer""><code>ReadKey()</code></a> waits for any key (except for modifier keys).</p>

<p><em>Edit: stole the key symbol from Darin.</em></p>
","11512831"
"how to update the value stored in Dictionary in C#?","338586","","<p>How to update value for a specific key in a dictionary <code>Dictionary&lt;string, int&gt;</code>?</p>
","<p>Just point to the dictionary at given key and assign a new value:</p>

<pre><code>myDictionary[myKey] = myNewValue;
</code></pre>
","1243724"
"An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode","337276","","<p>I Installed DotNetOpenAuth SDK-3.4.5.10201.vsix and I can't get it working.
It works locally (when I run as localhost) but when i try to publish it ain't working. </p>

<p>The IIS error message I get is </p>

<blockquote>
  <p>Error Summary<br>
    HTTP Error 500.22 - Internal Server Error<br>
    An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode.</p>
</blockquote>

<p>AND</p>

<blockquote>
<pre><code>Module       ConfigurationValidationModule  
Notification BeginRequest  
Handler      StaticFile  
Error Code   0x80070032  
</code></pre>
</blockquote>

<p>then there are some suggestions on how to solve the problem:</p>

<p>Things you can try:</p>

<blockquote>
  <ul>
  <li><p>Migrate the configuration to the
     <code>system.webServer/modules</code> section. You
     can do so manually or by using AppCmd
     from the command line - for example,
     <code>%SystemRoot%\system32\inetsrv\appcmd
     migrate config ""Default Web Site/""</code>.
     Using <code>AppCmd</code> to migrate your
     application will enable it to work in
     Integrated mode, and continue to work
     in Classic mode and on previous
     versions of IIS.</p></li>
  <li><p>If you are certain that it is OK to
     ignore this error, it can be disabled
     by setting
     <code>system.webServer/validation@validateIntegratedModeConfiguration</code>
     to false.  </p></li>
  <li><p>Alternatively, switch the application
     to a Classic mode application pool -
     for example,
     <code>%SystemRoot%\system32\inetsrv\appcmd
     set app ""Default Web Site/""
     /applicationPool:""Classic .NET
     AppPool""</code>. Only do this if you are
     unable to migrate your application.<br>
     (Set ""Default Web Site"" and ""Classic .NET AppPool"" to your application path and application pool name)</p></li>
  </ul>
</blockquote>

<p>But the problem is that I don't have access to the ISS server as I am not the owner of it. Is there any way to solve this?</p>
","<p>The 2<sup>nd</sup> option is the one you want.</p>

<p>In your <code>web.config</code>, make sure these keys exist:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;configuration&gt;
    &lt;system.webServer&gt;
        &lt;validation validateIntegratedModeConfiguration=""false""/&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;
</code></pre>
","4210026"
"How do I force my .NET application to run as administrator?","336356","","<p>Once my program is installed on a client machine, how do I force my program to run as an administrator on Windows 7?</p>
","<p>You'll want to modify the manifest that gets embedded in the program. This works on Visual&nbsp;Studio&nbsp;2008 and higher: Project + Add New Item, select ""Application Manifest File"". Change the <code>&lt;requestedExecutionLevel&gt;</code> element to:</p>

<pre><code> &lt;requestedExecutionLevel level=""requireAdministrator"" uiAccess=""false"" /&gt;
</code></pre>

<p>The user gets the <a href=""http://en.wikipedia.org/wiki/User_Account_Control"" rel=""noreferrer"">UAC</a> prompt when they start the program. Use wisely; their patience can wear out quickly.</p>
","2818776"
"How do I initialize an empty array in C#?","336133","","<p>Is it possible to create an empty array without specifying the size?</p>

<p>For example, I created:</p>

<pre><code>String[] a = new String[5];
</code></pre>

<p>Can we create the above string array without the size?</p>
","<p>If you are going to use a collection that you don't know the size of in advance, there are better options than arrays.</p>

<p>Use a <code>List&lt;string&gt;</code> instead - it will allow you to add as many items as you need and if you need to return an array, call <code>ToArray()</code> on the variable.</p>

<pre><code>var listOfStrings = new List&lt;string&gt;();

// do stuff...

string[] arrayOfStrings = listOfStrings.ToArray();
</code></pre>

<p>If you <em>must</em> create an empty array you can do this:</p>

<pre><code>string[] emptyStringArray = new string[0]; 
</code></pre>
","8727172"
"Input string was not in a correct format","335656","","<p>I'm new with C#, I have some basic knowledge in Java but I can't get this code to run properly.</p>

<p>It's just a basic calculator, but when I run the program VS2008 gives me this error:</p>

<p><img src=""https://i.stack.imgur.com/yWpBd.png"" alt=""Calculator""></p>

<p>I did almost the same program but in java using JSwing and it worked perfectly.</p>

<p>Here's the form of c#:</p>

<p><img src=""https://i.stack.imgur.com/u26pk.png"" alt=""Form""></p>

<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace calculadorac
{
    public partial class Form1 : Form
    {

    int a, b, c;
    String resultado;

    public Form1()
    {
        InitializeComponent();
        a = Int32.Parse(textBox1.Text);
        b = Int32.Parse(textBox2.Text);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        add();
        result();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        substract();
        result();
    }

    private void button3_Click(object sender, EventArgs e)
    {
        clear();
    }

    private void add()
    {
        c = a + b;
        resultado = Convert.ToString(c);
    }

    private void substract()
    {
        c = a - b;
        resultado = Convert.ToString(c);
    }

    private void result()
    {
        label1.Text = resultado;
    }

    private void clear()
    {
        label1.Text = """";
        textBox1.Text = """";
        textBox2.Text = """";
    }
}
</code></pre>

<p>What can be the problem? Is there a way to solve it?</p>

<p>PS: I also tried</p>

<pre><code>a = Convert.ToInt32(textBox1.text);
b = Convert.ToInt32(textBox2.text);
</code></pre>

<p>and it didn't work.</p>
","<p>The error means that the string you're trying to parse an integer from doesn't actually contain a valid integer.</p>

<p>It's extremely unlikely that the text boxes will contain a valid integer immediately when the form is created - which is where you're getting the integer values.  It would make much more sense to update <code>a</code> and <code>b</code> in the button click events (in the same way that you are in the constructor).  Also, check out the <a href=""http://msdn.microsoft.com/en-us/library/f02979c7.aspx"" rel=""noreferrer""><code>Int.TryParse</code></a> method - it's much easier to use if the string might not actually contain an integer - it doesn't throw an exception so it's easier to recover from.</p>
","8321527"
"How to post data to specific URL using WebClient in C#","335606","","<p>I need to use ""HTTP Post"" with WebClient to post some data to a specific URL I have.</p>

<p>Now, I know this can be accomplished with WebRequest but for some reasons I wanna use WebClient instead. Is that possible? If so, can someone show me some example or point me to the right direction?</p>
","<p>I just found the solution and yea it was easier than I thought :)</p>

<p>so here is the solution:      </p>

<pre><code>string URI = ""http://www.myurl.com/post.php"";
string myParameters = ""param1=value1&amp;param2=value2&amp;param3=value3"";

using (WebClient wc = new WebClient())
{
    wc.Headers[HttpRequestHeader.ContentType] = ""application/x-www-form-urlencoded"";
    string HtmlResult = wc.UploadString(URI, myParameters);
}
</code></pre>

<p>it works like charm :)</p>
","5401597"
"Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on","334808","","<p>I have a scenario. (Windows Forms, C#, .NET)</p>

<ol>
<li>There is a main form which hosts some user control.</li>
<li>The user control does some heavy data operation, such that if I directly call the <code>UserControl_Load</code> method the UI become nonresponsive for the duration for load method execution.</li>
<li>To overcome this I load data on different thread (trying to change existing code as little as I can)  </li>
<li>I used a background worker thread which will be loading the data and when done will notify the application that it has done its work.  </li>
<li>Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I'm fetching data based on the values of some control (like textbox) on userControl. </li>
</ol>

<p>The pseudocode would look like this:</p>

<p><strong>CODE 1</strong></p>

<pre><code>UserContrl1_LoadDataMethod()
{
    if (textbox1.text == ""MyName"") // This gives exception
    {
        //Load data corresponding to ""MyName"".
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage.
    }
}
</code></pre>

<p>The Exception it gave was</p>

<blockquote>
  <p>Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.</p>
</blockquote>

<p>To know more about this I did some googling and a suggestion came up like using the following code</p>

<p><strong>CODE 2</strong></p>

<pre><code>UserContrl1_LoadDataMethod()
{
    if (InvokeRequired) // Line #1
    {
        this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod));
        return;
    }

    if (textbox1.text == ""MyName"") // Now it wont give an exception
    {
    //Load data correspondin to ""MyName""
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage
    }
}
</code></pre>

<p>BUT BUT BUT... it seems I'm back to square one. The Application again 
become nonresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.</p>

<p>I don't know whether I perceived this right or wrong. I'm new to threading.</p>

<p>How do I resolve this and also what is the effect of execution of Line#1 if block?</p>

<p><strong>The situation is this</strong>: I want to load data into a global variable based on the value of a control. I don't want to change the value of a control from the child thread. I'm not going to do it ever from a child thread. </p>

<p>So only accessing the value so that the corresponding data can be fetched from the database.</p>
","<p>As per <a href=""https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the#142108"">Prerak K's update comment</a> (since deleted):</p>

<blockquote>
  <p>I guess I have not presented the question properly.</p>
  
  <p>Situation is this: I want to load data into a global variable based on the value of a control. I don't want to change the value of a control from the child thread. I'm not going to do it ever from a child thread.</p>
  
  <p>So only accessing the value so that corresponding data can be fetched from the database.</p>
</blockquote>

<p>The solution you want then should look like:</p>

<pre><code>UserContrl1_LOadDataMethod()
{
    string name = """";
    if(textbox1.InvokeRequired)
    {
        textbox1.Invoke(new MethodInvoker(delegate { name = textbox1.text; }));
    }
    if(name == ""MyName"")
    {
        // do whatever
    }
}
</code></pre>

<p>Do your serious processing in the separate thread <em>before</em> you attempt to switch back to the control's thread. For example:</p>

<pre><code>UserContrl1_LOadDataMethod()
{
    if(textbox1.text==""MyName"") //&lt;&lt;======Now it wont give exception**
    {
        //Load data correspondin to ""MyName""
        //Populate a globale variable List&lt;string&gt; which will be
        //bound to grid at some later stage
        if(InvokeRequired)
        {
            // after we've done all the processing, 
            this.Invoke(new MethodInvoker(delegate {
                // load the control with the appropriate data
            }));
            return;
        }
    }
}
</code></pre>
","142069"
"Reading a key from the Web.Config using ConfigurationManager","334734","","<p>I am trying to read the keys from the <code>Web.config</code> file in a different layer than the web layer (Same solution)</p>

<p>Here is what I am trying:</p>

<pre><code>string userName = System.Configuration.ConfigurationManager.AppSettings[""PFUserName""];
string password = System.Configuration.ConfigurationManager.AppSettings[""PFPassWord""];
</code></pre>

<p>And here is my <code>appSettings</code> in the <code>Web.config</code> file:</p>

<pre><code>&lt;configuration&gt;
   ....
   &lt;appSettings&gt;
      &lt;add key=""PFUserName"" value=""myusername""/&gt;
      &lt;add key=""PFPassWord"" value=""mypassword""/&gt;
   &lt;/appSettings&gt;
   ....
&lt;/configuration&gt;
</code></pre>

<p>When I debug the code <code>username</code> and <code>password</code> are just <code>null</code>, so it is not getting the value of the keys.</p>

<p>What am I doing wrong to read these values?</p>
","<p>Try using the WebConfigurationManager class instead. For example:</p>

<pre><code>string userName = WebConfigurationManager.AppSettings[""PFUserName""]
</code></pre>
","4595323"
"What does the [Flags] Enum Attribute mean in C#?","334274","","<p>From time to time I see an enum like the following:</p>

<pre><code>[Flags]
public enum Options 
{
    None    = 0,
    Option1 = 1,
    Option2 = 2,
    Option3 = 4,
    Option4 = 8
}
</code></pre>

<p>I don't understand what exactly the <code>[Flags]</code>-attribute does.</p>

<p>Anyone have a good explanation or example they could post?</p>
","<p>The flags attribute should be used whenever the enumerable represents a collection of flags, rather than a single value. Such collections are usually manipulated using bitwise operators, for example:</p>

<pre><code>myProperties.AllowedColors = MyColor.Red | MyColor.Green | MyColor.Blue;
</code></pre>

<p>Note that <code>[Flags]</code> by itself doesn't change this <strong>at all</strong> - all it does is enable a nice representation by the <code>.ToString()</code> method:</p>

<pre><code>enum Suits { Spades = 1, Clubs = 2, Diamonds = 4, Hearts = 8 }
[Flags] enum SuitsFlags { Spades = 1, Clubs = 2, Diamonds = 4, Hearts = 8 }

...

var str1 = (Suits.Spades | Suits.Diamonds).ToString();
           // ""5""
var str2 = (SuitsFlags.Spades | SuitsFlags.Diamonds).ToString();
           // ""Spades, Diamonds""
</code></pre>

<p>It is also important to note that <code>[Flags]</code> <strong>does not</strong> automatically make the enum values powers of two. If you omit the numeric values, the enum will not work as one might expect in bitwise operations, because by default the values start with 0 and increment. </p>

<p>Incorrect declaration:</p>

<pre><code>[Flags]
public enum MyColors
{
    Yellow,
    Green,
    Red,
    Blue
}
</code></pre>

<p>The values, if declared this way, will be Yellow = 0, Green = 1, Red = 2, Blue = 3.  This will render it useless for use as flags.</p>

<p>Here's an example of a correct declaration:</p>

<pre><code>[Flags]
public enum MyColors
{
    Yellow = 1,
    Green = 2,
    Red = 4,
    Blue = 8
}
</code></pre>

<p>To retrieve the distinct values in your property, one can do this:</p>

<pre><code>if((myProperties.AllowedColors &amp; MyColor.Yellow) == MyColor.Yellow)
{
    // Yellow has been set...
}

if((myProperties.AllowedColors &amp; MyColor.Green) == MyColor.Green)
{
    // Green has been set...
}    
</code></pre>

<p>or, in .NET 4 and later:</p>

<pre><code>if (myProperties.AllowedColors.HasFlag(MyColor.Yellow))
{
    // Yellow has been set...
}
</code></pre>

<p><strong>Under the covers</strong></p>

<p>This works because you previously used powers of two in your enumeration. Under the covers, your enumeration values look like this (presented as bytes, which has 8 bits which can be 1's or 0's)</p>

<pre><code> Yellow: 00000001
 Green:  00000010
 Red:    00000100
 Blue:   00001000
</code></pre>

<p>Likewise, after you've set your property <em>AllowedColors</em> to Red, Green and Blue (which values where OR'ed by the pipe |), <em>AllowedColors</em> looks like this</p>

<pre><code>myProperties.AllowedColors: 00001110
</code></pre>

<p>So when you retrieve the value you are actually bitwise AND'ing the values</p>

<pre><code>myProperties.AllowedColors: 00001110
             MyColor.Green: 00000010
             -----------------------
                            00000010 // Hey, this is the same as MyColor.Green!
</code></pre>

<p><strong>The None = 0 value</strong></p>

<p>And regarding use 0 in you enumeration, quoting from msdn:</p>

<pre><code>[Flags]
public enum MyColors
{
    None = 0,
    ....
}
</code></pre>

<blockquote>
  <p>Use None as the name of the flag enumerated constant whose value is zero. <strong>You cannot use the None enumerated constant in a bitwise AND operation to test for a flag because the result is always zero.</strong> However, you can perform a logical, not a bitwise, comparison between the numeric value and the None enumerated constant to determine whether any bits in the numeric value are set. </p>
</blockquote>

<p>You can find more info about the flags attribute and its usage at <a href=""http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx"" rel=""noreferrer"">msdn</a> and <a href=""http://msdn.microsoft.com/en-us/library/ms229062.aspx"" rel=""noreferrer"">designing flags at msdn</a></p>
","8480"
"How can I get the assembly file version","333848","","<p>In <code>AssemblyInfo</code> there are two assembly versions:</p>

<ol>
<li><code>AssemblyVersion</code>: Specify the version of the assembly being attributed.</li>
<li><code>AssemblyFileVersion</code>: Instructs a compiler to use a specific version number for the Win32 file version resource. The Win32 file version is not required to be the same as the assembly's version number.</li>
</ol>

<p>I can get the <code>Assembly Version</code> with the following line of code:</p>

<pre><code>Version version = Assembly.GetEntryAssembly().GetName().Version;
</code></pre>

<p>But how can I get the <code>Assembly File Version</code>?</p>
","<p>See my comment above asking for clarification on what you really want. Hopefully this is it:</p>

<pre><code>System.Reflection.Assembly assembly = System.Reflection.Assembly.GetExecutingAssembly();
FileVersionInfo fvi = FileVersionInfo.GetVersionInfo(assembly.Location);
string version = fvi.FileVersion;
</code></pre>
","909583"
"decimal vs double! - Which one should I use and when?","333464","","<p>I keep seeing people using doubles in C#. I know I read somewhere that doubles sometimes lose precision. 
My question is when should a use a double and when should I use a decimal type?
Which type is suitable for money computations? (ie. greater than $100 million)</p>
","<p>For money, <strong>always</strong> decimal. It's why it was created.</p>

<p>If numbers must add up correctly or balance, use decimal. This includes any financial storage or calculations, scores, or other numbers that people might do by hand.</p>

<p>If the exact value of numbers is not important, use double for speed. This includes graphics, physics or other physical sciences computations where there is already a ""number of significant digits"".</p>
","1165788"
"Client to send SOAP request and received response","333274","","<p>Trying to create a C# client (will be developed as a Windows service) that sends SOAP requests to a web service (and gets the results).</p>

<p>From this <a href=""https://stackoverflow.com/questions/1862965/sending-and-receiving-soap-xml"">question</a> I saw this code:</p>

<pre><code>protected virtual WebRequest CreateRequest(ISoapMessage soapMessage)
{
    var wr = WebRequest.Create(soapMessage.Uri);
    wr.ContentType = ""text/xml;charset=utf-8"";
    wr.ContentLength = soapMessage.ContentXml.Length;

    wr.Headers.Add(""SOAPAction"", soapMessage.SoapAction);
    wr.Credentials = soapMessage.Credentials;
    wr.Method = ""POST"";
    wr.GetRequestStream().Write(Encoding.UTF8.GetBytes(soapMessage.ContentXml), 0, soapMessage.ContentXml.Length);

    return wr;
}

public interface ISoapMessage
{
    string Uri { get; }
    string ContentXml { get; }
    string SoapAction { get; }
    ICredentials Credentials { get; }
}
</code></pre>

<p>Looks nice, anyone knows how to use it and if it is the best practice?</p>
","<p>However, I normally use another way to do the same</p>

<pre><code>using System.Xml;
using System.Net;
using System.IO;

public static void CallWebService()
{
    var _url = ""http://xxxxxxxxx/Service1.asmx"";
    var _action = ""http://xxxxxxxx/Service1.asmx?op=HelloWorld"";

    XmlDocument soapEnvelopeXml = CreateSoapEnvelope();
    HttpWebRequest webRequest = CreateWebRequest(_url, _action);
    InsertSoapEnvelopeIntoWebRequest(soapEnvelopeXml, webRequest);

    // begin async call to web request.
    IAsyncResult asyncResult = webRequest.BeginGetResponse(null, null);

    // suspend this thread until call is complete. You might want to
    // do something usefull here like update your UI.
    asyncResult.AsyncWaitHandle.WaitOne();

    // get the response from the completed web request.
    string soapResult;
    using (WebResponse webResponse = webRequest.EndGetResponse(asyncResult))
    {
        using (StreamReader rd = new StreamReader(webResponse.GetResponseStream()))
        {
            soapResult = rd.ReadToEnd();
        }
        Console.Write(soapResult);        
    }
}

private static HttpWebRequest CreateWebRequest(string url, string action)
{
    HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(url);
    webRequest.Headers.Add(""SOAPAction"", action);
    webRequest.ContentType = ""text/xml;charset=\""utf-8\"""";
    webRequest.Accept = ""text/xml"";
    webRequest.Method = ""POST"";
    return webRequest;
}

private static XmlDocument CreateSoapEnvelope()
{
    XmlDocument soapEnvelopeDocument = new XmlDocument();
    soapEnvelopeDocument.LoadXml(@""&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=""""http://schemas.xmlsoap.org/soap/envelope/"""" xmlns:xsi=""""http://www.w3.org/1999/XMLSchema-instance"""" xmlns:xsd=""""http://www.w3.org/1999/XMLSchema""""&gt;&lt;SOAP-ENV:Body&gt;&lt;HelloWorld xmlns=""""http://tempuri.org/"""" SOAP-ENV:encodingStyle=""""http://schemas.xmlsoap.org/soap/encoding/""""&gt;&lt;int1 xsi:type=""""xsd:integer""""&gt;12&lt;/int1&gt;&lt;int2 xsi:type=""""xsd:integer""""&gt;32&lt;/int2&gt;&lt;/HelloWorld&gt;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;"");
    return soapEnvelopeDocument;
}

private static void InsertSoapEnvelopeIntoWebRequest(XmlDocument soapEnvelopeXml, HttpWebRequest webRequest)
{
    using (Stream stream = webRequest.GetRequestStream())
    {
        soapEnvelopeXml.Save(stream);
    }
}
</code></pre>
","4791932"
"Most efficient way to remove special characters from string","332014","","<p>I want to remove all special characters from a string. Allowed characters are A-Z (uppercase or lowercase), numbers (0-9), underscore (_), or the dot sign (.).</p>

<p>I have the following, it works but I suspect (I know!) it's not very efficient:</p>

<pre><code>    public static string RemoveSpecialCharacters(string str)
    {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i &lt; str.Length; i++)
        {
            if ((str[i] &gt;= '0' &amp;&amp; str[i] &lt;= '9')
                || (str[i] &gt;= 'A' &amp;&amp; str[i] &lt;= 'z'
                    || (str[i] == '.' || str[i] == '_')))
                {
                    sb.Append(str[i]);
                }
        }

        return sb.ToString();
    }
</code></pre>

<p>What is the most efficient way to do this? What would a regular expression look like, and how does it compare with normal string manipulation?</p>

<p>The strings that will be cleaned will be rather short, usually between 10 and 30 characters in length.</p>
","<p>Why do you think that your method is not efficient? It's actually one of the most efficient ways that you can do it.</p>

<p>You should of course read the character into a local variable or use an enumerator to reduce the number of array accesses:</p>

<pre><code>public static string RemoveSpecialCharacters(this string str) {
   StringBuilder sb = new StringBuilder();
   foreach (char c in str) {
      if ((c &gt;= '0' &amp;&amp; c &lt;= '9') || (c &gt;= 'A' &amp;&amp; c &lt;= 'Z') || (c &gt;= 'a' &amp;&amp; c &lt;= 'z') || c == '.' || c == '_') {
         sb.Append(c);
      }
   }
   return sb.ToString();
}
</code></pre>

<p>One thing that makes a method like this efficient is that it scales well. The execution time will be relative to the length of the string. There is no nasty surprises if you would use it on a large string.</p>

<p>Edit:<br>
I made a quick performance test, running each function a million times with a 24 character string. These are the results:</p>

<p>Original function: 54.5 ms.<br>
My suggested change: 47.1 ms.<br>
Mine with setting StringBuilder capacity: 43.3 ms.<br>
Regular expression: 294.4 ms.</p>

<p>Edit 2:
I added the distinction between A-Z and a-z in the code above. (I reran the performance test, and there is no noticable difference.)</p>

<p>Edit 3:<br>
I tested the lookup+char[] solution, and it runs in about 13 ms.</p>

<p>The price to pay is, of course, the initialization of the huge lookup table and keeping it in memory. Well, it's not that much data, but it's much for such a trivial function...</p>

<pre><code>private static bool[] _lookup;

static Program() {
   _lookup = new bool[65536];
   for (char c = '0'; c &lt;= '9'; c++) _lookup[c] = true;
   for (char c = 'A'; c &lt;= 'Z'; c++) _lookup[c] = true;
   for (char c = 'a'; c &lt;= 'z'; c++) _lookup[c] = true;
   _lookup['.'] = true;
   _lookup['_'] = true;
}

public static string RemoveSpecialCharacters(string str) {
   char[] buffer = new char[str.Length];
   int index = 0;
   foreach (char c in str) {
      if (_lookup[c]) {
         buffer[index] = c;
         index++;
      }
   }
   return new string(buffer, 0, index);
}
</code></pre>
","1120277"
"What is the best way to implement a ""timer""?","331638","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/186084/how-do-you-add-a-timer-to-a-c-sharp-console-application"">How do you add a timer to a C# console application</a>  </p>
</blockquote>



<p>What is the best way to implement a timer? A code sample would be great! For this question, ""best"" is defined as most reliable (least number of misfires) and precise. If I specify an interval of 15 seconds, I want the target method invoked every 15 seconds, not every 10 - 20 seconds. On the other hand, I don't need nanosecond accuracy. In this example, it would be acceptable for the method to fire every 14.51 - 15.49 seconds.</p>
","<p>Use the <code>Timer</code> class.</p>

<p><a href=""https://msdn.microsoft.com/en-us/library/system.timers.timer(v=vs.110).aspx"" rel=""noreferrer"">https://msdn.microsoft.com/en-us/library/system.timers.timer(v=vs.110).aspx</a></p>

<pre><code>public static void Main()
{
    System.Timers.Timer aTimer = new System.Timers.Timer();
    aTimer.Elapsed+=new ElapsedEventHandler(OnTimedEvent);
    aTimer.Interval=5000;
    aTimer.Enabled=true;

    Console.WriteLine(""Press \'q\' to quit the sample."");
    while(Console.Read()!='q');
}

 // Specify what you want to happen when the Elapsed event is raised.
 private static void OnTimedEvent(object source, ElapsedEventArgs e)
 {
     Console.WriteLine(""Hello World!"");
 }
</code></pre>

<p>The <code>Elapsed</code> event will be raised every X amount of milliseconds, specified by the <code>Interval</code> property on the Timer object. It will call the <code>Event Handler</code> method you specify, in the example above it is <code>OnTimedEvent</code></p>
","12535731"
"The type or namespace name does not exist in the namespace 'System.Web.Mvc'","329698","","<p>Buiding MVC3 solution went well but have got an error in browser:</p>

<p>Compiler Error Message: CS0234: The type or namespace name 'Html' does not exist in the namespace 'System.Web.Mvc' (are you missing an assembly reference?)</p>

<pre><code>Source Error:
Line 25:         &lt;add namespace=""System.Web.Mvc"" /&gt;
Line 26:         &lt;!--&lt;add namespace=""System.Web.Mvc.Ajax"" /&gt;--&gt;
Line 27:         &lt;add namespace=""System.Web.Mvc.Html"" /&gt;
Line 28:         &lt;add namespace=""System.Web.Routing"" /&gt;
Line 29:         &lt;add namespace=""System.Web.WebPages"" /&gt;
</code></pre>

<p>I have installed packets for the solution with <code>NuGet</code> and set up for all projects <code>MVC3</code>. Does <code>MVC3</code> include libraries <code>System.Web.Mvc.Ajax</code>,  <code>System.Web.Mvc.Html</code> and others? Why am I getting the error?</p>

<hr>

<p>In References folder, I have System.Web.Mvc</p>

<p><code>Runtime version: v4.0.30319</code>,</p>

<pre><code>Version: 3.0.0.0
</code></pre>

<hr>

<p>Web.config</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=152368
  --&gt;
&lt;configuration&gt;
  &lt;configSections&gt;
    &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;
    &lt;section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /&gt;
  &lt;/configSections&gt;
  &lt;appSettings&gt;
    &lt;add key=""aspnet:UseTaskFriendlySynchronizationContext"" value=""true"" /&gt;
    &lt;add key=""webpages:Version"" value=""1.0.0.0"" /&gt;
    &lt;add key=""ClientValidationEnabled"" value=""true"" /&gt;
    &lt;add key=""UnobtrusiveJavaScriptEnabled"" value=""true"" /&gt;
  &lt;/appSettings&gt;
  &lt;system.web&gt;
    &lt;compilation debug=""true"" targetFramework=""4.5"" /&gt;
    &lt;authentication mode=""Forms""&gt;
      &lt;forms loginUrl=""~/Account/LogOn"" timeout=""2880"" /&gt;
    &lt;/authentication&gt;
    &lt;pages&gt;
      &lt;namespaces&gt;
        &lt;add namespace=""System.Web.Helpers"" /&gt;
        &lt;add namespace=""System.Web.Mvc"" /&gt;
        &lt;add namespace=""System.Web.Mvc.Ajax"" /&gt;
        &lt;add namespace=""System.Web.Mvc.Html"" /&gt;
        &lt;add namespace=""System.Web.Routing"" /&gt;
        &lt;add namespace=""System.Web.WebPages"" /&gt;
      &lt;/namespaces&gt;
    &lt;/pages&gt;
    &lt;httpRuntime targetFramework=""4.5"" encoderType=""System.Web.Security.AntiXss.AntiXssEncoder, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"" /&gt;
    &lt;machineKey compatibilityMode=""Framework45"" /&gt;
    &lt;profile defaultProvider=""DefaultProfileProvider""&gt;
      &lt;providers&gt;
        &lt;add name=""DefaultProfileProvider"" type=""System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" applicationName=""/"" /&gt;
      &lt;/providers&gt;
    &lt;/profile&gt;
    &lt;membership defaultProvider=""DefaultMembershipProvider""&gt;
      &lt;providers&gt;
        &lt;add name=""DefaultMembershipProvider"" type=""System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" enablePasswordRetrieval=""false"" enablePasswordReset=""true"" requiresQuestionAndAnswer=""false"" requiresUniqueEmail=""false"" maxInvalidPasswordAttempts=""5"" minRequiredPasswordLength=""6"" minRequiredNonalphanumericCharacters=""0"" passwordAttemptWindow=""10"" applicationName=""/"" /&gt;
      &lt;/providers&gt;
    &lt;/membership&gt;
    &lt;roleManager defaultProvider=""DefaultRoleProvider""&gt;
      &lt;providers&gt;
        &lt;add name=""DefaultRoleProvider"" type=""System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" applicationName=""/"" /&gt;
      &lt;/providers&gt;
    &lt;/roleManager&gt;
    &lt;sessionState mode=""InProc"" customProvider=""DefaultSessionProvider""&gt;
      &lt;providers&gt;
        &lt;add name=""DefaultSessionProvider"" type=""System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"" connectionStringName=""DefaultConnection"" /&gt;
      &lt;/providers&gt;
    &lt;/sessionState&gt;
  &lt;/system.web&gt;
  &lt;system.webServer&gt;
    &lt;validation validateIntegratedModeConfiguration=""false"" /&gt;
  &lt;/system.webServer&gt;
  &lt;runtime&gt;
    &lt;assemblyBinding xmlns=""urn:schemas-microsoft-com:asm.v1""&gt;
      &lt;dependentAssembly&gt;
        &lt;assemblyIdentity name=""System.Web.Mvc"" publicKeyToken=""31bf3856ad364e35"" /&gt;
        &lt;bindingRedirect oldVersion=""1.0.0.0-2.0.0.0"" newVersion=""3.0.0.0"" /&gt;
      &lt;/dependentAssembly&gt;
    &lt;/assemblyBinding&gt;
  &lt;/runtime&gt;
  &lt;entityFramework&gt;
    &lt;defaultConnectionFactory type=""System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework"" /&gt;
  &lt;/entityFramework&gt;
  &lt;connectionStrings&gt;
    &lt;add name=""EFDbContext"" connectionString=""Data Source=.\SQLEXPRESS;Initial Catalog=SportStore;Integrated Security=True;Pooling=False;"" providerName=""System.Data.SqlClient"" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.web.mvc.aspx"">MSDN</a> the System.Web.Mvc namespace</p>

<p>file <code>packages.config</code>:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;packages&gt;
  &lt;package id=""EntityFramework"" version=""5.0.0-rc"" /&gt;
  &lt;package id=""jQuery"" version=""1.7.2"" /&gt;
  &lt;package id=""jQuery.UI.Combined"" version=""1.8.11"" /&gt;
  &lt;package id=""jQuery.Validation"" version=""1.9"" /&gt;
  &lt;package id=""Microsoft.AspNet.Mvc"" version=""3.0.20105.1"" /&gt;
  &lt;package id=""Microsoft.AspNet.Providers.Core"" version=""1.0"" /&gt;
  &lt;package id=""Microsoft.AspNet.Providers.LocalDB"" version=""1.0"" /&gt;
  &lt;package id=""Microsoft.AspNet.Razor"" version=""1.0.20105.408"" /&gt;
  &lt;package id=""Microsoft.AspNet.WebPages"" version=""1.0.20105.408"" /&gt;
  &lt;package id=""Microsoft.Web.Infrastructure"" version=""1.0.0.0"" /&gt;
  &lt;package id=""Modernizr"" version=""2.0.6"" /&gt;
  &lt;package id=""Moq"" version=""4.0.10827"" /&gt;
  &lt;package id=""Ninject"" version=""3.0.1.10"" /&gt;
&lt;/packages&gt;
</code></pre>
","<p>Clean your solution and then set the property of those files to <code>Copy Local = True</code>.</p>

<p>To set the Copy Local property to True or False</p>

<p>In Solution Explorer, click the Show All Files button to display the References node.</p>

<ul>
<li>Open the References node for the project.</li>
<li>Right-click a reference in the References list, and click Properties.
The properties associated with that reference appear in a list in the Properties window.</li>
<li>In the Properties window, change the Copy Local property to True or False.</li>
</ul>
","13149587"
"Microsoft.Jet.OLEDB.4.0' provider is not registered on the local machine","329403","","<p>I created a windows application developed in .NET 3.5 in a 32 bit Windows 2008 server. When deployed the application in a 64 bit server it shows the error ""Microsoft.Jet.OLEDB.4.0' provider is not registered on the local machine "".</p>

<p>So as a solution to this issue, i have changed the build property of the project to X86, so that it will build in 32 bit mode, and rebuild the project in the 32bit machine. But, the same project uses other DB drivers (DB2, SQL etc.) to connect to other databases. So when i deployed my app again in the 64 bit OS, it throws the exception "" Attempted to load a 64-bit assembly on a 32-bit platform. ""</p>

<p>I am using the Microsoft.Jet.OLEDB.4.0 driver to read and write to the Excel (.xls)</p>
","<p>I found a solution for this problem. The issue I described in my question occured basically due to the incompatibility of the <em>Microsoft.Jet.OLEDB.4.0 driver</em> in 64 bit OS. </p>

<p>So if we are using Microsoft.Jet.OLEDB.4.0 driver in a 64 bit server, we have to force our application to build in in 32 bit mode (This is the answer I found when I did an extensive search for this <strong>known issue</strong>) and that causes other part of my code to break.</p>

<p>Fortunately, now Microsoft has released a 64 bit compatible <strong><em>2010 Office System Driver</em></strong> which can be used as replacement for the traditional Microsoft.Jet.OLEDB.4.0 driver. It works both in 32 bit as well as 64 bit servers. I have used it for Excel file manipulation and it worked fine for me in both the environments. <del>But this driver is in <strong>BETA</strong>.</del></p>

<p>You can download this driver from <a href=""http://www.microsoft.com/download/en/details.aspx?id=13255"" rel=""noreferrer"">Microsoft Access Database Engine 2010 Redistributable</a></p>
","1992009"
"How to open .dll files to see what is written inside?","329063","","<p>I lost the solution of class-library, can I open <code>.dll</code> file which is created by <code>class-library</code>.  </p>
","<p>you are better off with a decompiler like redgates .net reflector or jetbrains resharper decompiler. there are open source ones also like</p>

<p><a href=""http://www.jetbrains.com/decompiler/"">http://www.jetbrains.com/decompiler/</a></p>

<p><a href=""http://ilspy.net/"">http://ilspy.net/</a></p>
","18050646"
"Where IN clause in LINQ","327905","","<p>How to make a where in clause similar to one in SQL Server?</p>

<p>I made one by myself but can anyone please improve this?</p>

<pre><code>    public List&lt;State&gt; Wherein(string listofcountrycodes)
    {
        string[] countrycode = null;
        countrycode = listofcountrycodes.Split(',');
        List&lt;State&gt; statelist = new List&lt;State&gt;();

        for (int i = 0; i &lt; countrycode.Length; i++)
        {
            _states.AddRange(
                 from states in _objdatasources.StateList()
                 where states.CountryCode == countrycode[i].ToString()
                 select new State
                 {
                    StateName  = states.StateName                    

                 });
        }
        return _states;
    }
</code></pre>
","<p>This expression should do what you want to achieve.</p>

<pre><code>dataSource.StateList.Where(s =&gt; countryCodes.Contains(s.CountryCode))
</code></pre>
","959815"
"How do I use Assert to verify that an exception has been thrown?","327144","","<p>How do I use Assert (or other Test class?) to verify that an exception has been thrown?</p>
","<p>For ""Visual Studio Team Test"" it appears you apply the ExpectedException attribute to the test's method.</p>

<p>Sample from the documentation here: <a href=""http://msdn.microsoft.com/en-us/library/ms379625(VS.80).aspx#vstsunittesting_topic5"" rel=""noreferrer"">A Unit Testing Walkthrough with Visual Studio Team Test</a></p>

<pre><code>[TestMethod]
[ExpectedException(typeof(ArgumentException),
    ""A userId of null was inappropriately allowed."")]
public void NullUserIdInConstructor()
{
   LogonInfo logonInfo = new LogonInfo(null, ""P@ss0word"");
}
</code></pre>
","933627"
"How to delete an element from an array in C#","327052","","<p>Lets say I have this array,</p>

<pre><code>int[] numbers = {1, 3, 4, 9, 2};
</code></pre>

<p>How can I delete an element by ""name""? , lets say number 4?</p>

<p>Even <code>ArrayList</code> didn't help to delete?</p>

<pre><code>string strNumbers = "" 1, 3, 4, 9, 2"";
ArrayList numbers = new ArrayList(strNumbers.Split(new char[] { ',' }));
numbers.RemoveAt(numbers.IndexOf(4));
foreach (var n in numbers)
{
    Response.Write(n);
}
</code></pre>
","<p><strong><em>If you want to remove all instances of 4 without needing to know the index:</em></strong></p>

<p><strong><em>LINQ:</em></strong> (.NET Framework 3.5)</p>

<pre><code>int[] numbers = { 1, 3, 4, 9, 2 };
int numToRemove = 4;
numbers = numbers.Where(val =&gt; val != numToRemove).ToArray();
</code></pre>

<p><strong><em>Non-LINQ:</em></strong> (.NET Framework 2.0)</p>

<pre><code>static bool isNotFour(int n)
{
    return n != 4;
}

int[] numbers = { 1, 3, 4, 9, 2 };
numbers = Array.FindAll(numbers, isNotFour).ToArray();
</code></pre>

<p><strong><em>If you want to remove just the first instance:</em></strong></p>

<p><strong><em>LINQ:</em></strong> (.NET Framework 3.5)</p>

<pre><code>int[] numbers = { 1, 3, 4, 9, 2, 4 };
int numToRemove = 4;
int numIndex = Array.IndexOf(numbers, numToRemove);
numbers = numbers.Where((val, idx) =&gt; idx != numIndex).ToArray();
</code></pre>

<p><strong><em>Non-LINQ:</em></strong> (.NET Framework 2.0)</p>

<pre><code>int[] numbers = { 1, 3, 4, 9, 2, 4 };
int numToRemove = 4;
int numIdx = Array.IndexOf(numbers, numToRemove);
List&lt;int&gt; tmp = new List&lt;int&gt;(numbers);
tmp.RemoveAt(numIdx);
numbers = tmp.ToArray();
</code></pre>

<p><strong><em>Edit:</em></strong> Just in case you hadn't already figured it out, as Malfist pointed out, you need to be targetting the .NET Framework 3.5 in order for the LINQ code examples to work.  If you're targetting 2.0 you need to reference the Non-LINQ examples.</p>
","497005"
"How do I use LINQ Contains(string[]) instead of Contains(string)","326915","","<p>I got one big question.</p>

<p>I got a linq query to put it simply looks like this:</p>

<pre><code>from xx in table
where xx.uid.ToString().Contains(string[])
select xx
</code></pre>

<p>The values of the <code>string[]</code> array would be numbers like (1,45,20,10,etc...)</p>

<p>the Default for <code>.Contains</code> is <code>.Contains(string)</code>.</p>

<p>I need it to do this instead:  <code>.Contains(string[])</code>...</p>

<p><strong>EDIT :</strong> One user suggested writing an extension class for <code>string[]</code>.  I would like to learn how, but any one willing to point me in the right direction?</p>

<p><strong>EDIT :</strong> The uid would also be a number. That's why it is converted to a string.</p>

<p>Help anyone?</p>
","<p>spoulson has it nearly right, but you need to create a <code>List&lt;string&gt;</code> from <code>string[]</code> first.  Actually a <code>List&lt;int&gt;</code> would be better if uid is also <code>int</code>.  <code>List&lt;T&gt;</code> supports <code>Contains()</code>.  Doing  <code>uid.ToString().Contains(string[])</code> would imply that the uid as a string contains all of the values of the array as a substring???  Even if you did write the extension method the sense of it would be wrong. </p>

<p><strong>[EDIT]</strong></p>

<p>Unless you changed it around and wrote it for <code>string[]</code> as Mitch Wheat demonstrates, then you'd just be able to skip the conversion step. </p>

<p><strong>[ENDEDIT]</strong> </p>

<p>Here is what you want, if you don't do the extension method (unless you already have the collection of potential uids as ints -- then just use <code>List&lt;int&gt;()</code> instead).  This uses the chained method syntax, which I think is cleaner, and
does the conversion to int to ensure that the query can be used with more providers.</p>

<pre><code>var uids = arrayofuids.Select(id =&gt; int.Parse(id)).ToList();

var selected = table.Where(t =&gt; uids.Contains(t.uid));
</code></pre>
","194974"
"Sorting rows in a data table","326416","","<p>We have two columns in a <code>DataTable</code>, like so:</p>

<pre><code>COL1   COL2
Abc    5
Def    8
Ghi    3
</code></pre>

<p>We're trying to sort this <code>datatable</code> based on <code>COL2</code> in decreasing order. </p>

<pre><code>COL1            COL2
ghi             8
abc             4
def             3
jkl             1
</code></pre>

<p>We tried this:</p>

<pre><code>ft.DefaultView.Sort = ""occr desc"";
ft = ft.DefaultView.ToTable(true);
</code></pre>

<p>but, without using a <code>DataView</code>, we want to sort the <code>DataTable</code> itself, not the <code>DataView</code>.</p>
","<p>I'm afraid you can't easily do an in-place sort of a DataTable like it sounds like you want to do.</p>

<p>What you can do is create a new DataTable from a DataView that you create from your original DataTable.  Apply whatever sorts and/or filters you want on the DataView and then create a new DataTable from the DataView using the <a href=""http://msdn.microsoft.com/en-us/library/system.data.dataview.totable.aspx"">DataView.ToTable</a> method:</p>

<pre><code>   DataView dv = ft.DefaultView;
   dv.Sort = ""occr desc"";
   DataTable sortedDT = dv.ToTable();
</code></pre>
","9108171"
"Best way to read a large file into a byte array in C#?","326003","","<p>I have a web server which will read large binary files (several megabytes) into byte arrays. The server could be reading several files at the same time (different page requests), so I am looking for the most optimized way for doing this without taxing the CPU too much. Is the code below good enough?</p>

<pre><code>public byte[] FileToByteArray(string fileName)
{
    byte[] buff = null;
    FileStream fs = new FileStream(fileName, 
                                   FileMode.Open, 
                                   FileAccess.Read);
    BinaryReader br = new BinaryReader(fs);
    long numBytes = new FileInfo(fileName).Length;
    buff = br.ReadBytes((int) numBytes);
    return buff;
}
</code></pre>
","<p>Simply replace the whole thing with:</p>

<pre><code>return File.ReadAllBytes(fileName);
</code></pre>

<p>However, if you are concerned about the memory consumption, you should <em>not</em> read the whole file into memory all at once at all. You should do that in chunks. </p>
","2030865"
"How to insert newline in string literal?","325982","","<p>In .NET I can provide both <code>\r</code> or <code>\n</code> string literals, but there is a way to insert
something like ""new line"" special character like <code>Environment.NewLine</code> static property?</p>
","<p>Well, simple options are:</p>

<ul>
<li><p><code>string.Format</code>:</p>

<pre><code>string x = string.Format(""first line{0}second line"", Environment.NewLine);
</code></pre></li>
<li><p>String concatenation:</p>

<pre><code>string x = ""first line"" + Environment.NewLine + ""second line"";
</code></pre></li>
<li><p>String interpolation (in C#6 and above):</p>

<pre><code>string x = $""first line{Environment.NewLine}second line"";
</code></pre></li>
</ul>

<p>You could also use \n everywhere, and replace:</p>

<pre><code>string x = ""first line\nsecond line\nthird line"".Replace(""\n"",
                                                         Environment.NewLine);
</code></pre>

<p>Note that you can't make this a string <em>constant</em>, because the value of <code>Environment.NewLine</code> will only be available at execution time.</p>
","4085759"
"C# Linq Group By on multiple columns","325885","","<pre><code>public class ConsolidatedChild
{
    public string School { get; set; }
    public string Friend { get; set; }
    public string FavoriteColor { get; set; }
    public List&lt;Child&gt; Children { get; set; }
}

public class Child
{
    public string School { get; set; }
    public string Name { get; set; }
    public string Address { get; set; }
    public string Friend { get; set; }
    public string Mother { get; set; }
    public string FavoriteColor { get; set; }
}
</code></pre>

<p>Given the two classes above, I would like to use LINQ to create a List from the List, grouped by the School, Friend and FavoriteColor properties. Is this possible with LINQ?</p>

<p>Please ignore the properties, the code has been written just to help with the question.</p>
","<p>Easy:</p>

<pre><code>var consolidatedChildren =
    from c in children
    group c by new
    {
        c.School,
        c.Friend,
        c.FavoriteColor,
    } into gcs
    select new ConsolidatedChild()
    {
        School = gcs.Key.School,
        Friend = gcs.Key.Friend,
        FavoriteColor = gcs.Key.FavoriteColor,
        Children = gcs.ToList(),
    };
</code></pre>
","5232194"
"Get current date only in C#","321496","","<p>I am able to get date and time using:</p>

<pre><code>DateTime now = DateTime.Now;
</code></pre>

<p>How can I get the current date and time separately in DateTime format itself?</p>

<p>I am not using DateTime picker dialog box in ASP.net (<code>C#</code>).</p>
","<p>Well, you can get just today's date as a <code>DateTime</code> using the <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.today.aspx""><code>Today</code></a> property:</p>

<pre><code> DateTime today = DateTime.Today;
</code></pre>

<p>or more generally, you can use the <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx""><code>Date</code></a> property. For example, if you wanted the UTC date you could use:</p>

<pre><code> DateTime dateTime = DateTime.UtcNow.Date;
</code></pre>

<p>It's not very clear whether that's what you need or not though... if you're just looking to <em>print</em> the date, you can use:</p>

<pre><code>Console.WriteLine(dateTime.ToString(""d""));
</code></pre>

<p>or use an explicit format:</p>

<pre><code>Console.WriteLine(dateTime.ToString(""dd/MM/yyyy""));
</code></pre>

<p>See more about <a href=""http://msdn.microsoft.com/en-us/library/az4se3k1.aspx"">standard</a> and <a href=""http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx"">custom</a> date/time format strings. Depending on your situation you may also want to specify the culture.</p>

<p>If you want a more expressive date/time API which allows you to talk about dates separately from times, you might want to look at the <a href=""http://noda-time.googlecode.com"">Noda Time</a> project which I started. It's not ready for production just yet, but we'd love to hear what you'd like to do with it...</p>
","6817292"
"Get local IP address","321153","","<p>In the internet there are several places that show you how to get an IP address. And a lot of them look like this example:</p>

<pre><code>String strHostName = string.Empty;
// Getting Ip address of local machine...
// First get the host name of local machine.
strHostName = Dns.GetHostName();
Console.WriteLine(""Local Machine's Host Name: "" + strHostName);
// Then using host name, get the IP address list..
IPHostEntry ipEntry = Dns.GetHostEntry(strHostName);
IPAddress[] addr = ipEntry.AddressList;

for (int i = 0; i &lt; addr.Length; i++)
{
    Console.WriteLine(""IP Address {0}: {1} "", i, addr[i].ToString());
}
Console.ReadLine();
</code></pre>

<p>With this example I get several IP addresses, but I'm only interested in getting the one that the router assigns to the computer running the program: the IP that I would give to someone if he wishes to access a shared folder in my computer for instance.</p>

<p>If I am not connected to a network and I am connected to the internet directly via a modem with no router then I would like to get an error. How can I see if my computer is connected to a network with C# and if it is then to get the LAN IP address. </p>
","<p>To get local Ip Address:</p>

<pre><code>public static string GetLocalIPAddress()
{
    var host = Dns.GetHostEntry(Dns.GetHostName());
    foreach (var ip in host.AddressList)
    {
        if (ip.AddressFamily == AddressFamily.InterNetwork)
        {
            return ip.ToString();
        }
    }
    throw new Exception(""No network adapters with an IPv4 address in the system!"");
}
</code></pre>

<p>To check if you're connected or not:</p>

<p><code>System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable();</code></p>
","6803109"
"Read connection string from web.config","319158","","<p>How can i read connection string from web.config file in to a public class in class library.
i've tried </p>

<pre><code>WebConfigurationManager

ConfigurationManager
</code></pre>

<p>but these are not recognized in class library</p>
","<p>Add <code>System.Configuration</code> as a reference.</p>

<p>For some bizarre reason it's not included by default. </p>
","6134374"
"AppSettings get value from .config file","319060","","<p>I'm not able to access values in configuration file.</p>

<pre><code>Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
var clientsFilePath = config.AppSettings.Settings[""ClientsFilePath""].Value; 
// the second line gets a NullReferenceException
</code></pre>

<p><strong>.config file</strong>:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;?xml version=""1.0"" encoding=""utf-8"" ?&gt;
&lt;configuration&gt;
  &lt;appSettings&gt;
    &lt;!-- ... --&gt;
    &lt;add key=""ClientsFilePath"" value=""filepath""/&gt;
    &lt;!-- ... --&gt;
  &lt;/appSettings&gt;
&lt;/configuration&gt;
</code></pre>

<p>Do you have any suggestion what should I do?</p>
","<p>This works for me:</p>

<pre><code>string value = System.Configuration.ConfigurationManager.AppSettings[key];
</code></pre>
","10766683"
"IEnumerable vs List - What to Use? How do they work?","318113","","<p>I have some doubts over how Enumerators work, and LINQ. Consider these two simple selects:</p>

<pre><code>List&lt;Animal&gt; sel = (from animal in Animals 
                    join race in Species
                    on animal.SpeciesKey equals race.SpeciesKey
                    select animal).Distinct().ToList();
</code></pre>

<p>or</p>

<pre><code>IEnumerable&lt;Animal&gt; sel = (from animal in Animals 
                           join race in Species
                           on animal.SpeciesKey equals race.SpeciesKey
                           select animal).Distinct();
</code></pre>

<p>I changed the names of my original objects so that this looks like a more generic example. The query itself is not that important. What I want to ask is this:</p>

<pre><code>foreach (Animal animal in sel) { /*do stuff*/ }
</code></pre>

<ol>
<li><p>I noticed that if I use <code>IEnumerable</code>, when I debug and inspect ""sel"", which in that case is the IEnumerable, it has some interesting members: ""inner"", ""outer"", ""innerKeySelector"" and ""outerKeySelector"", these last 2 appear to be delegates. The ""inner"" member does not have ""Animal"" instances in it, but rather ""Species"" instances, which was very strange for me. The ""outer"" member does contain ""Animal"" instances. I presume that the two delegates determine which goes in and what goes out of it?</p></li>
<li><p>I noticed that if I use ""Distinct"", the ""inner"" contains 6 items (this is incorrect as only 2 are Distinct), but the ""outer"" does contain the correct values. Again, probably the delegated methods determine this but this is a bit more than I know about IEnumerable.</p></li>
<li><p>Most importantly, which of the two options is the best performance-wise?</p></li>
</ol>

<p>The evil List conversion via <code>.ToList()</code>?</p>

<p>Or maybe using the enumerator directly?</p>

<p>If you can, please also explain a bit or throw some links that explain this use of IEnumerable.</p>
","<p><code>IEnumerable</code> describes behavior, while List is an implementation of that behavior. When you use <code>IEnumerable</code>, you give the compiler a chance to defer work until later, possibly optimizing along the way. If you use ToList() you force the compiler to reify the results right away.</p>

<p>Whenever I'm ""stacking"" LINQ expressions, I use <code>IEnumerable</code>, because by only specifying the behavior I give LINQ a chance to defer evaluation and possibly optimize the program. Remember how LINQ doesn't generate the SQL to query the database until you enumerate it? Consider this:</p>

<pre><code>public IEnumerable&lt;Animals&gt; AllSpotted()
{
    return from a in Zoo.Animals
           where a.coat.HasSpots == true
           select a;
}

public IEnumerable&lt;Animals&gt; Feline(IEnumerable&lt;Animals&gt; sample)
{
    return from a in sample
           where a.race.Family == ""Felidae""
           select a;
}

public IEnumerable&lt;Animals&gt; Canine(IEnumerable&lt;Animals&gt; sample)
{
    return from a in sample
           where a.race.Family == ""Canidae""
           select a;
}
</code></pre>

<p>Now you have a method that selects an initial sample (""AllSpotted""), plus some filters. So now you can do this:</p>

<pre><code>var Leopards = Feline(AllSpotted());
var Hyenas = Canine(AllSpotted());
</code></pre>

<p>So is it faster to use List over <code>IEnumerable</code>? Only if you want to prevent a query from being executed more than once. But is it better overall? Well in the above, Leopards and Hyenas get converted into <em>single SQL queries each</em>, and the database only returns the rows that are relevant. But if we had returned a List from <code>AllSpotted()</code>, then it may run slower because the database could return far more data than is actually needed, and we waste cycles doing the filtering in the client.</p>

<p>In a program, it may be better to defer converting your query to a list until the very end, so if I'm going to enumerate through Leopards and Hyenas more than once, I'd do this:</p>

<pre><code>List&lt;Animals&gt; Leopards = Feline(AllSpotted()).ToList();
List&lt;Animals&gt; Hyenas = Canine(AllSpotted()).ToList();
</code></pre>
","3628705"
"How to add double quotes to a string that is inside a variable?","317797","","<p>I have variable like:</p>

<pre><code>string title = string.empty;
</code></pre>

<p>My need is that whatever string is passed to it  I have to display the content inside a div with in a double quotes. So I have written something like:</p>

<pre><code>...
...
&lt;div&gt;""+ title +@""&lt;/div&gt;
...
...
</code></pre>

<p>But how to add the double quotes here? So that it will display like :</p>

<pre><code>""How to add double quotes""
</code></pre>
","<p>You need to escape them by doubling them (verbatim string literal):</p>

<pre><code>string str = @""""""How to add doublequotes"""""";
</code></pre>

<p>Or with a normal string literal you escape them with a <code>\</code>:</p>

<pre><code>string str = ""\""How to add doublequotes\"""";
</code></pre>
","3905970"
"How to remove illegal characters from path and filenames?","316775","","<p>I need a robust and simple way to remove illegal path and file characters from a simple string. I've used the below code but it doesn't seem to do anything, what am I missing?</p>

<pre><code>using System;
using System.IO;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string illegal = ""\""M&lt;&gt;\""\\a/ry/ h**ad:&gt;&gt; a\\/:*?\""&lt;&gt;| li*tt|le|| la\""mb.?"";

            illegal = illegal.Trim(Path.GetInvalidFileNameChars());
            illegal = illegal.Trim(Path.GetInvalidPathChars());

            Console.WriteLine(illegal);
            Console.ReadLine();
        }
    }
}
</code></pre>
","<p>Try something like this instead;</p>

<pre><code>string illegal = ""\""M\""\\a/ry/ h**ad:&gt;&gt; a\\/:*?\""| li*tt|le|| la\""mb.?"";
string invalid = new string(Path.GetInvalidFileNameChars()) + new string(Path.GetInvalidPathChars());

foreach (char c in invalid)
{
    illegal = illegal.Replace(c.ToString(), """"); 
}
</code></pre>

<p>But I have to agree with the comments, I'd probably try to deal with the source of the illegal paths, rather than try to mangle an illegal path into a legitimate but probably unintended one.</p>

<p>Edit: Or a potentially 'better' solution, using Regex's.</p>

<pre><code>string illegal = ""\""M\""\\a/ry/ h**ad:&gt;&gt; a\\/:*?\""| li*tt|le|| la\""mb.?"";
string regexSearch = new string(Path.GetInvalidFileNameChars()) + new string(Path.GetInvalidPathChars());
Regex r = new Regex(string.Format(""[{0}]"", Regex.Escape(regexSearch)));
illegal = r.Replace(illegal, """");
</code></pre>

<p>Still, the question begs to be asked, why you're doing this in the first place.</p>
","146162"
"How to properly exit a C# application?","316366","","<p>I have a published application in C#. The problem here is whenever I close the main form by clicking on the red exit button, it closes the form but it doesn't close the application. I found this out when I tried shutting down the computer, hopeful that the application I made was running smoothly then I was bombarded by a lot of child windows with which I have put <em>MessageBox</em> Alerts.</p>

<p>I tried Application.Exit but it still calls all the child windows and alerts and I don't know how to use <em>Environment.Exit</em> and which integer to put into it. By the way, whenever my forms call the formclosed or form closing event I close the application with a <code>this.Hide()</code> function. Does that affect how my application is behaving now?</p>
","<p>From MSDN:</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/ms157894.aspx"" rel=""noreferrer""><strong>Application.Exit</strong></a></p>

<blockquote>
  <p>Informs all message pumps that they must terminate, and then closes all application windows after the messages have been processed. This is the code to use if you are have called Application.Run (WinForms applications), this method stops all running message loops on all threads and closes all windows of the application.</p>
</blockquote>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx"" rel=""noreferrer""><strong>Environment.Exit</strong></a></p>

<blockquote>
  <p>Terminates this process and gives the underlying operating system the specified exit code. This is the code to call when you are using console application.</p>
</blockquote>

<p>This article, <a href=""http://geekswithblogs.net/mtreadwell/archive/2004/06/06/6123.aspx"" rel=""noreferrer"">Application.Exit vs. Environment.Exit</a>, points towards a good tip:</p>

<p>You can determine if <code>System.Windows.Forms.Application.Run</code> has been called by checking the <code>System.Windows.Forms.Application.MessageLoop</code> property. If true, then Run has been called and you can assume that a WinForms application is executing as follows.</p>

<pre><code>if (System.Windows.Forms.Application.MessageLoop) 
{
    // WinForms app
    System.Windows.Forms.Application.Exit();
}
else
{
    // Console app
    System.Environment.Exit(1);
}
</code></pre>

<p>Reference: <a href=""https://stackoverflow.com/questions/554408/why-would-application-exit-fail-to-work"">Why would Application.Exit fail to work?</a></p>
","12978034"
"Writing data into CSV file in C#","313771","","<p>I am trying to write into a <code>csv</code> file row by row using C# language. Here is my function</p>

<pre><code>string first = reader[0].ToString();
string second=image.ToString();
string csv = string.Format(""{0},{1}\n"", first, second);
File.WriteAllText(filePath, csv);
</code></pre>

<p>The whole function runs inside a loop, and every row should be written to the <code>csv</code> file. In my case next row overwrites the existing row and in the end I am getting only single record in the csv file which is last one. How can I write all the rows in the <code>csv</code> file. </p>
","<p><strong>UPDATE</strong></p>

<p>Back in my naïve days, I suggested doing this manually (it was a simple solution to a simple question), however due to this becoming more and more popular, I'd recommend using the library <a href=""https://joshclose.github.io/CsvHelper/"" rel=""nofollow noreferrer"">CsvHelper</a> that does all the safety checks, etc.  </p>

<p>CSV is way more complicated than what the question/answer suggests.</p>

<p><strong>Original Answer</strong></p>

<p>As you already have a loop, consider doing it like this:</p>

<pre><code>//before your loop
    var csv = new StringBuilder();

//in your loop
    var first = reader[0].ToString();
    var second = image.ToString();
    //Suggestion made by KyleMit
    var newLine = string.Format(""{0},{1}"", first, second);
    csv.AppendLine(newLine);  

//after your loop
    File.WriteAllText(filePath, csv.ToString());
</code></pre>

<p>Or something to this effect.
My reasoning is: you won't be need to write to the file for every item, you will only be opening the stream once and then writing to it.</p>

<p>You can replace</p>

<pre><code>File.WriteAllText(filePath, csv.ToString());
</code></pre>

<p>with </p>

<pre><code>File.AppendAllText(filePath, csv.ToString());
</code></pre>

<p>if you want to keep previous versions of csv in the same file</p>

<p><strong>C# 6</strong></p>

<p>If you are using c# 6.0 then you can do the following</p>

<pre><code>var newLine = $""{first},{second}""
</code></pre>

<p><strong>EDIT</strong></p>

<p>Here is a <a href=""https://stackoverflow.com/questions/1015766/difference-between-n-and-environment-newline"">link</a> to a question that explains what <code>Environment.NewLine</code> does</p>
","18757247"
"Call one constructor from another","313414","","<p>I have two constructors which feed values to readonly fields.</p>

<pre><code>class Sample
{
    public Sample(string theIntAsString)
    {
        int i = int.Parse(theIntAsString);

        _intField = i;
    }

    public Sample(int theInt)
    {
        _intField = theInt;
    }


    public int IntProperty
    {
        get { return _intField; }
    }
    private readonly int _intField;

}
</code></pre>

<p>One constructor receives the values directly, and the other does some calculation and obtains the values, then sets the fields.</p>

<p>Now here's the catch:</p>

<ol>
<li>I don't want to duplicate the
setting code. In this case, just one
field is set but of course there may
well be more than one.</li>
<li>To make the fields readonly, I need
to set them from the constructor, so
I can't ""extract"" the shared code to
a utility function.</li>
<li>I don't know how to call one
constructor from another.</li>
</ol>

<p>Any ideas?</p>
","<p>Like this:</p>

<pre><code>public Sample(string str) : this(int.Parse(str)) {
}
</code></pre>
","4009032"
"No connection could be made because the target machine actively refused it 127.0.0.1:3446","312953","","<p>I'm using the WCF4.0 template -<a href=""http://en.wikipedia.org/wiki/Representational_State_Transfer"" rel=""noreferrer"">REST</a>. I'm trying to make a method that uploads a file using a stream.</p>

<p>The problem always occur at</p>

<pre><code>Stream serverStream = request.GetRequestStream();
</code></pre>

<p>Class for streaming:</p>

<pre><code>namespace LogicClass
{
    public class StreamClass : IStreamClass
    {
        public bool UploadFile(string filename, Stream fileStream)
        {
            try
            {
                FileStream fileToupload = new FileStream(filename, FileMode.Create);
                byte[] bytearray = new byte[10000];
                int bytesRead, totalBytesRead = 0;
                do
                {
                    bytesRead = fileStream.Read(bytearray, 0, bytearray.Length);
                    totalBytesRead += bytesRead;
                } while (bytesRead &gt; 0);

                fileToupload.Write(bytearray, 0, bytearray.Length);
                fileToupload.Close();
                fileToupload.Dispose();
            }
            catch (Exception ex) { throw new Exception(ex.Message); }
            return true;
        }
    }
}
</code></pre>

<p>REST project:</p>

<pre><code>[WebInvoke(UriTemplate = ""AddStream/{filename}"", Method = ""POST"", BodyStyle = WebMessageBodyStyle.Bare)]
public bool AddStream(string filename, System.IO.Stream fileStream)
{
    LogicClass.FileComponent rest = new LogicClass.FileComponent();
    return rest.AddStream(filename, fileStream);
}
</code></pre>

<p>Windows Form project: for testing</p>

<pre><code>private void button24_Click(object sender, EventArgs e)
{
    byte[] fileStream;
    using (FileStream fs = new FileStream(""E:\\stream.txt"", FileMode.Open, FileAccess.Read, FileShare.Read))
    {
        fileStream = new byte[fs.Length];
        fs.Read(fileStream, 0, (int)fs.Length);
        fs.Close();
        fs.Dispose();
    }

    string baseAddress = ""http://localhost:3446/File/AddStream/stream.txt"";
    HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(baseAddress);
    request.Method = ""POST"";
    request.ContentType = ""text/plain"";
    Stream serverStream = request.GetRequestStream();
    serverStream.Write(fileStream, 0, fileStream.Length);
    serverStream.Close();
    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
    {
        int statusCode = (int)response.StatusCode;
        StreamReader reader = new StreamReader(response.GetResponseStream());
    }
}
</code></pre>

<p>I've turned off the firewall and my Internet connection, but the error still exists. Is there a better way of testing the uploading method?</p>

<p>Stack trace:</p>

<blockquote>
  <p>at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
         at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket&amp; socket, IPAddress&amp; address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception&amp; exception)</p>
</blockquote>
","<p>""Actively refused it"" means that the host sent a reset instead of an ack when you tried to connect. It is therefore not a problem in your code.  Either there is a firewall blocking the connection or the process that is hosting the service is not listening on that port. This may be because it is not running at all or because it is listening on a different port.</p>

<p>Once you start the process hosting your service, try <code>netstat -anb</code> (requires admin privileges) to verify that it is running and listening on the expected port.</p>

<p>update: On Linux you may need to do <code>netstat -anp</code> instead.</p>
","9695442"
"Easiest way to read from and write to files","312277","","<p>There are a lot of different ways to read and write files (<em>text files</em>, not binary) in C#. </p>

<p>I just need something that is easy and uses the least amount of code, because I am going to be working with files a lot in my project. I only need something for <code>string</code> since all I need is to read and write <code>string</code>s.</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx"" rel=""noreferrer"">File.ReadAllText</a> and <a href=""http://msdn.microsoft.com/en-us/library/system.io.file.writealltext.aspx"" rel=""noreferrer"">File.WriteAllText</a>.</p>

<p>It could not be simpler...</p>

<p>MSDN examples:</p>

<pre><code>// Create a file to write to.
string createText = ""Hello and Welcome"" + Environment.NewLine;
File.WriteAllText(path, createText);

// Open the file to read from.
string readText = File.ReadAllText(path);
</code></pre>
","7569938"
"How to get ASCII value of string in C#","312026","","<p>I want to get the ASCII value of characters in a string in C#.</p>

<p>If my string has the value ""9quali52ty3"", I want an array with the ASCII values of each of the 11 characters.</p>

<p>How can I get ASCII values in C#?</p>
","<p>From <a href=""http://msdn.microsoft.com/en-us/library/system.text.encoding.convert(VS.71).aspx"" rel=""noreferrer"">MSDN</a></p>

<pre><code>string value = ""9quali52ty3"";

// Convert the string into a byte[].
byte[] asciiBytes = Encoding.ASCII.GetBytes(value);
</code></pre>

<p>You now have an array of the ASCII value of the bytes. I got the following:</p>

<p>57
113
117
97
108
105
53
50
116
121
51</p>
","400777"
"Multiple Inheritance in C#","311900","","<p>Since multiple inheritance is bad (it makes the source more complicated) C# does not provide such a pattern directly. But sometimes it would be helpful to have this ability.</p>

<p>For instance I'm able to implement the missing multiple inheritance pattern using interfaces and three classes like that:</p>

<pre><code>public interface IFirst { void FirstMethod(); }
public interface ISecond { void SecondMethod(); }

public class First:IFirst 
{ 
    public void FirstMethod() { Console.WriteLine(""First""); } 
}

public class Second:ISecond 
{ 
    public void SecondMethod() { Console.WriteLine(""Second""); } 
}

public class FirstAndSecond: IFirst, ISecond
{
    First first = new First();
    Second second = new Second();
    public void FirstMethod() { first.FirstMethod(); }
    public void SecondMethod() { second.SecondMethod(); }
}
</code></pre>

<p>Every time I add a method to one of the interfaces I need to change the class <em>FirstAndSecond</em> as well. </p>

<p>Is there a way to inject multiple existing classes into one new class like it is possible in C++? </p>

<p>Maybe there is a solution using some kind of code generation?</p>

<p>Or it may look like this (imaginary c# syntax):</p>

<pre><code>public class FirstAndSecond: IFirst from First, ISecond from Second
{ }
</code></pre>

<p>So that there won't be a need to update the class FirstAndSecond when I modify one of the interfaces.</p>

<hr>

<h3>EDIT</h3>

<p>Maybe it would be better to consider a practical example:</p>

<p>You have an existing class (e.g. a text based TCP client based on ITextTcpClient) which you do already use at different locations inside your project.  Now you feel the need to create a component of your class to be easy accessible for windows forms developers.</p>

<p>As far as I know you currently have two ways to do this:</p>

<ol>
<li><p>Write a new class that is inherited from components and implements the interface of the TextTcpClient class using an instance of the class itself as shown with FirstAndSecond.</p></li>
<li><p>Write a new class that inherits from TextTcpClient and somehow implements IComponent (haven't actually tried this yet).</p></li>
</ol>

<p>In both cases you need to do work per method and not per class. Since you know that we will need all the methods of TextTcpClient and Component it would be the easiest solution to just combine those two into one class.</p>

<p>To avoid conflicts this may be done by code generation where the result could be altered afterwards but typing this by hand is a pure pain in the ass.</p>
","<blockquote>
  <p>Since multiple inheritance is bad (it makes the source more complicated) C# does not provide such a pattern directly. But sometimes it would be helpful to have this ability.</p>
</blockquote>

<p>C# and the .net CLR have not implemented MI because they have not concluded how it would inter-operate between C#, VB.net and the other languages yet, not because ""it would make source more complex""</p>

<p>MI is a useful concept, the un-answered questions are ones like:- ""What do you do when you have multiple common base classes in the different superclasses?</p>

<p>Perl is the only language I've ever worked with where MI works and works well. .Net may well introduce it one day but not yet, the CLR does already support MI but as I've said, there are no language constructs for it beyond that yet.</p>

<p>Until then you are stuck with Proxy objects and multiple Interfaces instead :(</p>
","1695631"
"DateTime.ToString(""MM/dd/yyyy HH:mm:ss.fff"") resulted in something like ""09/14/2013 07.20.31.371""","311836","","<p>I have a WP8 app, which will send the current time to a web service.</p>

<p>I get the datetime string by calling </p>

<pre><code>DateTime.ToString(""MM/dd/yyyy HH:mm:ss.fff"")
</code></pre>

<p>For most users it works great and gives me the correct string like <code>""09/10/2013 04:04:31.415""</code>. But for some user the resulted string is something like <code>""09/14/2013 07.20.31.371""</code>, which causes problem in my web service.</p>

<p>Is it because some culture format issue? How can I make sure the result string is delimited by colon instead of dot?</p>
","<blockquote>
  <p>Is it because some culture format issue?</p>
</blockquote>

<p>Yes. Your user must be in a culture where the time separator is a dot. Both "":"" and ""/"" are interpreted in a culture-sensitive way in <a href=""http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx"" rel=""noreferrer"">custom date and time formats</a>.</p>

<blockquote>
  <p>How can I make sure the result string is delimited by colon instead of dot?</p>
</blockquote>

<p>I'd suggest specifying <code>CultureInfo.InvariantCulture</code>:</p>

<pre><code>string text = dateTime.ToString(""MM/dd/yyyy HH:mm:ss.fff"",
                                CultureInfo.InvariantCulture);
</code></pre>

<p>Alternatively, you <em>could</em> just quote the time and date separators:</p>

<pre><code>string text = dateTime.ToString(""MM'/'dd'/'yyyy HH':'mm':'ss.fff"");
</code></pre>

<p>... but that will give you ""interesting"" results that you probably don't expect if you get users running in a culture where the default calendar system isn't the Gregorian calendar. For example, take the following code:</p>

<pre><code>using System;
using System.Globalization;
using System.Threading;

class Test
{
    static void Main()        
    {
        DateTime now = DateTime.Now;
        CultureInfo culture = new CultureInfo(""ar-SA""); // Saudi Arabia
        Thread.CurrentThread.CurrentCulture = culture;
        Console.WriteLine(now.ToString(""yyyy-MM-ddTHH:mm:ss.fff""));
    }
} 
</code></pre>

<p>That produces output (on September 18th 2013) of:</p>

<pre><code>11/12/1434 15:04:31.750
</code></pre>

<p>My guess is that your web service would be surprised by that!</p>

<p>I'd actually suggest not only using the invariant culture, but <em>also</em> changing to an ISO-8601 date format:</p>

<pre><code>string text = dateTime.ToString(""yyyy-MM-ddTHH:mm:ss.fff"");
</code></pre>

<p>This is a more globally-accepted format - it's also sortable, and makes the month and day order obvious. (Whereas 06/07/2013 could be interpreted as June 7th or July 6th depending on the reader's culture.)</p>
","18874187"
"How to remove all event handlers from a control","309757","","<p>To create a new event handler on a control you can do this</p>

<pre><code>c.Click += new EventHandler(mainFormButton_Click);
</code></pre>

<p>or this</p>

<pre><code>c.Click += mainFormButton_Click;
</code></pre>

<p>and to remove an event handler you can do this</p>

<pre><code>c.Click -= mainFormButton_Click;
</code></pre>

<p>But how do you remove all event handlers from a control?</p>
","<p>I found a solution on the <a href=""http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/576f69e7-55aa-4574-8d31-417422954689/"" rel=""noreferrer"">MSDN forums</a>. The sample code below will remove all <code>Click</code> events from <code>button1</code>.</p>

<pre><code>public partial class Form1 : Form
{
        public Form1()
        {
            InitializeComponent();

            button1.Click += button1_Click;
            button1.Click += button1_Click2;
            button2.Click += button2_Click;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            MessageBox.Show(""Hello"");
        }

        private void button1_Click2(object sender, EventArgs e)
        {
            MessageBox.Show(""World"");
        }

        private void button2_Click(object sender, EventArgs e)
        {
            RemoveClickEvent(button1);
        }

        private void RemoveClickEvent(Button b)
        {
            FieldInfo f1 = typeof(Control).GetField(""EventClick"", 
                BindingFlags.Static | BindingFlags.NonPublic);
            object obj = f1.GetValue(b);
            PropertyInfo pi = b.GetType().GetProperty(""Events"",  
                BindingFlags.NonPublic | BindingFlags.Instance);
            EventHandlerList list = (EventHandlerList)pi.GetValue(b, null);
            list.RemoveHandler(obj, list[obj]);
        }
    }
}
</code></pre>
","91853"
"JavaScript: Alert.Show(message) From ASP.NET Code-behind","309554","","<p>I am reading this <a href=""http://archive.devnewz.com/devnewz-3-20061129JavaScriptAlertShowmessagefromASPNETCodebehind.html"" rel=""noreferrer"">JavaScript: Alert.Show(message) From ASP.NET Code-behind</a></p>

<p>I am trying to implement the same. So I created a static class like this:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Data.SqlClient;
using System.Web;
using System.Text;
using System.Web.UI;

namespace Registration.DataAccess
{
    public static class Repository
    {
        /// &lt;summary&gt; 
        /// Shows a client-side JavaScript alert in the browser. 
        /// &lt;/summary&gt; 
        /// &lt;param name=""message""&gt;The message to appear in the alert.&lt;/param&gt; 
        public static void Show(string message) 
            { 
               // Cleans the message to allow single quotation marks 
               string cleanMessage = message.Replace(""'"", ""\'""); 
               string script = ""&lt;script type=""text/javascript""&gt;alert('"" + cleanMessage + ""');&lt;/script&gt;""; 

               // Gets the executing web page 
               Page page = HttpContext.Current.CurrentHandler as Page; 

               // Checks if the handler is a Page and that the script isn't allready on the Page 
               if (page != null &amp;&amp; !page.ClientScript.IsClientScriptBlockRegistered(""alert"")) 
               { 
                 page.ClientScript.RegisterClientScriptBlock(typeof(Alert), ""alert"", script); 
               } 
            } 
    }
}
</code></pre>

<p>On this line: </p>

<pre><code>string script = ""&lt;script type=""text/javascript""&gt;alert('"" + cleanMessage + ""');&lt;/script&gt;""; 
</code></pre>

<p>It is showing me err: <strong>; Expected</strong></p>

<p>And also on </p>

<pre><code>page.ClientScript.RegisterClientScriptBlock(typeof(Alert), ""alert"", script); 
</code></pre>

<p>Err: <strong>The type or namespace name 'Alert' could not be found (are you missing a using directive or an assembly reference?)</strong></p>

<p>What I am doing wrong here? </p>
","<p>Here is an easy way:</p>

<pre><code>Response.Write(""&lt;script&gt;alert('Hello');&lt;/script&gt;"");
</code></pre>
","5827956"
"How do you do a deep copy of an object in .NET (C# specifically)?","309488","","<p>I want a true deep copy. In Java, this was easy, but how do you do it in C#?</p>
","<p>I've seen a few different approaches to this, but I use a generic utility method as such:    </p>

<pre><code>public static T DeepClone&lt;T&gt;(T obj)
{
 using (var ms = new MemoryStream())
 {
   var formatter = new BinaryFormatter();
   formatter.Serialize(ms, obj);
   ms.Position = 0;

   return (T) formatter.Deserialize(ms);
 }
}
</code></pre>

<p>Notes:</p>

<ul>
<li>Your class MUST be marked as <code>[Serializable]</code> in order for this to work.  </li>
<li><p>Your source file must include the following code:</p>

<pre><code>using System.Runtime.Serialization.Formatters.Binary;
using System.IO;
</code></pre></li>
</ul>
","129395"
"How to get current page URL in MVC 3","309400","","<p>I am using the Facebook comments plugin on a blog I am building. It has some FBXML tags that are interpreted by the facebook javascript that is referenced on the page.</p>

<p>This all works fine, but I have to pass in the current, fully-qualified URL to the plugin.</p>

<pre><code>&lt;div style=""width: 900px; margin: auto;""&gt;
    &lt;div id=""fb-root""&gt;&lt;/div&gt;
    &lt;fb:comments href=""URL HERE"" num_posts=""10"" width=""900""&gt;&lt;/fb:comments&gt;
&lt;/div&gt;
</code></pre>

<p>What is the best way to get the URL of the current page? The request URL.</p>

<h3>Solution</h3>

<p>Here is the final code of my solution:</p>

<pre><code>&lt;fb:comments href=""@Request.Url.AbsoluteUri"" num_posts=""15"" width=""900""&gt;&lt;/fb:comments&gt;
</code></pre>
","<p>You could use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.httprequestbase.rawurl.aspx"" rel=""noreferrer""><code>Request.RawUrl</code></a>, <a href=""http://msdn.microsoft.com/en-us/library/system.uri.originalstring.aspx"" rel=""noreferrer""><code>Request.Url.OriginalString</code></a>, <code>Request.Url.ToString()</code> or <code>Request.Url.AbsoluteUri</code>.</p>
","5304805"
"How to change row color in datagridview?","309195","","<p>I would like to change the color of a particular row in my datagridview. The row should be changed to red when the value of columncell 7 is less than the value in columncell 10. Any suggestions on how to accomplish this?</p>
","<p>You need to loop through the rows in the datagridview and then compare values of columns 7 and 10 on each row.</p>

<p>Try this:</p>

<pre><code>foreach (DataGridViewRow row in vendorsDataGridView.Rows) 
     if (Convert.ToInt32(row.Cells[7].Value) &lt; Convert.ToInt32(row.Cells[10].Value)) 
     {
         row.DefaultCellStyle.BackColor = Color.Red; 
     }
</code></pre>
","2193018"
"C# Equivalent of SQL Server DataTypes","309189","","<p>For the following SQL Server datatypes, what would be the corresponding datatype in C#?</p>

<p><strong>Exact Numerics</strong></p>

<pre><code>bigint
numeric
bit
smallint
decimal
smallmoney
int
tinyint
money
</code></pre>

<hr>

<p><strong>Approximate Numerics</strong></p>

<pre><code>float
real
</code></pre>

<hr>

<p><strong>Date and Time</strong></p>

<pre><code>date
datetimeoffset
datetime2
smalldatetime
datetime
time
</code></pre>

<hr>

<p><strong>Character Strings</strong></p>

<pre><code>char
varchar
text
</code></pre>

<hr>

<p><strong>Unicode Character Strings</strong></p>

<pre><code>nchar
nvarchar
ntext
</code></pre>

<hr>

<p><strong>Binary Strings</strong></p>

<pre><code>binary
varbinary
image
</code></pre>

<hr>

<p><strong>Other Data Types</strong></p>

<pre><code>cursor
timestamp
hierarchyid
uniqueidentifier
sql_variant
xml
table
</code></pre>

<p>(source: <a href=""http://msdn.microsoft.com/en-us/library/ms187752.aspx"" rel=""noreferrer"">MSDN</a>)</p>
","<p>This is for <a href=""http://msdn.microsoft.com/en-us/library/ms131092(SQL.90).aspx"" rel=""noreferrer"">SQL Server 2005</a>. There are updated versions of the table for <a href=""http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.100%29.aspx"" rel=""noreferrer"">SQL Server 2008</a>, <a href=""http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.105%29.aspx"" rel=""noreferrer"">SQL Server 2008 R2</a>, <a href=""http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.110%29.aspx"" rel=""noreferrer"">SQL Server 2012</a> and <a href=""http://msdn.microsoft.com/en-us/library/ms131092(v=sql.120).aspx"" rel=""noreferrer"">SQL Server 2014</a>.</p>

<h2>SQL Server Data Types and Their .NET Framework Equivalents</h2>

<p>The following table lists Microsoft SQL Server data types, their equivalents in the common language runtime (CLR) for SQL Server in the <strong>System.Data.SqlTypes</strong> namespace, and their native CLR equivalents in the Microsoft .NET Framework.</p>

<pre><code>SQL Server data type          CLR data type (SQL Server)    CLR data type (.NET Framework)  
varbinary                     SqlBytes, SqlBinary           Byte[]  
binary                        SqlBytes, SqlBinary           Byte[]  
varbinary(1), binary(1)       SqlBytes, SqlBinary           byte, Byte[] 
image                         None                          None

varchar                       None                          None
char                          None                          None
nvarchar(1), nchar(1)         SqlChars, SqlString           Char, String, Char[]     
nvarchar                      SqlChars, SqlString           String, Char[] 
nchar                         SqlChars, SqlString           String, Char[] 
text                          None                          None
ntext                         None                          None

uniqueidentifier              SqlGuid                       Guid 
rowversion                    None                          Byte[]  
bit                           SqlBoolean                    Boolean 
tinyint                       SqlByte                       Byte 
smallint                      SqlInt16                      Int16  
int                           SqlInt32                      Int32  
bigint                        SqlInt64                      Int64 

smallmoney                    SqlMoney                      Decimal  
money                         SqlMoney                      Decimal  
numeric                       SqlDecimal                    Decimal  
decimal                       SqlDecimal                    Decimal  
real                          SqlSingle                     Single  
float                         SqlDouble                     Double  

smalldatetime                 SqlDateTime                   DateTime  
datetime                      SqlDateTime                   DateTime 

sql_variant                   None                          Object  
User-defined type(UDT)        None                          user-defined type     
table                         None                          None 
cursor                        None                          None
timestamp                     None                          None 
xml                           SqlXml                        None
</code></pre>
","968734"
"Making a Simple Ajax call to controller in asp.net mvc","308927","","<p>I'm trying to get started with ASP.NET MVC Ajax calls.</p>

<p><strong>Controller:</strong></p>

<pre><code>public class AjaxTestController : Controller
{
    //
    // GET: /AjaxTest/
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult FirstAjax()
    {
        return Json(""chamara"", JsonRequestBehavior.AllowGet);
    }   
}
</code></pre>

<p><strong>View:</strong></p>

<pre><code>&lt;head runat=""server""&gt;
    &lt;title&gt;FirstAjax&lt;/title&gt;
    &lt;script src=""http://code.jquery.com/jquery-1.9.1.js""&gt;&lt;/script&gt;
    &lt;script src=""http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js""&gt;&lt;/script&gt;
    &lt;script type=""text/javascript""&gt;
        $(document).ready(function () {
            var serviceURL = '/AjaxTest/FirstAjax';

            $.ajax({
                type: ""POST"",
                url: serviceURL,
                data: param = """",
                contentType: ""application/json; charset=utf-8"",
                dataType: ""json"",
                success: successFunc,
                error: errorFunc
            });

            function successFunc(data, status) {     
                alert(data);
            }

            function errorFunc() {
                alert('error');
            }
        });
    &lt;/script&gt;
&lt;/head&gt;
</code></pre>

<p>I just need to print an alert with the controller method returning data. Above code just print ""chamara"" on my view. An alert is not firing.</p>

<p><strong>UPDATE</strong></p>

<p>I modified my controller as below and it start working. I don't have an clear idea why it's working now. Some one please explain. The parameter ""a"" does not related i added it because i can not add two methods with same method name and parameters.I think this might not be the solution but its working</p>

<pre><code>public class AjaxTestController : Controller
    {
        //
        // GET: /AjaxTest/
        [HttpGet]
        public ActionResult FirstAjax()
        {
            return View();
        }

        [HttpPost]
        public ActionResult FirstAjax(string a)
        {
            return Json(""chamara"", JsonRequestBehavior.AllowGet);
        }
    }
</code></pre>
","<p>After the update you have done, </p>

<ol>
<li>its first calling the FirstAjax action with default HttpGet request
and renders the blank Html view . (Earlier you were not having it) </li>
<li>later on  loading of DOM elements of that view your Ajax call get fired and displays alert.</li>
</ol>

<p>Earlier you were only returning JSON to browser without rendering any HTML. Now it has a HTML view rendered where it can get your JSON Data. </p>

<p>You can't directly render JSON its plain data not HTML.</p>
","16207638"
"ASP.NET MVC get textbox input value","308873","","<p>I have a textbox input and some radio buttons. For example my textbox input HTML looks like that:</p>

<pre><code>&lt;input type=""text"" name=""IP"" id=""IP"" /&gt;
</code></pre>

<p>Once user clicks a button on a web page I want to pass data to my controller:</p>

<pre><code>&lt;input type=""button"" name=""Add"" value=""@Resource.ButtonTitleAdd""  onclick=""location.href='@Url.Action(""Add"", ""Configure"", new { ipValue =@[ValueOfTextBox], TypeId = 1 })'""/&gt;
</code></pre>

<p>Maybe it is trivial but my problem is that I do not know how to get textbox value and pass it through to the controller. How can I read the textbox value and pass it to the controller through <code>ipValue=@[ValueOfTextBox]</code>?</p>
","<p>Simple ASP.NET MVC subscription form with email textbox would be implemented like that:</p>

<h2>Model</h2>

<p>The data from the form is mapped to this model</p>

<pre><code>public class SubscribeModel
{
    [Required]
    public string Email { get; set; }
}
</code></pre>

<h2>View</h2>

<p>View name should match controller method name.</p>

<pre><code>@model App.Models.SubscribeModel

@using (Html.BeginForm(""Subscribe"", ""Home"", FormMethod.Post))
{
    @Html.TextBoxFor(model =&gt; model.Email)
    @Html.ValidationMessageFor(model =&gt; model.Email)
    &lt;button type=""submit""&gt;Subscribe&lt;/button&gt;
}
</code></pre>

<h2>Controller</h2>

<p>Controller is responsible for request processing and returning proper response view.</p>

<pre><code>public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public ActionResult Subscribe(SubscribeModel model)
    {
        if (ModelState.IsValid)
        {
            //TODO: SubscribeUser(model.Email);
        }

        return View(""Index"", model);
    }
}
</code></pre>

<p>Here is my project structure. Please notice, ""Home"" views folder matches HomeController name.</p>

<p><a href=""https://i.stack.imgur.com/AMHPm.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/AMHPm.png"" alt=""ASP.NET MVC structure""></a></p>
","18873263"
"Conversion of System.Array to List","307842","","<p>Last night I had dream that the following was impossible. But in the same dream, someone from SO told me otherwise.  Hence I would like to know if it it possible to convert <code>System.Array</code> to <code>List</code></p>

<pre><code>Array ints = Array.CreateInstance(typeof(int), 5);
ints.SetValue(10, 0);
ints.SetValue(20, 1);
ints.SetValue(10, 2);
ints.SetValue(34, 3);
ints.SetValue(113, 4);
</code></pre>

<p>to</p>

<pre><code>List&lt;int&gt; lst = ints.OfType&lt;int&gt;(); // not working
</code></pre>
","<p>Save yourself some pain...</p>

<pre><code>using System.Linq;

int[] ints = new [] { 10, 20, 10, 34, 113 };

List&lt;int&gt; lst = ints.OfType&lt;int&gt;().ToList(); // this isn't going to be fast.
</code></pre>

<p>Can also just...</p>

<pre><code>List&lt;int&gt; lst = new List&lt;int&gt; { 10, 20, 10, 34, 113 };
</code></pre>

<p>or...</p>

<pre><code>List&lt;int&gt; lst = new List&lt;int&gt;();
lst.Add(10);
lst.Add(20);
lst.Add(10);
lst.Add(34);
lst.Add(113);
</code></pre>

<p>or...</p>

<pre><code>List&lt;int&gt; lst = new List&lt;int&gt;(new int[] { 10, 20, 10, 34, 113 });
</code></pre>

<p>or...</p>

<pre><code>var lst = new List&lt;int&gt;();
lst.AddRange(new int[] { 10, 20, 10, 34, 113 });
</code></pre>
","1603173"
"Update all objects in a collection using LINQ","307478","","<p>Is there a way to do the following using LINQ?</p>

<pre><code>foreach (var c in collection)
{
    c.PropertyToSet = value;
}
</code></pre>

<p>To clarify, I want to iterate through each object in a collection and then update a property on each object.</p>

<p>My use case is I have a bunch of comments on a blog post, and I want to iterate through each comment on a blog post and set the datetime on the blog post to be +10 hours. I could do it in SQL, but I want to keep it in the business layer.</p>
","<p>While you can use a <code>ForEach</code> extension method, if you want to use just the framework you can do</p>

<pre><code>collection.Select(c =&gt; {c.PropertyToSet = value; return c;}).ToList();
</code></pre>

<p>The <code>ToList</code> is needed in order to evaluate the select immediately due to <em>lazy evaluation</em>.</p>
","399073"
"Difference Between Select and SelectMany","306749","","<p>I've been searching the difference between <code>Select</code> and <code>SelectMany</code> but I haven't been able to find a suitable answer. I need to learn the difference when using LINQ To SQL but all I've found are standard array examples. </p>

<p>Can someone provide a LINQ To SQL example?</p>
","<p><code>SelectMany</code> flattens queries that return lists of lists. For example</p>

<pre><code>public class PhoneNumber
{
    public string Number { get; set; }
}

public class Person
{
    public IEnumerable&lt;PhoneNumber&gt; PhoneNumbers { get; set; }
    public string Name { get; set; }
}

IEnumerable&lt;Person&gt; people = new List&lt;Person&gt;();

// Select gets a list of lists of phone numbers
IEnumerable&lt;IEnumerable&lt;PhoneNumber&gt;&gt; phoneLists = people.Select(p =&gt; p.PhoneNumbers);

// SelectMany flattens it to just a list of phone numbers.
IEnumerable&lt;PhoneNumber&gt; phoneNumbers = people.SelectMany(p =&gt; p.PhoneNumbers);

// And to include data from the parent in the result: 
// pass an expression to the second parameter (resultSelector) in the overload:
var directory = people
   .SelectMany(p =&gt; p.PhoneNumbers,
               (parent, child) =&gt; new { parent.Name, child.Number });
</code></pre>

<p><a href=""https://dotnetfiddle.net/LNyymI"" rel=""noreferrer"">Live Demo on .NET Fiddle</a></p>
","959057"
"How to generate getters and setters in Visual Studio?","306294","","<p>By ""generate"", I mean auto-generation of the code necessary for a particuliar selected (set of) variable(s).</p>

<p>But any more explicit explication or comment on good practice is welcome.</p>
","<p>Rather than using <kbd>ctrl</kbd>+<kbd>k</kbd>,<kbd>x</kbd> you can also just type <code>prop</code> and then hit tab twice</p>
","3029"
"Efficient way to remove ALL whitespace from String?","304691","","<p>I'm calling a REST API and am receiving an XML response back. It returns a list of a workspace names, and I'm writing a quick <code>IsExistingWorkspace()</code> method. Since all workspaces consist of contiguous characters with no whitespace, I'm assuming the easiest way to find out if a particular workspace is in the list is to remove all whitespace (including newlines) and doing this (XML is the string received from the web request):</p>

<pre><code>XML.Contains(""&lt;name&gt;"" + workspaceName + ""&lt;/name&gt;"");
</code></pre>

<p>I know it's case-sensitive, and I'm relying on that. I just need a way to remove all whitespace in a string efficiently. I know RegEx and LINQ can do it, but I'm open to other ideas. I am mostly just concerned about speed.</p>
","<p>This is fastest way I know of, even though you said you didn't want to use regular expressions:</p>

<pre><code>Regex.Replace(XML, @""\s+"", """")
</code></pre>
","6219488"
"How can I build XML in C#?","303513","","<p>How can I generate valid XML in C#?</p>
","<p>It depends on the scenario. <code>XmlSerializer</code> is certainly one way and has the advantage of mapping directly to an object model. In .NET 3.5, <code>XDocument</code>, etc. are also very friendly. If the size is very large, then <code>XmlWriter</code> is your friend.</p>

<p>For an <code>XDocument</code> example:</p>

<pre><code>Console.WriteLine(
    new XElement(""Foo"",
        new XAttribute(""Bar"", ""some &amp; value""),
        new XElement(""Nested"", ""data"")));
</code></pre>

<p>Or the same with <code>XmlDocument</code>:</p>

<pre><code>XmlDocument doc = new XmlDocument();
XmlElement el = (XmlElement)doc.AppendChild(doc.CreateElement(""Foo""));
el.SetAttribute(""Bar"", ""some &amp; value"");
el.AppendChild(doc.CreateElement(""Nested"")).InnerText = ""data"";
Console.WriteLine(doc.OuterXml);
</code></pre>

<p>If you are writing a <strong>large</strong> stream of data, then any of the DOM approaches (such as <code>XmlDocument</code>/<code>XDocument</code>, etc.) will quickly take a lot of memory. So if you are writing a 100&nbsp;MB XML file from <a href=""http://en.wikipedia.org/wiki/Comma-separated_values"" rel=""noreferrer"">CSV</a>, you might consider <code>XmlWriter</code>; this is more primitive (a write-once firehose), but very efficient (imagine a big loop here):</p>

<pre><code>XmlWriter writer = XmlWriter.Create(Console.Out);
writer.WriteStartElement(""Foo"");
writer.WriteAttributeString(""Bar"", ""Some &amp; value"");
writer.WriteElementString(""Nested"", ""data"");
writer.WriteEndElement();
</code></pre>

<p>Finally, via <code>XmlSerializer</code>:</p>

<pre><code>[Serializable]
public class Foo
{
    [XmlAttribute]
    public string Bar { get; set; }
    public string Nested { get; set; }
}
...
Foo foo = new Foo
{
    Bar = ""some &amp; value"",
    Nested = ""data""
};
new XmlSerializer(typeof(Foo)).Serialize(Console.Out, foo);
</code></pre>

<p>This is a nice model for mapping to classes, etc.; however, it might be overkill if you are doing something simple (or if the desired XML doesn't really have a direct correlation to the object model). Another issue with <code>XmlSerializer</code> is that it doesn't like to serialize immutable types : everything must have a public getter <em>and</em> setter (unless you do it all yourself by implementing <code>IXmlSerializable</code>, in which case you haven't gained much by using <code>XmlSerializer</code>).</p>
","284331"
"How to use OpenFileDialog to select a folder?","302663","","<p>How to use <code>OpenFileDialog</code> to select folders?</p>

<p>I was going to use the following project: <a href=""https://github.com/scottwis/OpenFileOrFolderDialog"">https://github.com/scottwis/OpenFileOrFolderDialog</a></p>

<p>However, I faced one problem. It uses the <code>GetOpenFileName</code> function and <code>OPENFILENAME</code> structure. And <code>OPENFILENAME</code> has the member named <code>templateID</code>. It's the identifier for dialog template. And the project contains the <code>res1.rc</code> file and the templated dialog init, too. But I couldn't figure out how to attach this file to my C# project.</p>

<p>Is there a better way to use an <code>OpenFileDialog</code> to select folders?</p>
","<p>Basically you need the <strong><a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx"" rel=""noreferrer""><code>FolderBrowserDialog</code></a></strong> class:</p>

<blockquote>
  <p>Prompts the user to select a folder. This class cannot be inherited.</p>
</blockquote>

<p>Example:</p>

<pre><code>using(var fbd = new FolderBrowserDialog())
{
    DialogResult result = fbd.ShowDialog();

    if (result == DialogResult.OK &amp;&amp; !string.IsNullOrWhiteSpace(fbd.SelectedPath))
    {
        string[] files = Directory.GetFiles(fbd.SelectedPath);

        System.Windows.Forms.MessageBox.Show(""Files found: "" + files.Length.ToString(), ""Message"");
    }
}
</code></pre>

<p>If you work in <strong>WPF</strong> you have to add the reference to <code>System.Windows.Forms</code>.</p>

<p>you also have to add <code>using System.IO</code> for <code>Directory</code> class</p>
","11624322"
"how to bind a list to a combobox? (Winforms)","302483","","<p>I want to connect a binding source to a list of class objects and then objects value to a combo box can anyone suggest how to do it </p>

<pre><code>public class Country
    {
        public string Name { get; set; }
        public IList&lt;City&gt; Cities { get; set; }

        public Country()
        {
            Cities = new List&lt;City&gt;();
        }
    }
</code></pre>

<p>is my class and i want to bind its name field to a binding source which could be then associated with a combobox</p>
","<p>As you are referring to a combobox, I'm assuming you don't want to use 2-way databinding (if so, look at using a <code>BindingList</code>)</p>

<pre><code>public class Country
{
    public string Name { get; set; }
    public IList&lt;City&gt; Cities { get; set; }
    public Country(string _name)
    {
        Cities = new List&lt;City&gt;();
        Name = _name;
    }
}
</code></pre>

<p><br><br/></p>

<pre><code>List&lt;Country&gt; countries = new List&lt;Country&gt; { new Country(""UK""), 
                                     new Country(""Australia""), 
                                     new Country(""France"") };

bindingSource1.DataSource = countries;

comboBox1.DataSource = bindingSource1.DataSource;

comboBox1.DisplayMember = ""Name"";
comboBox1.ValueMember = ""Name"";
</code></pre>
","600892"
"Append lines to a file using a StreamWriter","301843","","<p>I want to append lines to my file. I am using a StreamWriter:</p>

<pre><code>StreamWriter file2 = new StreamWriter(@""c:\file.txt"");
file2.WriteLine(someString);
file2.Close();
</code></pre>

<p>The output of my file should be several strings below each other, but I have only one row, which is overwritten every time I run this code.</p>

<p>Is there some way to let the StreamWriter append to an existing file?</p>
","<p>Use this instead:</p>

<pre><code>new StreamWriter(""c:\\file.txt"", true);
</code></pre>

<p>With this overload of the StreamWriter constructor you choose if you append the file, or overwrite it. </p>

<p>C# 4 and above offers the following syntax, which some find more readable:</p>

<pre><code>new StreamWriter(""c:\\file.txt"", append: true);
</code></pre>
","7306236"
"Index of Currently Selected Row in DataGridView","301383","","<p>It's that simple. How do I get the index of the currently selected <code>Row</code> of a <code>DataGridView</code>? I don't want the <code>Row</code> object, I want the index (0 .. n).</p>
","<p>There is the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.rowindex.aspx"" rel=""noreferrer""><code>RowIndex</code></a> property for the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcell.aspx"" rel=""noreferrer""><code>CurrentCell</code></a> property for the DataGridView.</p>

<pre><code>datagridview.CurrentCell.RowIndex
</code></pre>

<p>Handle the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.selectionchanged.aspx"" rel=""noreferrer""><code>SelectionChanged</code></a> event and find the index of the selected row as above.</p>
","3578198"
"Regex Email validation","301081","","<p>I use this</p>

<pre><code>@""^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$""
</code></pre>

<p>regexp to validate the email</p>

<p><code>([\w\.\-]+)</code> - this is for the first-level domain (many letters and numbers, also point and hyphen)<br><br>
<code>([\w\-]+)</code> - this is for second-level domain<br><br>
<code>((\.(\w){2,3})+)</code> - and this is for other level domains(from 3 to infinity) which includes a point and 2 or 3 literals<br></p>

<p>what's wrong with this regex?</p>

<p>EDIT:it doesn't match the ""something@someth.ing"" email</p>
","<p>TLD's like <a href=""http://en.wikipedia.org/wiki/.museum"" rel=""noreferrer"">.museum</a> aren't matched this way, and there are a few other long TLD's. Also, you can validate email addresses using the <a href=""http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddress.aspx"" rel=""noreferrer"">MailAddress class</a> as Microsoft explains <a href=""http://msdn.microsoft.com/en-us/library/01escwtf.aspx"" rel=""noreferrer"">here</a> in a note:</p>

<blockquote>
  <p>Instead of using a regular expression to validate an email address,
  you can use the System.Net.Mail.MailAddress class. To determine
  whether an email address is valid, pass the email address to the
  MailAddress.MailAddress(String) class constructor.</p>
</blockquote>

<pre><code>public bool IsValid(string emailaddress)
{
    try
    {
        MailAddress m = new MailAddress(emailaddress);

        return true;
    }
    catch (FormatException)
    {
        return false;
    }
}
</code></pre>

<p>This saves you a lot af headaches because you don't have to write (or try to understand someone else's) regex.</p>
","5342460"
"Convert generic List/Enumerable to DataTable?","300343","","<p>I have few methods that returns different Generic Lists. </p>

<p>Exists in .net any class static method or whatever to convert any list into a datatable? The only thing that i can imagine is use Reflection to do this.</p>

<p>IF i have this:</p>

<pre><code>List&lt;Whatever&gt; whatever = new List&lt;Whatever&gt;();
</code></pre>

<p>(This next code doesn't work of course, but i would like to have the possibility of:</p>

<pre><code>DataTable dt = (DataTable) whatever;
</code></pre>
","<p>Here's a nice 2013 update using <a href=""http://nuget.org/packages/FastMember/"" rel=""noreferrer"">FastMember</a> from NuGet:</p>

<pre><code>IEnumerable&lt;SomeType&gt; data = ...
DataTable table = new DataTable();
using(var reader = ObjectReader.Create(data)) {
    table.Load(reader);
}
</code></pre>

<p>This uses the FastMember's meta-programming API for maximum performance. If you want to restrict it to particular members (or enforce the order), then you can do that too:</p>

<pre><code>IEnumerable&lt;SomeType&gt; data = ...
DataTable table = new DataTable();
using(var reader = ObjectReader.Create(data, ""Id"", ""Name"", ""Description"")) {
    table.Load(reader);
}
</code></pre>

<p>Editor's <em>Dis</em>/<strong>claimer:</strong> FastMember is a Marc Gravell project. Its gold and  full-on flys!</p>

<hr>

<p>Yes, this is pretty much the exact opposite of <a href=""https://stackoverflow.com/questions/545328/asp-net-potential-memory-leaks-converting-datatable-to-lists/545429#545429"">this</a> one; reflection would suffice - or if you need quicker, <a href=""http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx"" rel=""noreferrer""><code>HyperDescriptor</code></a> in 2.0, or maybe <code>Expression</code> in 3.5. Actually, <code>HyperDescriptor</code> should be more than adequate.</p>

<p>For example:</p>

<pre><code>// remove ""this"" if not on C# 3.0 / .NET 3.5
public static DataTable ToDataTable&lt;T&gt;(this IList&lt;T&gt; data)
{
    PropertyDescriptorCollection props =
        TypeDescriptor.GetProperties(typeof(T));
    DataTable table = new DataTable();
    for(int i = 0 ; i &lt; props.Count ; i++)
    {
        PropertyDescriptor prop = props[i];
        table.Columns.Add(prop.Name, prop.PropertyType);
    }
    object[] values = new object[props.Count];
    foreach (T item in data)
    {
        for (int i = 0; i &lt; values.Length; i++)
        {
            values[i] = props[i].GetValue(item);
        }
        table.Rows.Add(values);
    }
    return table;        
}
</code></pre>

<p>Now with one line you can make this many many times faster than reflection (by enabling <a href=""http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx"" rel=""noreferrer""><code>HyperDescriptor</code></a> for the object-type <code>T</code>).</p>

<hr>

<p>edit re performance query; here's a test rig with results:</p>

<pre><code>Vanilla 27179
Hyper   6997
</code></pre>

<p>I suspect that the bottleneck has shifted from member-access to <code>DataTable</code> performance... I doubt you'll improve much on that...</p>

<p>code:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
public class MyData
{
    public int A { get; set; }
    public string B { get; set; }
    public DateTime C { get; set; }
    public decimal D { get; set; }
    public string E { get; set; }
    public int F { get; set; }
}

static class Program
{
    static void RunTest(List&lt;MyData&gt; data, string caption)
    {
        GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
        GC.WaitForPendingFinalizers();
        GC.WaitForFullGCComplete();
        Stopwatch watch = Stopwatch.StartNew();
        for (int i = 0; i &lt; 500; i++)
        {
            data.ToDataTable();
        }
        watch.Stop();
        Console.WriteLine(caption + ""\t"" + watch.ElapsedMilliseconds);
    }
    static void Main()
    {
        List&lt;MyData&gt; foos = new List&lt;MyData&gt;();
        for (int i = 0 ; i &lt; 5000 ; i++ ){
            foos.Add(new MyData
            { // just gibberish...
                A = i,
                B = i.ToString(),
                C = DateTime.Now.AddSeconds(i),
                D = i,
                E = ""hello"",
                F = i * 2
            });
        }
        RunTest(foos, ""Vanilla"");
        Hyper.ComponentModel.HyperTypeDescriptionProvider.Add(
            typeof(MyData));
        RunTest(foos, ""Hyper"");
        Console.ReadLine(); // return to exit        
    }
}
</code></pre>
","564373"
"Initialize a byte array to a certain value, other than the default null?","299269","","<p>I'm busy rewriting an old project that was done in C++, to C#. </p>

<p>My task is to rewrite the program so that it functions as close to the original as possible.</p>

<p>During a bunch of file-handling the previous developer who wrote this program creates a structure containing a ton of fields that correspond to the set format that a file has to be written in, so all that work is already done for me. </p>

<p>These fields are all byte arrays. What the C++ code then does is use <code>memset</code> to set this entire structure to all spaces characters (<code>0x20</code>). One line of code. Easy.</p>

<p>This is very important as the utility that this file eventually goes to is expecting the file in this format. What I've had to do is change this struct to a class in C#, but I cannot find a way to easily initialize each of these byte arrays to all space characters.</p>

<p>What I've ended up having to do is this in the class constructor:</p>

<pre><code>//Initialize all of the variables to spaces.
int index = 0;
foreach (byte b in UserCode)
{
    UserCode[index] = 0x20;
    index++;
}
</code></pre>

<p>This works fine, but I'm sure there must be a simpler way to do this. When the array is set to <code>UserCode = new byte[6]</code> in the constructor the byte array gets automatically initialized to the default null values. Is there no way that I can make it become all spaces upon declaration, so that when I call my class' constructor that it is initialized straight away like this? Or some <code>memset</code>-like function?</p>
","<p>For small arrays use array initialisation syntax:</p>

<pre><code>var sevenItems = new byte[] { 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 };
</code></pre>

<p>For larger arrays use a standard <code>for</code> loop. This is the most readable and efficient way to do it:</p>

<pre><code>var sevenThousandItems = new byte[7000];
for (int i = 0; i &lt; sevenThousandItems.Length; i++)
{
    sevenThousandItems[i] = 0x20;
}
</code></pre>

<p>Of course, if you need to do this a lot then you could create a helper method to help keep your code concise:</p>

<pre><code>byte[] sevenItems = CreateSpecialByteArray(7);
byte[] sevenThousandItems = CreateSpecialByteArray(7000);

// ...

public static byte[] CreateSpecialByteArray(int length)
{
    var arr = new byte[length];
    for (int i = 0; i &lt; arr.Length; i++)
    {
        arr[i] = 0x20;
    }
    return arr;
}
</code></pre>
","6150310"
"What does void mean in C, C++, and C#?","299012","","<p>Looking to get the fundamentals on where the term VOID comes from and why it would be called void. The intention of the question is to assist someone who has no C experience and is suddenly looking at a C-based codebase. </p>
","<p>Basically it means ""nothing"" or ""no type""</p>

<p>There are 3 basic ways that void is used:</p>

<ol>
<li><p>Function argument: <code>int myFunc(void)</code>
-- the function takes nothing. </p></li>
<li><p>Function return value: <code>void myFunc(int)</code>
-- the function returns nothing</p></li>
<li><p>Generic data pointer: <code>void* data</code>
-- 'data' is a pointer to data of unknown type, and cannot be dereferenced</p></li>
</ol>

<p>Note: the <code>void</code> in a function argument is optional in C++, so <code>int myFunc()</code> is exactly the same as <code>int myFunc(void)</code>, and it is left out completely in C#. It is always required for a return value.</p>
","1043107"
"How can I find a specific element in a List<T>?","298903","","<p>My application uses a list like this:</p>

<p><code>List&lt;MyClass&gt; list = new List&lt;MyClass&gt;();</code></p>

<p>Using the <code>Add</code> method, another instance of <code>MyClass</code> is added to the list.</p>

<p><code>MyClass</code> provides, among others, the following methods:</p>

<pre><code>public void SetId(String Id);
public String GetId();
</code></pre>

<p>How can I find a specific instance of <code>MyClass</code> by means of using the <code>GetId</code> method? I know there is the <code>Find</code> method, but I don't know if this would work here?!</p>
","<p>Use a lambda expression</p>

<pre><code>MyClass result = list.Find(x =&gt; x.GetId() == ""xy"");
</code></pre>

<hr>

<p>Note: C# has a built-in syntax for properties. Instead of writing Set- and Get-methods, write</p>

<pre><code>private string _id;
public string Id
{
    get
    {
        return _id;
    }
    set
    {
        _id = value;
    }
}
</code></pre>

<p><code>value</code> is a contextual keyword known only in the set accessor. It represents the value assigned to the property.</p>

<p>Since this pattern is often used, C# provides automatically implemented properties. They are a short version of the code above; however, the backing variable is hidden and not accessible (it is accessible from within the class in VB, however).</p>

<pre><code>public string Id { get; set; }
</code></pre>

<p>You can simply use properties as if you were accessing a field:</p>

<pre><code>var obj = new MyClass();
obj.Id = ""xy"";       // Calls the setter with ""xy"" assigned to the value parameter.
string id = obj.Id;  // Calls the getter.
</code></pre>

<hr>

<p>Using properties, you would search for items in the list like this</p>

<pre><code>MyClass result = list.Find(x =&gt; x.Id == ""xy""); 
</code></pre>

<hr>

<p>You can also use automatically implemented properties if you need a read-only property:</p>

<pre><code>public string Id { get; private set; }
</code></pre>

<p>This enables you to set the <code>Id</code> within the class but not from outside. If you need to set it in derived classes as well you can also protect the setter</p>

<pre><code>public string Id { get; protected set; }
</code></pre>

<hr>

<p>And finally, you can declare properties as <code>virtual</code> and override them in deriving classes, allowing you to provide different implementations for getters and setters; just as for ordinary virtual methods.</p>

<hr>

<p>Since C# 6.0 (Visual Studio 2015, Roslyn) you can write getter-only auto-properties with an inline initializer</p>

<pre><code>public string Id { get; } = ""A07""; // Evaluated once when object is initialized.
</code></pre>

<p>You can also initialize getter-only properties within the constructor instead. Getter-only auto-properties are <strong>true</strong> read-only properties, unlike automatically implemented properties with a private setter.</p>

<p>This works also with read-write auto-properties:</p>

<pre><code>public string Id { get; set; } = ""A07"";
</code></pre>

<p>Beginning with C# 6.0 you can also write properties as expression-bodied members</p>

<pre><code>public DateTime Yesterday =&gt; DateTime.Date.AddDays(-1); // Evaluated at each call.
// Instead of
public DateTime Yesterday { get { return DateTime.Date.AddDays(-1); } }
</code></pre>

<p>See: <a href=""https://roslyn.codeplex.com/"" rel=""nofollow noreferrer"">.NET Compiler Platform (""Roslyn"")</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=""https://github.com/dotnet/roslyn/wiki/New-Language-Features-in-C%23-6"" rel=""nofollow noreferrer"">New Language Features in C# 6</a></p>

<p>Starting with <a href=""https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/"" rel=""nofollow noreferrer"">C# 7.0</a>, both, getter and setter, can be written with expression bodies:</p>

<pre><code>public string Name
{
    get =&gt; _name;                                // getter
    set =&gt; _name = value;                        // setter
}
</code></pre>

<p>Note that in this case the setter must be an expression. It cannot be a statement. The example above works, because in C#, an assignment can be used as an expression or as a statement. The value of an assignment expression is the assigned value. The assignment itself is a side effect. This allows you to assign a value to more than one variable at once: <code>x = y = z = 0</code> is equivalent to <code>x = (y = (z = 0))</code>.</p>
","9854944"
"Static readonly vs const","298856","","<p>I've read around about <code>const</code> and <code>static readonly</code> fields. We have some classes which contains only constant values. Used for various things around in our system. So I am wondering if my observation is correct:</p>

<p>Should these kind of constant values always be <code>static readonly</code> for everything that is public? And only use <code>const</code> for internal/protected/private values?</p>

<p>What do you recommend? Should I maybe even not use <code>static readonly</code> fields, but rather use properties maybe?</p>
","<p>Public static readonly fields are a little unusual; public static properties (with only a <code>get</code>) would be more common (perhaps backed by a private static readonly field).</p>

<p>Const values are burned directly into the call-site; this is double edged:</p>

<ul>
<li>it is useless if the value is fetched at runtime, perhaps from config</li>
<li>if you change the value of a const, you need to rebuild all the clients</li>
<li>but it can be faster, as it avoids a method call...</li>
<li>...which might sometimes have been inlined by the JIT anyway</li>
</ul>

<p>If the value will <strong>never</strong> change, then const is fine - <code>Zero</code> etc make reasonable consts ;-p Other than that, static properties are more common.</p>
","755693"
"Serialize an object to XML","297422","","<p>I have a C# class that I have inherited. I have successfully ""built"" the object. But I need to serialize the object to XML. Is there an easy way to do it?</p>

<p>It looks like the class has been set up for serialization, but I'm not sure how to get the XML representation. My class definition looks like this:</p>

<pre><code>[System.CodeDom.Compiler.GeneratedCodeAttribute(""xsd"", ""4.0.30319.1"")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute(""code"")]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true, Namespace = ""http://www.domain.com/test"")]
[System.Xml.Serialization.XmlRootAttribute(Namespace = ""http://www.domain.com/test"", IsNullable = false)]
public partial class MyObject
{
  ...
}
</code></pre>

<p>Here is what I thought I could do, but it doesn't work:</p>

<pre><code>MyObject o = new MyObject();
// Set o properties
string xml = o.ToString();
</code></pre>

<p>How do I get the XML representation of this object?</p>
","<p>You have to use XmlSerializer for XML serialization. Below is a sample snippet.</p>

<pre><code> XmlSerializer xsSubmit = new XmlSerializer(typeof(MyObject));
 var subReq = new MyObject();
 var xml = """";

 using(var sww = new StringWriter())
 {
     using(XmlWriter writer = XmlWriter.Create(sww))
     {
         xsSubmit.Serialize(writer, subReq);
         xml = sww.ToString(); // Your XML
     }
 }
</code></pre>
","4123648"
"Login failed for user 'IIS APPPOOL\ASP.NET v4.0'","296149","","<p>I have a web project (C# Asp.Net, EF 4, MS SQL 2008 and IIS 7) and I need to migrate it to IIS 7 locally (at the moment works fine with CASSINI).</p>

<p>Locally in IIS I have my <code>Default Web Site</code> with my deploy. Both my deploy and <code>Default Web Site</code> are on pool ASP.NET v4.0 (look image for settings) the pool target Framework 4 as my web project.
<img src=""https://i.stack.imgur.com/nNY78.png"" alt=""Pool Settings"">
When visiting the site, the browser does not show the page and allow the browser to download the page instead.</p>

<p>I have other projects running on IIS locally and they work with no problems (but they do not use Entity Framework).</p>

<p>Using the Event Logger I see errors as below:</p>

<pre><code>Exception information: 
    Exception type: EntityException 
    Exception message: The underlying provider failed on Open.
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean&amp; closeStoreConnectionOnFailure)


    Login failed for user 'IIS APPPOOL\ASP.NET v4.0'.
       at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
       at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
       at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
       at System.Data.SqlClient.SqlConnection.Open()
       at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean&amp; closeStoreConnectionOnFailure)
</code></pre>

<p><a href=""https://stackoverflow.com/questions/7697867/passing-from-cassini-to-iis-7"">Related question</a></p>

<p>UPDATE:
You can read in the resources on this question that permissions must be granted on MS SQL 2008 manually as arift explain in his answer.
Using IIS 7.5 and MS SQL 2008 R2, setting manually permission should not be necessary.</p>
","<p>Looks like it's failing trying to open a connection to SQL Server.</p>

<p>You need to add a login to SQL Server for <code>IIS APPPOOL\ASP.NET v4.0</code> and grant permissions to the database.</p>

<p>In SSMS, under the server, expand Security, then right click Logins and select ""New Login..."".</p>

<p>In the New Login dialog, enter the app pool as the login name and click ""OK"".</p>

<p><img src=""https://i.stack.imgur.com/6sfIM.png"" alt=""enter image description here""></p>

<p>You can then right click the login for the app pool, select Properties and select ""User Mapping"".  Check the appropriate database, and the appropriate roles.  I think you could just select <code>db_datareader</code> and <code>db_datawriter</code>, but I think you would still need to grant permissions to execute stored procedures if you do that through EF.  You can check the details for the roles <a href=""http://msdn.microsoft.com/en-us/library/ms189121%28v=SQL.105%29.aspx"" rel=""noreferrer"">here</a>.</p>
","7698316"
"How do I get my C# program to sleep for 50 msec?","296089","","<p>How do I get my C# program to sleep for 50 milliseconds?</p>

<p>This might seem an easy question, but I'm having a temporary brain failure moment!</p>
","<pre><code>System.Threading.Thread.Sleep(50);
</code></pre>

<p>Remember though, that doing this in the main GUI thread will block your GUI from updating (it will feel ""sluggish"")</p>

<p>Just remove the <code>;</code> to make it work for VB.net as well.</p>
","91119"
"How to send email in ASP.NET C#","295920","","<p>I'm very new to the <a href=""http://en.wikipedia.org/wiki/ASP.NET"" rel=""noreferrer"">ASP.NET</a> C# area. I'm planning to send a mail through ASP.NET C# and this is the <a href=""http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol"" rel=""noreferrer"">SMTP</a> address from my <a href=""http://en.wikipedia.org/wiki/Internet_service_provider"" rel=""noreferrer"">ISP</a>: </p>

<pre><code>smtp-proxy.tm.net.my
</code></pre>

<p>Below is what I tried to do, but failed.</p>

<pre><code>&lt;%@ Page Language=""C#"" AutoEventWireup=""true"" CodeFile=""Default.aspx.cs"" Inherits=""SendMail"" %&gt;
&lt;html&gt;
&lt;head id=""Head1"" runat=""server""&gt;&lt;title&gt;Email Test Page&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;form id=""form1"" runat=""server""&gt;
        Message to: &lt;asp:TextBox ID=""txtTo"" runat=""server"" /&gt;&lt;br&gt;
        Message from: &lt;asp:TextBox ID=""txtFrom"" runat=""server"" /&gt;&lt;br&gt;
        Subject: &lt;asp:TextBox ID=""txtSubject"" runat=""server"" /&gt;&lt;br&gt;
        Message Body:&lt;br&gt;
        &lt;asp:TextBox ID=""txtBody"" runat=""server"" Height=""171px"" TextMode=""MultiLine""  Width=""270px"" /&gt;&lt;br&gt;
        &lt;asp:Button ID=""Btn_SendMail"" runat=""server"" onclick=""Btn_SendMail_Click"" Text=""Send Email"" /&gt;&lt;br&gt;
        &lt;asp:Label ID=""Label1"" runat=""server"" Text=""Label""&gt;&lt;/asp:Label&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>And below is my <a href=""http://en.wikipedia.org/wiki/ASP.NET#Code-behind_solutions"" rel=""noreferrer"">code-behind</a>:</p>

<pre><code>using System;
using System.Web.UI.WebControls;
using System.Net.Mail;
public partial class SendMail : System.Web.UI.Page
{
    protected void Btn_SendMail_Click(object sender, EventArgs e)
    {
        MailMessage mailObj = new MailMessage(
            txtFrom.Text, txtTo.Text, txtSubject.Text, txtBody.Text);
        SmtpClient SMTPServer = new SmtpClient(""127.0.0.1"");
        try
        {
            SMTPServer.Send(mailObj);
        }
        catch (Exception ex)
        {
            Label1.Text = ex.ToString();
        }
    }
}
</code></pre>

<p>PS: I'm sorry that I couldn't understand the receiver/sender SMTP concept, and so I am trying to understand the whole concept from here.</p>
","<p>Just go through the below code.</p>

<pre><code>SmtpClient smtpClient = new SmtpClient(""mail.MyWebsiteDomainName.com"", 25);

smtpClient.Credentials = new System.Net.NetworkCredential(""info@MyWebsiteDomainName.com"", ""myIDPassword"");
smtpClient.UseDefaultCredentials = true;
smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network;
smtpClient.EnableSsl = true;
MailMessage mail = new MailMessage();

//Setting From , To and CC
mail.From = new MailAddress(""info@MyWebsiteDomainName"", ""MyWeb Site"");
mail.To.Add(new MailAddress(""info@MyWebsiteDomainName""));
mail.CC.Add(new MailAddress(""MyEmailID@gmail.com""));

smtpClient.Send(mail);
</code></pre>
","18326814"
"File Upload ASP.NET MVC 3.0","295042","","<p>I want to upload file in <a href=""/questions/tagged/asp.net-mvc"" class=""post-tag"" title=""show questions tagged 'asp.net-mvc'"" rel=""tag"">asp.net-mvc</a>. How can I upload the file using html <code>input file</code> control?</p>
","<p>You don't use a file input control. Server side controls are not used in ASP.NET MVC. Checkout the <a href=""http://haacked.com/archive/2010/07/16/uploading-files-with-aspnetmvc.aspx"" rel=""noreferrer"">following blog post</a> which illustrates how to achieve this in ASP.NET MVC.</p>

<p>So you would start by creating an HTML form which would contain a file input:</p>

<pre><code>@using (Html.BeginForm(""Index"", ""Home"", FormMethod.Post, new { enctype = ""multipart/form-data"" }))
{
    &lt;input type=""file"" name=""file"" /&gt;
    &lt;input type=""submit"" value=""OK"" /&gt;
}
</code></pre>

<p>and then you would have a controller to handle the upload:</p>

<pre><code>public class HomeController : Controller
{
    // This action renders the form
    public ActionResult Index()
    {
        return View();
    }

    // This action handles the form POST and the upload
    [HttpPost]
    public ActionResult Index(HttpPostedFileBase file)
    {
        // Verify that the user selected a file
        if (file != null &amp;&amp; file.ContentLength &gt; 0) 
        {
            // extract only the filename
            var fileName = Path.GetFileName(file.FileName);
            // store the file inside ~/App_Data/uploads folder
            var path = Path.Combine(Server.MapPath(""~/App_Data/uploads""), fileName);
            file.SaveAs(path);
        }
        // redirect back to the index action to show the form once again
        return RedirectToAction(""Index"");        
    }
}
</code></pre>
","5193851"
"How to convert JSON to XML or XML to JSON?","293191","","<p>I started to use Json.NET to convert a string in JSON format to object or viceversa. I am not sure in the Json.NET framework, is it possible to convert a string in JSON to XML format and viceversa?</p>
","<p>Yes. Using the JsonConvert class which contains helper methods for this precise purpose:</p>

<pre><code>// To convert an XML node contained in string xml into a JSON string   
XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
string jsonText = JsonConvert.SerializeXmlNode(doc);

// To convert JSON text contained in string json into an XML node
XmlDocument doc = JsonConvert.DeserializeXmlNode(json);
</code></pre>

<p>Documentation here: <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/ConvertingJSONandXML.htm"" rel=""noreferrer""><strong>Converting between JSON and XML with Json.NET</strong></a></p>
","814027"
"Make first letter of a string upper case (with maximum performance)","292792","","<p>I have a <code>DetailsView</code> with a <code>TextBox</code>
and I want the <em>input data</em> be <em>saved always</em> with the FIRST LETTER IN CAPITAL.</p>

<p><strong>Example:</strong></p>

<pre><code>""red"" --&gt; ""Red""
""red house"" --&gt; "" Red house""
</code></pre>

<p>How can I achieve this <strong>maximizing performance</strong>?</p>

<hr>

<p><strong>NOTE</strong>:<br>
Based on the answers and the comments under the answers, many people think this is asking about capitalizing <em>all</em> words in the string. E.g. <code>=&gt; Red House</code> <strong>It isn't, but if that is what you seek</strong>, look for one of the answers that uses <code>TitleInfo</code>'s <code>ToTitleCase</code> method. (NOTE: Those answers are <em>incorrect</em> for the question actually asked.)<br>
See <a href=""https://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase(v=vs.110).aspx"" rel=""noreferrer"">TextInfo.ToTitleCase doc</a> for caveats (doesn't touch all-caps words - they are considered acronyms; may lowercase letters in middle of words that ""shouldn't"" be lowered, e.g. ""McDonald"" => ""Mcdonald""; not guaranteed to handle all culture-specific subtleties re capitalization rules.)</p>

<hr>

<p><strong>NOTE</strong>:<br>
The question is <em>ambiguous</em> as to whether letters after the first should be <strong>forced</strong> to <em>lower case</em>.  The accepted answer assumes that <em>only the first letter should be altered</em>. If you want to force <em>all letters in the string except the first</em> to be lower case, look for an answer containing <code>ToLower</code>, and <em>not containing ToTitleCase</em>.</p>
","<p><strong>EDIT:</strong> Updated to newer syntax (and more correct answer)</p>

<pre><code>public static string FirstCharToUpper(string input)
{
    switch (input)
    {
        case null: throw new ArgumentNullException(nameof(input));
        case """": throw new ArgumentException($""{nameof(input)} cannot be empty"", nameof(input));
        default: return input.First().ToString().ToUpper() + input.Substring(1);
    }
}
</code></pre>

<p><strong>OLD ANSWERS</strong></p>

<pre><code>public static string FirstCharToUpper(string input)
{
    if (String.IsNullOrEmpty(input))
        throw new ArgumentException(""ARGH!"");
    return input.First().ToString().ToUpper() + String.Join("""", input.Skip(1));
}
</code></pre>

<p><strong>EDIT</strong>:
This version is shorter. For a faster solution take a look at <a href=""https://stackoverflow.com/questions/4135317/make-first-letter-of-a-string-upper-case-with-maximum-performance/4135491#4135491"">Equiso's answer</a></p>

<pre><code>public static string FirstCharToUpper(string input)
{
    if (String.IsNullOrEmpty(input))
        throw new ArgumentException(""ARGH!"");
    return input.First().ToString().ToUpper() + input.Substring(1);
}
</code></pre>

<p><strong>EDIT 2</strong>:
Probably the fastest solution is <a href=""https://stackoverflow.com/questions/4135317/make-first-letter-of-a-string-upper-case-with-maximum-performance/27073919#27073919"">Darren's</a> (There's even a benchmark) although I would change it's <code>string.IsNullOrEmpty(s)</code> validation to throw an exception since the original requirement expects for a first letter to exist so it can be uppercased. Note that this code works for a generic string and not particularly on valid values from the <code>Textbox</code>.</p>
","4405876"
"What is the difference between a Field and a Property in C#?","292486","","<p>In C#, what makes a field different from a property, and when should a field be used instead of a property?</p>
","<p>Properties expose fields.  Fields should (almost always) be kept private to a class and accessed via get and set properties.  Properties provide a level of abstraction allowing you to change the fields while not affecting the external way they are accessed by the things that use your class.</p>

<pre><code>public class MyClass
{
    // this is a field.  It is private to your class and stores the actual data.
    private string _myField;

    // this is a property. When accessed it uses the underlying field,
    // but only exposes the contract, which will not be affected by the underlying field
    public string MyProperty
    {
        get
        {
            return _myField;
        }
        set
        {
            _myField = value;
        }
    }

    // This is an AutoProperty (C# 3.0 and higher) - which is a shorthand syntax
    // used to generate a private field for you
    public int AnotherProperty{get;set;} 
}
</code></pre>

<p>@Kent points out that Properties are not required to encapsulate fields, they could do a calculation on other fields, or serve other purposes.</p>

<p>@GSS points out that you can also do other logic, such as validation, when a property is accessed, another useful feature.</p>
","295109"
"Could not load file or assembly ... An attempt was made to load a program with an incorrect format (System.BadImageFormatException)","290965","","<p>I have two projects, <code>ProjectA</code> and <code>ProjectB</code>.  <code>ProjectB</code> is a console application, which depends on <code>ProjectA</code>.  Yesterday, everything was working fine, but suddenly today when I run <code>ProjectB</code> I get this:</p>

<blockquote>
  <p><strong>BadImageFormatException was unhandled</strong>:<br>
  Could not load file or assembly 'ProjectA, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. An attempt was made to load a program with an incorrect format.</p>
</blockquote>

<p>Both are just regular projects, with no dependencies on any other non-.Net projects.  Both are fully .Net - there is no native code, and no P/Invoke.  I have other projects which depend on <code>ProjectA</code> and still work just fine.</p>

<p>Things I have tried:</p>

<ul>
<li>Make sure both projects are set to ""Any CPU,"" with the <em>build</em> checkbox checked.  They are.</li>
<li>Make sure both projects are for the same Target Framework <em>(.Net 4.0 Client Profile)</em>.</li>
<li>Under ProjectB --> References --> ProjectA --> Properties, make sure <em>""Copy Local""</em> is set to <em>""True""</em> _ <em>(I verified that ProjectA.dll is being copied correctly)</em></li>
<li>Clean/Rebuild the solution.  I even tried manually deleting the /bin and /obj folders in both projects.</li>
<li>Restart Visual Studio.  Restart my computer.</li>
<li>Check out an entirely new copy of the repository.</li>
</ul>

<p>But I still get the same error.  I have no idea what I did to cause this, nor how to fix it.  Any ideas?</p>
","<p>I am pretty sure you're having a 32-bit / 64-bit conflict. It sounds like your main project might be set to 32-bit while the class its referencing is set to 64-bit. Try looking at <a href=""https://stackoverflow.com/questions/8996653/troubleshooting-badimageformatexception"">this SO question</a> and <a href=""https://stackoverflow.com/questions/4340362/system-badimageformatexception-an-attempt-was-made-to-load-a-program-with-an-inc"">this one too</a>. Between the two of them, you should be able to figure out your problem.</p>
","11371644"
"Seeing the console's output in Visual Studio 2010?","290711","","<p>I am writing a simple C# program with some outputs (<code>Console.WriteLine(""..."");</code>). The problem is, each time I run it, I cannot see the program's output in the output window.</p>

<p>The ""program output"" tag is already checked, and I already redirected all outputs to the intermediate window but to no avail.</p>

<p>How do I enable seeing the program's output?</p>

<p>I don't think the problem lies with my code. I tried running a simple program that just outputs a string and readline ""ala hello world"" and I am still unable to see any output. The problem is either with me looking for the output in the wrong location or Visual Studio acting out.</p>

<p>The <code>debug.write</code> method also doesn't work.</p>

<p>Using <code>debug.Write</code>, it all works, though it didn't before. Either something bugged out with me before I restarted or I just need to take a break, either way it's all good now. Thanks all for the helpful comments =)</p>
","<p>You can use the <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.write.aspx"" rel=""noreferrer""><code>System.Diagnostics.Debug.Write</code></a> or <code>System.Runtime.InteropServices</code> method to write messages to the Output Window.</p>
","5301266"
"Can a Byte[] Array be written to a file in C#?","290706","","<p>I'm trying to write out a  <code>Byte[]</code> array representing a complete file to a file.</p>

<p>The original file from the client is sent via TCP and then received by a server. The received stream is read to a byte array and then sent to be processed by this class. </p>

<p>This is mainly to ensure that the receiving <code>TCPClient</code> is ready for the next stream and separate the receiving end from the processing end. </p>

<p>The <code>FileStream</code> class does not take a byte array as an argument or another Stream object ( which does allow you to write bytes to it).</p>

<p>I'm aiming to get the processing done by a different thread from the original ( the one with the TCPClient). </p>

<p>I don't know how to implement this, what should I try?</p>
","<p>Based on the first sentence of the question: <em>""I'm trying to write out a Byte[] array <strong>representing a complete file</strong> to a file.""</em></p>

<p>The path of least resistance would be:</p>

<pre><code>File.WriteAllBytes(string path, byte[] bytes)
</code></pre>

<p>Documented here:</p>

<blockquote>
  <p><a href=""http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx"" rel=""noreferrer""><code>System.IO.File.WriteAllBytes</code> - MSDN</a></p>
</blockquote>
","381529"
"Calculate the execution time of a method","289299","","<blockquote>
  <p><strong>Possible Duplicate:</strong> <br/>
  <a href=""https://stackoverflow.com/questions/10107140/how-to-measure-how-long-is-a-function-running"">How do I measure how long a function is running?</a></p>
</blockquote>



<p>I have an I/O time-taking method which copies data from a location to another. What's the best and most real way of calculating the execution time? <code>Thread</code>? <code>Timer</code>? <code>Stopwatch</code>? Any other solution? I want the most exact one, and briefest as much as possible.</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx"" rel=""noreferrer""><code>Stopwatch</code></a> is designed for this purpose and is one of the best ways to measure time execution in .NET.</p>

<pre><code>var watch = System.Diagnostics.Stopwatch.StartNew();
// the code that you want to measure comes here
watch.Stop();
var elapsedMs = watch.ElapsedMilliseconds;
</code></pre>

<p><a href=""https://stackoverflow.com/questions/28637/is-datetime-now-the-best-way-to-measure-a-functions-performance""><strong>Do not</strong> use DateTime</a> to measure time execution in .NET.</p>

<hr>

<p>UPDATE:</p>

<p>As pointed out by @series0ne in the comments section: If you want a real precise measurement of the execution of some code, you will have to use the performance counters that's built into the operating system. The <a href=""https://stackoverflow.com/questions/1409762/creating-a-perfmon-counter-to-record-an-average-per-call-c/1409833#1409833"">following answer</a> contains a nice overview.</p>
","14019526"
"Set background color of WPF Textbox in C# code","288852","","<p>How can I change the background and foreground colors of a WPF Textbox programatically in c#?</p>
","<pre><code>textBox1.Background = Brushes.Blue;
textBox1.Foreground = Brushes.Yellow;
</code></pre>

<p>WPF Foreground and Background is of type <code>System.Windows.Media.Brush</code>. You can set another color like this:</p>

<pre><code>// using System.Windows.Media;

**EDIT**
textBox1.Background = Brushes.White;
textBox1.Background = new SolidColorBrush(Colors.White);
textBox1.Background = new SolidColorBrush(Colors.FromArgb(0xFF, 0xFF, 0, 0));
textBox1.Background = System.Windows.SystemColors.MenuHighlightBrush;
</code></pre>
","979906"
"How can I make the cursor turn to the wait cursor?","288719","","<p>I have a C# application that has users login to it, and because the hashing algorithm is expensive, it takes a little while to do. How can I display the Wait/Busy Cursor (usually the hourglass) to the user to let them know the program is doing something?</p>

<p>The project is in C#.</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.cursor.current.aspx"" rel=""noreferrer""><code>Cursor.Current</code></a>.</p>

<pre><code>// Set cursor as hourglass
Cursor.Current = Cursors.WaitCursor;

// Execute your time-intensive hashing code here...

// Set cursor as default arrow
Cursor.Current = Cursors.Default;
</code></pre>

<p>However, if the hashing operation is <em>really</em> lengthy (MSDN defines this as more than 2-7 seconds), you should probably use a visual feedback indicator other than the cursor to notify the user of the progress. For a more in-depth set of guidelines, see <a href=""http://msdn.microsoft.com/en-us/library/aa841990%28AX.10%29.aspx"" rel=""noreferrer"">this article</a>.</p>

<p><strong>Edit:</strong><br>
As @Am pointed out, you may need to call <code>Application.DoEvents();</code> after <code>Cursor.Current = Cursors.WaitCursor;</code> to ensure that the hourglass is actually displayed. </p>
","1568562"
"Setting the filter to an OpenFileDialog to allow the typical image formats?","288181","","<p>I have this code, how can I allow it to accept all typical image formats? PNG, JPEG, JPG, GIF?</p>

<p>Here's what I have so far:</p>

<pre><code>public void EncryptFile()
{            
    OpenFileDialog dialog = new OpenFileDialog();
    dialog.Filter = ""txt files (*.txt)|*.txt|All files (*.*)|*.*"";
    dialog.InitialDirectory = @""C:\"";
    dialog.Title = ""Please select an image file to encrypt."";

    if (dialog.ShowDialog() == DialogResult.OK)
    {
        //Encrypt the selected file. I'll do this later. :)
    }             
}
</code></pre>

<p>Notice that the filter is set to .txt files. I <strong>could</strong> change to PNG, but what of the other types?</p>
","<p>From <a href=""http://msdn.microsoft.com/en-us/library/microsoft.win32.filedialog.filter.aspx"" rel=""noreferrer"">the docs</a>, the filter syntax that you need is as follows:</p>

<pre><code>Office Files|*.doc;*.xls;*.ppt
</code></pre>

<p>i.e. separate the multiple extensions with a semicolon -- thus, <code>Image Files|*.jpg;*.jpeg;*.png;...</code>.</p>
","2069090"
"How to use Lambda in LINQ select statement","287761","","<p>I am trying to select stores using a lambda function and converting the result to a SelectListItem so I can render it.  However it is throwing a ""<strong>Type of Expression in Select Clause is Incorrect</strong>"" error:</p>

<pre><code>IEnumerable&lt;SelectListItem&gt; stores =
    from store in database.Stores
    where store.CompanyID == curCompany.ID
    select (s =&gt; new SelectListItem { Value = s.ID, Text = s.Name} );
ViewBag.storeSelector = stores;
</code></pre>

<p>What am I doing wrong?</p>

<p>EDIT:</p>

<p>Also, how do I convert Int to String in this situation?  The following does not work:</p>

<pre><code>select (s =&gt; new SelectListItem { Value = s.ID.ToString(), Text = s.Name} );
select (s =&gt; new SelectListItem { Value = s.ID + """", Text = s.Name} );
</code></pre>

<p>EDIT 2:</p>

<p>Figure out the Int to String conversion.  It is so typical of Microsoft to forget to include an int2string conversion function.  Here is the actual workaround everyone is using, with fully working syntax:</p>

<pre><code>select new SelectListItem { Value = SqlFunctions.StringConvert((double)store.ID), Text = store.Name };
</code></pre>

<p>To call this situation absurd is an understatement.</p>
","<p>using LINQ query expression</p>

<pre><code> IEnumerable&lt;SelectListItem&gt; stores =
        from store in database.Stores
        where store.CompanyID == curCompany.ID
        select new SelectListItem { Value = store.Name, Text = store.ID };

 ViewBag.storeSelector = stores;
</code></pre>

<p>or using LINQ extension methods with lambda expressions</p>

<pre><code> IEnumerable&lt;SelectListItem&gt; stores = database.Stores
        .Where(store =&gt; store.CompanyID == curCompany.ID)
        .Select(store =&gt; new SelectListItem { Value = store.Name, Text = store.ID });

 ViewBag.storeSelector = stores;
</code></pre>
","15577929"
"Converting String To Float in C#","287558","","<p>I am converting a string like ""41.00027357629127"", and I am using;</p>

<pre><code>Convert.ToSingle(""41.00027357629127"");
</code></pre>

<p>or</p>

<pre><code>float.Parse(""41.00027357629127"");
</code></pre>

<p>These methods return <em>4.10002732E+15</em>.</p>

<p>When I convert to float I want ""41.00027357629127"". This string should be the same...</p>
","<p>Your thread's locale is set to one in which the decimal mark is "","" instead of ""."".</p>

<p>Try using this:</p>

<pre><code>float.Parse(""41.00027357629127"", CultureInfo.InvariantCulture.NumberFormat);
</code></pre>

<p>Note, however, that a float cannot hold that many digits of precision. You would have to use double or Decimal to do so.</p>
","11203062"
"How can I detect if this dictionary key exists in C#?","286966","","<p>I am working with the Exchange Web Services Managed API, with contact data. I have the following code, which is <em>functional</em>, but not ideal:</p>

<pre><code>foreach (Contact c in contactList)
{
    string openItemUrl = ""https://"" + service.Url.Host + ""/owa/"" + c.WebClientReadFormQueryString;

    row = table.NewRow();
    row[""FileAs""] = c.FileAs;
    row[""GivenName""] = c.GivenName;
    row[""Surname""] = c.Surname;
    row[""CompanyName""] = c.CompanyName;
    row[""Link""] = openItemUrl;

    //home address
    try { row[""HomeStreet""] = c.PhysicalAddresses[PhysicalAddressKey.Home].Street.ToString(); }
    catch (Exception e) { }
    try { row[""HomeCity""] = c.PhysicalAddresses[PhysicalAddressKey.Home].City.ToString(); }
    catch (Exception e) { }
    try { row[""HomeState""] = c.PhysicalAddresses[PhysicalAddressKey.Home].State.ToString(); }
    catch (Exception e) { }
    try { row[""HomeZip""] = c.PhysicalAddresses[PhysicalAddressKey.Home].PostalCode.ToString(); }
    catch (Exception e) { }
    try { row[""HomeCountry""] = c.PhysicalAddresses[PhysicalAddressKey.Home].CountryOrRegion.ToString(); }
    catch (Exception e) { }

    //and so on for all kinds of other contact-related fields...
}
</code></pre>

<p>As I said, this code <em>works</em>. Now I want to make it suck <em>a little less</em>, if possible.</p>

<p>I can't find any methods that allow me to check for the existence of the key in the dictionary before attempting to access it, and if I try to read it (with <code>.ToString()</code>) and it doesn't exist then an exception is thrown:</p>

<blockquote>
  <p>500<br/>
  The given key was not present in the dictionary.</p>
</blockquote>

<p>How can I refactor this code to suck less (while still being functional)?</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/htszx2dy.aspx"" rel=""noreferrer""><code>ContainsKey</code></a>:</p>

<pre><code>if (dict.ContainsKey(key)) { ... }
</code></pre>

<p>or <a href=""http://msdn.microsoft.com/en-us/library/bb299639.aspx"" rel=""noreferrer""><code>TryGetValue</code></a>:</p>

<pre><code>dict.TryGetValue(key, out value);
</code></pre>

<hr>

<p><strong>Update</strong>: according to a comment the actual class here is not an <code>IDictionary</code> but a <a href=""http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.physicaladdressdictionary%28EXCHG.80%29.aspx"" rel=""noreferrer""><code>PhysicalAddressDictionary</code></a>, so the methods are <a href=""http://msdn.microsoft.com/en-us/library/dd634696%28EXCHG.80%29.aspx"" rel=""noreferrer""><code>Contains</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.physicaladdressdictionary.trygetvalue%28EXCHG.80%29.aspx"" rel=""noreferrer""><code>TryGetValue</code></a> but they work in the same way.</p>

<p>Example usage:</p>

<pre><code>PhysicalAddressEntry entry;
PhysicalAddressKey key = c.PhysicalAddresses[PhysicalAddressKey.Home].Street;
if (c.PhysicalAddresses.TryGetValue(key, out entry))
{
    row[""HomeStreet""] = entry;
}
</code></pre>

<hr>

<p><strong>Update 2:</strong> here is the working code (compiled by question asker)</p>

<pre><code>PhysicalAddressEntry entry;
PhysicalAddressKey key = PhysicalAddressKey.Home;
if (c.PhysicalAddresses.TryGetValue(key, out entry))
{
    if (entry.Street != null)
    {
        row[""HomeStreet""] = entry.Street.ToString();
    }
}
</code></pre>

<p>...with the inner conditional repeated as necessary for each key required. The TryGetValue is only done once per PhysicalAddressKey (Home, Work, etc).</p>
","2829903"
"Concat all strings inside a List<string> using LINQ","286736","","<p>Is there any easy LINQ expression to concatenate my entire <code>List&lt;string&gt;</code> collection items to a single <code>string</code> with a delimiter character?</p>

<p>What if the collection is of custom objects instead of <code>string</code>? Imagine I need to concatenate on <code>object.Name</code>.</p>
","<p>By using LINQ, this should work;</p>

<pre><code>string delimiter = "","";
List&lt;string&gt; items = new List&lt;string&gt;() { ""foo"", ""boo"", ""john"", ""doe"" };
Console.WriteLine(items.Aggregate((i, j) =&gt; i + delimiter + j));
</code></pre>

<p>class description:</p>

<pre><code>public class Foo
{
    public string Boo { get; set; }
}
</code></pre>

<p>Usage:</p>

<pre><code>class Program
{
    static void Main(string[] args)
    {
        string delimiter = "","";
        List&lt;Foo&gt; items = new List&lt;Foo&gt;() { new Foo { Boo = ""ABC"" }, new Foo { Boo = ""DEF"" },
            new Foo { Boo = ""GHI"" }, new Foo { Boo = ""JKL"" } };

        Console.WriteLine(items.Aggregate((i, j) =&gt; new Foo{Boo = (i.Boo + delimiter + j.Boo)}).Boo);
        Console.ReadKey();

    }
}
</code></pre>

<p>And here is my best :)</p>

<pre><code>items.Select(i =&gt; i.Boo).Aggregate((i, j) =&gt; i + delimiter + j)
</code></pre>
","559461"
"Randomize a List<T>","286569","","<p>What is the best way to randomize the order of a generic list in C#? I've got a finite set of 75 numbers in a list I would like to assign a random order to, in order to draw them for a lottery type application.</p>
","<p>Shuffle any <code>(I)List</code> with an extension method based on the <a href=""http://en.wikipedia.org/wiki/Fisher-Yates_shuffle"" rel=""noreferrer"">Fisher-Yates shuffle</a>:</p>

<pre><code>private static Random rng = new Random();  

public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)  
{  
    int n = list.Count;  
    while (n &gt; 1) {  
        n--;  
        int k = rng.Next(n + 1);  
        T value = list[k];  
        list[k] = list[n];  
        list[n] = value;  
    }  
}
</code></pre>

<p>Usage:</p>

<pre><code>List&lt;Product&gt; products = GetProducts();
products.Shuffle();
</code></pre>

<p>The code above uses the much criticised System.Random method to select swap candidates. It's fast but not as random as it should be. If you need a better quality of randomness in your shuffles use the random number generator in System.Security.Cryptography like so:</p>

<pre><code>using System.Security.Cryptography;
...
public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)
{
    RNGCryptoServiceProvider provider = new RNGCryptoServiceProvider();
    int n = list.Count;
    while (n &gt; 1)
    {
        byte[] box = new byte[1];
        do provider.GetBytes(box);
        while (!(box[0] &lt; n * (Byte.MaxValue / n)));
        int k = (box[0] % n);
        n--;
        T value = list[k];
        list[k] = list[n];
        list[n] = value;
    }
}
</code></pre>

<p>A simple comparison is available <a href=""https://web.archive.org/web/20150801085341/http://blog.thijssen.ch/2010/02/when-random-is-too-consistent.html"" rel=""noreferrer"">at this blog</a> (WayBack Machine).</p>

<p>Edit: Since writing this answer a couple years back, many people have commented or written to me, to point out the big silly flaw in my comparison. They are of course right. There's nothing wrong with System.Random if it's used in the way it was intended. In my first example above, I instantiate the rng variable inside of the Shuffle method, which is asking for trouble if the method is going to be called repeatedly. Below is a fixed, full example based on a really useful comment received today from @weston here on SO.</p>

<p>Program.cs:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Threading;

namespace SimpleLottery
{
  class Program
  {
    private static void Main(string[] args)
    {
      var numbers = new List&lt;int&gt;(Enumerable.Range(1, 75));
      numbers.Shuffle();
      Console.WriteLine(""The winning numbers are: {0}"", string.Join("",  "", numbers.GetRange(0, 5)));
    }
  }

  public static class ThreadSafeRandom
  {
      [ThreadStatic] private static Random Local;

      public static Random ThisThreadsRandom
      {
          get { return Local ?? (Local = new Random(unchecked(Environment.TickCount * 31 + Thread.CurrentThread.ManagedThreadId))); }
      }
  }

  static class MyExtensions
  {
    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)
    {
      int n = list.Count;
      while (n &gt; 1)
      {
        n--;
        int k = ThreadSafeRandom.ThisThreadsRandom.Next(n + 1);
        T value = list[k];
        list[k] = list[n];
        list[n] = value;
      }
    }
  }
}
</code></pre>
","1262619"
"Delete last char of string","286341","","<p>I am retrieving a lot of informations in a list, linked to a database.</p>

<p>I want to create a string of groups, for someone who is connected to the website.</p>

<p>I use this to test ... But this is not dynamic so it is really bad:</p>

<pre><code>string strgroupids = ""6"";
</code></pre>

<p>I want to use this now. But the string returned is something like <code>1,2,3,4,5,</code></p>

<pre><code>groupIds.ForEach((g) =&gt;
{
    strgroupids = strgroupids  + g.ToString() + "","";
    strgroupids.TrimEnd(',');
});

strgroupids.TrimEnd(new char[] { ',' });
</code></pre>

<p>I want to delete the <code>,</code> after the <code>5</code> but it's definitely not working..
Can someone help me?</p>
","<pre><code>strgroupids = strgroupids.Remove(strgroupids.Length - 1);
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.string.remove.aspx"" rel=""noreferrer"">MSDN:</a></p>

<blockquote>
  <p><strong>String.Remove(Int32):</strong></p>
  
  <p>Deletes all the characters from this string beginning at a specified
  position and continuing through the last position</p>
</blockquote>
","7901378"
"Select Multiple Fields from List in Linq","285483","","<p>In ASP.NET C# I have a struct:</p>

<pre><code>public struct Data
{
    public int item1;
    public int item2;
    public int category_id;
    public string category_name;
}
</code></pre>

<p>and I have a List of those.  I want to select <code>category_id</code> and <code>category_name</code>, running a <code>DISTINCT</code> and finally an <code>ORDERBY</code> on <code>category_name</code>.</p>

<p>Here's what I have now:</p>

<pre><code>List&lt;Data&gt; listObject = getData();
string[] catNames = listObject
                    .Select(i=&gt; i.category_name)
                    .Distinct()
                    .OrderByDescending(s =&gt; s)
                    .ToArray();
</code></pre>

<p>This obviously just gets the category name.  My question is, how do I get multiple fields, and what data structure will I store this in (not a <code>string[]</code>)?</p>

<p>EDIT</p>

<p>Using a list of structs is not set in stone.  If it would be advisable to change my backing data structure to make selects easier (I'll be writing a lot of these) then I'd gladly take recommendations.</p>
","<p>Anonymous types allow you to select arbitrary fields into data structures that are strongly typed later on in your code:</p>

<pre><code>var cats = listObject
    .Select(i =&gt; new { i.category_id, i.category_name })
    .Distinct()
    .OrderByDescending(i =&gt; i.category_name)
    .ToArray();
</code></pre>

<p>Since you (apparently) need to store it for later use, you could use the GroupBy operator:</p>

<pre><code>Data[] cats = listObject
    .GroupBy(i =&gt; new { i.category_id, i.category_name })
    .OrderByDescending(g =&gt; g.Key.category_name)
    .Select(g =&gt; g.First())
    .ToArray();
</code></pre>
","1203013"
"C# Double - ToString() formatting with two decimal places but no rounding","284312","","<p>How do I format a <code>Double</code> to a <code>String</code> in C# so as to have only two decimal places? </p>

<p>If I use <code>String.Format(""{0:0.00}%"", myDoubleValue)</code> the number is then rounded and I want a simple truncate without any rounding. I also want the conversion to <code>String</code> to be culture sensitive.</p>
","<p>I use the following:</p>

<pre><code>double x = Math.Truncate(myDoubleValue * 100) / 100;
</code></pre>

<p>For instance:</p>

<p>If the number is 50.947563 and you use the following, the following will happen:</p>

<pre><code>- Math.Truncate(50.947563 * 100) / 100;
- Math.Truncate(5094.7563) / 100;
- 5094 / 100
- 50.94
</code></pre>

<p>And there's your answer truncated, now to format the string simply do the following:</p>

<pre><code>string s = string.Format(""{0:N2}%"", x); // No fear of rounding and takes the default number format
</code></pre>
","2453982"
"How to get the current user in ASP.NET MVC","284065","","<p>In a forms model, I used to get the current logged-in user by:</p>

<pre><code>Page.CurrentUser
</code></pre>

<p>How do I get the current user inside a controller class in ASP.NET MVC?</p>
","<p>If you need to get the user from within the controller, use the <code>User</code> property of Controller. If you need it from the view, I would populate what you specifically need in the <code>ViewData</code>, or you could just call User as I think it's a property of <code>ViewPage</code>.</p>
","263853"
"""The remote certificate is invalid according to the validation procedure."" using Gmail SMTP server","283758","","<p>I'm getting this error:</p>

<blockquote>
  <p>The remote certificate is invalid according to the validation procedure.</p>
</blockquote>

<p>whenever I try to send e-mail using Gmail's SMTP server in my C# code.
Can someone point me to the right direction for a solution to this problem?</p>

<p>The following is the stack trace...</p>

<pre><code>at System.Net.Security.SslState.StartSendAuthResetSignal(ProtocolToken message, AsyncProtocolRequest asyncRequest, Exception exception)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ForceAuthentication(Boolean receiveFirst, Byte[] buffer, AsyncProtocolRequest asyncRequest)
at System.Net.Security.SslState.ProcessAuthentication(LazyAsyncResult lazyResult)
at System.Net.TlsStream.CallProcessAuthentication(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result)
at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size)
at System.Net.PooledStream.Write(Byte[] buffer, Int32 offset, Int32 size)
at System.Net.Mail.SmtpConnection.Flush()
at System.Net.Mail.SmtpConnection.GetConnection(String host, Int32 port)
at System.Net.Mail.SmtpTransport.GetConnection(String host, Int32 port)
at System.Net.Mail.SmtpClient.GetConnection()
at System.Net.Mail.SmtpClient.Send(MailMessage message)
at BulkEmail.frmemail.mailsending(String toaddress, String fromaddress, String fromname, String subject, String pwd, String attachements, String mailmessage, String htmlmessage, Int32 i, Int32 j, String replytoaddress)
</code></pre>
","<h1>Warning: do not use this in production code!</h1>

<p>As a workaround, you can switch off certificate validation.</p>

<p>Put this code somewhere before <code>smtpclient.Send()</code>:</p>

<pre><code>ServicePointManager.ServerCertificateValidationCallback =
    delegate(object s, X509Certificate certificate,
             X509Chain chain, SslPolicyErrors sslPolicyErrors)
    { return true; };
</code></pre>
","1386568"
"Random String Generator Returning Same String","282660","","<p>I've developed a random string generator but it's not behaving quite as I'm hoping.  My goal is to be able to run this twice and generate two distinct four character random strings.  However, it just generates one four character random string twice.</p>

<p>Here's the code and an example of its output:</p>

<pre><code>private string RandomString(int size)
{
    StringBuilder builder = new StringBuilder();
    Random random = new Random();
    char ch;
    for (int i = 0; i &lt; size; i++)
    {
        ch = Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65)));                 
        builder.Append(ch);
    }

    return builder.ToString();
}

// get 1st random string 
string Rand1 = RandomString(4);

// get 2nd random string 
string Rand2 = RandomString(4);

// create full rand string
string docNum = Rand1 + ""-"" + Rand2;
</code></pre>

<p>...and the output looks like this:  UNTE-UNTE
...but it should look something like this UNTE-FWNU</p>

<p>How can I ensure two distinctly random strings?</p>
","<p>You're making the Random instance in the method, which causes it to return the same values when called in quick succession. I would do something like this:</p>

<pre><code>private static Random random = new Random((int)DateTime.Now.Ticks);//thanks to McAden
private string RandomString(int size)
    {
        StringBuilder builder = new StringBuilder();
        char ch;
        for (int i = 0; i &lt; size; i++)
        {
            ch = Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65)));                 
            builder.Append(ch);
        }

        return builder.ToString();
    }

// get 1st random string 
string Rand1 = RandomString(4);

// get 2nd random string 
string Rand2 = RandomString(4);

// creat full rand string
string docNum = Rand1 + ""-"" + Rand2;
</code></pre>

<p>(modified version of your code)</p>
","1122519"
"Fastest Way of Inserting in Entity Framework","282017","","<p>I'm looking for the fastest way of inserting into Entity Framework.</p>

<p>I'm asking this because of the scenario where you have an active TransactionScope and the insertion is huge (4000+). It can potentially last more than 10 minutes (default timeout of transactions), and this will lead to an incomplete transaction.</p>
","<p>To your remark in the comments to your question:</p>

<blockquote>
  <p>""...SavingChanges (<strong>for each
  record</strong>)...""</p>
</blockquote>

<p>That's the worst thing you can do! Calling <code>SaveChanges()</code> for each record slows bulk inserts extremely down. I would do a few simple tests which will very likely improve the performance:</p>

<ul>
<li>Call <code>SaveChanges()</code> once after ALL records.</li>
<li>Call <code>SaveChanges()</code> after for example 100 records.</li>
<li>Call <code>SaveChanges()</code> after for example 100 records and dispose the context and create a new one.</li>
<li>Disable change detection</li>
</ul>

<p>For bulk inserts I am working and experimenting with a pattern like this:</p>

<pre><code>using (TransactionScope scope = new TransactionScope())
{
    MyDbContext context = null;
    try
    {
        context = new MyDbContext();
        context.Configuration.AutoDetectChangesEnabled = false;

        int count = 0;            
        foreach (var entityToInsert in someCollectionOfEntitiesToInsert)
        {
            ++count;
            context = AddToContext(context, entityToInsert, count, 100, true);
        }

        context.SaveChanges();
    }
    finally
    {
        if (context != null)
            context.Dispose();
    }

    scope.Complete();
}

private MyDbContext AddToContext(MyDbContext context,
    Entity entity, int count, int commitCount, bool recreateContext)
{
    context.Set&lt;Entity&gt;().Add(entity);

    if (count % commitCount == 0)
    {
        context.SaveChanges();
        if (recreateContext)
        {
            context.Dispose();
            context = new MyDbContext();
            context.Configuration.AutoDetectChangesEnabled = false;
        }
    }

    return context;
}
</code></pre>

<p>I have a test program which inserts 560.000 entities (9 scalar properties, no navigation properties) into the DB. With this code it works in less than 3 minutes.</p>

<p>For the performance it is important to call <code>SaveChanges()</code> after ""many"" records (""many"" around 100 or 1000). It also improves the performance to dispose the context after SaveChanges and create a new one. This clears the context from all entites, <code>SaveChanges</code> doesn't do that, the entities are still attached to the context in state <code>Unchanged</code>. It is the growing size of attached entities in the context what slows down the insertion step by step. So, it is helpful to clear it after some time.</p>

<p>Here are a few measurements for my 560.000 entities:</p>

<ul>
<li>commitCount = 1,       recreateContext = false: <strong>many hours</strong> (That's your current procedure)</li>
<li>commitCount = 100,     recreateContext = false: <strong>more than 20 minutes</strong></li>
<li>commitCount = 1000,    recreateContext = false: <strong>242 sec</strong></li>
<li>commitCount = 10000,   recreateContext = false: <strong>202 sec</strong></li>
<li>commitCount = 100000,  recreateContext = false: <strong>199 sec</strong></li>
<li>commitCount = 1000000, recreateContext = false: <strong>out of memory exception</strong></li>
<li>commitCount = 1,       recreateContext = true:  <strong>more than 10 minutes</strong></li>
<li>commitCount = 10,      recreateContext = true:  <strong>241 sec</strong></li>
<li>commitCount = 100,     recreateContext = true:  <strong>164 sec</strong></li>
<li>commitCount = 1000,    recreateContext = true:  <strong>191 sec</strong></li>
</ul>

<p>The behaviour in the first test above is that the performance is very non-linear and decreases extremely over time. (""Many hours"" is an estimation, I never finished this test, I stopped at 50.000 entities after 20 minutes.) This non-linear behaviour is not so significant in all other tests.</p>
","5942176"
"Interop type cannot be embedded","281744","","<p>I am creating a web application on the .NET 4.0 framework (beta2) in C#.</p>

<p>When I try to use a assembly called ""ActiveHomeScriptLib"", I get the following error:</p>

<blockquote>
  <p>Interop type
  'ActiveHomeScriptLib.ActiveHomeClass'
  cannot be embedded. Use the applicable
  interface instead.</p>
</blockquote>

<p>When I change the framework to version 3.5, I don't have any errors.</p>

<p>What is an Interop Type and why does this only occur when I use the 4.0 framework?</p>
","<p>.NET 4.0 allows primary interop assemblies (or rather, the bits of it that you need) to be embedded into your assembly so that you don't need to deploy them alongside your application.</p>

<p>For whatever reason, this assembly can't be embedded - but it sounds like that's not a problem for you. Just open the Properties tab for the assembly in Visual Studio 2010 and set ""Embed Interop Types"" to ""False"".</p>

<p>EDIT: See also Michael Gustus's <a href=""https://stackoverflow.com/a/4553402/641833"">answer</a>, removing the <code>Class</code> suffix from the types you're using.</p>
","2483688"
"C# Split A String By Another String","281525","","<p>I've been using the <code>Split()</code> method to split strings, but this only appears to work if you are splitting a string by a character. Is there any way to split a <code>string</code>, with another string being the split by parameter?  I've tried converting the splitter into a character array, with no luck.</p>

<p>In other words, I'd like to split the <code>string</code>:</p>

<blockquote>
  <p>THExxQUICKxxBROWNxxFOX</p>
</blockquote>

<p>by <code>xx</code>, and return an array with values:  </p>

<blockquote>
  <p>THE, QUICK, BROWN, FOX</p>
</blockquote>
","<p>In order to split by a string you'll have to use the <a href=""http://msdn.microsoft.com/en-us/library/tabh47cf.aspx"" rel=""noreferrer"">string array overload</a>.</p>

<pre><code>string data = ""THExxQUICKxxBROWNxxFOX"";

return data.Split(new string[] { ""xx"" }, StringSplitOptions.None);
</code></pre>
","2245460"
"Best practice to return errors in ASP.NET Web API","281479","","<p>I have concerns on the way that we returns errors to client.</p>

<p>Do we return error immediately by throwing HttpResponseException when we get an error:</p>

<pre><code>public void Post(Customer customer)
{
    if (string.IsNullOrEmpty(customer.Name))
    {
        throw new HttpResponseException(""Customer Name cannot be empty"", HttpStatusCode.BadRequest) 
    }
    if (customer.Accounts.Count == 0)
    {
         throw new HttpResponseException(""Customer does not have any account"", HttpStatusCode.BadRequest) 
    }
}
</code></pre>

<p>Or we accumulate all errors then send back to client:</p>

<pre><code>public void Post(Customer customer)
{
    List&lt;string&gt; errors = new List&lt;string&gt;();
    if (string.IsNullOrEmpty(customer.Name))
    {
        errors.Add(""Customer Name cannot be empty""); 
    }
    if (customer.Accounts.Count == 0)
    {
         errors.Add(""Customer does not have any account""); 
    }
    var responseMessage = new HttpResponseMessage&lt;List&lt;string&gt;&gt;(errors, HttpStatusCode.BadRequest);
    throw new HttpResponseException(responseMessage);
}
</code></pre>

<p>This is just a sample code, it does not matter either validation errors or server error, I just would like to know the best practice, the pros and cons of each approach.</p>
","<p>For me I usually send back a <code>HttpResponseException</code> and set the status code accordingly depending on the exception thrown and if the exception is fatal or not will determine whether I send back the <code>HttpResponseException</code> immediately.</p>

<p>At the end of the day its an API sending back responses and not views, so I think its fine to send back a message with the exception and status code to the consumer. I currently haven't needed to accumulate errors and send them back as most exceptions are usually due to incorrect parameters or calls etc.</p>

<p>An example in my app is that sometimes the client will ask for data, but there isnt any data available so i throw a custom noDataAvailableException and let it bubble to the web api app, where then in my custom filter which captures it sending back a relevant message along with the correct status code.</p>

<p>I am not 100% sure on whats the best practice for this, but this is working for me currently so thats what im doing.</p>

<p><strong>Update</strong>:</p>

<p>Since i answered this question a few blog posts have been written on the topic:</p>

<p><a href=""http://weblogs.asp.net/fredriknormen/archive/2012/06/11/asp-net-web-api-exception-handling.aspx"">http://weblogs.asp.net/fredriknormen/archive/2012/06/11/asp-net-web-api-exception-handling.aspx</a></p>

<p>(this one has some new features in the nightly builds)
<a href=""http://blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx"">http://blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx</a></p>

<p><strong>Update 2</strong></p>

<p>Update to our error handling process, we have two cases: </p>

<ol>
<li><p>For general errors like not found, or invalid parameters being passed to an action we return a HttpResponseException to stop processing immediately. Additionally for model errors in our actions we will hand the model state dictionary to the <code>Request.CreateErrorResponse</code> extension and wrap it in a HttpResponseException. Adding the model state dictionary results in a list of the model errors sent in the response body.</p></li>
<li><p>For errors that occur in higher layers, server errors, we let the exception bubble to the Web API app, here we have a global exception filter which looks at the exception, logs it with elmah and trys to make sense of it setting the correct http status code and a relevant friendly error message as the body again in a HttpResponseException. For exceptions that we aren't expecting the client will receive the default 500 internal server error, but a generic message due to security reasons.</p></li>
</ol>

<p><strong>Update 3</strong></p>

<p>Recently, after picking up Web API 2, for sending back general errors we now use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.http.ihttpactionresult%28v=vs.118%29.aspx"">IHttpActionResult</a> interface, specifically the built in classes for in the System.Web.Http.Results namespace such as NotFound, BadRequest when they fit, if they dont we extend them, for example a notfound result with a response message:</p>

<pre><code>public class NotFoundWithMessageResult : IHttpActionResult
{
    private string message;

    public NotFoundWithMessageResult(string message)
    {
        this.message = message;
    }

    public Task&lt;HttpResponseMessage&gt; ExecuteAsync(CancellationToken cancellationToken)
    {
        var response = new HttpResponseMessage(HttpStatusCode.NotFound);
        response.Content = new StringContent(message);
        return Task.FromResult(response);
    }
}
</code></pre>
","10734690"
"c# remove item from list","281473","","<p>I have a list stored in resultlist as follows:</p>

<pre><code>    var resultlist = results.ToList();
</code></pre>

<p>It looks something like this</p>

<pre><code>ID FirstName  LastName
-- ---------  --------
1  Bill       Smith
2  John       Wilson
3  Doug       Berg
</code></pre>

<p>How do I remove ID 2 from the list? </p>
","<p><code>List&lt;T&gt;</code> has two methods you can use. </p>

<p><a href=""http://msdn.microsoft.com/en-us/library/5cw9x18z.aspx"" rel=""noreferrer"">RemoveAt(int index)</a> can be used if you know the index of the item. For example:</p>

<pre><code>resultlist.RemoveAt(1);
</code></pre>

<p>Or you can use <a href=""http://msdn.microsoft.com/en-us/library/cd666k3e.aspx"" rel=""noreferrer"">Remove(T item)</a>:</p>

<pre><code>var itemToRemove = resultlist.Single(r =&gt; r.Id == 2);
resultList.Remove(itemToRemove);
</code></pre>

<p>When you are not sure the item really exists you can use <a href=""http://msdn.microsoft.com/en-us/library/bb549274.aspx"" rel=""noreferrer"">SingleOrDefault</a>. <code>SingleOrDefault</code> will return <code>null</code> if there is no item (<code>Single</code> will throw an exception when it can't find the item). Both will throw when there is a duplicate value (two items with the same <code>id</code>).</p>

<pre><code>var itemToRemove = resultlist.SingleOrDefault(r =&gt; r.Id == 2);
if (itemToRemove != null)
    resultList.Remove(itemToRemove);
</code></pre>
","10019009"
"How to get C# Enum description from value?","281357","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/1799370/getting-attributes-of-enums-value"">Getting attributes of Enum’s value</a>  </p>
</blockquote>



<p>I have an enum with Description attributes like this:</p>

<pre><code>public enum MyEnum
{
    Name1 = 1,
    [Description(""Here is another"")]
    HereIsAnother = 2,
    [Description(""Last one"")]
    LastOne = 3
}
</code></pre>

<p>I found this bit of code for retrieving the description based on an Enum</p>

<pre><code>public static string GetEnumDescription(Enum value)
{
    FieldInfo fi = value.GetType().GetField(value.ToString());

    DescriptionAttribute[] attributes =
        (DescriptionAttribute[])fi.GetCustomAttributes(
        typeof(DescriptionAttribute),
        false);

    if (attributes != null &amp;&amp;
        attributes.Length &gt; 0)
        return attributes[0].Description;
    else
        return value.ToString();
}
</code></pre>

<p>This allows me to write code like:</p>

<pre><code>var myEnumDescriptions = from MyEnum n in Enum.GetValues(typeof(MyEnum))
                         select new { ID = (int)n, Name = Enumerations.GetEnumDescription(n) };
</code></pre>

<p>What I want to do is if I know the enum value (e.g. 1) - how can I retrieve the description? In other words, how can I convert an integer into an ""Enum value"" to pass to my GetDescription method?</p>
","<pre><code>int value = 1;
string description = Enumerations.GetEnumDescription((MyEnum)value);
</code></pre>

<p>The default underlying data type for an <code>enum</code> in C# is an <code>int</code>, you can just cast it.</p>
","2650090"
"Launching an application (.EXE) from C#?","281197","","<p>How can I launch an application using C#?</p>

<p>Requirements:
Must work on <a href=""http://en.wikipedia.org/wiki/Windows_XP"" rel=""noreferrer"">Windows&nbsp;XP</a> and <a href=""http://en.wikipedia.org/wiki/Windows_Vista"" rel=""noreferrer"">Windows&nbsp;Vista</a>.</p>

<p>I have seen a sample from DinnerNow.net sampler that only works in Windows&nbsp;Vista.</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx"" rel=""noreferrer""><code>System.Diagnostics.Process.Start()</code></a> method.</p>

<p>Check out <a href=""http://www.codeproject.com/KB/cs/start_an_external_app.aspx"" rel=""noreferrer"">this article</a> on how to use it.</p>
","240191"
"How do I copy items from list to list without foreach?","281087","","<p>How do I transfer the items contained in one <code>List</code> to another in C# without using <code>foreach</code>?</p>
","<p>You could try this:</p>

<pre><code>List&lt;Int32&gt; copy = new List&lt;Int32&gt;(original);
</code></pre>

<p>or if you're using C# 3 and .NET 3.5, with Linq, you can do this:</p>

<pre><code>List&lt;Int32&gt; copy = original.ToList();
</code></pre>
","1952191"
"What is the difference between int, Int16, Int32 and Int64?","280875","","<p>What is the difference between <code>int</code>, <code>System.Int16</code>, <code>System.Int32</code> and <code>System.Int64</code> other than their sizes?</p>
","<p>Each type of integer has a different range of storage capacity</p>

<pre><code>   Type      Capacity

   Int16 -- (-32,768 to +32,767)

   Int32 -- (-2,147,483,648 to +2,147,483,647)

   Int64 -- (-9,223,372,036,854,775,808 to +9,223,372,036,854,775,807)
</code></pre>

<p>As stated by James Sutherland in <a href=""https://stackoverflow.com/questions/62503/c-int-or-int32-should-i-care/62555#62555"">his answer</a>:</p>

<blockquote>
  <p><code>int</code> and <code>Int32</code> are indeed synonymous; <code>int</code> will be a little more
  familiar looking, <code>Int32</code> makes the 32-bitness more explicit to those
  reading your code. I would be inclined to use int where I just need
  'an integer', <code>Int32</code> where the size is important (cryptographic code,
  structures) so future maintainers will know it's safe to enlarge an
  <code>int</code> if appropriate, but should take care changing <code>Int32</code> variables
  in the same way.</p>
  
  <p>The resulting code will be identical: the difference is purely one of
  readability or code appearance.</p>
</blockquote>
","9696777"
"C# convert int to string with padding zeros?","280319","","<p>In C# I have an integer value which need to be convereted to string but it needs to add zeros before:</p>

<p>For Example:</p>

<pre><code>int i = 1;
</code></pre>

<p>When I convert it to string it needs to  become 0001</p>

<p>I need to know the syntax in C#.</p>
","<p><code>i.ToString().PadLeft(4, '0')</code> - okay, but doesn't work for negative numbers<br>
<code>i.ToString(""0000"");</code> - explicit form<br>
<code>i.ToString(""D4"");</code> - short form format specifier</p>
","4325289"
"Distinct() with lambda?","280232","","<p>Right, so I have an enumerable and wish to get distinct values from it.</p>

<p>Using <code>System.Linq</code>, there's of course an extension method called <code>Distinct</code>. In the simple case, it can be used with no parameters, like:</p>

<pre><code>var distinctValues = myStringList.Distinct();
</code></pre>

<p>Well and good, but if I have an enumerable of objects for which I need to specify equality, the only available overload is:</p>

<pre><code>var distinctValues = myCustomerList.Distinct(someEqualityComparer);
</code></pre>

<p>The equality comparer argument must be an instance of <code>IEqualityComparer&lt;T&gt;</code>. I can do this, of course, but it's somewhat verbose and, well, cludgy.</p>

<p>What I would have expected is an overload that would take a lambda, say a Func&lt;T, T, bool&gt;:</p>

<pre><code>var distinctValues
    = myCustomerList.Distinct((c1, c2) =&gt; c1.CustomerId == c2.CustomerId);
</code></pre>

<p>Anyone know if some such extension exists, or some equivalent workaround? Or am I missing something?</p>

<p>Alternatively, is there a way of specifying an IEqualityComparer inline (embarass me)?</p>

<p><strong>Update</strong></p>

<p>I found a reply by Anders Hejlsberg to a <a href=""http://social.msdn.microsoft.com/Forums/en-US/linqprojectgeneral/thread/6834054e-e1c1-49db-970c-370a9012c675"" rel=""noreferrer"">post</a> in an MSDN forum on this subject. He says:</p>

<blockquote>
  <p>The problem you're going to run into is that when two objects compare
  equal they must have the same GetHashCode return value (or else the
  hash table used internally by Distinct will not function correctly).
  We use IEqualityComparer because it packages compatible
  implementations of Equals and GetHashCode into a single interface.</p>
</blockquote>

<p>I suppose that makes sense..</p>
","<pre><code>IEnumerable&lt;Customer&gt; filteredList = originalList
  .GroupBy(customer =&gt; customer.CustomerId)
  .Select(group =&gt; group.First());
</code></pre>
","4158364"
"Download file of any type in Asp.Net MVC using FileResult?","279982","","<p>I've had it suggested to me that I should use FileResult to allow users to download files from my Asp.Net MVC application. But the only examples of this I can find always has to do with image files (specifying content type image/jpeg). </p>

<p>But what if I can't know the file type? I want users to be able to download pretty much any file from the filearea of my site.</p>

<p>I had read one method of doing this (see a <a href=""https://stackoverflow.com/questions/3597179/file-download-in-asp-net-mvc-2"">previous post</a> for the code), that actually works fine, except for one thing: the name of the file that comes up in the Save As dialog is concatenated from the file path with underscores (folder_folder_file.ext). Also, it seems people think I should return a FileResult instead of using this custom class that I had found BinaryContentResult.</p>

<p>Anyone know the ""correct"" way of doing such a download in MVC?</p>

<p>EDIT:
I got the answer (below), but just thought I should post the full working code if someone else is interested:</p>

<pre><code>public ActionResult Download(string filePath, string fileName)
{
    string fullName = Path.Combine(GetBaseDir(), filePath, fileName);

    byte[] fileBytes = GetFile(fullName);
    return File(
        fileBytes, System.Net.Mime.MediaTypeNames.Application.Octet, fileName);
}

byte[] GetFile(string s)
{
    System.IO.FileStream fs = System.IO.File.OpenRead(s);
    byte[] data = new byte[fs.Length];
    int br = fs.Read(data, 0, data.Length);
    if (br != fs.Length)
        throw new System.IO.IOException(s);
    return data;
}
</code></pre>
","<p>You can just specify the generic octet-stream MIME type:</p>

<pre><code>public FileResult Download()
{
    byte[] fileBytes = System.IO.File.ReadAllBytes(@""c:\folder\myfile.ext"");
    string fileName = ""myfile.ext"";
    return File(fileBytes, System.Net.Mime.MediaTypeNames.Application.Octet, fileName);
}
</code></pre>
","3605510"
"How to read a CSV file into a .NET Datatable","278781","","<p>How can I load a CSV file into a <code>System.Data.DataTable</code>, creating the datatable based on the CSV file?</p>

<p>Does the regular ADO.net functionality allow this?</p>
","<p>Here's an excellent class that will copy CSV data into a datatable using the structure of the data to create the DataTable:</p>

<p><a href=""http://www.codeproject.com/KB/database/GenericParser.aspx"" rel=""noreferrer"">A portable and efficient generic parser for flat files</a></p>

<p>It's easy to configure and easy to use.  I urge you to take a look.</p>
","1050149"
"The request was aborted: Could not create SSL/TLS secure channel","278266","","<p>We are unable to connect to an HTTPS server using <code>WebRequest</code> because of this error message:</p>

<p><code>The request was aborted: Could not create SSL/TLS secure channel.</code></p>

<p>We know that the server doesn't have a valid HTTPS certificate with the path used, but to bypass this issue, we use the following code that we've taken from another StackOverflow post:</p>

<pre><code>private void Somewhere() {
    ServicePointManager.ServerCertificateValidationCallback += new RemoteCertificateValidationCallback(AllwaysGoodCertificate);
}

private static bool AllwaysGoodCertificate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors policyErrors) {
   return true;
}
</code></pre>

<p>The problem is that server never validates the certificate and fails with the above error. Does anyone have any idea of what should I do?</p>

<hr>

<p>I should mention that a colleague and I performed tests a few weeks ago and it was working fine with something similar to what I wrote above. The only ""major difference"" we've found is that I'm using Windows 7 and he was using Windows XP.  Does that change something?</p>
","<p>I finally found the answer (I haven't noted my source but it was from a search); </p>

<p>While the code works in Windows XP, in Windows 7, you must add this at the beginning:</p>

<pre><code>ServicePointManager.Expect100Continue = true;
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;
// Use SecurityProtocolType.Ssl3 if needed for compatibility reasons
</code></pre>

<p>And now, it works perfectly.</p>

<hr>

<p><strong>ADDENDUM</strong></p>

<p>As mentioned by Robin French; PayPal no longer support SSL3 so you'll need to use TLS1.2. <a href=""https://www.paypal-knowledge.com/infocenter/index?page=content&amp;widgetview=true&amp;id=FAQ1914&amp;viewlocale=en_US"" rel=""noreferrer"">Paypal Info Page</a></p>
","2904963"
"Formatting a float to 2 decimal places","278227","","<p>I am currently building a sales module for a clients website. So far I have got the sale price to calculate perfectly but where I have come stuck is formatting the output to 2 decimal places.</p>

<p>I am currently calling this in a variable so that I can data bind the results to a listview.</p>

<pre><code>Sale = float.Parse(((x.Sale_Price - (x.Sale_Price * (x.Discount_Price / 100))).ToString())),
</code></pre>

<p>Can anyone show me how to format the output to 2 decimal places?? Many Thanks!</p>
","<p>You can pass the format in to the <code>ToString</code> method, e.g.:</p>

<pre><code>myFloatVariable.ToString(""0.00""); //2dp Number

myFloatVariable.ToString(""n2""); // 2dp Number

myFloatVariable.ToString(""c2""); // 2dp currency
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx"" rel=""noreferrer"">Standard Number Format Strings</a></p>
","6356381"
"Install a Windows service using a Windows command prompt?","277636","","<p>I want to install a Windows service using a Windows command prompt (not the Visual Studio command prompt).</p>

<p>How do I do this?</p>
","<p>Navigate to the installutil.exe in your .net folder (for .net 4 it's C:\Windows\Microsoft.NET\Framework\v4.0.30319 for example) and use it to install your service, like this:</p>

<pre><code>""C:\Windows\Microsoft.NET\Framework\v4.0.30319\installutil.exe"" ""c:\myservice.exe""
</code></pre>
","8165122"
"Tree data structure in C#","277277","","<p>I was looking for a tree or graph data structure in C# but I guess there isn't one provided. <a href=""http://msdn.microsoft.com/en-us/library/ms379574.aspx"" rel=""noreferrer"">An Extensive Examination of Data Structures Using C# 2.0</a> explains a bit about why.  Is there a convenient library which is commonly used to provide this functionality?  Perhaps through a strategy pattern to solve the issues presented in the article.</p>

<p>I feel a bit silly implementing my own tree, just as I would implementing my own ArrayList.   </p>

<p>I just want a generic tree which can be unbalanced.  Think of a directory tree.  C5 looks nifty, but their tree structures seem to be implemented as balanced red-black trees better suited to search than representing a hierarchy of nodes.  </p>
","<p>My best advice would be that there is no standard tree data structure because there are so many ways you could implement it that it would be impossible to cover all bases with one solution.  The more specific a solution, the less likely it is applicable to any given problem.  I even get annoyed with LinkedList - what if I want a circular linked list?</p>

<p>The basic structure you'll need to implement will be a collection of nodes, and here are some options to get you started.  Let's assume that the class Node is the base class of the entire solution.</p>

<p>If you need to only navigate down the tree, then a Node class needs a List of children.</p>

<p>If you need to navigate up the tree, then the Node class needs a link to its parent node.</p>

<p>Build an AddChild method that takes care of all the minutia of these two points and any other business logic that must be implemented (child limits, sorting the children, etc.)</p>
","66956"
"System.BadImageFormatException: Could not load file or assembly","277215","","<pre><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319&gt;InstallUtil.exe C:\_PRODUKCIJA\D
ebug\DynamicHtmlTool.exe
Microsoft (R) .NET Framework Installation utility Version 4.0.30319.1
Copyright (c) Microsoft Corporation.  All rights reserved.

Exception occurred while initializing the installation:
System.BadImageFormatException: Could not load file or assembly 'file:///C:\_PRO
DUKCIJA\Debug\DynamicHtmlTool.exe' or one of its dependencies. An attempt was ma
de to load a program with an incorrect format..

C:\Windows\Microsoft.NET\Framework64\v4.0.30319&gt;
</code></pre>

<p>service is x86 compiled even both computers are x64 and it works on my computer. Here in server where is win 2008 i get this error.</p>

<p>i try solutions from google but none works.</p>

<p>Like write here i have x86 project
<a href=""http://www.davesquared.net/2008/12/systembadimageformatexception-on-64-bit.html"">http://www.davesquared.net/2008/12/systembadimageformatexception-on-64-bit.html</a></p>
","<p>It seems that you are using the 64-bit version of the tool to install a 32-bit/x86 architecture application. Look for the 32-bit version of the tool here:</p>

<pre><code>C:\Windows\Microsoft.NET\Framework\v4.0.30319
</code></pre>

<p>and it should install your 32-bit application just fine.</p>
","5229405"
"How to pass parameters to ThreadStart method in Thread?","276975","","<p>How to pass parameters to <code>Thread.ThreadStart()</code> method in C#?</p>

<p>Suppose I have method called 'download'</p>

<pre><code>public void download(string filename)
{
    // download code
}
</code></pre>

<p>Now I have created one thread in the main method:</p>

<pre><code>Thread thread = new Thread(new ThreadStart(download(filename));
</code></pre>

<blockquote>
  <p>error method type expected.</p>
</blockquote>

<p>How can I pass parameters to <code>ThreadStart</code> with target method with parameters?</p>
","<p>The simplest is just</p>

<pre><code>string filename = ...
Thread thread = new Thread(() =&gt; download(filename));
thread.Start();
</code></pre>

<p>The advantage(s) of this (over <code>ParameterizedThreadStart</code>) is that you can pass multiple parameters, and you get compile-time checking without needing to cast from <code>object</code> all the time.</p>
","3360582"
"What Are Some Good .NET Profilers?","276908","","<p>What profilers have you used when working with .net programs, and which would you particularly recommend?</p>
","<p>I have used <a href=""http://www.jetbrains.com/profiler/"" rel=""noreferrer"">JetBrains dotTrace</a> and <a href=""http://www.red-gate.com/products/ants_performance_profiler/"" rel=""noreferrer"">Redgate ANTS</a> extensively. They are fairly similar in features and price. They both offer useful performance profiling and quite basic memory profiling.</p>

<p>dotTrace integrates with Resharper, which is really convenient, as you can profile the performance of a unit test with one click from the IDE. However, dotTrace often seems to give spurious results (e.g. saying that a method took several years to run)</p>

<p>I prefer the way that ANTS presents the profiling results. It shows you the source code and to the left of each line tells you how long it took to run. dotTrace just has a tree view.</p>

<p><a href=""http://www.eqatec.com/Profiler/"" rel=""noreferrer"">EQATEC profiler</a> is quite basic and requires you to compile special instrumented versions of your assemblies which can then be run in the EQATEC profiler. It is, however, free.</p>

<p>Overall I prefer ANTS for performance profiling, although if you use Resharper then the integration of dotTrace is a killer feature and means it beats ANTS in usability.</p>

<p>The free Microsoft CLR Profiler (<a href=""http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=13382"" rel=""noreferrer"">.Net framework 2.0</a> / <a href=""http://www.microsoft.com/download/en/details.aspx?id=16273"" rel=""noreferrer"">.Net Framework 4.0</a>) is all you need for .NET memory profiling.</p>

<p><strong>2011 Update:</strong></p>

<p>The <a href=""http://memprofiler.com/"" rel=""noreferrer"">Scitech memory profiler</a> has quite a basic UI but lots of useful information, including some information on unmanaged memory which dotTrace and ANTS lack - you might find it useful if you are doing COM interop, but I have yet to find any profiler that makes COM memory issues easy to diagnose - you usually have to break out <code>windbg.exe</code>.</p>

<p>The ANTS profiler has come on in leaps and bounds in the last few years, and its memory profiler has some truly useful features which now pushed it ahead of dotTrace as a package in my estimation. I'm lucky enough to have licenses for both, but if you are going to buy one .Net profiler for both performance and memory, make it ANTS.</p>
","100490"
"How to access session variables from any class in ASP.NET?","276376","","<p>I have created a class file in the App_Code folder in my application. I have a session variable </p>

<pre><code>Session[""loginId""]
</code></pre>

<p>I want to access this session variables in my class, but when I am writing the following line then it gives error</p>

<pre><code>Session[""loginId""]
</code></pre>

<p>Can anyone tell me how to access session variables within a class which is created in app_code folder in ASP.NET 2.0 (C#)</p>
","<p>(Updated for completeness)<br>
You can access session variables from any page or control using <code>Session[""loginId""]</code> and from any class (e.g. from inside a class library), using <code>System.Web.HttpContext.Current.Session[""loginId""].</code></p>

<p>But please read on for my original answer...</p>

<hr>

<p>I always use a wrapper class around the ASP.NET session to simplify access to session variables:</p>

<pre><code>public class MySession
{
    // private constructor
    private MySession()
    {
      Property1 = ""default value"";
    }

    // Gets the current session.
    public static MySession Current
    {
      get
      {
        MySession session =
          (MySession)HttpContext.Current.Session[""__MySession__""];
        if (session == null)
        {
          session = new MySession();
          HttpContext.Current.Session[""__MySession__""] = session;
        }
        return session;
      }
    }

    // **** add your session properties here, e.g like this:
    public string Property1 { get; set; }
    public DateTime MyDate { get; set; }
    public int LoginId { get; set; }
}
</code></pre>

<p>This class stores one instance of itself in the ASP.NET session and allows you to access your session properties in a type-safe way from any class, e.g like this:</p>

<pre><code>int loginId = MySession.Current.LoginId;

string property1 = MySession.Current.Property1;
MySession.Current.Property1 = newValue;

DateTime myDate = MySession.Current.MyDate;
MySession.Current.MyDate = DateTime.Now;
</code></pre>

<p>This approach has several advantages:</p>

<ul>
<li>it saves you from a lot of type-casting</li>
<li>you don't have to use hard-coded session keys throughout your application (e.g. Session[""loginId""]</li>
<li>you can document your session items by adding XML doc comments on the properties of MySession</li>
<li>you can initialize your session variables with default values (e.g. assuring they are not null)</li>
</ul>
","621620"
"Why is it important to override GetHashCode when Equals method is overridden?","276227","","<p>Given the following class</p>

<pre><code>public class Foo
{
    public int FooId { get; set; }
    public string FooName { get; set; }

    public override bool Equals(object obj)
    {
        Foo fooItem = obj as Foo;

        return fooItem.FooId == this.FooId;
    }

    public override int GetHashCode()
    {
        // Which is preferred?

        return base.GetHashCode();

        //return this.FooId.GetHashCode();
    }
}
</code></pre>

<p>I have overridden the <code>Equals</code> method because <code>Foo</code> represent a row for the <code>Foo</code>s table.  Which is the preferred method for overriding the <code>GetHashCode</code>?</p>

<p>Why is it important to override <code>GetHashCode</code>?</p>
","<p>Yes, it is important if your item will be used as a key in a dictionary, or <code>HashSet&lt;T&gt;</code>, etc - since this is used (in the absence of a custom <code>IEqualityComparer&lt;T&gt;</code>) to group items into buckets. If the hash-code for two items does not match, they may <em>never</em> be considered equal (<code>Equals</code> will simply never be called).</p>

<p>The <code>GetHashCode()</code> method should reflect the <code>Equals</code> logic; the rules are:</p>

<ul>
<li>if two things are equal (<code>Equals(...) == true</code>) then they <em>must</em> return the same value for <code>GetHashCode()</code></li>
<li>if the <code>GetHashCode()</code> is equal, it is <em>not</em> necessary for them to be the same; this is a collision, and <code>Equals</code> will be called to see if it is a real equality or not.</li>
</ul>

<p>In this case, it looks like ""<code>return FooId;</code>"" is a suitable <code>GetHashCode()</code> implementation. If you are testing multiple properties, it is common to combine them using code like below, to reduce diagonal collisions (i.e. so that <code>new Foo(3,5)</code> has a different hash-code to <code>new Foo(5,3)</code>):</p>

<pre><code>int hash = 13;
hash = (hash * 7) + field1.GetHashCode();
hash = (hash * 7) + field2.GetHashCode();
...
return hash;
</code></pre>

<p>Oh - for convenience, you might also consider providing <code>==</code> and <code>!=</code> operators when overriding <code>Equals</code> and <code>GetHashCode</code>.</p>

<hr>

<p>A demonstration of what happens when you get this wrong is <a href=""https://stackoverflow.com/questions/638761/c-gethashcode-override-of-object-containing-generic-array/639098#639098"">here</a>.</p>
","371348"
"What's the difference between the 'ref' and 'out' keywords?","276088","","<p>I'm creating a function where I need to pass an object so that it can be modified by the function. What is the difference between:</p>

<pre><code>public void myFunction(ref MyClass someClass)
</code></pre>

<p>and</p>

<pre><code>public void myFunction(out MyClass someClass)
</code></pre>

<p>Which should I use and why?</p>
","<p><code>ref</code> tells the compiler that the object is initialized before entering the function, while <code>out</code> tells the compiler that the object will be initialized inside the function. </p>

<p>So while <code>ref</code> is two-ways, <code>out</code> is out-only.</p>
","388467"
"Inconsistent Accessibility: Parameter type is less accessible than method","275638","","<p>I'm trying to pass an object (a reference to the currently logged on user, basically) between two forms.  At the moment, I have something along these lines in the login form:</p>

<pre><code>private ACTInterface oActInterface;

public void button1_Click(object sender, EventArgs e)
    {
        oActInterface = new ACTInterface(@""\\actserver\Database\Premier.pad"",this.textUser.Text,this.textPass.Text);

        if (oActInterface.checkLoggedIn())
        {
            //user has authed against ACT, so we can carry on
            clients oClientForm = new clients(oActInterface);
            this.Hide();
            oClientForm.Show();
        }
        else...
</code></pre>

<p>on the next form (clients), I have:</p>

<pre><code>public partial class clients : Form
{
    private ACTInterface oActInt {get; set;}

    public clients(ACTInterface _oActInt)
</code></pre>

<p>...which results in me getting:</p>

<pre><code>Error   1   Inconsistent accessibility: 
parameter type 'support.ACTInterface' is less accessible than method    
'support.clients.clients(support.ACTInterface)'  
c:\work\net\backup\support\support\clients.cs   20  16  support
</code></pre>

<p>I don't really understand what the problem is - both fields are private, and accessed by the relevant public method from the form.  Googling doesn't really help, as it just points towards one element being public and the other private, which isn't the case here.</p>

<p>Anybody help?</p>
","<p>Constructor of <code>public</code> class <code>clients</code> is <code>public</code> but it has a parameter of type <code>ACTInterface</code> that is <code>private</code> (it is nested in a class?). You can't do that. You need to make <code>ACTInterface</code> at least as accessible as <code>clients</code>.</p>
","6229537"
"How to open a new form from another form","275628","","<p>I have form which is opened using ShowDialog Method. In this form i have a Button called More.
If we click on More it should open another form and it should close the current form.</p>

<p>on More Button's Click event Handler i have written the following code</p>

<pre><code>MoreActions objUI = new MoreActions (); 
objUI.ShowDialog();
this.Close();
</code></pre>

<p>But what is happening is, it's not closing the first form. So, i modified this code to </p>

<pre><code>MoreActions objUI = new MoreActions (); 
objUI.Show();
this.Close();
</code></pre>

<p>Here, The second form is getting displayed and within seconds both the forms getting closed.</p>

<p>Can anybody please help me to fix issue.  What i need to do is, If we click on More Button, it should open another form and close the first form.</p>

<p>Any kind of help will be really helpful to me.</p>
","<p>In my opinion the main form should be responsible for opening both child form. Here is some pseudo that explains what I would do:</p>

<pre><code>// MainForm
private ChildForm childForm;
private MoreForm moreForm;

ButtonThatOpenTheFirstChildForm_Click()
{
    childForm = CreateTheChildForm();
    childForm.MoreClick += More_Click;
    childForm.Show();
}

More_Click()
{
    childForm.Close();
    moreForm = new MoreForm();
    moreForm.Show();
}
</code></pre>

<p>You will just need to create a simple event MoreClick in the first child. The main benefit of this approach is that you can replicate it as needed and you can very easily model some sort of basic workflow.</p>
","3965618"
"There is already an open DataReader associated with this Command which must be closed first","275486","","<p>I have this query and I get the error in this function:</p>

<pre><code>var accounts = from account in context.Accounts
               from guranteer in account.Gurantors
               select new AccountsReport
               {
                   CreditRegistryId = account.CreditRegistryId,
                   AccountNumber = account.AccountNo,
                   DateOpened = account.DateOpened,
               };

 return accounts.AsEnumerable()
                .Select((account, index) =&gt; new AccountsReport()
                    {
                        RecordNumber = FormattedRowNumber(account, index + 1),
                        CreditRegistryId = account.CreditRegistryId,
                        DateLastUpdated = DateLastUpdated(account.CreditRegistryId, account.AccountNumber),
                        AccountNumber = FormattedAccountNumber(account.AccountType, account.AccountNumber)
                    })
                .OrderBy(c=&gt;c.FormattedRecordNumber)
                .ThenByDescending(c =&gt; c.StateChangeDate);


public DateTime DateLastUpdated(long creditorRegistryId, string accountNo)
{
    return (from h in context.AccountHistory
            where h.CreditorRegistryId == creditorRegistryId &amp;&amp; h.AccountNo == accountNo
            select h.LastUpdated).Max();
}
</code></pre>

<p>Error is:</p>

<blockquote>
  <p>There is already an open DataReader associated with this Command which must be closed first. </p>
</blockquote>

<p><strong>Update:</strong></p>

<p>stack trace added:</p>

<pre><code>InvalidOperationException: There is already an open DataReader associated with this Command which must be closed first.]
   System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command) +5008639
   System.Data.SqlClient.SqlConnection.ValidateConnectionForExecute(String method, SqlCommand command) +23
   System.Data.SqlClient.SqlCommand.ValidateCommand(String method, Boolean async) +144
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +87
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +32
   System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +141
   System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +12
   System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior) +10
   System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) +443

[EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details.]
   System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) +479
   System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute(ObjectContext context, ObjectParameterCollection parameterValues) +683
   System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) +119
   System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable&lt;T&gt;.GetEnumerator() +38
   System.Linq.Enumerable.Single(IEnumerable`1 source) +114
   System.Data.Objects.ELinq.ObjectQueryProvider.&lt;GetElementFunction&gt;b__3(IEnumerable`1 sequence) +4
   System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle(IEnumerable`1 query, Expression queryRoot) +29
   System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute(Expression expression) +91
   System.Data.Entity.Internal.Linq.DbQueryProvider.Execute(Expression expression) +69
   System.Linq.Queryable.Max(IQueryable`1 source) +216
   CreditRegistry.Repositories.CreditRegistryRepository.DateLastUpdated(Int64 creditorRegistryId, String accountNo) in D:\Freelance Work\SuperExpert\CreditRegistry\CreditRegistry\Repositories\CreditRegistryRepository.cs:1497
   CreditRegistry.Repositories.CreditRegistryRepository.&lt;AccountDetails&gt;b__88(AccountsReport account, Int32 index) in D:\Freelance Work\SuperExpert\CreditRegistry\CreditRegistry\Repositories\CreditRegistryRepository.cs:1250
   System.Linq.&lt;SelectIterator&gt;d__7`2.MoveNext() +198
   System.Linq.Buffer`1..ctor(IEnumerable`1 source) +217
   System.Linq.&lt;GetEnumerator&gt;d__0.MoveNext() +96
</code></pre>
","<p>This can happen if you execute a query while iterating over the results from another query. It is not clear from your example where this happens because the example is not complete.</p>

<p>One thing that can cause this is lazy loading triggered when iterating over the results of some query.</p>

<p>This can be easily solved by allowing MARS in your connection string. Add <code>MultipleActiveResultSets=true</code> to the provider part of your connection string (where Data Source, Initial Catalog, etc. are specified).</p>
","6064422"
"Get current folder path","274037","","<p>I want to create a program that converts files. I would like the user to be able to place the executable file in any directory, and when executing that program (double-clicking on the .exe) I want the program to process <strong>all the files within the current folder where the exe file exists</strong>. How can the program determine the path in which it is currently executing?</p>

<p>I tried <code>System.Windows.Forms.Application.StartupPath</code> but that seems to be the wrong way.</p>

<p>Any ideas?</p>
","<p>You should <strong>not</strong> use <code>Directory.GetCurrentDirectory()</code> in your case, as the current directory may differ from the execution folder, especially when you execute the program through a shortcut.</p>

<p>It's better to use <code>Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);</code> for your purpose. This returns the pathname where the currently executing assembly resides.</p>

<p>While my suggested approach allows you to differentiate between the executing assembly, the entry assembly or any other loaded assembly, as <em>Soner Gönül</em> said in his answer, </p>

<pre><code>System.IO.Path.GetDirectoryName(Application.ExecutablePath);
</code></pre>

<p>may also be sufficient. This would be equal to</p>

<pre><code>System.IO.Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
</code></pre>
","15653938"
"Error - Unable to access the IIS metabase","274009","","<p>After installing Visual Studio 2012 and opening my solution I get a series of errors in this form:</p>

<blockquote>
  <p>The Web Application Project Foo is configured to use IIS.<br>
  Unable to access the IIS metabase. You do not have sufficient privilege to access IIS web sites on your machine.</p>
</blockquote>

<p>I get this for each of our web applications.  Things I have tried:</p>

<ol>
<li>Running Visual Studio as Administrator </li>
<li>Running aspnet_regiis.exe -ga MyUserName </li>
<li>Running aspnet_regiis.exe -i</li>
</ol>

<p>These seem to be common solutions for this problem but I have not had any success with them.  Is there anything else I can try to do?  </p>
","<p><strong>Thank you to everyone that answered.</strong> Since this was closed for a long time I couldn't provide much feedback, but I did eventually fix my problem. I tried many of these other solutions and they didn't fix my issue, but I'm sure they help when the root cause is different.</p>

<p><strong>My Solution</strong></p>

<p>I solved this problem by turning off the IIS and .Net Framework features within Windows 7 and then turning them back on. It seems like this re-installation is what fixed my issue. I still don't know what caused the problem, but at least one other developer on my team had the same issue.</p>
","14715377"
"C# code to validate email address","273437","","<p>What is the most elegant code to validate that a string is a valid email address?</p>
","<p>What about this?</p>

<pre><code>bool IsValidEmail(string email)
{
    try {
        var addr = new System.Net.Mail.MailAddress(email);
        return addr.Address == email;
    }
    catch {
        return false;
    }
}
</code></pre>

<p>To clarify, the question is asking whether a particular string is a valid representation of an e-mail address, not whether an e-mail address is a valid destination to send a message. For that, the only real way is to send a message to confirm.</p>

<p>Note that e-mail addresses are more forgiving than you might first assume. These are all perfectly valid forms:</p>

<ul>
<li>cog@wheel</li>
<li>""cogwheel the orange""@example.com</li>
<li>123@$.xyz</li>
</ul>

<p>For most use cases, a false ""invalid"" is much worse for your users and future proofing than a false ""valid"". Here's an <a href=""http://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx/"" rel=""noreferrer"">article that used to be the accepted answer</a> to this question (that answer has since been deleted). It has a lot more detail and some other ideas of how to solve the problem.</p>

<p>Providing sanity checks is still a good idea for user experience. Assuming the e-mail passes validation, you can then pass it through another validator that could look for a known top-level domain, check the domain for an MX record, check for spelling errors from common domain names (gmail.cmo), etc. Then present a warning giving the user a chance to say ""yes, my mail server really does allow 🌮🍳🎁 as an email address.""</p>

<p>As for using exception handling for business logic, I agree that is a thing to be avoided. But this is one of those cases where the convenience and clarity may outweigh the dogma.</p>

<p>Per Stuart's comment, this compares the final address with the original string instead of always returning true. MailAddress tries to parse a string with spaces into ""Display Name"" and ""Address"" portions, so the original version was returning false positives.</p>
","1374644"
"How to call asynchronous method from synchronous method in C#?","273272","","<p>I have a <code>public async void Foo()</code> method that I want to call from synchronous method. So far all I have seen from MSDN documentation is calling async methods via async methods, but my whole program is not built with async methods.</p>

<p>Is this even possible?</p>

<p>Here's one example of calling these methods from an asynchronous method: <a href=""http://msdn.microsoft.com/en-us/library/hh300224(v=vs.110).aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/hh300224(v=vs.110).aspx</a></p>

<p>Now I'm looking into calling these async methods from sync methods.</p>
","<p>Asynchronous programming does ""grow"" through the code base. It has been <a href=""http://blogs.msdn.com/b/lucian/archive/2011/04/15/async-ctp-refresh-design-changes.aspx"">compared to a zombie virus</a>. The best solution is to allow it to grow, but sometimes that's not possible.</p>

<p>I have written a few types in my <a href=""https://github.com/StephenCleary/AsyncEx"">Nito.AsyncEx</a> library for dealing with a partially-asynchronous code base. There's no solution that works in every situation, though.</p>

<p><strong>Solution A</strong></p>

<p>If you have a simple asynchronous method that doesn't need to synchronize back to its context, then you can use <code>Task.WaitAndUnwrapException</code>:</p>

<pre><code>var task = MyAsyncMethod();
var result = task.WaitAndUnwrapException();
</code></pre>

<p>You do <em>not</em> want to use <code>Task.Wait</code> or <code>Task.Result</code> because they wrap exceptions in <code>AggregateException</code>.</p>

<p>This solution is only appropriate if <code>MyAsyncMethod</code> does not synchronize back to its context. In other words, every <code>await</code> in <code>MyAsyncMethod</code> should end with <code>ConfigureAwait(false)</code>. This means it can't update any UI elements or access the ASP.NET request context.</p>

<p><strong>Solution B</strong></p>

<p>If <code>MyAsyncMethod</code> does need to synchronize back to its context, then you may be able to use <code>AsyncContext.RunTask</code> to provide a nested context:</p>

<pre><code>var result = AsyncContext.RunTask(MyAsyncMethod).Result;
</code></pre>

<hr>

<p>*Update 4/14/2014: In more recent versions of the library the API is as follows:</p>

<pre><code>var result = AsyncContext.Run(MyAsyncMethod);
</code></pre>

<hr>

<p>(It's OK to use <code>Task.Result</code> in this example because <code>RunTask</code> will propagate <code>Task</code> exceptions).</p>

<p>The reason you may need <code>AsyncContext.RunTask</code> instead of <code>Task.WaitAndUnwrapException</code> is because of a rather subtle deadlock possibility that happens on WinForms/WPF/SL/ASP.NET:</p>

<ol>
<li>A synchronous method calls an async method, obtaining a <code>Task</code>.</li>
<li>The synchronous method does a blocking wait on the <code>Task</code>.</li>
<li>The <code>async</code> method uses <code>await</code> without <code>ConfigureAwait</code>.</li>
<li>The <code>Task</code> cannot complete in this situation because it only completes when the <code>async</code> method is finished; the <code>async</code> method cannot complete because it is attempting to schedule its continuation to the <code>SynchronizationContext</code>, and WinForms/WPF/SL/ASP.NET will not allow the continuation to run because the synchronous method is already running in that context.</li>
</ol>

<p>This is one reason why it's a good idea to use <code>ConfigureAwait(false)</code> within every <code>async</code> method as much as possible.</p>

<p><strong>Solution C</strong></p>

<p><code>AsyncContext.RunTask</code> won't work in every scenario. For example, if the <code>async</code> method awaits something that requires a UI event to complete, then you'll deadlock even with the nested context. In that case, you could start the <code>async</code> method on the thread pool:</p>

<pre><code>var task = TaskEx.RunEx(async () =&gt; await MyAsyncMethod());
var result = task.WaitAndUnwrapException();
</code></pre>

<p>However, this solution requires a <code>MyAsyncMethod</code> that will work in the thread pool context. So it can't update UI elements or access the ASP.NET request context. And in that case, you may as well add <code>ConfigureAwait(false)</code> to its <code>await</code> statements, and use solution A.</p>
","9343733"
"ThreadStart with parameters","272972","","<p>How do you start a thread with parameters in C#?</p>
","<p>Yep : </p>

<pre><code>Thread t = new Thread (new ParameterizedThreadStart(myMethod));
t.Start (myParameterObject);
</code></pre>
","1195910"
"Howto: Count the items from a IEnumerable<T> without iterating?","272265","","<pre><code>private IEnumerable&lt;string&gt; Tables
{
    get
    {
        yield return ""Foo"";
        yield return ""Bar"";
    }
}
</code></pre>

<p>Let's say I want iterate on those and write something like processing #n of #m. </p>

<p>Is there a way I can find out the value of m without iterating before my main iteration?</p>

<p>I hope I made myself clear.</p>
","<p><code>IEnumerable</code> doesn't support this. This is by design. <code>IEnumerable</code> uses lazy evaluation to get the elements you ask for just before you need them.</p>

<p>If you want to know the number of items without iterating over them you can use <code>ICollection&lt;T&gt;</code>, it has a <code>Count</code> property.</p>
","168922"
"Reading Xml with XmlReader in C#","271278","","<p>I'm trying to read the following Xml document as fast as I can and let additional classes manage the reading of each sub block.</p>

<pre><code>&lt;ApplicationPool&gt;
    &lt;Accounts&gt;
        &lt;Account&gt;
            &lt;NameOfKin&gt;&lt;/NameOfKin&gt;
            &lt;StatementsAvailable&gt;
                &lt;Statement&gt;&lt;/Statement&gt;
            &lt;/StatementsAvailable&gt;
        &lt;/Account&gt;
    &lt;/Accounts&gt;
&lt;/ApplicationPool&gt;
</code></pre>

<p>However, I'm trying to use the XmlReader object to read each Account and subsequently the ""StatementsAvailable"". Do you suggest using XmlReader.Read and check each element and handle it?</p>

<p>I've thought of seperating my classes to handle each node properly. So theres an AccountBase class that accepts a XmlReader instance that reads the NameOfKin and several other properties about the account. Then I was wanting to interate through the Statements and let another class fill itself out about the Statement (and subsequently add it to an IList).</p>

<p>Thus far I have the ""per class"" part done by doing XmlReader.ReadElementString() but I can't workout how to tell the pointer to move to the StatementsAvailable element and let me iterate through them and let another class read each of those proeprties.</p>

<p>Sounds easy!</p>
","<p>My experience of <code>XmlReader</code> is that it's very easy to accidentally read too much. I know you've said you want to read it as quickly as possible, but have you <em>tried</em> using a DOM model instead? I've found that LINQ to XML makes XML work much <em>much</em> easier.</p>

<p>If your document is particularly huge, you can combine <code>XmlReader</code> and LINQ to XML by creating an <code>XElement</code> from an <code>XmlReader</code> for each of your ""outer"" elements in a streaming manner: this lets you do most of the conversion work in LINQ to XML, but still only need a small portion of the document in memory at any one time. Here's some sample code (adapted slightly from <a href=""http://blogs.msdn.com/xmlteam/archive/2007/03/24/streaming-with-linq-to-xml-part-2.aspx"" rel=""noreferrer"">this blog post</a>):</p>

<pre><code>static IEnumerable&lt;XElement&gt; SimpleStreamAxis(string inputUrl,
                                              string elementName)
{
  using (XmlReader reader = XmlReader.Create(inputUrl))
  {
    reader.MoveToContent();
    while (reader.Read())
    {
      if (reader.NodeType == XmlNodeType.Element)
      {
        if (reader.Name == elementName)
        {
          XElement el = XNode.ReadFrom(reader) as XElement;
          if (el != null)
          {
            yield return el;
          }
        }
      }
    }
  }
}
</code></pre>

<p>I've used this to convert the StackOverflow user data (which is enormous) into another format before - it works very well.</p>

<p>EDIT from radarbob, reformatted by Jon - although it's not quite clear which ""read too far"" problem is being referred to...</p>

<p>This should simplify the nesting and take care of the ""a read too far"" problem.</p>

<pre><code>using (XmlReader reader = XmlReader.Create(inputUrl))
{
    reader.ReadStartElement(""theRootElement"");

    while (reader.Name == ""TheNodeIWant"")
    {
        XElement el = (XElement) XNode.ReadFrom(reader);
    }

    reader.ReadEndElement();
}
</code></pre>

<p>This takes care of ""a read too far"" problem because it implements the classic while loop pattern:</p>

<pre><code>initial read;
(while ""we're not at the end"") {
    do stuff;
    read;
}
</code></pre>
","2441694"
"How can I decode HTML characters in C#?","271082","","<p>I have email addresses encoded with HTML character entities. Is there anything in .NET that can convert them to plain strings?</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/7c5fyk1k.aspx"" rel=""noreferrer""><code>HttpUtility.HtmlDecode</code></a></p>

<p>If you are using .NET 4.0+ you can also use <a href=""http://msdn.microsoft.com/en-us/library/ee388354.aspx"" rel=""noreferrer""><code>WebUtility.HtmlDecode</code></a> which does not require an extra assembly reference as it is available in the <code>System.Net</code> namespace.</p>
","122658"
"Can you call Directory.GetFiles() with multiple filters?","270225","","<p>I am trying to use the <code>Directory.GetFiles()</code> method to retrieve a list of files of multiple types, such as <code>mp3</code>'s and <code>jpg</code>'s.  I have tried both of the following with no luck:</p>

<pre><code>Directory.GetFiles(""C:\\path"", ""*.mp3|*.jpg"", SearchOption.AllDirectories);
Directory.GetFiles(""C:\\path"", ""*.mp3;*.jpg"", SearchOption.AllDirectories);
</code></pre>

<p>Is there a way to do this in one call?</p>
","<p>For .NET 4.0 and later, </p>

<pre><code>var files = Directory.EnumerateFiles(""C:\\path"", ""*.*"", SearchOption.AllDirectories)
            .Where(s =&gt; s.EndsWith("".mp3"") || s.EndsWith("".jpg""));
</code></pre>

<p>For earlier versions of .NET,</p>

<pre><code>var files = Directory.GetFiles(""C:\\path"", ""*.*"", SearchOption.AllDirectories)
            .Where(s =&gt; s.EndsWith("".mp3"") || s.EndsWith("".jpg""));
</code></pre>

<p><strong>edit:</strong> <em>Please read the comments. The improvement that <a href=""https://stackoverflow.com/users/97516/paul-farry"">Paul Farry</a> suggests, and the memory/performance issue that <a href=""https://stackoverflow.com/users/21567/christian-k"">Christian.K</a> points out are both very important.</em></p>
","163220"
"Regular Expression to find a string included between two characters while EXCLUDING the delimiters","270200","","<p>I need to extract from a string a set of characters which are included between two delimiters, without returning the delimiters themselves.</p>

<p>A simple example should be helpful:</p>

<p><strong>Target</strong>: extract the substring between square brackets, without returning the brackets themselves.</p>

<p><strong>Base string</strong>: <em>This is a test string [more or less]</em></p>

<p>If I use the following reg. ex.</p>

<pre>\[.*?\]</pre>

<p>The match is <strong>[more or less]</strong>. I need to get only <strong>more or less</strong> (without the brackets).  </p>

<p>Is it possible to do it?</p>
","<p>Easy done:</p>

<pre><code>(?&lt;=\[)(.*?)(?=\])
</code></pre>

<p>Technically that's using lookaheads and lookbehinds. See <a href=""http://www.regular-expressions.info/lookaround.html"" rel=""noreferrer"">Lookahead and Lookbehind Zero-Width Assertions</a>. The pattern consists of:</p>

<ul>
<li>is preceded by a [ that is not captured (lookbehind);</li>
<li>a non-greedy captured group. It's non-greedy to stop at the first ]; and</li>
<li>is followed by a ] that is not captured (lookahead).</li>
</ul>

<p>Alternatively you can just capture what's between the square brackets:</p>

<pre><code>\[(.*?)\]
</code></pre>

<p>and return the first captured group instead of the entire match.</p>
","1454936"
"How do I convert an enum to a list in C#?","270180","","<p>Is there a way to convert an <code>enum</code> to a list that contains all the enum's options?</p>
","<p>This will return an <code>IEnumerable&lt;SomeEnum&gt;</code> of all the values of an Enum.</p>

<pre><code>Enum.GetValues(typeof(SomeEnum)).Cast&lt;SomeEnum&gt;();
</code></pre>

<p>If you want that to be a <code>List&lt;SomeEnum&gt;</code>, just add <code>.ToList()</code> after <code>.Cast&lt;SomeEnum&gt;()</code>.</p>

<p>To use the Cast function on an Array you need to have the <code>System.Linq</code> in your using section.</p>
","1167367"
"How can I detect the encoding/codepage of a text file","269903","","<p>In our application, we receive text files (<code>.txt</code>, <code>.csv</code>, etc.) from diverse sources. When reading, these files sometimes contain garbage, because the files where created in a different/unknown codepage.</p>

<p>Is there a way to (automatically) detect the codepage of a text file? </p>

<p>The <code>detectEncodingFromByteOrderMarks</code>, on the <code>StreamReader</code> constructor, works for <code>UTF8</code>  and other unicode marked files, but I'm looking for a way to detect code pages, like <code>ibm850</code>, <code>windows1252</code>. </p>

<hr>

<p>Thanks for your answers, this is what I've done.</p>

<p>The files we receive are from end-users, they do not have a clue about codepages. The receivers are also end-users, by now this is what they know about codepages: Codepages exist, and are annoying.</p>

<p><strong>Solution:</strong> </p>

<ul>
<li>Open the received file in Notepad, look at a garbled piece of text. If somebody is called François or something, with your human intelligence you can guess this.</li>
<li>I've created a small app that the user can use to open the file with, and enter a text that user knows it will appear in the file, when the correct codepage is used. </li>
<li>Loop through all codepages, and display the ones that give a solution with the user provided text. </li>
<li>If more as one codepage pops up, ask the user to specify more text.</li>
</ul>
","<p>You can't detect the codepage, you need to be told it. You can analyse the bytes and guess it, but that can give some bizarre (sometimes amusing) results. I can't find it now, but I'm sure Notepad can be tricked into displaying English text in Chinese. </p>

<p>Anyway, this is what you need to read: 
<a href=""http://www.joelonsoftware.com/articles/Unicode.html"" rel=""noreferrer"">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a>.</p>

<p>Specifically Joel says:</p>

<blockquote>
  <p><strong>The Single Most Important Fact About Encodings</strong></p>
  
  <p>If you completely forget everything I just explained, please remember one extremely important fact. It does not make sense to have a string without knowing what encoding it uses. You can no longer stick your head in the sand and pretend that ""plain"" text is ASCII.
  There Ain't No Such Thing As Plain Text.</p>
  
  <p>If you have a string, in memory, in a file, or in an email message, you have to know what encoding it is in or you cannot interpret it or display it to users correctly.</p>
</blockquote>
","90956"
"Understanding events and event handlers in C#","269645","","<p>I understand the purpose of events, especially within the context of creating user interfaces. I think this is the prototype for creating an event:</p>

<pre><code>public void EventName(object sender, EventArgs e);
</code></pre>

<p>What do event handlers do, why are they needed, and how do I to create one?</p>
","<p>To understand event handlers, you need to understand <a href=""https://msdn.microsoft.com/en-us/library/ms173171.aspx"" rel=""noreferrer"">delegates</a>. In <a href=""http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29"" rel=""noreferrer"">C#</a>, you can think of a delegate as a pointer (or a reference) to a method. This is useful because the pointer can be passed around as a value.</p>

<p>The central concept of a delegate is its signature, or shape. That is (1) the return type and (2) the input arguments. For example, if we create a delegate <code>void MyDelegate(object sender, EventArgs e)</code>, it can only point to methods which return <code>void</code>, and take an <code>object</code> and <code>EventArgs</code>. Kind of like a square hole and a square peg. So we say these methods have the same signature, or shape, as the delegate.</p>

<p>So knowing how to create a reference to a method, let's think about the purpose of events: we want to cause some code to be executed when something happens elsewhere in the system - or ""handle the event"". To do this, we create specific methods for the code we want to be executed. The glue between the event and the methods to be executed are the delegates. The event must internally store a ""list"" of pointers to the methods to call when the event is raised.* Of course, to be able to call a method, we need to know what arguments to pass to it! We use the delegate as the ""contract"" between the event and all the specific methods that will be called.</p>

<p>So the default <code>EventHandler</code> (and many like it) represents a <em>specific shape of method</em> (again, void/object-EventArgs). When you declare an event, you are saying <em>which shape of method</em> (EventHandler) that event will invoke, by specifying a delegate:</p>

<pre><code>//This delegate can be used to point to methods
//which return void and take a string.
public delegate void MyEventHandler(string foo);

//This event can cause any method which conforms
//to MyEventHandler to be called.
public event MyEventHandler SomethingHappened;

//Here is some code I want to be executed
//when SomethingHappened fires.
void HandleSomethingHappened(string foo)
{
    //Do some stuff
}

//I am creating a delegate (pointer) to HandleSomethingHappened
//and adding it to SomethingHappened's list of ""Event Handlers"".
myObj.SomethingHappened += new MyEventHandler(HandleSomethingHappened);
</code></pre>

<p>(*This is the key to events in .NET and peels away the ""magic"" - an event is really, under the covers, just a list of methods of the same ""shape"". The list is stored where the event lives. When the event is ""raised"", it's really just ""go through this list of methods and call each one, using these values as the parameters"". Assigning an event handler is just a prettier, easier way of adding your method to this list of methods to be called).</p>
","803320"
"ArrayList vs List<> in C#","267976","","<p>What is the difference between <code>ArrayList</code> and <code>List&lt;&gt;</code> in C#? </p>

<p>Is it only that <code>List&lt;&gt;</code> has a type while <code>ArrayList</code> doesn't?</p>
","<p>Yes, pretty much. <code>List&lt;T&gt;</code> is a generic class. It supports storing values of a specific type without casting to or from <code>object</code> (which would have incurred boxing/unboxing overhead when <code>T</code> is a value type in the <code>ArrayList</code> case). <code>ArrayList</code> simply stores <code>object</code> references. As a generic collection, <code>List&lt;T&gt;</code> implements the generic <code>IEnumerable&lt;T&gt;</code> interface and can be used easily in LINQ (without requiring any <code>Cast</code> or <code>OfType</code> call). </p>

<p><code>ArrayList</code> belongs to the days that C# didn't have generics. It's deprecated in favor of <code>List&lt;T&gt;</code>. You shouldn't use <code>ArrayList</code> in new code that targets .NET >= 2.0 unless you have to interface with an old API that uses it.</p>
","2309699"
"C# Java HashMap equivalent","267466","","<p>Coming from a Java world into a C# one is there a HashMap equivalent? If not what would you recommend?</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/xfhwa508.aspx"" rel=""noreferrer""><code>Dictionary</code></a> is probably the closest. <code>System.Collections.Generic.Dictionary</code> implements the <a href=""http://msdn.microsoft.com/en-us/library/s4ys34ea.aspx"" rel=""noreferrer""><code>System.Collections.Generic.IDictionary</code></a> interface (which is similar to Java's <code>Map</code> interface).</p>

<p>Some notable differences that you should be aware of:</p>

<ul>
<li>Adding/Getting items

<ul>
<li>Java's HashMap has the <code>put</code> and <code>get</code> methods for setting/getting items

<ul>
<li><code>myMap.put(key, value)</code></li>
<li><code>MyObject value = myMap.get(key)</code></li>
</ul></li>
<li>C#'s Dictionary uses <code>[]</code> indexing for setting/getting items

<ul>
<li><code>myDictionary[key] = value</code></li>
<li><code>MyObject value = myDictionary[key]</code></li>
</ul></li>
</ul></li>
<li><code>null</code> keys

<ul>
<li>Java's <code>HashMap</code> allows null keys</li>
<li>.NET's <code>Dictionary</code> throws an <code>ArgumentNullException</code> if you try to add a null key</li>
</ul></li>
<li>Adding a duplicate key

<ul>
<li>Java's <code>HashMap</code> will replace the existing value with the new one.</li>
<li>.NET's <code>Dictionary</code> will replace the existing value with the new one if you use <code>[]</code> indexing.  If you use the <code>Add</code> method, it will instead throw an <code>ArgumentException</code>.</li>
</ul></li>
<li>Attempting to get a non-existent key

<ul>
<li>Java's <code>HashMap</code> will return null.</li>
<li>.NET's <code>Dictionary</code> will throw a <code>KeyNotFoundException</code>.  You can use the <a href=""https://msdn.microsoft.com/en-us/library/bb347013%28v=vs.110%29.aspx"" rel=""noreferrer""><code>TryGetValue</code></a> method instead of the <code>[]</code> indexing to avoid this:<br>
<code>MyObject value = null;
if (!myDictionary.TryGetValue(key, value)) { /* key doesn't exist */ }</code></li>
</ul></li>
</ul>

<p><code>Dictionary</code>'s has a <a href=""https://msdn.microsoft.com/en-us/library/kw5aaea4%28v=vs.110%29.aspx"" rel=""noreferrer""><code>ContainsKey</code></a> method that can help deal with the previous two problems.</p>
","1273149"
"How do I group Windows Form radio buttons?","266874","","<p>How can I group the radio buttons in Windows Form application (a lot like ASP.NET's radiobuttonlist!)? </p>

<p>So I can switch between each case chosen from the options.</p>
","<p>Put all radio buttons for a group in a container object like a <code>Panel</code> or a <code>GroupBox</code>.  That will automatically group them together in Windows Forms.</p>
","2178262"
"Round double in two decimal places in C#?","266867","","<p>I want to round up double value in two decimal places in c# how can i do that?</p>

<pre><code>double inputValue = 48.485;
</code></pre>

<p>after round up</p>

<pre><code>inputValue = 48.49;
</code></pre>

<h3>Related: <a href=""https://stackoverflow.com/questions/164926/c-sharp-how-do-i-round-a-decimal-value-to-2-decimal-places-for-output-on-a-pa"">c# - How do I round a decimal value to 2 decimal places (for output on a page)</a></h3>
","<p>This works:</p>

<pre><code>inputValue = Math.Round(inputValue, 2);
</code></pre>
","2357866"
"Reflection: How to Invoke Method with parameters","266490","","<p>I am trying to invoke a method via reflection with parameters and I get:</p>

<blockquote>
  <p>object does not match target type</p>
</blockquote>

<p>If I invoke a method without parameters, it works fine. Based on the following code if I call the method <code>Test(""TestNoParameters"")</code>, it works fine. However if I call <code>Test(""Run"")</code>, I get an exception. Is something wrong with my code?</p>

<p>My initial purpose was to pass an array of objects e.g. <code>public void Run(object[] options)</code> but this did not work and I tried something simpler e.g. string without success.</p>

<pre><code>// Assembly1.dll
namespace TestAssembly
{
    public class Main
    {
        public void Run(string parameters)
        { 
            // Do something... 
        }
        public void TestNoParameters()
        {
            // Do something... 
        }
    }
}

// Executing Assembly.exe
public class TestReflection
{
    public void Test(string methodName)
    {
        Assembly assembly = Assembly.LoadFile(""...Assembly1.dll"");
        Type type = assembly.GetType(""TestAssembly.Main"");

        if (type != null)
        {
            MethodInfo methodInfo = type.GetMethod(methodName);

            if (methodInfo != null)
            {
                object result = null;
                ParameterInfo[] parameters = methodInfo.GetParameters();
                object classInstance = Activator.CreateInstance(type, null);

                if (parameters.Length == 0)
                {
                    // This works fine
                    result = methodInfo.Invoke(classInstance, null);
                }
                else
                {
                    object[] parametersArray = new object[] { ""Hello"" };

                    // The invoke does NOT work;
                    // it throws ""Object does not match target type""             
                    result = methodInfo.Invoke(methodInfo, parametersArray);
                }
            }
        }
    }
}
</code></pre>
","<p>Change ""methodInfo"" to ""classInstance"", just like in the call with the null parameter array.</p>

<pre><code>  result = methodInfo.Invoke(classInstance, parametersArray);
</code></pre>
","2202430"
"Getting a sub-array from an existing array","266321","","<p>I have an array X of 10 elements. I would like to create a new array containing all the elements from X that begin at index 3 and ends in index 7. Sure I can easily write a loop that will do it for me but I would like to keep my code as clean as possible. Is there a method in C# that can do it for me?</p>

<p>Something like (pseudo code):</p>

<pre><code>Array NewArray = oldArray.createNewArrayFromRange(int BeginIndex , int EndIndex)
</code></pre>

<p><strong><code>Array.Copy</code> doesn't fit my needs</strong>. I need the items in the new array to be clones. <code>Array.copy</code> is just a C-Style <code>memcpy</code> equivalent, it's not what I'm looking for.</p>
","<p>You could add it as an extension method:</p>

<pre><code>public static T[] SubArray&lt;T&gt;(this T[] data, int index, int length)
{
    T[] result = new T[length];
    Array.Copy(data, index, result, 0, length);
    return result;
}
static void Main()
{
    int[] data = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };
    int[] sub = data.SubArray(3, 4); // contains {3,4,5,6}
}
</code></pre>

<hr>

<p>Update re cloning (which wasn't obvious in the original question). If you <em>really</em> want a deep clone; something like:</p>

<pre><code>public static T[] SubArrayDeepClone&lt;T&gt;(this T[] data, int index, int length)
{
    T[] arrCopy = new T[length];
    Array.Copy(data, index, arrCopy, 0, length);
    using (MemoryStream ms = new MemoryStream())
    {
        var bf = new BinaryFormatter();
        bf.Serialize(ms, arrCopy);
        ms.Position = 0;
        return (T[])bf.Deserialize(ms);
    }
}
</code></pre>

<p>This does require the objects to be serializable (<code>[Serializable]</code> or <code>ISerializable</code>), though. You could easily substitute for any other serializer as appropriate - <code>XmlSerializer</code>, <code>DataContractSerializer</code>, protobuf-net, etc.</p>

<p>Note that deep clone is tricky without serialization; in particular, <code>ICloneable</code> is hard to trust in most cases.</p>
","943650"
"What do two question marks together mean in C#?","266121","","<p>Ran across this line of code:</p>

<pre><code>FormsAuth = formsAuth ?? new FormsAuthenticationWrapper();
</code></pre>

<p>What do the two question marks mean, is it some kind of ternary operator?
It's hard to look up in Google.</p>
","<p>It's the null coalescing operator, and quite like the ternary (immediate-if) operator. See also <a href=""http://msdn.microsoft.com/en-us/library/ms173224.aspx"" rel=""noreferrer"">?? Operator - MSDN</a>.</p>

<pre><code>FormsAuth = formsAuth ?? new FormsAuthenticationWrapper();
</code></pre>

<p>expands to:</p>

<pre><code>FormsAuth = formsAuth != null ? formsAuth : new FormsAuthenticationWrapper();
</code></pre>

<p>which further expands to:</p>

<pre><code>if(formsAuth != null)
    FormsAuth = formsAuth;
else
    FormsAuth = new FormsAuthenticationWrapper();
</code></pre>

<p>In English, it means ""If whatever is to the left is not null, use that, otherwise use what's to the right.""</p>

<p>Note that you can use any number of these in sequence. The following statement will assign the first non-null <code>Answer#</code> to <code>Answer</code> (if all Answers are null then the <code>Answer</code> is null):</p>

<pre><code>string Answer = Answer1 ?? Answer2 ?? Answer3 ?? Answer4;
</code></pre>

<hr>

<p>Also it's worth mentioning while the expansion above is conceptually equivalent, the result of each expression is only evaluated once. This is important if for example an expression is a method call with side effects. (Credit to @Joey for pointing this out.)</p>
","446839"
"C# Set collection?","266026","","<p>Does anyone know if there is a good equivalent to Java's <code>Set</code> collection in C#? I know that you can somewhat mimic a set using a <code>Dictionary</code> or a <code>HashTable</code> by populating but ignoring the values, but that's not a very elegant way. </p>
","<p>Try <a href=""http://msdn.microsoft.com/en-us/library/bb359438.aspx"" rel=""noreferrer"">HashSet</a>:</p>

<blockquote>
  <p>The HashSet(Of T) class provides high-performance set operations. A set is a collection that contains no duplicate elements, and whose elements are in no particular order...</p>
  
  <p>The capacity of a HashSet(Of T) object is the number of elements that the object can hold. A HashSet(Of T) object's capacity automatically increases as elements are added to the object.</p>
  
  <p>The HashSet(Of T) class is based on the model of mathematical sets and provides high-performance set operations similar to accessing the keys of the <a href=""https://msdn.microsoft.com/en-us/library/xfhwa508.aspx"" rel=""noreferrer"">Dictionary(Of TKey, TValue)</a> or <a href=""https://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx"" rel=""noreferrer"">Hashtable</a> collections. In simple terms, the HashSet(Of T) class can be thought of as a <a href=""https://msdn.microsoft.com/en-us/library/xfhwa508.aspx"" rel=""noreferrer"">Dictionary(Of TKey, TValue)</a> collection without values.</p>
  
  <p>A HashSet(Of T) collection is not sorted and cannot contain duplicate elements...</p>
</blockquote>
","183691"
"Convert a bitmap into a byte array","265926","","<p>Using C#, is there a better way to convert a Windows <code>Bitmap</code> to a <code>byte[]</code> than saving to a temporary file and reading the result using a <code>FileStream</code>?</p>
","<p>There are a couple ways.</p>

<p><strong>ImageConverter</strong></p>

<pre><code>public static byte[] ImageToByte(Image img)
{
    ImageConverter converter = new ImageConverter();
    return (byte[])converter.ConvertTo(img, typeof(byte[]));
}
</code></pre>

<p>This one is convenient because it doesn't require a lot of code.</p>

<p><strong>Memory Stream</strong></p>

<pre><code>public static byte[] ImageToByte2(Image img)
{
    using (var stream = new MemoryStream())
    {
        img.Save(stream, System.Drawing.Imaging.ImageFormat.Png);
        return stream.ToArray();
    }
}
</code></pre>

<p>This one is equivalent to what you are doing, except the file is saved to memory instead of to disk. Although more code you have the option of ImageFormat and it can be easily modified between saving to memory or disk.</p>

<p>Source: <a href=""http://www.vcskicks.com/image-to-byte.php"">http://www.vcskicks.com/image-to-byte.php</a></p>
","7350818"
"Serialize an object to string","265535","","<p>I have the following method to save an Object to a file:</p>

<pre><code>// Save an object out to the disk
public static void SerializeObject&lt;T&gt;(this T toSerialize, String filename)
{
    XmlSerializer xmlSerializer = new XmlSerializer(toSerialize.GetType());
    TextWriter textWriter = new StreamWriter(filename);

    xmlSerializer.Serialize(textWriter, toSerialize);
    textWriter.Close();
}
</code></pre>

<p>I confess I did not write it (I only converted it to a extension method that took a type parameter).</p>

<p>Now I need it to give the xml back to me as a string (rather than save it to a file).  I am looking into it, but I have not figured it out yet.</p>

<p>I thought this might be really easy for someone familiar with these objects.  If not I will figure it out eventually.</p>
","<p>Use a <a href=""http://msdn.microsoft.com/en-us/library/system.io.stringwriter.aspx"" rel=""noreferrer""><code>StringWriter</code></a> instead of a <a href=""http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx"" rel=""noreferrer""><code>StreamWriter</code></a>:</p>

<pre><code>public static string SerializeObject&lt;T&gt;(this T toSerialize)
{
    XmlSerializer xmlSerializer = new XmlSerializer(toSerialize.GetType());

    using(StringWriter textWriter = new StringWriter())
    {
        xmlSerializer.Serialize(textWriter, toSerialize);
        return textWriter.ToString();
    }
}
</code></pre>

<p>Note, it is important to use <code>toSerialize.GetType()</code> instead of <code>typeof(T)</code> in XmlSerializer constructor: if you use the first one the code covers all possible subclasses of <code>T</code> (which are valid for the method), while using the latter one will fail when passing a type derived from <code>T</code>. 
 
Here is a link with some example code that motivate this statement, with <code>XmlSerializer</code> throwing an <code>Exception</code> when <code>typeof(T)</code> is used, because you pass an instance of a derived type to a method that calls SerializeObject that is defined in the derived type's base class: <a href=""http://ideone.com/1Z5J1"" rel=""noreferrer"">http://ideone.com/1Z5J1</a>.</p>

<p>Also, Ideone uses Mono to execute code; the actual <code>Exception</code> you would get using the Microsoft .NET runtime has a different <code>Message</code> than the one shown on Ideone, but it fails just the same.</p>
","2434558"
"Remove element of a regular array","265009","","<p>I have an array of Foo objects. How do I remove the second element of the array?</p>

<p>I need something similar to <code>RemoveAt()</code> but for a regular array.</p>
","<p>If you don't want to use List:</p>

<pre><code>var foos = new List&lt;Foo&gt;(array);
foos.RemoveAt(index);
return foos.ToArray();
</code></pre>

<p>You could try this extension method that I haven't actually tested:</p>

<pre><code>public static T[] RemoveAt&lt;T&gt;(this T[] source, int index)
{
    T[] dest = new T[source.Length - 1];
    if( index &gt; 0 )
        Array.Copy(source, 0, dest, 0, index);

    if( index &lt; source.Length - 1 )
        Array.Copy(source, index + 1, dest, index, source.Length - index - 1);

    return dest;
}
</code></pre>

<p>And use it like:</p>

<pre><code>Foo[] bar = GetFoos();
bar = bar.RemoveAt(2);
</code></pre>
","457501"
"How can I loop through a List<T> and grab each item?","264932","","<p>How can I loop through a List and grab each item? </p>

<p>I want the output to look like this:</p>

<pre><code>Console.WriteLine(""amount is {0}, and type is {1}"", myMoney.amount, myMoney.type);
</code></pre>

<p>Here is my code:</p>

<pre><code>static void Main(string[] args)
{
    List&lt;Money&gt; myMoney = new List&lt;Money&gt; 
    {
        new Money{amount = 10, type = ""US""},
        new Money{amount = 20, type = ""US""}
    };
}

class Money
{
    public int amount { get; set; }
    public string type { get; set; }
}
</code></pre>
","<p><code>foreach</code>:</p>

<pre><code>foreach (var money in myMoney) {
    Console.WriteLine(""Amount is {0} and type is {1}"", money.amount, money.type);
}
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/vstudio/ttw7t8t6.aspx"">MSDN Link</a></p>

<p>Alternatively, because it is a <code>List&lt;T&gt;</code>.. which implements an indexer method <code>[]</code>, you can use a normal <code>for</code> loop as well.. although its less readble (IMO):</p>

<pre><code>for (var i = 0; i &lt; myMoney.Count; i++) {
    Console.WriteLine(""Amount is {0} and type is {1}"", myMoney[i].amount, myMoney[i].type);
}
</code></pre>
","18863216"
"C# List<string> to string with delimiter","263753","","<p>Is there a function in C# to quickly convert some collection to string and separate values with delimiter?</p>

<p>For example:</p>

<p><code>List&lt;string&gt; names</code> --> <code>string names_together = ""John, Anna, Monica""</code></p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/57a79xd0.aspx"" rel=""noreferrer""><code>String.Join</code></a>.  If you have a <code>List&lt;string&gt;</code> then you can call <a href=""http://msdn.microsoft.com/en-us/library/x303t819.aspx"" rel=""noreferrer""><code>ToArray</code></a> first: </p>

<pre><code>List&lt;string&gt; names = new List&lt;string&gt;() { ""John"", ""Anna"", ""Monica"" };
var result = String.Join("", "", names.ToArray());
</code></pre>

<p>In .NET 4 you don't need the <code>ToArray</code> anymore, since there is an overload of <code>String.Join</code> that takes an <code>IEnumerable&lt;string&gt;</code>.  </p>
","3575036"
"Error message 'Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.'","263642","","<p>I have developed an application using <a href=""http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework"" rel=""noreferrer"">Entity Framework</a>, SQL Server 2000, Visual&nbsp;Studio&nbsp;2008 and Enterprise Library.</p>

<p>It works absolutely fine locally, but when I deploy the project to our test environment, I am getting the following error:</p>

<blockquote>
  <p>Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information</p>
  
  <p>Stack trace: at System.Reflection.Module._GetTypesInternal(StackCrawlMark&amp; stackMark)</p>
  
  <p>at System.Reflection.Assembly.GetTypes()</p>
  
  <p>at System.Data.Metadata.Edm.ObjectItemCollection.AssemblyCacheEntry.LoadTypesFromAssembly(LoadingContext context)</p>
  
  <p>at System.Data.Metadata.Edm.ObjectItemCollection.AssemblyCacheEntry.InternalLoadAssemblyFromCache(LoadingContext context)</p>
  
  <p>at System.Data.Metadata.Edm.ObjectItemCollection.AssemblyCacheEntry.LoadAssemblyFromCache(Assembly assembly, Boolean loadReferencedAssemblies, Dictionary<code>2 knownAssemblies, Dictionary</code>2&amp; typesInLoading, List`1&amp; errors)</p>
  
  <p>at System.Data.Metadata.Edm.ObjectItemCollection.LoadAssemblyFromCache(ObjectItemCollection objectItemCollection, Assembly assembly, Boolean loadReferencedAssemblies)</p>
  
  <p>at System.Data.Metadata.Edm.ObjectItemCollection.LoadAssemblyForType(Type type)</p>
  
  <p>at System.Data.Metadata.Edm.MetadataWorkspace.LoadAssemblyForType(Type type, Assembly callingAssembly)</p>
  
  <p>at System.Data.Objects.ObjectContext.CreateQuery[T](String queryString, ObjectParameter[] parameters)</p>
</blockquote>

<p>Entity Framework seems to have issue, any clue how to fix it?</p>
","<p>I solved this issue by setting the Copy Local attribute of my project's references to true.</p>
","6200173"
"JSON serialization of enum as string","263500","","<p>I have a class that contains an <code>enum</code> property, and upon serializing the object using <code>JavaScriptSerializer</code>, my json result contains the integer value of the enumeration rather than its <code>string</code> ""name"".  Is there a way to get the enum as a <code>string</code> in my json without having to create a custom <code>JavaScriptConverter</code>?  Perhaps there's an attribute that I could decorate the <code>enum</code> definition, or object property, with?</p>

<p>As an example:</p>

<pre><code>enum Gender { Male, Female }

class Person
{
    int Age { get; set; }
    Gender Gender { get; set; }
}
</code></pre>

<p>Desired json result:</p>

<pre><code>{ ""Age"": 35, ""Gender"": ""Male"" }
</code></pre>
","<p>No there is no special attribute you can use. <code>JavaScriptSerializer</code> serializes <code>enums</code> to their numeric values and not their string representation. You would need to use custom serialization to serialize the <code>enum</code> as its name instead of numeric value.</p>

<p><strong>Edit:</strong>
As pointed out by @OmerBakhari JSON.net covers this use case (via the attribute <code>[JsonConverter(typeof(StringEnumConverter))]</code>) and many others not handled by the built in .net serializers. <a href=""https://www.newtonsoft.com/json/help/html/JsonNetVsDotNetSerializers.htm"" rel=""noreferrer"">Here is a link comparing features and functionalities of the serializers</a>.</p>
","2441379"
"Check if list contains element that contains a string and get that element","263211","","<p>While searching for an answer to this question, I've run into similar ones utilizing LINQ but I haven't been able to fully understand them (and thus, implement them), as I'm not familiarized with it. What I would like to, basically, is this:</p>

<ol>
<li>Check if any element of a list contains a specific string.</li>
<li>If it does, get that element.</li>
</ol>

<p>I honestly don't know how I would go about doing that. What I can come up with is this (not working, of course):</p>

<pre><code>if (myList.Contains(myString))
    string element = myList.ElementAt(myList.IndexOf(myString));
</code></pre>

<p>I know WHY it does not work:</p>

<ul>
<li><code>myList.Contains()</code> does not return <code>true</code>, since it will check for if a whole element of the list matches the string I specified.</li>
<li><code>myList.IndexOf()</code> will not find an occurrence, since, as it is the case again, it will check for an element matching the string.</li>
</ul>

<p>Still, I have no clue how to solve this problem, but I figure I'll have to use LINQ as suggested in similar questions to mine. That being said, if that's the case here, I'd like for the answerer to explain to me the use of LINQ in their example (as I said, I haven't bothered with it in my time with C#). Thank you in advance guys (and gals?).</p>

<p>EDIT: I have come up with a solution; just loop through the list, check if current element contains the string and then set a string equal to the current element. I'm wondering, though, is there a more efficient way than this?</p>

<pre><code>string myString = ""bla"";
string element = """";

for (int i = 0; i &lt; myList.Count; i++)
{
    if (myList[i].Contains(myString))
        element = myList[i];
}
</code></pre>
","<p>You should be able to use Linq here:</p>

<pre><code>var matchingvalues = myList
    .Where(stringToCheck =&gt; stringToCheck.Contains(myString));
</code></pre>

<p>If you simply wish to return the first matching item:</p>

<pre><code>var match = myList
    .FirstOrDefault(stringToCheck =&gt; stringToCheck.Contains(myString));

if(match != null)
    //Do stuff
</code></pre>
","18767402"
"What are the correct version numbers for C#?","262700","","<p>What are the correct version numbers for C#? What came out when? Why can't I find any answers about <strong><em>C# 3.5</em></strong>?</p>

<p>This question is primarily to aid those who are searching for an answer using an incorrect version number, e.g. <strong><em>C# 3.5</em></strong>. The hope is that anyone failing to find an answer with the wrong version number will find <em>this</em> question and then search again with the right version number.</p>
","<p>These are the versions of C# known about at the time of this writing:</p>

<ul>
<li><strong>C# 1.0</strong> released with .NET 1.0 and VS2002 (January 2002)</li>
<li><strong>C# 1.2</strong> (bizarrely enough); released with .NET 1.1 and VS2003 (April 2003). First version to call <code>Dispose</code> on <code>IEnumerator</code>s which implemented <code>IDisposable</code>. A few other small features.</li>
<li><strong>C# 2.0</strong> released with .NET 2.0 and VS2005 (November 2005). Major new features: generics, anonymous methods, nullable types, iterator blocks</li>
<li><strong>C# 3.0</strong> released with .NET 3.5 and VS2008 (November 2007). Major new features: lambda expressions, extension methods, expression trees, anonymous types, implicit typing (<code>var</code>), query expressions</li>
<li><strong>C# 4.0</strong> released with .NET 4 and VS2010 (April 2010). Major new features: late binding (<code>dynamic</code>), delegate and interface generic variance, more COM support, named arguments, tuple data type and optional parameters</li>
<li><strong>C# 5.0</strong> released with .NET 4.5 and VS2012 (August 2012). <a href=""http://blogs.msdn.com/b/csharpfaq/archive/2012/02/29/visual-studio-11-beta-is-here.aspx"" rel=""noreferrer"">Major features</a>: async programming, caller info attributes. Breaking change: <a href=""http://blogs.msdn.com/b/ericlippert/archive/2009/11/16/closing-over-the-loop-variable-part-two.aspx"" rel=""noreferrer"">loop variable closure</a>.</li>
<li><strong>C# 6.0</strong> released with .NET 4.6 and VS2015 (July 2015). Implemented by <a href=""https://github.com/dotnet/roslyn"" rel=""noreferrer"">Roslyn</a>. Features: initializers for automatically implemented properties, using directives to import static members, exception filters, element initializers, <code>await</code> in <code>catch</code> and <code>finally</code>, extension <code>Add</code> methods in collection initializers.</li>
<li><strong>C# 7.0</strong> released with .NET 4.7 and VS2017 (March 2017) Major new features: tuples, ref locals and ref return, pattern matching (including pattern-based switch statements), inline <code>out</code> parameter declarations, local functions, binary literals, digit separators, and arbitrary async returns.</li>
<li><strong>C# 7.1</strong> released with VS2017 v15.3 (August 2017) Minor new features: <a href=""https://github.com/dotnet/csharplang/issues/97"" rel=""noreferrer"">async main</a>, <a href=""https://github.com/dotnet/csharplang/issues/415"" rel=""noreferrer"">tuple member name inference</a>, <a href=""https://github.com/dotnet/csharplang/issues/102"" rel=""noreferrer"">default expression</a>, <a href=""https://github.com/dotnet/csharplang/issues/154"" rel=""noreferrer"">pattern matching with generics</a>.</li>
<li><strong>C# 7.2</strong> released with VS2017 v15.5 (November 2017) Minor new features: <a href=""https://github.com/dotnet/csharplang/issues/37"" rel=""noreferrer"">private protected access modifier</a>, <a href=""https://github.com/dotnet/csharplang/issues/666"" rel=""noreferrer"">Span&lt;T&gt;, aka interior pointer, aka stackonly struct</a>, <a href=""https://github.com/dotnet/csharplang/milestone/6"" rel=""noreferrer"">everything else</a>.</li>
</ul>

<p>There is no such thing as C# 3.5 - the cause of confusion here is that the C# 3.0 is present in .NET 3.5. The language and framework are versioned independently, however - as is the CLR, which is at version 2.0 for .NET 2.0 through 3.5, .NET 4 introducing CLR 4.0, service packs notwithstanding. The CLR in .NET 4.5 has various improvements, but the versioning is unclear: in some places it may be referred to as CLR 4.5 (<a href=""http://msdn.microsoft.com/en-us/library/bb822049.aspx"" rel=""noreferrer"">this MSDN page</a> used to refer to it that way, for example), but the <a href=""http://msdn.microsoft.com/en-us/library/system.environment.version.aspx"" rel=""noreferrer""><code>Environment.Version</code></a> property still reports 4.0.xxx.</p>

<p>More detailed information about the relationship between the language, runtime and framework versions is available on the <a href=""http://csharpindepth.com/Articles/Chapter1/Versions.aspx"" rel=""noreferrer"">C# in Depth</a> site. This includes information about which features of C# 3.0 you can use when targeting .NET 2.0. (If anyone wants to bring all of the content into this wiki answer, they're welcome to.)</p>

<p>As of May 3, 2017, the C# Language Team created a history of C# versions and features on their github repo: <a href=""https://github.com/dotnet/csharplang/blob/master/Language-Version-History.md"" rel=""noreferrer"">Features Added in C# Language Versions</a></p>
","247623"
"How to increase the max upload file size in ASP.NET?","261750","","<p>I have a form that excepts a file upload in ASP.NET. I need to increase the max upload size to above the 4 MB default.</p>

<p>I have found in certain places referencing the below code at <a href=""http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.maxrequestlength.aspx"" rel=""noreferrer"">msdn</a>. </p>

<pre><code>[ConfigurationPropertyAttribute(""maxRequestLength"", DefaultValue = )]
</code></pre>

<p>None of the references actually describe how to use it, and I have tried several things with no success. I only want to modify this attribute for certain pages that are asking for file upload.</p>

<p>Is this the correct route to take? And how do I use this?</p>
","<p>This setting goes in your web.config file. It affects the entire application, though... I don't think you can set it per page.</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;configuration&gt;
  &lt;system.web&gt;
    &lt;httpRuntime maxRequestLength=""xxx"" /&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;
</code></pre>

<p>""xxx"" is in KB. The default is 4096 (= 4 MB).</p>
","288675"
"Select method in List<t> Collection","261604","","<p>I have an asp.net application, and now I am using datasets for data manipulation. I recently started to convert this dataset to a List collection. But, in some places it doesn't work. One is that in my old version I am using <code>datarow[] drow =  dataset.datatable.select(searchcriteria)</code>. But in the List collection there is no method available for finding particular values. Is there any way for me to select some values according with my search criteria? I want to know if this is possible. Please help me.</p>
","<p>Well, to start with <code>List&lt;T&gt;</code> <em>does</em> have the <a href=""http://msdn.microsoft.com/en-us/library/fh1w7y8z.aspx"" rel=""noreferrer""><code>FindAll</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx"" rel=""noreferrer""><code>ConvertAll</code></a> methods - but the more idiomatic, modern approach is to use LINQ:</p>

<pre><code>// Find all the people older than 30
var query1 = list.Where(person =&gt; person.Age &gt; 30);

// Find each person's name
var query2 = list.Select(person =&gt; person.Name);
</code></pre>

<p>You'll need a using directive in your file to make this work:</p>

<pre><code>using System.Linq;
</code></pre>

<p>Note that these don't use strings to express predicates and projects - they use delegates, usually created from lambda expressions as above.</p>

<p>If lambda expressions and LINQ are new to you, I would suggest you get a book covering LINQ first, such as <a href=""http://rads.stackoverflow.com/amzn/click/1933988169"" rel=""noreferrer"">LINQ in Action</a>, <a href=""http://rads.stackoverflow.com/amzn/click/1590597893"" rel=""noreferrer"">Pro LINQ</a>, <a href=""http://rads.stackoverflow.com/amzn/click/0596800959"" rel=""noreferrer"">C# 4 in a Nutshell</a> or my own <a href=""http://www.manning.com/affiliate/idevaffiliate.php?id=876_230"" rel=""noreferrer"">C# in Depth</a>. You certainly <em>can</em> learn LINQ just from web tutorials, but I think it's such an important technology, it's worth taking the time to learn it thoroughly.</p>
","3801762"
"How to have an auto incrementing version number (Visual Studio)?","261588","","<p>I want to store a set of integers that get auto incremented at build time:</p>

<pre><code>int MajorVersion = 0;
int MinorVersion = 1;
int Revision = 92;
</code></pre>

<p>When I compile, it would auto-increment <code>Revision</code>. When I build the setup project, it would increment <code>MinorVersion</code> (I'm OK with doing this manually). <code>MajorVersion</code> would only be incremented manually.</p>

<p>Then I could display a version number in menu Help/About to the user as:</p>

<pre>
  Version: 0.1.92
</pre>

<p>How can this be achieved?</p>

<p>This question asks not only how to have an auto-incrementing version number, but also how to use that in code which is a more complete answer than others.</p>
","<p>If you add an <a href=""http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.assemblyversionattribute.aspx"" rel=""noreferrer"">AssemblyInfo</a> class to your project and amend the AssemblyVersion attribute to end with an asterisk, for example:</p>

<pre><code>[assembly: AssemblyVersion(""2.10.*"")]
</code></pre>

<p>Visual studio will increment the final number for you according to <a href=""http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.aspx"" rel=""noreferrer"">these rules</a> (thanks galets, I had that completely wrong!)</p>

<p>To reference this version in code, so you can display it to the user, you use reflection.  For example,</p>

<pre><code>Version version = System.Reflection.Assembly.GetExecutingAssembly().GetName().Version;
DateTime buildDate = new DateTime(2000, 1, 1)
                        .AddDays(version.Build).AddSeconds(version.Revision * 2);
string displayableVersion = $""{version} ({buildDate})"";
</code></pre>

<h2>Two important gotchas that you should know</h2>

<h3>From @ashes999:</h3>

<p>It's also worth noting that if both <code>AssemblyVersion</code> and <code>AssemblyFileVersion</code> are specified, you won't see this on your .exe.</p>

<h3>From @BrainSlugs83:</h3>

<p>Setting only the 4th number to be <code>*</code> can be bad, as the version won't always increment.
The 3rd number is the number of days since the year 2000, and the 4th number is the number of seconds since midnight (divided by 2) [IT IS NOT RANDOM]. So if you built the solution late in a day one day, and early in a day the next day, the later build would have an earlier version number. I recommend always using <code>X.Y.*</code> instead of <code>X.Y.Z.*</code> because your version number will ALWAYS increase this way.</p>
","826850"
"How would I run an async Task<T> method synchronously?","260959","","<p>I'm learning about async/await, and ran into a situation where I need to call an async method synchronously. How can I do that?</p>

<p>Async method:</p>

<pre><code>public async Task&lt;Customers&gt; GetCustomers()
{
    return await Service.GetCustomersAsync();
}
</code></pre>

<p>Normal usage:</p>

<pre><code>public async void GetCustomers()
{
    customerList = await GetCustomers();
}
</code></pre>

<p>I've tried using the following: </p>

<pre><code>Task&lt;Customer&gt; task = GetCustomers();
task.Wait()

Task&lt;Customer&gt; task = GetCustomers();
task.RunSynchronously();

Task&lt;Customer&gt; task = GetCustomers();
while(task.Status != TaskStatus.RanToCompletion)
</code></pre>

<p>I also tried a suggestion from <a href=""http://social.msdn.microsoft.com/Forums/en/async/thread/163ef755-ff7b-4ea5-b226-bbe8ef5f4796"" rel=""noreferrer"">here</a>, however it doesn't work when the dispatcher is in a suspended state.</p>

<pre><code>public static void WaitWithPumping(this Task task) 
{
        if (task == null) throw new ArgumentNullException(“task”);
        var nestedFrame = new DispatcherFrame();
        task.ContinueWith(_ =&gt; nestedFrame.Continue = false);
        Dispatcher.PushFrame(nestedFrame);
        task.Wait();
}
</code></pre>

<p>Here is the exception and stack trace from calling <code>RunSynchronously</code>:</p>

<blockquote>
  <p>System.InvalidOperationException</p>
  
  <p><strong>Message</strong>: RunSynchronously may not be called on a task unbound to a delegate.</p>
  
  <p><strong>InnerException</strong>: null</p>
  
  <p><strong>Source</strong>: mscorlib</p>
  
  <p><strong>StackTrace</strong>:</p>
</blockquote>

<pre><code>          at System.Threading.Tasks.Task.InternalRunSynchronously(TaskScheduler scheduler)
   at System.Threading.Tasks.Task.RunSynchronously()
   at MyApplication.CustomControls.Controls.MyCustomControl.CreateAvailablePanelList() in C:\Documents and Settings\...\MyApplication.CustomControls\Controls\MyCustomControl.xaml.cs:line 638
   at MyApplication.CustomControls.Controls.MyCustomControl.get_AvailablePanels() in C:\Documents and Settings\...\MyApplication.CustomControls\Controls\MyCustomControl.xaml.cs:line 233
   at MyApplication.CustomControls.Controls.MyCustomControl.&lt;CreateOpenPanelList&gt;b__36(DesktopPanel panel) in C:\Documents and Settings\...\MyApplication.CustomControls\Controls\MyCustomControl.xaml.cs:line 597
   at System.Collections.Generic.List`1.ForEach(Action`1 action)
   at MyApplication.CustomControls.Controls.MyCustomControl.&lt;CreateOpenPanelList&gt;d__3b.MoveNext() in C:\Documents and Settings\...\MyApplication.CustomControls\Controls\MyCustomControl.xaml.cs:line 625
   at System.Runtime.CompilerServices.TaskAwaiter.&lt;&gt;c__DisplayClass7.&lt;TrySetContinuationForAwait&gt;b__1(Object state)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   at System.Windows.Threading.DispatcherOperation.InvokeImpl()
   at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)
   at System.Threading.ExecutionContext.runTryCode(Object userData)
   at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.ProcessQueue()
   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)
   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)
   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.Run()
   at System.Windows.Application.RunDispatcher(Object ignore)
   at System.Windows.Application.RunInternal(Window window)
   at System.Windows.Application.Run(Window window)
   at System.Windows.Application.Run()
   at MyApplication.App.Main() in C:\Documents and Settings\...\MyApplication\obj\Debug\App.g.cs:line 50
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart()
</code></pre>
","<p>Here's a workaround I found that works for all cases (including suspended dispatchers). It's not my code and I'm still working to fully understand it, but it does work.</p>

<p>It can be called using:</p>

<p><code>customerList = AsyncHelpers.RunSync&lt;List&lt;Customer&gt;&gt;(() =&gt; GetCustomers());</code></p>

<p>Code is from <a href=""http://social.msdn.microsoft.com/Forums/en/async/thread/163ef755-ff7b-4ea5-b226-bbe8ef5f4796"" rel=""noreferrer"">here</a></p>

<pre><code>public static class AsyncHelpers
{
    /// &lt;summary&gt;
    /// Execute's an async Task&lt;T&gt; method which has a void return value synchronously
    /// &lt;/summary&gt;
    /// &lt;param name=""task""&gt;Task&lt;T&gt; method to execute&lt;/param&gt;
    public static void RunSync(Func&lt;Task&gt; task)
    {
        var oldContext = SynchronizationContext.Current;
        var synch = new ExclusiveSynchronizationContext();
        SynchronizationContext.SetSynchronizationContext(synch);
        synch.Post(async _ =&gt;
        {
            try
            {
                await task();
            }
            catch (Exception e)
            {
                synch.InnerException = e;
                throw;
            }
            finally
            {
                synch.EndMessageLoop();
            }
        }, null);
        synch.BeginMessageLoop();

        SynchronizationContext.SetSynchronizationContext(oldContext);
    }

    /// &lt;summary&gt;
    /// Execute's an async Task&lt;T&gt; method which has a T return type synchronously
    /// &lt;/summary&gt;
    /// &lt;typeparam name=""T""&gt;Return Type&lt;/typeparam&gt;
    /// &lt;param name=""task""&gt;Task&lt;T&gt; method to execute&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public static T RunSync&lt;T&gt;(Func&lt;Task&lt;T&gt;&gt; task)
    {
        var oldContext = SynchronizationContext.Current;
        var synch = new ExclusiveSynchronizationContext();
        SynchronizationContext.SetSynchronizationContext(synch);
        T ret = default(T);
        synch.Post(async _ =&gt;
        {
            try
            {
                ret = await task();
            }
            catch (Exception e)
            {
                synch.InnerException = e;
                throw;
            }
            finally
            {
                synch.EndMessageLoop();
            }
        }, null);
        synch.BeginMessageLoop();
        SynchronizationContext.SetSynchronizationContext(oldContext);
        return ret;
    }

    private class ExclusiveSynchronizationContext : SynchronizationContext
    {
        private bool done;
        public Exception InnerException { get; set; }
        readonly AutoResetEvent workItemsWaiting = new AutoResetEvent(false);
        readonly Queue&lt;Tuple&lt;SendOrPostCallback, object&gt;&gt; items =
            new Queue&lt;Tuple&lt;SendOrPostCallback, object&gt;&gt;();

        public override void Send(SendOrPostCallback d, object state)
        {
            throw new NotSupportedException(""We cannot send to our same thread"");
        }

        public override void Post(SendOrPostCallback d, object state)
        {
            lock (items)
            {
                items.Enqueue(Tuple.Create(d, state));
            }
            workItemsWaiting.Set();
        }

        public void EndMessageLoop()
        {
            Post(_ =&gt; done = true, null);
        }

        public void BeginMessageLoop()
        {
            while (!done)
            {
                Tuple&lt;SendOrPostCallback, object&gt; task = null;
                lock (items)
                {
                    if (items.Count &gt; 0)
                    {
                        task = items.Dequeue();
                    }
                }
                if (task != null)
                {
                    task.Item1(task.Item2);
                    if (InnerException != null) // the method threw an exeption
                    {
                        throw new AggregateException(""AsyncHelpers.Run method threw an exception."", InnerException);
                    }
                }
                else
                {
                    workItemsWaiting.WaitOne();
                }
            }
        }

        public override SynchronizationContext CreateCopy()
        {
            return this;
        }
    }
}
</code></pre>
","5097066"
"Excel ""External table is not in the expected format.""","260762","","<p>I'm trying to read an Excel (xlsx) file using the code shown below. I get an ""External table is not in the expected format."" error unless I have the file already open in Excel. In other words, I have to open the file in Excel first before I can read if from my C# program. The xlsx file is on a share on our network. How can I read the file without having to open it first?
Thanks</p>

<pre><code>string sql = ""SELECT * FROM [Sheet1$]"";
string excelConnection = ""Provider=Microsoft.Jet.OLEDB.4.0;Data Source="" + pathname + "";Extended Properties=\""Excel 8.0;HDR=YES;IMEX=1;\"""";

using (OleDbDataAdapter adaptor = new OleDbDataAdapter(sql, excelConnection)) {
    DataSet ds = new DataSet();
    adaptor.Fill(ds);
}
</code></pre>
","<p>""External table is not in the expected format."" typically occurs when trying to use an Excel 2007 file with a connection string that uses: Microsoft.Jet.OLEDB.4.0 and Extended Properties=Excel 8.0</p>

<p>Using the following connection string seems to fix most problems.</p>

<pre><code>public static string path = @""C:\src\RedirectApplication\RedirectApplication\301s.xlsx"";
public static string connStr = ""Provider=Microsoft.ACE.OLEDB.12.0;Data Source="" + path + "";Extended Properties=Excel 12.0;"";
</code></pre>
","1363480"
"Datatable select with multiple conditions","260264","","<p>I have a datatable with 4 columns A, B, C and D such that a particular combination of values for column A, B and C is unique in the datatable.</p>

<p><strong>Objective:</strong> To find the value of column D, for a given combination of values for column A, B and C.</p>

<p>I guess looping over the set of data rows should do it. Is there a way to use Datatable.Select() to accomplish this? To be more specific - can I have multiple conditions in the select filter i.e. a logical AND operator connecting conditions for each of the columns A, B and C.</p>
","<p>Yes, the <code>DataTable.Select</code> method supports boolean operators in the same way that you would use them in a ""real"" SQL statement:</p>

<pre><code>DataRow[] results = table.Select(""A = 'foo' AND B = 'bar' AND C = 'baz'"");
</code></pre>

<p>See <a href=""http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx"" rel=""noreferrer"">DataColumn.Expression in MSDN</a> for the syntax supported by DataTable's <code>Select</code> method.</p>
","1990958"
"SQL Data Reader - handling Null column values","260003","","<p>I'm using a SQLdatareader to build POCOs from a database. The code works except when it encounters a null value in the database. For example, if the FirstName column in the database contains a null value, an exception is thrown. </p>

<pre><code>employee.FirstName = sqlreader.GetString(indexFirstName);
</code></pre>

<p>What is the best way to handle null values in this situation?</p>
","<p>You need to check for <code>IsDBNull</code>:</p>

<pre><code>if(!SqlReader.IsDBNull(indexFirstName))
{
  employee.FirstName = sqlreader.GetString(indexFirstName);
}
</code></pre>

<p>That's your only reliable way to detect and handle this situation.</p>

<p>I wrapped those things into extension methods and tend to return a default value if the column is indeed <code>null</code>:</p>

<pre><code>public static string SafeGetString(this SqlDataReader reader, int colIndex)
{
   if(!reader.IsDBNull(colIndex))
       return reader.GetString(colIndex);
   return string.Empty;
}
</code></pre>

<p>Now you can call it like this:</p>

<pre><code>employee.FirstName = SqlReader.SafeGetString(indexFirstName);
</code></pre>

<p>and you'll never have to worry about an exception or a <code>null</code> value again.</p>
","1772037"
"C#: how to get first char of a string?","259944","","<p>Can the first <code>char</code> of a string be retrieved by doing the following?</p>

<pre><code>MyString.ToCharArray[0]
</code></pre>
","<p>Just <code>MyString[0]</code>.  This uses the <a href=""http://msdn.microsoft.com/en-us/library/system.string.chars.aspx"" rel=""noreferrer"">String.Chars</a> indexer.</p>
","3878828"
"How do I properly clean up Excel interop objects?","259649","","<p>I'm using the Excel interop in C# (<code>ApplicationClass</code>) and have placed the following code in my finally clause:</p>

<pre><code>while (System.Runtime.InteropServices.Marshal.ReleaseComObject(excelSheet) != 0) { }
excelSheet = null;
GC.Collect();
GC.WaitForPendingFinalizers();
</code></pre>

<p>Although this kind of works, the <code>Excel.exe</code> process is still in the background even after I close Excel. It is only released once my application is manually closed.</p>

<p>What am I doing wrong, or is there an alternative to ensure interop objects are properly disposed of?</p>
","<p>Excel does not quit because your application is still holding references to COM objects.</p>

<p><strong>I guess you're invoking at least one member of a COM object without assigning it to a variable.</strong></p>

<p>For me it was the <em>excelApp.Worksheets</em> object which I directly used without assigning it to a variable:</p>

<pre><code>Worksheet sheet = excelApp.Worksheets.Open(...);
...
Marshal.ReleaseComObject(sheet);
</code></pre>

<p>I didn't know that internally C# created a wrapper for the <strong>Worksheets</strong> COM object which didn't get released by my code (because I wasn't aware of it) and was the cause why Excel was not unloaded.</p>

<p>I found the solution to my problem on <a href=""http://www.velocityreviews.com/forums/showpost.php?s=f87f0674feda4442dcbd40019cbca65b&amp;p=528575&amp;postcount=2"" rel=""noreferrer"">this page</a>, which also has a nice rule for the usage of COM objects in C#:</p>

<blockquote>
  <p>Never use two dots with COM objects.</p>
</blockquote>

<hr>

<p>So with this knowledge the right way of doing the above is:</p>

<pre><code>Worksheets sheets = excelApp.Worksheets; // &lt;-- The important part
Worksheet sheet = sheets.Open(...);
...
Marshal.ReleaseComObject(sheets);
Marshal.ReleaseComObject(sheet);
</code></pre>
","158752"
"How to convert numbers between hexadecimal and decimal in C#?","259270","","<p>How do you convert between hexadecimal numbers and decimal numbers in C#?</p>
","<p>To convert from decimal to hex do...</p>

<pre><code>string hexValue = decValue.ToString(""X"");
</code></pre>

<p>To convert from hex to decimal do either...</p>

<pre><code>int decValue = int.Parse(hexValue, System.Globalization.NumberStyles.HexNumber);
</code></pre>

<p>or </p>

<pre><code>int decValue = Convert.ToInt32(hexValue, 16);
</code></pre>
","74223"
"How to check if a file exists in a folder?","258870","","<p>I need to check if an xml file exists in the folder.</p>

<pre><code>DirectoryInfo di = new DirectoryInfo(ProcessingDirectory);
FileInfo[] TXTFiles = di.GetFiles(""*.xml"");
if (TXTFiles.Length == 0)
{
    log.Info(""no files present"")
}
</code></pre>

<p>Is this the best way to check a file exists in the folder.</p>

<p>I need to check just an xml file is present</p>
","<p>This is a way to see if any XML-files exists in that folder, yes.</p>

<p>To check for specific files use <a href=""http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx""><code>File.Exists(path)</code></a>, which will return a boolean indicating wheter the file at <code>path</code> exists.</p>
","7385282"
"How to change time in DateTime?","258721","","<p>How can I change the time alone in <code>DateTime</code> variable?</p>

<pre><code>DateTime s = some datetime;
</code></pre>

<p>I need to the change only the time part in <code>s</code>.</p>
","<p>You can't change a DateTime value - it's immutable. However, you can change the variable to have a new value. The easiest way of doing that to change just the time is to create a TimeSpan with the relevant time, and use the DateTime.Date property:</p>

<pre><code>DateTime s = ...;
TimeSpan ts = new TimeSpan(10, 30, 0);
s = s.Date + ts;
</code></pre>

<p><code>s</code> will now be the same date, but at 10.30am.</p>

<p>Note that <code>DateTime</code> disregards daylight saving time transitions, representing ""naive"" Gregorian time in both directions (see Remarks section in the <a href=""http://msdn.microsoft.com/en-us/library/System.DateTime%28v=vs.110%29.aspx"" rel=""noreferrer""><code>DateTime</code> docs</a>). The only exceptions are <code>.Now</code> and <code>.Today</code>: they retrieve current system time which reflects these events as they occur.</p>

<p>This is the kind of thing which motivated me to start the <a href=""http://nodatime.org"" rel=""noreferrer"">Noda Time</a> project, which is now production-ready. Its <code>ZonedDateTime</code> type is made ""aware"" <a href=""http://nodatime.org/1.2.x/userguide/tzdb.html"" rel=""noreferrer"">by linking it to a <code>tz</code> database entry</a>.</p>
","1859266"
"Populating a razor dropdownlist from a List<object> in MVC","258621","","<p>I have a model:</p>

<pre><code>public class DbUserRole
    {
        public int UserRoleId { get; set; }
        public string UserRole { get; set; }
    }

public class DbUserRoles
    {
        public List&lt;DbUserRole&gt; GetRoles()
        {
            BugnetReports RoleDropDown = new BugnetReports();
            List&lt;DbUserRole&gt; Roles = new List&lt;DbUserRole&gt;();
            DataSet table = RoleDropDown.userRoleDropDown();
            foreach (DataRow item in table.Tables[0].Rows)
            {
                DbUserRole ur = new DbUserRole();
                ur.UserRole = Convert.ToString(item[""UserRoleName""]);
                ur.UserRoleId = Convert.ToInt32(item[""UserRoleID""]);
                Roles.Add(ur);
            }
            return Roles;
        }
    }
</code></pre>

<p>And here is the Controller that loads the view:</p>

<pre><code>        //
        // GET: /Admin/AddNewUser

        public ActionResult AddNewUser()
        {
            DbUserRoles Roles = new DbUserRoles();
            return View(Roles.GetRoles());
        }
</code></pre>

<p>I can get the items in the list to display using a <code>@foreach</code> loop as shown below:</p>

<pre><code>@foreach (var item in Model)
       {
           &lt;tr&gt;
               &lt;td&gt;
                   @item.UserRoleId
               &lt;/td&gt;
               &lt;td&gt;
                   @item.UserRole
               &lt;/td&gt;
           &lt;/tr&gt;
       }
</code></pre>

<p>But how do I populate a dropdownlist with the model that is passed through, I have tried </p>

<p><code>@Html.DropDownListFor(x =&gt; x.UserRole)</code></p>

<p>but I'm having no luck.</p>
","<p>You can separate out your business logic into a viewmodel, so your view has cleaner separation.</p>

<p>First create a viewmodel to store the Id the user will select along with a list of items that will appear in the <code>DropDown</code>.</p>

<p>ViewModel:</p>

<pre><code>public class UserRoleViewModel
{
    // Display Attribute will appear in the Html.LabelFor
    [Display(Name = ""User Role"")]
    public int SelectedUserRoleId { get; set; }
    public IEnumerable&lt;SelectListItem&gt; UserRoles { get; set; }
}
</code></pre>

<p>References:</p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayattribute.aspx"" rel=""noreferrer""><code>DisplayAttribute</code></a></li>
</ul>

<p>Inside the controller create a method to get your <code>UserRole</code> list and transform it into the form that will be presented in the view.</p>

<p>Controller:</p>

<pre><code>private IEnumerable&lt;SelectListItem&gt; GetRoles()
{
    var dbUserRoles = new DbUserRoles();
    var roles = dbUserRoles
                .GetRoles()
                .Select(x =&gt;
                        new SelectListItem
                            {
                                Value = x.UserRoleId.ToString(),
                                Text = x.UserRole
                            });

    return new SelectList(roles, ""Value"", ""Text"");
}

public ActionResult AddNewUser()
{
    var model = new UserRoleViewModel
                    {
                        UserRoles = GetRoles()
                    };
    return View(model);
}
</code></pre>

<p>References:</p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/system.web.mvc.selectlistitem.aspx"" rel=""noreferrer""><code>SelectListItem</code></a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/dd505286.aspx"" rel=""noreferrer""><code>SelectList Constructor (IEnumerable, String, String)</code></a></li>
</ul>

<p>Now that the viewmodel is created the presentation logic is simplified</p>

<p>View:</p>

<pre><code>@model UserRoleViewModel

@Html.LabelFor(m =&gt; m.SelectedUserRoleId)
@Html.DropDownListFor(m =&gt; m.SelectedUserRoleId, Model.UserRoles)
</code></pre>

<p>References:</p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/ee407381.aspx"" rel=""noreferrer""><code>LabelExtensions.LabelFor</code></a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/ee703462.aspx"" rel=""noreferrer""><code>SelectExtensions.DropDownListFor</code></a></li>
</ul>

<p>This will produce:</p>

<pre><code>&lt;label for=""SelectedUserRoleId""&gt;User Role&lt;/label&gt;
&lt;select id=""SelectedUserRoleId"" name=""SelectedUserRoleId""&gt;
    &lt;option value=""1""&gt;First Role&lt;/option&gt;
    &lt;option value=""2""&gt;Second Role&lt;/option&gt;
    &lt;option value=""3""&gt;Etc...&lt;/option&gt;
&lt;/select&gt;
</code></pre>
","18382610"
"How to iterate through a DataTable","258133","","<p>I need to iterate through a <code>DataTable</code>. I have an column there  named <code>ImagePath</code>.</p>

<p>When I am using <code>DataReader</code> I do it this way:</p>

<pre><code>SqlDataReader dr = null;
dr = cmd.ExecuteReader();
while (dr.Read())
{
    TextBox1.Text = dr[""ImagePath""].ToString();
}
</code></pre>

<p>How can I achieve the same thing using <code>DataTable</code>?</p>
","<pre><code>DataTable dt = new DataTable();

SqlDataAdapter adapter = new SqlDataAdapter(cmd);

adapter.Fill(dt);

foreach(DataRow row in dt.Rows)
{
    TextBox1.Text = row[""ImagePath""].ToString();
}
</code></pre>

<p>...assumes the connection is open and the command is set up properly. I also didn't check the syntax, but it should give you the idea.</p>
","1774515"
"Create a .txt file if doesn't exist, and if it does append a new line","258088","","<p>I would like to create a .txt file and write to it, and if the file already exists I just want to append some more lines:</p>

<pre><code>string path = @""E:\AppServ\Example.txt"";
if (!File.Exists(path))
{
    File.Create(path);
    TextWriter tw = new StreamWriter(path);
    tw.WriteLine(""The very first line!"");
    tw.Close();
}
else if (File.Exists(path))
{
    TextWriter tw = new StreamWriter(path);
    tw.WriteLine(""The next line!"");
    tw.Close(); 
}
</code></pre>

<p>But the first line seems to always get overwritten... how can I avoid writing on the same line (I'm using this in a loop)?</p>

<p>I know it's a pretty simple thing, but I never used the <code>WriteLine</code> method before. I'm totally new to C#.</p>
","<p>Use the <a href=""http://msdn.microsoft.com/en-us/library/36b035cb.aspx"" rel=""noreferrer"">correct constructor</a>:</p>

<pre><code>else if (File.Exists(path))
{
    using(var tw = new StreamWriter(path, true))
    {
        tw.WriteLine(""The next line!"");
        tw.Close();
    }
}
</code></pre>
","9907728"
"Enum String Name from Value","257793","","<p>I have an enum construct like this:</p>

<pre><code>public enum EnumDisplayStatus
{
    None=1,
    Visible=2,
    Hidden=3,
    MarkedForDeletion=4
}
</code></pre>

<p>In my database, the enumerations are referenced by value. My question is, how can I turn the number representation of the enum back to the string name. </p>

<p>For example, given <code>2</code> the result should be <code>Visible</code>.</p>
","<p>You can convert the <code>int</code> back to an enumeration member with a simple cast, and then call <code>ToString()</code>:</p>

<pre><code>int value = GetValueFromDb();
EnumDisplayStatus enumDisplayStatus = (EnumDisplayStatus)value;
string stringValue = enumDisplayStatus.ToString();
</code></pre>
","309339"
"How to Get a Specific Column Value from a DataTable?","257607","","<p>I have a datatable. I need to fetch a certain column value based on the user input. For example, lets say the datatable has two columns CountryID and CountryName.</p>

<p>I need to find CountryID in the datatable based on the user input country name. I could just open a connection with DB and run the query select countryID from Country where countryName = @userinput. Is there anyway i could do this on the datatable.</p>
","<pre><code>string countryName = ""USA"";
DataTable dt = new DataTable();
int id = (from DataRow dr in dt.Rows
              where (string)dr[""CountryName""] == countryName
              select (int)dr[""id""]).FirstOrDefault();
</code></pre>
","2916648"
"Getting mouse position in c#","257588","","<p>How do I get the mouse position? I want it in term of screen position.</p>

<p>I start my program I want to set to the current mouse position.</p>

<pre><code>Location.X = ??
Location.Y = ??
</code></pre>

<p><strong>Edit:</strong> This must happen before the form is created.</p>
","<p>You should use <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.cursor.position.aspx"" rel=""noreferrer"">System.Windows.Forms.Cursor.Position</a>: ""A Point that represents the cursor's position in screen coordinates.""</p>
","1316694"
"How can I find the last element in a List<> ?","257384","","<p>The following is an extract from my code: </p>

<pre><code>public class AllIntegerIDs 
{
    public AllIntegerIDs() 
    {            
        m_MessageID = 0;
        m_MessageType = 0;
        m_ClassID = 0;
        m_CategoryID = 0;
        m_MessageText = null;
    }

    ~AllIntegerIDs()
    {
    }

    public void SetIntegerValues (int messageID, int messagetype,
        int classID, int categoryID)
    {
        this.m_MessageID = messageID;
        this.m_MessageType = messagetype;
        this.m_ClassID = classID;
        this.m_CategoryID = categoryID;
    }

    public string m_MessageText;
    public int m_MessageID;
    public int m_MessageType;
    public int m_ClassID;
    public int m_CategoryID;
}
</code></pre>

<p>I am trying to use the following in my main() function code:</p>

<pre><code>List&lt;AllIntegerIDs&gt; integerList = new List&lt;AllIntegerIDs&gt;();

/* some code here that is ised for following assignments*/
{
   integerList.Add(new AllIntegerIDs());
   index++;
   integerList[index].m_MessageID = (int)IntegerIDsSubstring[IntOffset];
   integerList[index].m_MessageType = (int)IntegerIDsSubstring[IntOffset + 1];
   integerList[index].m_ClassID = (int)IntegerIDsSubstring[IntOffset + 2];
   integerList[index].m_CategoryID = (int)IntegerIDsSubstring[IntOffset + 3];
   integerList[index].m_MessageText = MessageTextSubstring;
}
</code></pre>

<p>Problem is here: I am trying to print all elements in my List using a for loop:</p>

<pre><code>for (int cnt3 = 0 ; cnt3 &lt;= integerList.FindLastIndex ; cnt3++) //&lt;----PROBLEM HERE
{
   Console.WriteLine(""{0}\t{1}\t{2}\t{3}\t{4}\n"", integerList[cnt3].m_MessageID,integerList[cnt3].m_MessageType,integerList[cnt3].m_ClassID,integerList[cnt3].m_CategoryID, integerList[cnt3].m_MessageText);
}
</code></pre>

<p>I want to find the last element so that I equate cnt3 in my for loop and print out all entries in the List. Each element in the list is an object of the class AllIntegerIDs as mentioned above in the code sample. How do I find the last valid entry in the List?</p>

<p>Should I use something like integerList.Find(integerList[].m_MessageText == null;</p>

<p>If I use that it will need an index that will range from 0 to whatever maximum. Means I will have to use another for loop which I do not intend to use. Is there a shorter/better way?</p>

<p>Thanks,
Viren</p>
","<p>If you just want to access the last item in the list you can do</p>

<pre><code>var item = integerList[integerList.Count - 1];
</code></pre>

<p>to get the total number of items in the list you can use the Count propery</p>

<pre><code>var itemCount = integerList.Count;
</code></pre>
","1246955"
"How to remove elements from a generic list while iterating over it?","257272","","<p>I am looking for a better <strong><em>pattern</em></strong> for working with a list of elements which each need processed and then depending on the outcome are removed from the list. </p>

<p>You can't use <code>.Remove(element)</code> inside a <code>foreach (var element in X)</code> (because it results in <code>Collection was modified; enumeration operation may not execute.</code> exception)... you also can't use <code>for (int i = 0; i &lt; elements.Count(); i++)</code> and <code>.RemoveAt(i)</code> because it disrupts your current position in the collection relative to <code>i</code>.</p>

<p>Is there an elegant way to do this?</p>
","<p>Iterate your list in reverse with a for loop:</p>

<pre><code>for (int i = safePendingList.Count - 1; i &gt;= 0; i--)
{
    // some code
    // safePendingList.RemoveAt(i);
}
</code></pre>

<p>Example:</p>

<pre><code>var list = new List&lt;int&gt;(Enumerable.Range(1, 10));
for (int i = list.Count - 1; i &gt;= 0; i--)
{
    if (list[i] &gt; 5)
        list.RemoveAt(i);
}
list.ForEach(i =&gt; Console.WriteLine(i));
</code></pre>

<p>Alternately, you can use the <a href=""http://msdn.microsoft.com/en-us/library/wdka673a.aspx"" rel=""noreferrer"">RemoveAll method</a> with a predicate to test against:</p>

<pre><code>safePendingList.RemoveAll(item =&gt; item.Value == someValue);
</code></pre>

<p>Here's a simplified example to demonstrate:</p>

<pre><code>var list = new List&lt;int&gt;(Enumerable.Range(1, 10));
Console.WriteLine(""Before:"");
list.ForEach(i =&gt; Console.WriteLine(i));
list.RemoveAll(i =&gt; i &gt; 5);
Console.WriteLine(""After:"");
list.ForEach(i =&gt; Console.WriteLine(i));
</code></pre>
","1582317"
"LINQ: How to perform .Max() on a property of all objects in a collection and return the object with maximum value","256886","","<p>I have a list of objects that have two int properties. The list is the output of another linq query. The object:</p>

<pre><code>public class DimensionPair  
{
    public int Height { get; set; }
    public int Width { get; set; }
}
</code></pre>

<p>I want to find and return the object in the list which has the largest <code>Height</code> property value.</p>

<p>I can manage to get the highest value of the <code>Height</code> value but not the object itself.</p>

<p>Can I do this with Linq? How?</p>
","<p>We have an <a href=""https://github.com/morelinq/MoreLINQ/blob/master/MoreLinq/MaxBy.cs"" rel=""noreferrer"">extension method</a> to do exactly this in <a href=""https://github.com/morelinq/MoreLINQ"" rel=""noreferrer"">MoreLINQ</a>. You can look at the implementation there, but basically it's a case of iterating through the data, remembering the maximum element we've seen so far and the maximum value it produced under the projection.</p>

<p>In your case you'd do something like:</p>

<pre><code>var item = items.MaxBy(x =&gt; x.Height);
</code></pre>

<p>This is better (IMO) than any of the solutions presented here other than Mehrdad's second solution (which is basically the same as <code>MaxBy</code>):</p>

<ul>
<li>It's O(n) unlike the <a href=""https://stackoverflow.com/a/1101848/16587"">previous accepted answer</a> which finds the maximum value on every iteration (making it O(n^2))</li>
<li>The ordering solution is O(n log n)</li>
<li>Taking the <code>Max</code> value and then finding the first element with that value is O(n), but iterates over the sequence twice. Where possible, you should use LINQ in a single-pass fashion.</li>
<li>It's a lot simpler to read and understand than the aggregate version, and only evaluates the projection once per element</li>
</ul>
","1101979"
"Joining two lists together","256885","","<p>If I have two lists of type string (or any other type), what is a quick way of joining the two lists?</p>

<p>The order should stay the same. Duplicates should be removed (though every item in both links are unique). I didn't find much on this when googling and didn't want to implement any .NET interfaces for speed of delivery.</p>
","<p>You could try:</p>

<pre><code>List&lt;string&gt; a = new List&lt;string&gt;();
List&lt;string&gt; b = new List&lt;string&gt;();

a.AddRange(b);
</code></pre>

<p><a href=""https://msdn.microsoft.com/en-us/library/z883w3dc(v=vs.110).aspx"" rel=""noreferrer"">MSDN page for <code>AddRange</code></a></p>

<p>This preserves the order of the lists, but it doesn't remove any duplicates which <a href=""https://msdn.microsoft.com/en-us/library/bb341731(v=vs.110).aspx"" rel=""noreferrer""><code>Union</code></a> would do.</p>

<p>This does change list <code>a</code>. If you wanted to preserve the original lists then you should use <a href=""https://msdn.microsoft.com/en-us/library/bb302894(v=vs.110).aspx"" rel=""noreferrer""><code>Concat</code></a> (as pointed out in the other answers):</p>

<pre><code>var newList = a.Concat(b);
</code></pre>

<p>This returns an <code>IEnumerable</code> as long as <code>a</code> is not null.</p>
","1528181"
"How to get temporary folder for current user","256857","","<p>Currently I am using following function to get the temporary folder path for current user:</p>

<pre><code>string tempPath = System.IO.Path.GetTempPath();
</code></pre>

<p>On some machines it gives me temp folder path of current user like: </p>

<blockquote>
  <p>C:\Documents and Settings\administrator\Local Settings\Temp\</p>
</blockquote>

<p>On some machines it gives me system temp folder path like: </p>

<blockquote>
  <p>C:\Windows\TEMP</p>
</blockquote>

<p>MSDN Documentation also says that above API returns current system's temporary folder.</p>

<p>Is there any other API available which gives me current user's temporary folder path like this:</p>

<blockquote>
  <p>C:\Documents and Settings\administrator\Local Settings\Temp\</p>
</blockquote>
","<p><code>System.IO.Path.GetTempPath()</code> is just a wrapper for a native call to <code>GetTempPath(..)</code> in Kernel32.</p>

<p>Have a look at <a href=""http://msdn.microsoft.com/en-us/library/aa364992%28VS.85%29.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/aa364992(VS.85).aspx</a></p>

<p>Copied from that page:</p>

<blockquote>
  <p>The GetTempPath function checks for the existence of environment variables in the following order and uses the first path found:</p>
  
  <ul>
  <li>The path specified by the TMP environment variable.</li>
  <li>The path specified by the TEMP environment variable.</li>
  <li>The path specified by the USERPROFILE environment variable.</li>
  <li>The Windows directory.</li>
  </ul>
</blockquote>

<p>It's not entirely clear to me whether ""The Windows directory"" means the temp directory under windows or the windows directory itself. Dumping temp files in the windows directory itself sounds like an undesirable case, but who knows.</p>

<p>So combining that page with your post I would guess that either one of the TMP, TEMP or USERPROFILE variables for your Administrator user points to the windows path, or else they're not set and it's taking a fallback to the windows temp path.</p>
","946017"
"Embedding DLLs in a compiled executable","256685","","<p>You know, I haven't seen a good answer for this anywhere. Is it possible to embed a pre-existing DLL into a compiled C# executable (so that you only have one file to distribute)? If it is possible, how would one go about doing it?</p>

<p>Normally, I'm cool with just leaving the DLLs outside and having the setup program handle everything, but there have been a couple of people at work who have asked me this and I honestly don't know.</p>
","<p>I highly recommend to use <a href=""https://github.com/Fody/Costura"">Costura.Fody</a> - by far the best and easiest way to embed resources in your assembly. It's available as NuGet package.</p>

<pre><code>Install-Package Costura.Fody
</code></pre>

<p>After adding it to the project, it will automatically embed all references that are copied to the output directory into your <em>main</em> assembly. You might want to clean the embedded files by adding a target to your project:</p>

<pre><code>Install-CleanReferencesTarget
</code></pre>

<p>You'll also be able to specify whether to include the pdb's, exclude certain assemblies, or extracting the assemblies on the fly. As far as I know, also unmanaged assemblies are supported.</p>

<p><strong>Update</strong></p>

<p>Currently, some people are trying to add <a href=""https://github.com/Fody/Fody/issues/206"">support for DNX</a>.</p>
","20306095"
"ASP.NET MVC -  passing parameters to the controller","256622","","<p>I have a controller with an action method as follows:</p>

<pre><code>public class InventoryController : Controller
{
    public ActionResult ViewStockNext(int firstItem)
    {
        // Do some stuff
    }
}
</code></pre>

<p>And when I run it I get an error stating:</p>

<blockquote>
  <p>The parameters dictionary does not contain a valid value of type 'System.Int32' for parameter 'firstItem'. To make a parameter optional its type should either be a reference type or a Nullable type.</p>
</blockquote>

<p>I had it working at one point and I decided to try the function without parameters.  Finding out that the controller was not persistant I put the parameter back in, now it refuses to recognise the parameter when I call the method.</p>

<p>I'm using this url syntax to call the action:</p>

<pre><code>http://localhost:2316/Inventory/ViewStockNext/11
</code></pre>

<p>Any ideas why I would get this error and what I need to do to fix it? </p>

<p>I've tried adding another method that takes an integer to the class it it also fails with the same reason.  I've tried adding one that takes a string, and the string is set to null.  I've tried adding one without parameters and that works fine, but of course it won't suit my needs.</p>
","<p>Your routing needs to be set up along the lines of <code>{controller}/{action}/{firstItem}</code>. If you left the routing as the default <code>{controller}/{action}/{id}</code> in your <code>global.asax.cs</code> file, then you will need to pass in <code>id</code>.</p>

<pre><code>routes.MapRoute(
    ""Inventory"",
    ""Inventory/{action}/{firstItem}"",
    new { controller = ""Inventory"", action = ""ListAll"", firstItem = """" }
);
</code></pre>

<p>... or something close to that.</p>
","155895"
"How do I remove all non alphanumeric characters from a string except dash?","255372","","<p>How do I remove all non alphanumeric characters from a string except dash and space characters?</p>
","<p>Replace <code>[^a-zA-Z0-9 -]</code> with an empty string.</p>

<pre><code>Regex rgx = new Regex(""[^a-zA-Z0-9 -]"");
str = rgx.Replace(str, """");
</code></pre>
","3210410"
"Read XML Attribute using XmlDocument","254976","","<p>How can I read an XML attribute using C#'s XmlDocument?</p>

<p>I have an XML file which looks somewhat like this:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8"" ?&gt;
&lt;MyConfiguration xmlns=""http://tempuri.org/myOwnSchema.xsd"" SuperNumber=""1"" SuperString=""whipcream""&gt;
    &lt;Other stuff /&gt;
&lt;/MyConfiguration&gt; 
</code></pre>

<p>How would I read the XML attributes SuperNumber and SuperString?</p>

<p>Currently I'm using XmlDocument, and I get the values in between using XmlDocument's <code>GetElementsByTagName()</code> and that works really well. I just can't figure out how to get the attributes?</p>
","<pre><code>XmlNodeList elemList = doc.GetElementsByTagName(...);
for (int i = 0; i &lt; elemList.Count; i++)
{
    string attrVal = elemList[i].Attributes[""SuperString""].Value;
}
</code></pre>
","933698"
"Simple way to convert datarow array to datatable","254627","","<p>I want to convert a <code>DataRow</code> array into <code>DataTable</code> ... What is the simplest way to do this?</p>
","<p>Why not iterate through your DataRow array and add (using DataRow.ImportRow, if necessary, to get a copy of the DataRow), something like:</p>

<pre><code>foreach (DataRow row in rowArray) {
   dataTable.ImportRow(row);
}
</code></pre>

<p>Make sure your dataTable has the same schema as the DataRows in your DataRow array.</p>
","2122634"
"How would you do a ""not in"" query with LINQ?","254569","","<p>I have two collections which have property <code>Email</code> in both collections. I need to get a list of the items in the first list where <code>Email</code> does not exist in the second list. With SQL I would just use ""not in"", but I do not know the equivalent in LINQ. How is that done?</p>

<p>So far I have a join, like...</p>

<pre><code>var matches = from item1 in list1
join item2 in list2 on item1.Email equals item2.Email
select new { Email = list1.Email };
</code></pre>

<p>But I cannot join since I need the difference and the join would fail. I need some way of using Contains or Exists I believe. I just have not found an example to do that yet.</p>
","<p>I don't know if this will help you but..</p>

<pre><code>NorthwindDataContext dc = new NorthwindDataContext();    
dc.Log = Console.Out;

var query =    
    from c in dc.Customers    
    where !(from o in dc.Orders    
            select o.CustomerID)    
           .Contains(c.CustomerID)    
    select c;

foreach (var c in query) Console.WriteLine( c );
</code></pre>

<p>from <a href=""http://programminglinq.com/blogs/marcorusso/archive/2008/01/14/the-not-in-clause-in-linq-to-sql.aspx"" rel=""noreferrer"">The NOT IN clause in LINQ to SQL</a> by <a href=""http://introducinglinq.com/blogs/marcorusso/default.aspx"" rel=""noreferrer"">Marco Russo</a></p>
","183804"
"Is ""else if"" faster than ""switch() case""?","254215","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/395618/is-there-any-significant-difference-between-using-if-else-and-switch-case-in-c"">Is there any significant difference between using if/else and switch-case in C#?</a>  </p>
</blockquote>



<p>I'm an ex Pascal guy, currently learning C#.
My question is the following:</p>

<p>Is the code below faster than making a switch?</p>

<pre><code>int a = 5;

if (a == 1)
{
    ....
}
else if(a == 2)
{
    ....
}
else if(a == 3)
{
    ....
}
else if(a == 4)
{
    ....
}
else
    ....
</code></pre>

<p>And the switch:</p>

<pre><code>int a = 5;

switch(a)
{
    case 1:
        ...
        break;

    case 2:
        ...
        break;

    case 3:
        ...
        break;

    case 4:
        ...
        break;

    default:
        ...
        break;


}
</code></pre>

<p>Which one is faster?</p>

<p>I'm asking, because my program has a similar structure (many, many ""else if"" statements).
Should I turn them into switches?</p>
","<p>For just a few items, the difference is small. If you have many items you should definitely use a switch.</p>

<p>If a switch contains more than five items, it's implemented using a lookup table or a hash list. This means that all items get the same access time, compared to a list of if:s where the last item takes much more time to reach as it has to evaluate every previous condition first.</p>
","767849"
"Proper use of the IDisposable interface","253282","","<p>I know from reading <a href=""http://msdn.microsoft.com/en-us/library/system.idisposable.aspx"" rel=""noreferrer"">the MSDN documentation</a> that the ""primary"" use of the <code>IDisposable</code> interface is to clean up unmanaged resources.</p>

<p>To me, ""unmanaged"" means things like database connections, sockets, window handles, etc.  But, I've seen code where the <code>Dispose()</code> method is implemented to free <em>managed</em> resources, which seems redundant to me, since the garbage collector should take care of that for you.</p>

<p>For example:</p>

<pre><code>public class MyCollection : IDisposable
{
    private List&lt;String&gt; _theList = new List&lt;String&gt;();
    private Dictionary&lt;String, Point&gt; _theDict = new Dictionary&lt;String, Point&gt;();

    // Die, clear it up! (free unmanaged resources)
    public void Dispose()
    {
        _theList.clear();
        _theDict.clear();
        _theList = null;
        _theDict = null;
    }
</code></pre>

<p>My question is, does this make the garbage collector free memory used by <code>MyCollection</code> any faster than it normally would?</p>

<p><strong>edit</strong>:  So far people have posted some good examples of using IDisposable to clean up unmanaged resources such as database connections and bitmaps.  But suppose that <code>_theList</code> in the above code contained a million strings, and you wanted to free that memory <em>now</em>, rather than waiting for the garbage collector.  Would the above code accomplish that?</p>
","<p>The point of Dispose <strong>is</strong> to free unmanaged resources. It needs to be done at some point, otherwise they will never be cleaned up. The garbage collector doesn't know <strong>how</strong> to call <code>DeleteHandle()</code> on a variable of type <code>IntPtr</code>, it doesn't know <strong>whether</strong> or not it needs to call <code>DeleteHandle()</code>.</p>

<blockquote>
  <p><strong>Note</strong>: What is an <em>unmanaged resource</em>? If you found it in the Microsoft .NET Framework: it's managed. If you went poking around MSDN yourself, it's unmanaged. Anything you've used P/Invoke calls to get outside of the nice comfy world of everything available to you in the .NET Framwork is unmanaged – and you're now responsible for cleaning it up.</p>
</blockquote>

<p>The object that you've created needs to expose <em>some</em> method, that the outside world can call, in order to clean up unmanaged resources. The method can be named whatever you like: </p>

<pre><code>public void Cleanup()

public void Shutdown()
</code></pre>

<p>But instead there is a standardized name for this method:</p>

<pre><code>public void Dispose()
</code></pre>

<p>There was even an interface created, <code>IDisposable</code>, that has just that one method:</p>

<pre><code>public interface IDisposable
{
   void Dispose()
}
</code></pre>

<p>So you make your object expose the <code>IDisposable</code> interface, and that way you promise that you've written that single method to clean up your unmanaged resources:</p>

<pre><code>public void Dispose()
{
   Win32.DestroyHandle(this.CursorFileBitmapIconServiceHandle);
}
</code></pre>

<p>And you're done. <strong>Except you can do better.</strong></p>

<hr>

<p>What if your object has allocated a 250MB <strong><a href=""http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx"" rel=""noreferrer"">System.Drawing.Bitmap</a></strong> (i.e. the .NET managed Bitmap class) as some sort of frame buffer? Sure, this is a managed .NET object, and the garbage collector will free it. But do you really want to leave 250MB of memory just sitting there – waiting for the garbage collector to <em>eventually</em> come along and free it? What if there's an <a href=""http://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.aspx"" rel=""noreferrer"">open database connection</a>? Surely we don't want that connection sitting open, waiting for the GC to finalize the object.</p>

<p>If the user has called <code>Dispose()</code> (meaning they no longer plan to use the object) why not get rid of those wasteful bitmaps and database connections?</p>

<p>So now we will:</p>

<ul>
<li>get rid of unmanaged resources (because we have to), and </li>
<li>get rid of managed resources (because we want to be helpful)</li>
</ul>

<p>So let's update our <code>Dispose()</code> method to get rid of those managed objects:</p>

<pre><code>public void Dispose()
{
   //Free unmanaged resources
   Win32.DestroyHandle(this.CursorFileBitmapIconServiceHandle);

   //Free managed resources too
   if (this.databaseConnection != null)
   {
      this.databaseConnection.Dispose();
      this.databaseConnection = null;
   }
   if (this.frameBufferImage != null)
   {
      this.frameBufferImage.Dispose();
      this.frameBufferImage = null;
   }
}
</code></pre>

<p>And all is good, <strong>except you can do better</strong>!</p>

<hr>

<p>What if the person <strong>forgot</strong> to call <code>Dispose()</code> on your object? Then they would leak some <strong>unmanaged</strong> resources! </p>

<blockquote>
  <p><strong>Note:</strong> They won't leak <strong>managed</strong> resources, because eventually the garbage collector is going to run, on a background thread, and free the memory associated with any unused objects. This will include your object, and any managed objects you use (e.g. the <code>Bitmap</code> and the <code>DbConnection</code>).</p>
</blockquote>

<p>If the person forgot to call <code>Dispose()</code>, we can <em>still</em> save their bacon! We still have a way to call it <em>for</em> them: when the garbage collector finally gets around to freeing (i.e. finalizing) our object.</p>

<blockquote>
  <p><strong>Note:</strong> The garbage collector will eventually free all managed objects.
  When it does, it calls the <strong><code>Finalize</code></strong>
  method on the object. The GC doesn't know, or
  care, about <em>your</em> <strong>Dispose</strong> method.
  That was just a name we chose for 
  a method we call when we want to get
  rid of unmanaged stuff.</p>
</blockquote>

<p>The destruction of our object by the Garbage collector is the <em>perfect</em> time to free those pesky unmanaged resources. We do this by overriding the <code>Finalize()</code> method. </p>

<blockquote>
  <p><strong>Note:</strong> In C#, you don't explicitly override the <code>Finalize()</code> method. 
  You write a method that <em>looks like</em> a <strong>C++ destructor</strong>, and the 
  compiler takes that to be your implementation of the <code>Finalize()</code> method:</p>
</blockquote>

<pre><code>~MyObject()
{
    //we're being finalized (i.e. destroyed), call Dispose in case the user forgot to
    Dispose(); //&lt;--Warning: subtle bug! Keep reading!
}
</code></pre>

<p>But there's a bug in that code. You see, the garbage collector runs on a <strong>background thread</strong>; you don't know the order in which two objects are destroyed. It is entirely possible that in your <code>Dispose()</code> code, the <strong>managed</strong> object you're trying to get rid of (because you wanted to be helpful) is no longer there:</p>

<pre><code>public void Dispose()
{
   //Free unmanaged resources
   Win32.DestroyHandle(this.gdiCursorBitmapStreamFileHandle);

   //Free managed resources too
   if (this.databaseConnection != null)
   {
      this.databaseConnection.Dispose(); //&lt;-- crash, GC already destroyed it
      this.databaseConnection = null;
   }
   if (this.frameBufferImage != null)
   {
      this.frameBufferImage.Dispose(); //&lt;-- crash, GC already destroyed it
      this.frameBufferImage = null;
   }
}
</code></pre>

<p>So what you need is a way for <code>Finalize()</code> to tell <code>Dispose()</code> that it should <strong>not touch any managed</strong> resources (because they <em>might not be there</em> anymore), while still freeing unmanaged resources.</p>

<p>The standard pattern to do this is to have <code>Finalize()</code> and <code>Dispose()</code> both call a <strong>third</strong>(!) method; where you pass a Boolean saying if you're calling it from <code>Dispose()</code> (as opposed to <code>Finalize()</code>), meaning it's safe to free managed resources.</p>

<p>This <em>internal</em> method <em>could</em> be given some arbitrary name like ""CoreDispose"", or ""MyInternalDispose"", but is tradition to call it <code>Dispose(Boolean)</code>:</p>

<pre><code>protected void Dispose(Boolean disposing)
</code></pre>

<p>But a more helpful parameter name might be:</p>

<pre><code>protected void Dispose(Boolean itIsSafeToAlsoFreeManagedObjects)
{
   //Free unmanaged resources
   Win32.DestroyHandle(this.CursorFileBitmapIconServiceHandle);

   //Free managed resources too, but only if I'm being called from Dispose
   //(If I'm being called from Finalize then the objects might not exist
   //anymore
   if (itIsSafeToAlsoFreeManagedObjects)  
   {    
      if (this.databaseConnection != null)
      {
         this.databaseConnection.Dispose();
         this.databaseConnection = null;
      }
      if (this.frameBufferImage != null)
      {
         this.frameBufferImage.Dispose();
         this.frameBufferImage = null;
      }
   }
}
</code></pre>

<p>And you change your implementation of the <code>IDisposable.Dispose()</code> method to:</p>

<pre><code>public void Dispose()
{
   Dispose(true); //I am calling you from Dispose, it's safe
}
</code></pre>

<p>and your finalizer to:</p>

<pre><code>~MyObject()
{
   Dispose(false); //I am *not* calling you from Dispose, it's *not* safe
}
</code></pre>

<blockquote>
  <p><strong>Note</strong>: If your object descends from an object that implements <code>Dispose</code>, then don't forget to call their <strong>base</strong> Dispose method when you override Dispose:</p>
</blockquote>

<pre><code>public Dispose()
{
    try
    {
        Dispose(true); //true: safe to free managed resources
    }
    finally
    {
        base.Dispose();
    }
}
</code></pre>

<p>And all is good, <strong>except you can do better</strong>!</p>

<hr>

<p>If the user calls <code>Dispose()</code> on your object, then everything has been cleaned up. Later on, when the garbage collector comes along and calls Finalize, it will then call <code>Dispose</code> again. </p>

<p>Not only is this wasteful, but if your object has junk references to objects you already disposed of from the <strong>last</strong> call to <code>Dispose()</code>, you'll try to dispose them again! </p>

<p>You'll notice in my code I was careful to remove references to objects that I've disposed, so I don't try to call <code>Dispose</code> on a junk object reference. But that didn't stop a subtle bug from creeping in.</p>

<p>When the user calls <code>Dispose()</code>: the handle <strong>CursorFileBitmapIconServiceHandle</strong> is destroyed. Later when the garbage collector runs, it will try to destroy the same handle again.</p>

<pre><code>protected void Dispose(Boolean iAmBeingCalledFromDisposeAndNotFinalize)
{
   //Free unmanaged resources
   Win32.DestroyHandle(this.CursorFileBitmapIconServiceHandle); //&lt;--double destroy 
   ...
}
</code></pre>

<p>The way you fix this is tell the garbage collector that it doesn't need to bother finalizing the object – its resources have already been cleaned up, and no more work is needed. You do this by calling <code>GC.SuppressFinalize()</code> in the <code>Dispose()</code> method:</p>

<pre><code>public void Dispose()
{
   Dispose(true); //I am calling you from Dispose, it's safe
   GC.SuppressFinalize(this); //Hey, GC: don't bother calling finalize later
}
</code></pre>

<p>Now that the user has called <code>Dispose()</code>, we have:</p>

<ul>
<li>freed unmanaged resources</li>
<li>freed managed resources</li>
</ul>

<p>There's no point in the GC running the finalizer – everything's taken care of.</p>

<h2>Couldn't I use Finalize to cleanup unmanaged resources?</h2>

<p>The documentation for <a href=""https://msdn.microsoft.com/en-us/library/system.object.finalize.aspx"" rel=""noreferrer""><code>Object.Finalize</code></a> says:</p>

<blockquote>
  <p>The Finalize method is used to perform cleanup operations on unmanaged resources held by the current object before the object is destroyed.</p>
</blockquote>

<p>But the MSDN documentation also says, for <a href=""https://msdn.microsoft.com/en-us/library/system.idisposable.dispose(v=vs.110).aspx"" rel=""noreferrer""><code>IDisposable.Dispose</code></a>:</p>

<blockquote>
  <p>Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.</p>
</blockquote>

<p>So which is it? Which one is the place for me to cleanup unmanaged resources? The answer is: </p>

<blockquote>
  <p>It's your choice! But choose <code>Dispose</code>.</p>
</blockquote>

<p>You certainly could place your unmanaged cleanup in the finalizer:</p>

<pre><code>~MyObject()
{
   //Free unmanaged resources
   Win32.DestroyHandle(this.CursorFileBitmapIconServiceHandle);

   //A C# destructor automatically calls the destructor of its base class.
}
</code></pre>

<p>The problem with that is you have no idea when the garbage collector will get around to finalizing your object. Your un-managed, un-needed, un-used native resources will stick around until the garbage collector <em>eventually</em> runs. Then it will call your finalizer method; cleaning up unmanaged resources. The documentation of <strong>Object.Finalize</strong> points this out:</p>

<blockquote>
  <p>The exact time when the finalizer executes is undefined. To ensure deterministic release of resources for instances of your class, implement a <strong>Close</strong> method or provide a <a href=""https://msdn.microsoft.com/en-us/library/system.idisposable.dispose(v=vs.110).aspx"" rel=""noreferrer""><code>IDisposable.Dispose</code></a> implementation.</p>
</blockquote>

<p>This is the virtue of using <code>Dispose</code> to cleanup unmanaged resources; you get to know, and control, when unmanaged resource are cleaned up. Their destruction is <em>""deterministic""</em>.</p>

<hr>

<p>To answer your original question: Why not release memory now, rather than for when the GC decides to do it? I have a facial recognition software that <em>needs</em> to get rid of 530 MB of internal images <strong>now</strong>, since they're no longer needed. When we don't: the machine grinds to a swapping halt.</p>

<h2>Bonus Reading</h2>

<p>For anyone who likes the style of this answer (explaining the <em>why</em>, so the <em>how</em> becomes obvious), I suggest you read Chapter One of Don Box's Essential COM: </p>

<ul>
<li>Direct link: <a href=""http://ptgmedia.pearsoncmg.com/images/0201634465/samplechapter/chap01.pdf"" rel=""noreferrer"">Chapter 1 sample by Pearson Publishing</a></li>
<li>magnet: 84bf0b960936d677190a2be355858e80ef7542c0</li>
</ul>

<p>In 35 pages he explains the problems of using binary objects, and invents COM before your eyes. Once you realize the <em>why</em> of COM, the remaining 300 pages are obvious, and just detail Microsoft's implementation.</p>

<p>I think every programmer who has ever dealt with objects or COM should, at the very least, read the first chapter. It is the best explanation of anything ever.</p>

<h2>Extra Bonus Reading</h2>

<p><a href=""https://ericlippert.com/2015/05/18/when-everything-you-know-is-wrong-part-one/"" rel=""noreferrer"">When everything you know is wrong</a> by Eric Lippert</p>

<blockquote>
  <p>It is therefore very difficult indeed to write a correct finalizer,
  and <strong>the best advice I can give you is to not try</strong>.</p>
</blockquote>
","538238"
"Linq style ""For Each""","253094","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/200574/linq-equivalent-of-foreach-for-ienumerable"">Linq equivalent of foreach for IEnumerable</a>  </p>
</blockquote>

<p>Is there any Linq style syntax for ""For each"" operations?</p>

<p>For instance, add values based on one collection to another, already existing one:</p>

<pre><code>IEnumerable&lt;int&gt; someValues = new List&lt;int&gt;() { 1, 2, 3 };

IList&lt;int&gt; list = new List&lt;int&gt;();

someValues.ForEach(x =&gt; list.Add(x + 1));
</code></pre>

<p>Instead of </p>

<pre><code>foreach(int value in someValues)
{
  list.Add(value + 1);
}
</code></pre>
","<p>Using the ToList() extension method is your best option:</p>

<pre><code>someValues.ToList().ForEach(x =&gt; list.Add(x + 1));
</code></pre>

<p>There is no extension method in the BCL that implements ForEach directly.</p>

<hr>

<p>Although there's no extension method in the <em>BCL</em> that does this, there <em>is</em> still an option in the <code>System</code> namespace... if you add <a href=""https://www.nuget.org/packages/Rx-Main"" rel=""noreferrer"">Reactive Extensions</a> to your project:</p>

<pre><code>using System.Reactive.Linq;

someValues.ToObservable().Subscribe(x =&gt; list.Add(x + 1));
</code></pre>

<p>This has the same end result as the above use of <code>ToList</code>, but is (in theory) more efficient, because it streams the values directly to the delegate.</p>
","1509450"
"How to search a string in String array","252213","","<p>I need to search a string in the string array. I dont want to use any for looping in it</p>

<pre><code>string [] arr = {""One"",""Two"",""Three""};

string var = ""One""
</code></pre>

<p>I need to check whether var variable is present in arr.</p>
","<p>Every method, mentioned earlier does looping either internally or externally, so it is not really important how to implement it. Here another example of finding all references of target string</p>

<pre><code>       string [] arr = {""One"",""Two"",""Three""};
       var target = ""One"";
       var results = Array.FindAll(arr, s =&gt; s.Equals(target));
</code></pre>
","265181"
"The provider is not compatible with the version of Oracle client","251759","","<p>I'm trying to use the <strong>Oracle ODP.NET 11g (11.1.0.6.20) Instant Client</strong> on my ASP.net project as a <strong>Data Provider</strong> but when I run the aspx page I get a ""<em>The provider is not compatible with the version of Oracle client</em>"" error message.  Any help would be appreciated.</p>

<p>I've referenced the Data Provider in Visual Studio 2005 and the code behind looks like this:</p>

<pre><code>using Oracle.DataAccess.Client;
..

OracleConnection oOracleConn = new OracleConnection();
oOracleConn.ConnectionString =
    ""Data Source=MyOracleServerName;"" +
    ""Integrated Security=SSPI"";
oOracleConn.Open();

//Do Something

oOracleConn.Close();
</code></pre>

<p>The error for the page looks like this:</p>

<pre><code>Exception Details: Oracle.DataAccess.Client.OracleException: The provider is not compatible with the version of Oracle client

Source Error: 
Line 21: 
Line 22: 
Line 23:             OracleConnection oOracleConn = new OracleConnection();
Line 24:             oOracleConn.ConnectionString =
Line 25:                 ""Data Source=MyOracleServerName;"" +

[OracleException (0x80004005): The provider is not compatible with the version of Oracle client]
   Oracle.DataAccess.Client.OracleInit.Initialize() +494
   Oracle.DataAccess.Client.OracleConnection..cctor() +483

Stack Trace: 
[TypeInitializationException: The type initializer for 'Oracle.DataAccess.Client.OracleConnection' threw an exception.]
   Oracle.DataAccess.Client.OracleConnection..ctor() +0
   Boeing.IVX.Web.RoyTesting.Page_Load(Object sender, EventArgs e) in C:\Documents and Settings\CE218C\Desktop\IVX.Net\Web\IVX\RoyTesting.aspx.cs:23
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +15
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +33
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436
</code></pre>
","<p>I only installed the <strong>Oracle Data Provider for .NET 2.0 (11.1.0.6.20)</strong> and I did not install the <strong>Oracle Instant Client (11.1.0.6.0)</strong>.  </p>

<p>I just installed it and the error disappeared!</p>
","660015"
"How to pass an array into a SQL Server stored procedure","250418","","<p>How to pass an array into a SQL Server stored procedure?</p>

<p>For example, I have a list of employees. I want to use this list as a table and join it with another table. But the list of employees should be passed as parameter from C#.</p>
","<p>Since you have a List already, I think there are more straightforward ways than XML.</p>

<h2>SQL Server 2008 (or newer)</h2>

<p>First, in your database, create the following two objects:</p>

<pre class=""lang-sql prettyprint-override""><code>CREATE TYPE dbo.EmployeeList
AS TABLE
(
  EmployeeID INT
);
GO

CREATE PROCEDURE dbo.DoSomethingWithEmployees
  @List AS dbo.EmployeeList READONLY
AS
BEGIN
  SET NOCOUNT ON;

  SELECT EmployeeID FROM @List; 
END
GO
</code></pre>

<p>Now in your C# code:</p>

<pre class=""lang-cs prettyprint-override""><code>DataTable tvp = new DataTable();
// define / populate DataTable from your List here

using (conn)
{
    SqlCommand cmd = new SqlCommand(""dbo.DoSomethingWithEmployees"", conn);
    cmd.CommandType = CommandType.StoredProcedure;
    SqlParameter tvparam = cmd.Parameters.AddWithValue(""@List"", tvp);
    tvparam.SqlDbType = SqlDbType.Structured;
    // execute query, consume results, etc. here
}
</code></pre>

<h2>SQL Server 2005</h2>

<p>If you are using SQL Server 2005, I would still recommend a split function over XML. First, create a function:</p>

<pre class=""lang-sql prettyprint-override""><code>CREATE FUNCTION dbo.SplitInts
(
   @List      VARCHAR(MAX),
   @Delimiter VARCHAR(255)
)
RETURNS TABLE
AS
  RETURN ( SELECT Item = CONVERT(INT, Item) FROM
      ( SELECT Item = x.i.value('(./text())[1]', 'varchar(max)')
        FROM ( SELECT [XML] = CONVERT(XML, '&lt;i&gt;'
        + REPLACE(@List, @Delimiter, '&lt;/i&gt;&lt;i&gt;') + '&lt;/i&gt;').query('.')
          ) AS a CROSS APPLY [XML].nodes('i') AS x(i) ) AS y
      WHERE Item IS NOT NULL
  );
GO
</code></pre>

<p>Now your stored procedure can just be:</p>

<pre class=""lang-sql prettyprint-override""><code>CREATE PROCEDURE dbo.DoSomethingWithEmployees
  @List VARCHAR(MAX)
AS
BEGIN
  SET NOCOUNT ON;

  SELECT EmployeeID = Item FROM dbo.SplitInts(@List, ','); 
END
GO
</code></pre>

<p>And in your C# code you just have to pass the list as <code>'1,2,3,12'</code>...</p>

<p>I recommend you compare the maintainability and performance of these options against the method you selected.</p>
","11105413"
"convert datetime to date format dd/mm/yyyy","250065","","<p>i have an object <code>2/19/2011 12:00:00 AM</code>. i want to convert this object to <code>19/2/2011</code>. please give me the most possible answers</p>

<p>convert datetime to string format.</p>
","<pre><code>DateTime dt = DateTime.ParseExact(yourObject.ToString(), ""MM/dd/yyyy hh:mm:ss tt"", CultureInfo.InvariantCulture);

string s = dt.ToString(""dd/M/yyyy"", CultureInfo.InvariantCulture);
</code></pre>
","5050141"
"How to wait for thread to finish with .NET?","249564","","<p>I've never really used threading before in C# where I need to have two threads, as well as the main UI thread. Basically, I have the following.</p>

<pre><code>public void StartTheActions()
{
  //Starting thread 1....
  Thread t1 = new Thread(new ThreadStart(action1));
  t1.Start();

  // Now, I want for the main thread (which is calling `StartTheActions` method) 
  // to wait for `t1` to finish. I've created an event in `action1` for this. 
  // The I wish `t2` to start...

  Thread t2 = new Thread(new ThreadStart(action2));
  t2.Start();
}
</code></pre>

<p>So, essentially, my question is how to have a thread wait for another one to finish. What is the best way to do this?</p>
","<p>I can see 5 options available:</p>

<h3>1. Thread.Join</h3>

<p>As with Mitch's answer. But this will block your UI thread, however you get a Timeout built in for you.</p>

<hr>

<h3>2. Use a <code>WaitHandle</code></h3>

<p><code>ManualResetEvent</code> is a <code>WaitHandle</code> as jrista suggested. </p>

<p>One thing to note is if you want to wait for multiple threads, <code>WaitHandle.WaitAll()</code> won't work by default, as it needs an MTA thread. You can get around this by marking your <code>Main()</code> method with <code>MTAThread</code> - however this blocks your message pump and isn't recommended from what I've read.</p>

<hr>

<h3>3. Fire an event</h3>

<p>See <a href=""http://www.yoda.arachsys.com/csharp/threads/lockchoice.shtml"" rel=""noreferrer"">this page by Jon Skeet</a> about events and multi-threading, it's possible that an event can become unsubcribed between the <code>if</code> and the <code>EventName(this,EventArgs.Empty)</code> - it's happened to me before.</p>

<p><em>(Hopefully these compile, I haven't tried)</em></p>

<pre><code>public class Form1 : Form
{
    int _count;

    void ButtonClick(object sender, EventArgs e)
    {
        ThreadWorker worker = new ThreadWorker();
        worker.ThreadDone += HandleThreadDone;

        Thread thread1 = new Thread(worker.Run);
        thread1.Start();

        _count = 1;
    }

    void HandleThreadDone(object sender, EventArgs e)
    {
        // You should get the idea this is just an example
        if (_count == 1)
        {
            ThreadWorker worker = new ThreadWorker();
            worker.ThreadDone += HandleThreadDone;

            Thread thread2 = new Thread(worker.Run);
            thread2.Start();

            _count++;
        }
    }

    class ThreadWorker
    {
        public event EventHandler ThreadDone;

        public void Run()
        {
            // Do a task

            if (ThreadDone != null)
                ThreadDone(this, EventArgs.Empty);
        }
    }
}
</code></pre>

<hr>

<h3>4. Use a delegate</h3>

<pre><code>public class Form1 : Form
{
    int _count;

    void ButtonClick(object sender, EventArgs e)
    {
        ThreadWorker worker = new ThreadWorker();

        Thread thread1 = new Thread(worker.Run);
        thread1.Start(HandleThreadDone);

        _count = 1;
    }

    void HandleThreadDone()
    {
        // As before - just a simple example
        if (_count == 1)
        {
            ThreadWorker worker = new ThreadWorker();

            Thread thread2 = new Thread(worker.Run);
            thread2.Start(HandleThreadDone);

            _count++;
        }
    }

    class ThreadWorker
    {
        // Switch to your favourite Action&lt;T&gt; or Func&lt;T&gt;
        public void Run(object state)
        {
            // Do a task

            Action completeAction = (Action)state;
            completeAction.Invoke();
        }
    }
}
</code></pre>

<p>If you do use the _count method, it might be an idea (to be safe) to increment it using</p>

<p><code>Interlocked.Increment(ref _count)</code></p>

<p>I'd be interested to know the difference between using delegates and events for thread notification, the only difference I know are events are called synchronously. </p>

<hr>

<h3>5. Do it asynchronously instead</h3>

<p>The answer to <a href=""https://stackoverflow.com/questions/1784928/c-four-patterns-in-asynchronous-execution"">this question</a> has a very clear description of your options with this method.</p>

<hr>

<h3>Delegate/Events on the wrong thread</h3>

<p>The event/delegate way of doing things will mean your event handler <strong>method</strong> is on thread1/thread2 <strong>not the main UI thread</strong>, so you will need to switch back right at the top of the HandleThreadDone methods:</p>

<pre><code>// Delegate example
if (InvokeRequired)
{
    Invoke(new Action(HandleThreadDone));
    return;
}
</code></pre>
","2228508"
"Get file name from a path string in C#","249234","","<p>I program in WPF C#.  I have e.g. the following Path:</p>

<pre><code>C:\Program Files\hello.txt
</code></pre>

<p>and I want to output ""<strong>hello</strong>"" from it. </p>

<p>The path is a string extract from database. Currently I'm using the following method (split from path by '\' then split again by a '.'):</p>

<pre><code>string path = ""C:\\Program Files\\hello.txt"";
string[] pathArr = path.Split('\\');
string[] fileArr = pathArr.Last().Split('.');
string fileName = fileArr.Last().ToString();
</code></pre>

<p>It works, but I believe there should be shorter and smarter solution to that. Any idea?</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx"" rel=""noreferrer"">Path.GetFileName</a></p>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx"" rel=""noreferrer"">Path.GetFileNameWithoutExtension</a></p>

<p>The <a href=""http://msdn.microsoft.com/en-us/library/3bdzys9w.aspx"" rel=""noreferrer"">Path</a> class is wonderful.</p>
","6921127"
"What is the difference between const and readonly?","249211","","<p>What is the difference between <strong><code>const</code></strong> and <strong><code>readonly</code></strong> and do you use one over the other?</p>
","<p>Apart from the apparent difference of </p>

<ul>
<li>having to declare the value at the time of a definition for a <code>const</code> VS <code>readonly</code> values can be computed dynamically but need to be assigned before the constructor exits.. after that it is frozen.</li>
<li>'const's are implicitly <code>static</code>. You use a <code>ClassName.ConstantName</code> notation to access them.</li>
</ul>

<p>There is a subtle difference. Consider a class defined in <code>AssemblyA</code>.</p>

<pre><code>public class Const_V_Readonly
{
  public const int I_CONST_VALUE = 2;
  public readonly int I_RO_VALUE;
  public Const_V_Readonly()
  {
     I_RO_VALUE = 3;
  }
}
</code></pre>

<p><code>AssemblyB</code> references <code>AssemblyA</code> and uses these values in code. When this is compiled, </p>

<ul>
<li>in the case of the <code>const</code> value, it is like a find-replace, the value 2 is 'baked into' the <code>AssemblyB</code>'s IL. This means that if tomorrow I'll update <code>I_CONST_VALUE</code> to 20 in the future. <em><code>AssemblyB</code> would still have 2 till I recompile it</em>.</li>
<li>in the case of the <code>readonly</code> value, it is like a <code>ref</code> to a memory location. The value is not baked into <code>AssemblyB</code>'s IL. This means that if the memory location is updated, <code>AssemblyB</code> gets the new value without recompilation. So if <code>I_RO_VALUE</code> is updated to 30, you only need to build <code>AssemblyA</code>. All clients do not need to be recompiled.</li>
</ul>

<p>So if you are confident that the value of the constant won't change use a <code>const</code>. </p>

<pre><code>public const int CM_IN_A_METER = 100;
</code></pre>

<p>But if you have a constant that may change (e.g. w.r.t. precision).. or when in doubt, use a <code>readonly</code>. </p>

<pre><code>public readonly float PI = 3.14;
</code></pre>

<p><em>Update: Aku needs to get a mention coz he pointed this out first. Also I need to plug where I learned this.. <a href=""http://rads.stackoverflow.com/amzn/click/0321245660"" rel=""noreferrer"">Effective C# - Bill Wagner</a></em></p>
","56024"
".NET / C# - Convert char[] to string","248421","","<p>What is the proper way to turn a <code>char[]</code> into a string?</p>

<p>The <code>ToString()</code> method from an array of characters doesn't do the trick.</p>
","<pre><code>char[] chars = {'a', ' ', 's', 't', 'r', 'i', 'n', 'g'};
string s = new string(chars);
</code></pre>
","1324013"
"Checking if a string array contains a value, and if so, getting its position","248330","","<p>I have this string array:</p>

<pre><code>string[] stringArray = { ""text1"", ""text2"", ""text3"", ""text4"" };
string value = ""text3"";
</code></pre>

<p>I would like to determine if <code>stringArray</code> contains <code>value</code>. If so, I want to locate its position in the array. </p>

<p>I don't want to use loops. Can anyone suggest how I might do this?</p>
","<p>You could use the <a href=""http://msdn.microsoft.com/en-us/library/system.array.indexof.aspx"">Array.IndexOf</a> method:</p>

<pre><code>string[] stringArray = { ""text1"", ""text2"", ""text3"", ""text4"" };
string value = ""text3"";
int pos = Array.IndexOf(stringArray, value);
if (pos &gt; -1)
{
    // the array contains the string and the pos variable
    // will have its position in the array
}
</code></pre>
","7867403"
"How to get only the date value from a Windows Forms DateTimePicker control?","248130","","<p>I'm building an application with C# code.<br>
How do I get only the date value from a <code>DateTimePicker</code> control?</p>
","<p>I'm assuming you mean a datetime picker in a winforms application. </p>

<p>in your code, you can do the following:</p>

<pre><code>string theDate = dateTimePicker1.Value.ToShortDateString();
</code></pre>

<p>or, if you'd like to specify the format of the date:</p>

<pre><code>string theDate = dateTimePicker1.Value.ToString(""yyyy-MM-dd"");
</code></pre>
","1138240"
"How do I extract data from a DataTable?","247850","","<p>I have a <code>DataTable</code> that is filled in from an SQL query to a local database, but I don't know how to extract data from it.
Main method (in test program):</p>

<pre class=""lang-cs prettyprint-override""><code>static void Main(string[] args)
{
    const string connectionString = ""server=localhost\\SQLExpress;database=master;integrated Security=SSPI;"";
    DataTable table = new DataTable(""allPrograms"");

    using (var conn = new SqlConnection(connectionString))
    {
        Console.WriteLine(""connection created successfuly"");

        string command = ""SELECT * FROM Programs"";

        using (var cmd = new SqlCommand(command, conn))
        {
            Console.WriteLine(""command created successfuly"");

            SqlDataAdapter adapt = new SqlDataAdapter(cmd);

            conn.Open(); 
            Console.WriteLine(""connection opened successfuly"");
            adapt.Fill(table);
            conn.Close();
            Console.WriteLine(""connection closed successfuly"");
        }
    }

    Console.Read();
}
</code></pre>

<p>The command I used to create the tables in my database:</p>

<pre class=""lang-sql prettyprint-override""><code>create table programs
(
    progid int primary key identity(1,1),
    name nvarchar(255),
    description nvarchar(500),
    iconFile nvarchar(255),
    installScript nvarchar(255)
)
</code></pre>

<p>How can I extract data from the <code>DataTable</code> into a form meaningful to use?</p>
","<p>The DataTable has a collection <code>.Rows</code> of DataRow elements.</p>

<p>Each DataRow corresponds to one row in your database, and contains a collection of columns.</p>

<p>In order to access a single value, do something like this:</p>

<pre><code> foreach(DataRow row in YourDataTable.Rows)
 { 
     string name = row[""name""].ToString();
     string description = row[""description""].ToString();
     string icoFileName = row[""iconFile""].ToString();
     string installScript = row[""installScript""].ToString();
 }
</code></pre>

<p>Marc</p>
","1346142"
"Best way to repeat a character in C#","247584","","<p>What it's the best way to generate a string of <code>\t</code>'s in C#</p>

<p>I am learning C# and experimenting with different ways of saying the same thing.  </p>

<p><code>Tabs(uint t)</code> is a function that returns a <code>string</code> with <code>t</code> amount of <code>\t</code>'s</p>

<p>For example <code>Tabs(3)</code> returns <code>""\t\t\t""</code></p>

<p>Which of these three ways of implementing <code>Tabs(uint numTabs)</code> is best?</p>

<p>Of course that depends on what ""best"" means.  </p>

<ol>
<li><p>The LINQ version is only two lines, which is nice.  But are the calls to Repeat and Aggregate unnecessarily time/resource consuming?</p></li>
<li><p>The <code>StringBuilder</code> version is very clear but is the <code>StringBuilder</code> class somehow slower?</p></li>
<li><p>The <code>string</code> version is basic, which means it is easy to understand.  </p></li>
<li><p>Does it not matter at all?  Are they all equal?</p></li>
</ol>

<p>These are all questions to help me get a better feel for C#.   </p>

<pre><code>private string Tabs(uint numTabs)
{
    IEnumerable&lt;string&gt; tabs = Enumerable.Repeat(""\t"", (int) numTabs);
    return (numTabs &gt; 0) ? tabs.Aggregate((sum, next) =&gt; sum + next) : """"; 
}  

private string Tabs(uint numTabs)
{
    StringBuilder sb = new StringBuilder();
    for (uint i = 0; i &lt; numTabs; i++)
        sb.Append(""\t"");

    return sb.ToString();
}  

private string Tabs(uint numTabs)
{
    string output = """";
    for (uint i = 0; i &lt; numTabs; i++)
    {
        output += '\t';
    }
    return output; 
}
</code></pre>
","<p>What about this:</p>

<pre><code>string tabs = new String('\t', n);
</code></pre>

<p>Where <code>n</code> is the number of times you want to repeat the string.</p>

<p>Or better:</p>

<pre><code>static string Tabs(int n)
{
    return new String('\t', n);
}
</code></pre>
","411762"
"how to show alert box after successful insert using C#","247308","","<p>i am using detail-view and would like to show an alert box at the end of my code where the insert is complete.  Is there an easy way to show some kind of alert box that says "" thank you data has been inserted successfully"" </p>
","<p>After insertion code,</p>

<pre><code>ScriptManager.RegisterClientScriptBlock(this, this.GetType(), ""alertMessage"", ""alert('Record Inserted Successfully')"", true);
</code></pre>
","16370491"
"How to build a query string for a URL in C#?","246675","","<p>A common task when calling web resources from a code is building a query string to including all the necessary parameters. While by all means no rocket science, there are some nifty details you need to take care of like, appending an <code>&amp;</code> if not the first parameter, encoding the parameters etc.</p>

<p>The code to do it is very simple, but a bit tedious:</p>

<pre><code>StringBuilder SB = new StringBuilder();
if (NeedsToAddParameter A) 
{ 
  SB.Append(""A=""); SB.Append(HttpUtility.UrlEncode(""TheValueOfA"")); 
}

if (NeedsToAddParameter B) 
{
  if (SB.Length&gt;0) SB.Append(""&amp;""); 
  SB.Append(""B=""); SB.Append(HttpUtility.UrlEncode(""TheValueOfB"")); }
}
</code></pre>

<p>This is such a common task one would expect a utility class to exist that makes it more elegant and readable. Scanning MSDN, I failed to find one&mdash;which brings me to the following question:</p>

<p>What is the most elegant clean way you know of doing the above?</p>
","<p>If you look under the hood the QueryString property is a NameValueCollection. When I've done similar things I've usually been interested in serialising AND deserialising so my suggestion is to build a NameValueCollection up and then pass to:</p>

<pre><code>using System.Web;
using System.Collections.Specialized;

private string ToQueryString(NameValueCollection nvc)
{
    var array = (from key in nvc.AllKeys
        from value in nvc.GetValues(key)
        select string.Format(""{0}={1}"", HttpUtility.UrlEncode(key), HttpUtility.UrlEncode(value)))
        .ToArray();
    return ""?"" + string.Join(""&amp;"", array);
}
</code></pre>

<p>Possibly I could've formatted that better :)</p>

<p>I imagine there's a super elegant way to do this in LINQ too...</p>
","829138"
"Is there a MessageBox equivalent in WPF?","246352","","<p>Is there a standard message box in WPF, like WinForms' <code>System.Windows.MessageBox.Show()</code>, or should I use the WinForms message box? </p>
","<p>The WPF equivalent would be the <a href=""http://msdn.microsoft.com/en-us/library/ms602949.aspx"" rel=""noreferrer""><code>System.Windows.MessageBox</code></a>. It has a quite similar interface, but uses other enumerations for parameters and return value.</p>
","3830253"
"How to generate .NET 4.0 classes from xsd?","245932","","<p>What are the options to generate .NET 4.0 c# classes (entities) from an xsd file, using Visual Studio 2010?</p>
","<p>simple enough; just run (at the vs command prompt)</p>

<pre><code>xsd your.xsd /classes
</code></pre>

<p>(which will create <code>your.cs</code>). Note, however, that most of the intrinsic options here haven't changed much since 2.0</p>

<p>For the options, use <code>xsd /?</code> or <a href=""http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=VS.100%29.aspx"">see MSDN</a>; for example <code>/enableDataBinding</code> can be useful.</p>
","5217696"
"How can I read user input from the console?","245731","","<p>I want to get a number from the user, and then multiply that number with Pi. my attempt at this is below. But <code>a</code> contains gibberish. For example, if I insert <code>22</code>, then <code>a</code> contains <code>50</code>. What am I doing wrong? I don't get any compiler errors.</p>

<pre><code>double a,b;
a = Console.Read();
b = a * Math.PI;
Console.WriteLine(b);
</code></pre>
","<p>I'm not sure what your problem is (since you haven't told us), but I'm guessing at </p>

<pre><code>a = Console.Read();
</code></pre>

<p>This will only read one character from your Console.</p>

<p>You can change your program to this. To make it more robust, accept more than 1 char input, and validate that the input is actually a number:</p>

<pre><code>double a, b;
Console.WriteLine(""istenen sayıyı sonuna .00 koyarak yaz"");
if (double.TryParse(Console.ReadLine(), out a)) {
  b = a * Math.PI;
  Console.WriteLine(""Sonuç "" + b); 
} else {
  //user gave an illegal input. Handle it here.
}
</code></pre>
","7280633"
"Func vs. Action vs. Predicate","245626","","<p>With real examples and their use, can someone please help me understand:</p>

<ol>
<li>When do we need Func delegate? </li>
<li>When do we need Action delegate?</li>
<li>When do we need Predicates delegate?</li>
</ol>
","<p>The difference between <code>Func</code> and <code>Action</code> is simply whether you want the delegate to return a value (use <code>Func</code>) or not (use <code>Action</code>).</p>

<p><code>Func</code> is probably most commonly used in LINQ - for example in projections:</p>

<pre><code> list.Select(x =&gt; x.SomeProperty)
</code></pre>

<p>or filtering:</p>

<pre><code> list.Where(x =&gt; x.SomeValue == someOtherValue)
</code></pre>

<p>or key selection:</p>

<pre><code> list.Join(otherList, x =&gt; x.FirstKey, y =&gt; y.SecondKey, ...)
</code></pre>

<p><code>Action</code> is more commonly used for things like <code>List&lt;T&gt;.ForEach</code>: execute the given action for each item in the list. I use this less often than <code>Func</code>, although I <em>do</em> sometimes use the parameterless version for things like <code>Control.BeginInvoke</code> and <code>Dispatcher.BeginInvoke</code>.</p>

<p><code>Predicate</code> is just a special cased <code>Func&lt;T, bool&gt;</code> really, introduced before all of the <code>Func</code> and most of the <code>Action</code> delegates came along. I suspect that if we'd already had <code>Func</code> and <code>Action</code> in their various guises, <code>Predicate</code> wouldn't have been introduced... although it <em>does</em> impart a certain meaning to the use of the delegate, whereas <code>Func</code> and <code>Action</code> are used for widely disparate purposes.</p>

<p><code>Predicate</code> is mostly used in <code>List&lt;T&gt;</code> for methods like <code>FindAll</code> and <code>RemoveAll</code>.</p>
","4317512"
"I get a ""An attempt was made to load a program with an incorrect format"" error on a SQL Server replication project","245589","","<p>The exact error is as follows</p>

<blockquote>
  <p>Could not load file or assembly 'Microsoft.SqlServer.Replication,
  Version=9.0.242.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91'
  or one of its dependencies. An attempt was made to load a program with
  an incorrect format.</p>
</blockquote>

<p>I've recently started working on this project again after a two month move to another project.  It worked perfectly before, and I've double checked all the references.</p>
","<p>I've found the solution.  I've recently upgraded my machine to Windows 2008 Server 64-bit.  The SqlServer.Replication namespace was written for 32-bit platforms.  All I needed to do to get it running again was to set the Target Platform in the Project Build Properties to X86.</p>
","41451"
"How using try catch for exception handling is best practice","244488","","<p>while maintaining my colleague's code from even someone who claims to be a senior developer, I often see the following code:</p>

<pre><code>try
{
  //do something
}
catch
{
  //Do nothing
}
</code></pre>

<p>or sometimes they write logging information to log files like following <code>try catch</code> block </p>

<pre><code>try
{
  //do some work
}
catch(Exception exception)
{
   WriteException2LogFile(exception);
}
</code></pre>

<p>I am just wondering if what they have done is the best practice? It makes me confused because in my thinking users should know what happens with the system.</p>

<p>Please give me some advice.</p>
","<p>My exception handling strategy is :</p>

<ul>
<li><p>To catch <strong>all unhandled exceptions</strong> by hooking to the <code>Application.ThreadException event</code>, then decide :</p>

<ul>
<li>For a UI application: to pop it to the user with an apology message (winforms)</li>
<li>For a Service or a Console application: log it to a file (service or console)</li>
</ul></li>
</ul>

<p>Then I always enclose <strong>every piece of code that is run externally</strong> in <code>try/catch</code> :</p>

<ul>
<li>All events fired by the Winforms infrastructure (Load, Click, SelectedChanged...)</li>
<li>All events fired by third party components</li>
</ul>

<p>Then I enclose in 'try/catch'</p>

<ul>
<li>All the <strong>operations that I <em>know might not work all the time</em></strong> (IO operations, calculations with a potential zero division...). In such a case, I throw a new <code>ApplicationException(""custom message"", innerException)</code> to keep track of what really happened</li>
</ul>

<p>Additionally, I try my best to <strong>sort exceptions correctly</strong>. There are exceptions which:</p>

<ul>
<li>need to be shown to the user immediately</li>
<li>require some extra processing to put things together when they happen to avoid cascading problems (ie: put .EndUpdate in the <code>finally</code> section during a <code>TreeView</code> fill)</li>
<li><p>the user does not care, but it is important to know what happened. So I always log them:</p>

<ul>
<li>In the event log</li>
<li>or in a .log file on the disk</li>
</ul></li>
</ul>

<p>It is a good practice to <strong>design some static methods to handle exceptions</strong> in the application top level error handlers.</p>

<p>I also force myself to try to:</p>

<ul>
<li>Remember <strong>ALL exceptions are bubbled up to the top level</strong>. It is not necessary to put exception handlers everywhere.</li>
<li>Reusable or deep called functions does not need to display or log exceptions : they are either bubbled up automatically or rethrown with some custom messages in my exception handlers.</li>
</ul>

<p>So finally :</p>

<p>Bad:</p>

<pre><code>// DON'T DO THIS, ITS BAD
try
{
    ...
}
catch 
{
   // only air...
}
</code></pre>

<p>Useless:</p>

<pre><code>// DONT'T DO THIS, ITS USELESS
try
{
    ...
}
catch(Exception ex)
{
    throw ex;
}
</code></pre>

<p>Having a try finally without a catch is perfectly valid:</p>

<pre><code>try
{
    listView1.BeginUpdate();

    // If an exception occurs in the following code, then the finally will be executed
    // and the exception will be thrown
    ...
}
finally
{
    // I WANT THIS CODE TO RUN EVENTUALLY REGARDLESS AN EXCEPTION OCCURED OR NOT
    listView1.EndUpdate();
}
</code></pre>

<p>What I do at the top level:</p>

<pre><code>// i.e When the user clicks on a button
try
{
    ...
}
catch(Exception ex)
{
    ex.Log(); // Log exception

    -- OR --

    ex.Log().Display(); // Log exception, then show it to the user with apologies...
}
</code></pre>

<p>What I do in some called functions:</p>

<pre><code>// Calculation module
try
{
    ...
}
catch(Exception ex)
{
    // Add useful information to the exception
    throw new ApplicationException(""Something wrong happened in the calculation module :"", ex);
}

// IO module
try
{
    ...
}
catch(Exception ex)
{
    throw new ApplicationException(string.Format(""I cannot write the file {0} to {1}"", fileName, directoryName), ex);
}
</code></pre>

<p>There is a lot to do with exception handling (Custom Exceptions) but thoses rules I try to keep in mind are enough for the simple applications I do.</p>

<p>Here is an example of extensions methods to handle caught exceptions a comfortable way. They are implemented a way they can be chained together, and it is very easy to add your own caught exception processing.</p>

<pre><code>// Usage:

try
{
    // boom
}
catch(Exception ex)
{
    // Only log exception
    ex.Log();

    -- OR --

    // Only display exception
    ex.Display();

    -- OR --

    // Log, then display exception
    ex.Log().Display();

    -- OR --

    // Add some user-friendly message to an exception
    new ApplicationException(""Unable to calculate !"", ex).Log().Display();
}

// Extension methods

internal static Exception Log(this Exception ex)
{
    File.AppendAllText(""CaughtExceptions"" + DateTime.Now.ToString(""yyyy-MM-dd"") + "".log"", DateTime.Now.ToString(""HH:mm:ss"") + "": "" + ex.Message + ""\n"" + ex.ToString() + ""\n"");
    return ex;
}

internal static Exception Display(this Exception ex, string msg = null, MessageBoxImage img = MessageBoxImage.Error)
{
    MessageBox.Show(msg ?? ex.Message, """", MessageBoxButton.OK, img);
    return ex;
}
</code></pre>
","14974163"
"Serializing a list to JSON","244361","","<p>I have an object model that looks like this:</p>

<pre><code>public MyObjectInJson
{
   public long ObjectID {get;set;}
   public string ObjectInJson {get;set;}
}
</code></pre>

<p>The property <code>ObjectInJson</code> is an already serialized version an object that contains nested lists. For the moment, I'm serializing the list of <code>MyObjectInJson</code> manually like this:</p>

<pre><code>StringBuilder TheListBuilder = new StringBuilder();

TheListBuilder.Append(""["");
int TheCounter = 0;

foreach (MyObjectInJson TheObject in TheList)
{
  TheCounter++;
  TheListBuilder.Append(TheObject.ObjectInJson);

  if (TheCounter != TheList.Count())
  {
    TheListBuilder.Append("","");
  }
}
TheListBuilder.Append(""]"");

return TheListBuilder.ToString();
</code></pre>

<p>I wonder if I can replace this sort of dangerous code with <code>JavascriptSerializer</code> and get the same results.
How would I do this?</p>

<p>Thanks.</p>
","<pre><code>// you need to reference System.Web.Extensions

using System.Web.Script.Serialization;

var jsonSerialiser = new JavaScriptSerializer();
var json = jsonSerialiser.Serialize(aList);
</code></pre>

<hr>

<p><strong>Please Note:</strong></p>

<p>Times have changed, I would default to using JSON.Net as my first choice JSON Parser. If its the right choice for WebAPI, its the right choice for me.</p>

<p>e.g.</p>

<pre><code>using Newtonsoft.Json;

var json = JsonConvert.SerializeObject(aList);
</code></pre>

<p>you may need to install the package first.</p>

<pre><code>PM&gt; Install-Package Newtonsoft.Json
</code></pre>

<p>For more details <a href=""https://stackoverflow.com/a/15239542/659190"">see and upvote the answer that is the source of this information</a>.</p>
","9110986"
"How do I get today's date in C# in mm/dd/yyyy format?","244279","","<p>How do I get today's date in C# in mm/dd/yyyy format?</p>

<p>I need to set a string variable to today's date (preferably without the year), but there's got to be a better way than building it month-/-day one piece at a time.</p>

<p>BTW: I'm in the US so M/dd would be correct, e.g. September 11th is 9/11.</p>

<p><em>Note: an answer from kronoz came in that discussed internationalization, and I thought it was awesome enough to mention since I can't make it an 'accepted' answer as well.</em></p>

<p><a href=""https://stackoverflow.com/questions/32747/how-do-i-get-todays-date-in-c-in-8282008-format#32819"" title=""kronoz&#39;s answer"">kronoz's answer</a></p>
","<pre><code>DateTime.Now.ToString(""M/d/yyyy"");
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx</a></p>
","32749"
"Conversion of a datetime2 data type to a datetime data type results out-of-range value","244187","","<p>I've got a datatable with 5 columns, where a row is being filled with data then saved to the database via a transaction.</p>

<p>While saving, an error is returned:</p>

<blockquote>
  <p>The conversion of a datetime2 data type to a datetime data type resulted in an out-of-range value</p>
</blockquote>

<p>It implies, as read, that my datatable has a type of <code>DateTime2</code> and my database a <code>DateTime</code>; that is wrong.</p>

<p>The date column is set to a <code>DateTime</code> like this: </p>

<p><code>new DataColumn(""myDate"", Type.GetType(""System.DateTime""))</code></p>

<p><strong>Question</strong></p>

<p>Can this be solved in code or does something have to be changed on a database level?</p>
","<p>What kind of dates do you have in the column?</p>

<p>Do all of them fit within the range of the type?</p>

<hr>

<p>As an aside, the correct way to get a <code>Type</code> object for the <code>DataColumn</code> constructor is the <code>typeof</code> keyword, which is orders of magnitude faster.</p>

<p>Therefore, to create the column, you should write</p>

<pre><code>new DataColumn(""myDate"", typeof(DateTime))
</code></pre>
","1331820"
"What represents a double in sql server?","244120","","<p>I have a couple of properties in <code>C#</code> which are <code>double</code> and I want to store these in a table in SQL Server, but noticed there is no <code>double</code> type, so what is best to use, <code>decimal</code> or <code>float</code>?</p>

<p>This will store latitude and longitude values, so I need the most accurate precision.</p>

<p>Thanks for the responses so far.</p>
","<pre><code>float
</code></pre>

<p>Or if you want to go old-school:</p>

<pre><code>real
</code></pre>

<p>You can also use float(53), but it means the same thing as float.</p>

<p>(""real"" is equivalent to float(24), not float/float(53).)</p>

<p>The <strong>decimal(x,y)</strong> SQL Server type is for when you want <em>exact</em> decimal numbers rather than floating point (which can be approximations). This is in contrast to the C# ""decimal"" data type, which is more like a 128-bit floating point number.</p>

<p>MSSQL <strong>float</strong> does not have <em>exactly</em> the same precision as the 64-bit <strong>double</strong> type in .NET (slight difference in mantissa IIRC), but it's a close enough match most uses.</p>

<p>To make things more confusing, a ""float"" in C# is only 32-bit, so it would be more equivalent in SQL to the real/float(24) type in MSSQL than float/float(53).</p>

<p><strong>In your specific use case...</strong>
All you need is 5 places after the decimal point to represent latitude and longitude within about one-meter precision, and you only need up to three digits before the decimal point for the degrees. Float(24) or decimal(8,5) will best fit your needs in MSSQL, and using float in C# is good enough, you don't need double. In fact, your users will probably thank you for rounding to 5 decimal places rather than having a bunch of insignificant digits coming along for the ride.</p>
","1209190"
"Implementing INotifyPropertyChanged - does a better way exist?","243805","","<p>Microsoft should have implemented something snappy for <code>INotifyPropertyChanged</code>, like in the automatic properties, just specify <code>{get; set; notify;}</code>
I think it makes a lot of sense to do it. Or are there any complications to do it? </p>

<p>Can we ourselves implement something like 'notify' in our properties. Is there a graceful solution for implementing <strong><code>INotifyPropertyChanged</code></strong> in your class or the only way to do it is by raising the <code>PropertyChanged</code> event in each property.</p>

<p>If not can we write something to auto-generate the piece of code to raise <code>PropertyChanged</code>  event?</p>
","<p>Without using something like postsharp, the minimal version I use uses something like:</p>

<pre><code>public class Data : INotifyPropertyChanged
{
    // boiler-plate
    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }
    protected bool SetField&lt;T&gt;(ref T field, T value, string propertyName)
    {
        if (EqualityComparer&lt;T&gt;.Default.Equals(field, value)) return false;
        field = value;
        OnPropertyChanged(propertyName);
        return true;
    }

    // props
    private string name;
    public string Name
    {
        get { return name; }
        set { SetField(ref name, value, ""Name""); }
    }
}
</code></pre>

<p>Each property is then just something like:</p>

<pre><code>    private string name;
    public string Name
    {
        get { return name; }
        set { SetField(ref name, value, ""Name""); }
    }
</code></pre>

<p>which isn't huge; it can also be used as a base-class if you want. The <code>bool</code> return from <code>SetField</code> tells you if it was a no-op, in case you want to apply other logic.</p>

<hr>

<p>or even easier with C# 5:</p>

<pre><code>protected bool SetField&lt;T&gt;(ref T field, T value,
    [CallerMemberName] string propertyName = null)
{...}
</code></pre>

<p>which can be called like this:</p>

<pre><code>set { SetField(ref name, value); }
</code></pre>

<p>with which the compiler will add the <code>""Name""</code> automatically.</p>

<hr>

<p>C# 6.0 makes the implementation easier:</p>

<pre><code>protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
{
    PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
}
</code></pre>

<p>-- </p>

<p>can even be made more simple:</p>

<pre><code>private string name;
public string Name
{
    get =&gt; name;
    set { SetField(ref name, value, nameof(Name)); }
}
</code></pre>
","1316417"
"Declare a const array","243631","","<p>Is it possible to write something similar to the following?</p>

<pre><code>public const string[] Titles = {""German"", ""Spanish"", ""Corrects"", ""Wrongs""};
</code></pre>
","<p>Yes, but you need to declare it <code>readonly</code> instead of <code>const</code>:</p>

<pre><code>public static readonly string[] Titles = { ""German"", ""Spanish"", ""Corrects"", ""Wrongs"" };
</code></pre>

<p>The reason is that <code>const</code> can only be applied to a field whose value is known at compile-time. The array initializer you've shown is not a constant expression in C#, so it produces a compiler error.</p>

<p>Declaring it <code>readonly</code> solves that problem because the value is not initialized until run-time (although it's guaranteed to have initialized before the first time that the array is used).</p>

<p>Depending on what it is that you ultimately want to achieve, you might also consider declaring an enum:</p>

<pre><code>public enum Titles { German, Spanish, Corrects, Wrongs };
</code></pre>
","5142378"
"Create Generic method constraining T to an Enum","243205","","<p>I'm building a function to extend the Enum.Parse concept that</p>

<ul>
<li>Allows a default value to be parsed in case that an Enum value is not found</li>
<li>Is case insensitive</li>
</ul>

<p>So I wrote the following:</p>

<pre><code>public static T GetEnumFromString&lt;T&gt;(string value, T defaultValue) where T : Enum
{
    if (string.IsNullOrEmpty(value)) return defaultValue;
    foreach (T item in Enum.GetValues(typeof(T)))
    {
        if (item.ToString().ToLower().Equals(value.Trim().ToLower())) return item;
    }
    return defaultValue;
}
</code></pre>

<p>I am getting a Error Constraint cannot be special class 'System.Enum'.</p>

<p>Fair enough, but is there a workaround to allow a Generic Enum, or am I going to have to mimic the Parse function and pass a type as an attribute, which forces the ugly boxing requirement to your code.</p>

<p><strong>EDIT</strong> All suggestions below have been greatly appreciated, thanks.</p>

<p>Have settled on (I've left the loop to maintain case insensitivity - I am usng this when parsing XML)</p>

<pre><code>public static class EnumUtils
{
    public static T ParseEnum&lt;T&gt;(string value, T defaultValue) where T : struct, IConvertible
    {
        if (!typeof(T).IsEnum) throw new ArgumentException(""T must be an enumerated type"");
        if (string.IsNullOrEmpty(value)) return defaultValue;

        foreach (T item in Enum.GetValues(typeof(T)))
        {
            if (item.ToString().ToLower().Equals(value.Trim().ToLower())) return item;
        }
        return defaultValue;
    }
}
</code></pre>

<p><strong>EDIT:</strong> (16th Feb 2015) Julien Lebosquain has recently posted <a href=""https://stackoverflow.com/a/8086788"">a compiler enforced type-safe generic solution in MSIL or F#</a> below, which is well worth a look, and an upvote. I will remove this edit if the solution bubbles further up the page.</p>
","<p>Since <code>Enum</code> Type implements <code>IConvertible</code> interface, a better implementation should be something like this:</p>

<pre><code>public T GetEnumFromString&lt;T&gt;(string value) where T : struct, IConvertible
{
   if (!typeof(T).IsEnum) 
   {
      throw new ArgumentException(""T must be an enumerated type"");
   }

   //...
}
</code></pre>

<p>This will still permit passing of value types implementing <code>IConvertible</code>. The chances are rare though.</p>
","79903"
"Searching if value exists in a list of objects using Linq","242778","","<p>Say I have a class Customer which has a property FirstName. Then I have a List.</p>

<p>Can LINQ be used to find if the list has a customer with Firstname = 'John' in a single statement.. how?</p>
","<p>LINQ defines an extension method that is perfect for solving this exact problem:</p>

<pre><code>using System.Linq;
...
    bool has = list.Any(cus =&gt; cus.FirstName == ""John"");
</code></pre>

<p>make sure you reference System.Core.dll, that's where LINQ lives.</p>
","1071045"
"How To Accept a File POST","242589","","<p>I'm using asp.net mvc 4 webapi beta to build a rest service.  I need to be able to accept POSTed images/files from client applications.  Is this possible using the webapi?  Below is how action I am currently using.  Does anyone know of an example how this should work?</p>

<pre><code>[HttpPost]
public string ProfileImagePost(HttpPostedFile profileImage)
{
    string[] extensions = { "".jpg"", "".jpeg"", "".gif"", "".bmp"", "".png"" };
    if (!extensions.Any(x =&gt; x.Equals(Path.GetExtension(profileImage.FileName.ToLower()), StringComparison.OrdinalIgnoreCase)))
    {
        throw new HttpResponseException(""Invalid file type."", HttpStatusCode.BadRequest);
    }

    // Other code goes here

    return ""/path/to/image.png"";
}
</code></pre>
","<p>see <a href=""http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2"" rel=""noreferrer"">http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2</a>, although I think the article makes it seem a bit more complicated than it really is.</p>

<p>Basically, </p>

<pre><code>public Task&lt;HttpResponseMessage&gt; PostFile() 
{ 
    HttpRequestMessage request = this.Request; 
    if (!request.Content.IsMimeMultipartContent()) 
    { 
        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType); 
    } 

    string root = System.Web.HttpContext.Current.Server.MapPath(""~/App_Data/uploads""); 
    var provider = new MultipartFormDataStreamProvider(root); 

    var task = request.Content.ReadAsMultipartAsync(provider). 
        ContinueWith&lt;HttpResponseMessage&gt;(o =&gt; 
    { 

        string file1 = provider.BodyPartFileNames.First().Value;
        // this is the file name on the server where the file was saved 

        return new HttpResponseMessage() 
        { 
            Content = new StringContent(""File uploaded."") 
        }; 
    } 
    ); 
    return task; 
} 
</code></pre>
","10327789"
"The type initializer for 'MyClass' threw an exception","242571","","<p>The following is my Windows service code. When I am debugging the code, I am getting the error/ exception:</p>

<blockquote>
  <p>The type initializer for 'CSMessageUtility.CSDetails' threw an exception.</p>
</blockquote>

<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Linq;
using System.ServiceProcess;
using System.Text;
using System.IO;
using System.Threading;
using System.Windows;
using System.Windows.Forms;
using CSMessageUtility;

namespace CS_Data_Trasmmiting_Service
{
    public partial class svcCSWinServ : ServiceBase
    {
        //private string sLogFormat;
        //private string sErrorTime;
        private Thread new_thread;
        Logger logObject = new Logger();
        private bool isenable = true;

        public svcCSWinServ()
        {
            InitializeComponent();
            logObject.append(""Initialize Service "" + DateTime.Now.ToString(), 70);
            CheckForAlarms();
        }

        protected override void OnStart(string[] args)
        {
            try
            {
                new_thread = new Thread(new ThreadStart(CheckForAlarms));
                new_thread.Start();
            }
            catch
            {
            }

            logObject.append(""Service Started successfully "" + DateTime.Now.ToString(), 70);
        }

        protected override void OnStop()
        {
            try
            {
                isenable = false;
                new_thread.Abort();
            }
            catch
            {

            }
            logObject.append(""Service Stopped successfully "" + DateTime.Now.ToString(), 70);
        }


        void CheckForAlarms()
        {
            try
            {
                while (true)
                {
                    //if((DateTime.Now.ToString(""HH:mm"") == ""18:00""))
                    //{

                        logObject.append(""Start Sending Data "" +DateTime.Now.ToString(), 70);
                        try
                        {
                            //SendAllInfo();
                            string str = CSMessageUtility.CSDetails.createDHSMessageFormat();
                            Thread.Sleep(2000);
                            string str1 = CSMessageUtility.CSDetails.createEALMessageFormat();
                            Thread.Sleep(2000);
                            string str2 = CSMessageUtility.CSDetails.createProductStatusMessageForamt();
                            Thread.Sleep(2000);
                            string str3 = CSMessageUtility.CSDetails.createEODMessageFormat();
                            Thread.Sleep(2000);
                            string str4 = CSDetails.createProductReceiptEntryatBOSMessageFormat();
                            Thread.Sleep(2000);
                            string str5 = CSMessageUtility.CSDetails.createProductSaleMessageFormat();
                            Thread.Sleep(2000);
                            string str6 = CSMessageUtility.CSDetails.createTotalizerExceptionMessageFormat();
                            Thread.Sleep(2000);
                            //CSMessageUtility.CSDetails.createDailyCOtransferMessageFormat();
                            //Thread.Sleep(2000);

                        }
                        catch (Exception ee)
                        {
                            logObject.append(ee.Message, 70);
                        }
                        logObject.append(""Finished Sending Data "" +DateTime.Now.ToString(), 70);
                        Thread.Sleep(3000);
                    //}
                    //Thread.Sleep(20000);
                }
            }
            catch (Exception ex)
            {
                logObject.append(""Thread Exception: ""+ ex.Message + "" ""+ DateTime.Now.ToString(), 70);

                try
                {
                    new_thread.Abort();
                }
                catch (Exception ex1)
                {
                    logObject.append(""Thread Exception: "" +ex1.Message + "" "" + DateTime.Now.ToString(), 70);
                }

                if (isenable == true)
                {
                    new_thread = new Thread(new ThreadStart(CheckForAlarms));
                    new_thread.Start();
                }
            }
        }
    }
}
</code></pre>
","<p>Check the <code>InnerException</code> property of the <code>TypeInitializationException</code>; it is likely to contain information about the underlying problem, and exactly where it occurred.</p>
","4398380"
"Setting dropdownlist selecteditem programmatically","241882","","<p>I want to set the <code>selecteditem</code> attribute for an ASP.Net dropdownlist control programmatically.</p>

<p>So I want to pass a value to the dropdownlist control to set the selected item where the item is equal to the passed value.</p>
","<p>Assuming the list is already data bound you can simply set the <code>SelectedValue</code> property on your dropdown list.</p>

<pre><code>list.DataSource = GetListItems(); // &lt;-- Get your data from somewhere.
list.DataValueField = ""ValueProperty"";
list.DataTextField = ""TextProperty"";
list.DataBind();

list.SelectedValue = myValue.ToString();
</code></pre>

<p>The value of the <code>myValue</code> variable would need to exist in the property specified within the <code>DataValueField</code> in your controls databinding.</p>

<p><strong>UPDATE</strong>:
If the value of <code>myValue</code> doesn't exist as a value with the dropdown list options it will default to select the first option in the dropdown list.</p>
","3496495"
"Call ASP.NET function from JavaScript?","241622","","<p>I'm writing a web page in ASP.NET. I have some JavaScript code, and I have a submit button with a click event.</p>

<p>Is it possible to call a method I created in ASP with JavaScript's click event?</p>
","<p>Well, if you don't want to do it using Ajax or any other way and just want a normal ASP.NET postback to happen, here is how you do it (without using any other libraries):</p>

<p><em>It is a little tricky though... :)</em></p>

<p>i. In your code file (assuming you are using C# and .NET 2.0 or later) add the following Interface to your Page class to make it look like</p>

<pre><code>public partial class Default : System.Web.UI.Page, IPostBackEventHandler{}
</code></pre>

<p>ii. This should add (using <kbd>Tab</kbd>-<kbd>Tab</kbd>) this function to your code file:</p>

<pre><code>public void RaisePostBackEvent(string eventArgument) { }
</code></pre>

<p>iii. In your onclick event in JavaScript, write the following code:</p>

<pre><code>var pageId = '&lt;%=  Page.ClientID %&gt;';
__doPostBack(pageId, argumentString);
</code></pre>

<p>This will call the 'RaisePostBackEvent' method in your code file with the 'eventArgument' as the 'argumentString' you passed from the JavaScript. Now, you can call any other event you like.</p>

<p>P.S: That is 'underscore-underscore-doPostBack' ... And, there should be no space in that sequence... Somehow the WMD does not allow me to write to underscores followed by a character!</p>
","3777"
"How to exit a WPF app programmatically?","241506","","<p>In the few years I've been using C# (WinForms), I've never used WPF. But, now I love WPF, but I don't know how I am supposed to exit my application when the user clicks on the Exit menu item from the File menu.</p>

<p>I have tried:</p>

<pre><code>this.Dispose();
this.Exit();
Application.ShutDown();
Application.Exit();
Application.Dispose();
</code></pre>

<p>Among many others. Nothing works.</p>
","<p>To exit your application you can call </p>

<pre><code>System.Windows.Application.Current.Shutdown();
</code></pre>

<p>As described in the documentation to the <a href=""http://msdn.microsoft.com/en-us/library/ms597013.aspx"" rel=""noreferrer""><code>Application.Shutdown</code></a> method you can also modify the shutdown behavior of your application by specifying a <a href=""http://msdn.microsoft.com/en-us/library/system.windows.application.shutdownmode.aspx"" rel=""noreferrer"">ShutdownMode</a>:</p>

<blockquote>
  <p>Shutdown  is implicitly called by Windows Presentation Foundation (WPF) in the following situations:</p>
  
  <ul>
  <li>When ShutdownMode is set to OnLastWindowClose.</li>
  <li>When the ShutdownMode is set to OnMainWindowClose.</li>
  <li>When a user ends a session and the SessionEnding event is either unhandled, or handled without cancellation.</li>
  </ul>
</blockquote>

<p>Please also note that <code>Application.Current.Shutdown();</code> may only be called from the thread that created the <code>Application</code> object, i.e. normally the main thread.</p>
","2820377"
"Which Radio button in the group is checked?","241009","","<p>Using WinForms; Is there a better way to find the checked RadioButton for a group? It seems to me that the code below should not be necessary. When you check a different RadioButton then it knows which one to uncheck… so it should know which is checked. How do I pull that information without doing a lot of if statements (or a switch).</p>

<pre><code>     RadioButton rb = null;

     if (m_RadioButton1.Checked == true)
     {
        rb = m_RadioButton1;
     }
     else if (m_RadioButton2.Checked == true)
     {
        rb = m_RadioButton2;
     }
     else if (m_RadioButton3.Checked == true)
     {
        rb = m_RadioButton3;
     }
</code></pre>
","<p>You could use LINQ:</p>

<pre><code>var checkedButton = container.Controls.OfType&lt;RadioButton&gt;()
                                      .FirstOrDefault(r =&gt; r.Checked);
</code></pre>

<p>Note that this requires that all of the radio buttons be directly in the same container (eg, Panel or Form), and that there is only one group in the container.  If that is not the case, you could make <code>List&lt;RadioButton&gt;</code>s in your constructor for each group, then write <code>list.FirstOrDefault(r =&gt; r.Checked)</code>.</p>
","1797955"
"Getting data from selected datagridview row and which event?","241001","","<p>I have a DataGridView (Selectionmode: FullRowSelect) on a windows form along with some textboxes, so what i want to do is that whenever a user selects a row(click or double_click maybe), the contents of that row must be displayed in the text boxes,</p>

<p>i tried out this codes </p>

<pre><code>private void dataGridView1_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
{
    MessageBox.Show(""CEll Double_Click event calls"");
    int rowIndex = e.RowIndex;
    DataGridViewRow row = dataGridView1.Rows[rowIndex];
    textBox5.Text = row.Cells[1].Value;
}

private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
    int rowIndex = e.RowIndex;
    DataGridViewRow row = dataGridView1.Rows[rowIndex];
    textBox5.Text = dataGridView1.Rows[1].Cells[1].Value.ToString();// row.Cells[1].Value;
}
</code></pre>

<p>there are many other textboxes, but the main problem is that none of the event seems to be triggered, what event should i use to do so, or is there some property of datagrid that i might have set wrong?
Any help would be appreciated...:(</p>
","<p>You can use SelectionChanged event since you are using FullRowSelect selection mode. Than inside the handler you can access SelectedRows property and get data from it. Example:</p>

<pre><code>private void dataGridView_SelectionChanged(object sender, EventArgs e) 
{
    foreach (DataGridViewRow row in dataGridView.SelectedRows) 
    {
        string value1 = row.Cells[0].Value.ToString();
        string value2 = row.Cells[1].Value.ToString();
        //...
    }
}
</code></pre>

<p>You can also walk through the column collection instead of typing indexes...</p>
","11293450"
"Simple proof that GUID is not unique","240865","","<p>I'd like to prove that a GUID is not unique in a simple test program.
I expected the following code to run for hours, but it's not working. How can I make it work?</p>

<pre><code>BigInteger begin = new BigInteger((long)0);
BigInteger end = new BigInteger(""340282366920938463463374607431768211456"",10);  //2^128
for(begin; begin&lt;end; begin++)
  Console.WriteLine(System.Guid.NewGuid().ToString());
</code></pre>

<p>I'm using C#.</p>
","<p>Kai, I have provided a program that will do what you want using threads. It is licensed under the following terms: you must pay me $0.0001 per hour per CPU core you run it on. Fees are payable at the end of each calendar month. Please contact me for my paypal account details at your earliest convenience.</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;

namespace GuidCollisionDetector
{
    class Program
    {
        static void Main(string[] args)
        {
            //var reserveSomeRam = new byte[1024 * 1024 * 100];     // This indeed has no effect.

            Console.WriteLine(""{0:u} - Building a bigHeapOGuids."", DateTime.Now);
            // Fill up memory with guids.
            var bigHeapOGuids = new HashSet&lt;Guid&gt;();
            try
            {
                do
                {
                    bigHeapOGuids.Add(Guid.NewGuid());
                } while (true);
            }
            catch (OutOfMemoryException)
            {
                // Release the ram we allocated up front.
                // Actually, these are pointless too.
                //GC.KeepAlive(reserveSomeRam);
                //GC.Collect();
            }
            Console.WriteLine(""{0:u} - Built bigHeapOGuids, contains {1} of them."", DateTime.Now, bigHeapOGuids.LongCount());


            // Spool up some threads to keep checking if there's a match.
            // Keep running until the heat death of the universe.
            for (long k = 0; k &lt; Int64.MaxValue; k++)
            {
                for (long j = 0; j &lt; Int64.MaxValue; j++)
                {
                    Console.WriteLine(""{0:u} - Looking for collisions with {1} thread(s)...."", DateTime.Now, Environment.ProcessorCount);
                    System.Threading.Tasks.Parallel.For(0, Int32.MaxValue, (i) =&gt;
                    {
                        if (bigHeapOGuids.Contains(Guid.NewGuid()))
                            throw new ApplicationException(""Guids collided! Oh my gosh!"");
                    }
                    );
                    Console.WriteLine(""{0:u} - That was another {1} attempts without a collision."", DateTime.Now, ((long)Int32.MaxValue) * Environment.ProcessorCount);
                }
            }
            Console.WriteLine(""Umm... why hasn't the universe ended yet?"");
        }
    }
}
</code></pre>

<p>PS: I wanted to try out the Parallel extensions library. That was easy.</p>

<p>And using OutOfMemoryException as control flow just feels wrong.</p>

<p><strong>EDIT</strong></p>

<p>Well, it seems this still attracts votes. So I've fixed the GC.KeepAlive() issue. And changed it to run with C# 4.</p>

<p>And to clarify my support terms: support is only available on the 28/Feb/2010. Please use a time machine to make support requests on that day only.</p>

<p><strong>EDIT 2</strong>
As always, the GC does a better job than I do at managing memory; any previous attempts at doing it myself were doomed to failure.</p>
","1705604"
"Executing Batch File in C#","240626","","<p>I'm trying to execute a batch file in C# but I'm not getting any luck doing it.</p>

<p>I've found multiple examples on the internet doing it but it is not working for me.</p>

<pre><code>public void ExecuteCommand(string command)
{
    int ExitCode;
    ProcessStartInfo ProcessInfo;
    Process Process;

    ProcessInfo = new ProcessStartInfo(""cmd.exe"", ""/c "" + command);
    ProcessInfo.CreateNoWindow = true;
    ProcessInfo.UseShellExecute = false;

    Process = Process.Start(ProcessInfo);
    Process.WaitForExit();

    ExitCode = Process.ExitCode;
    Process.Close();

    MessageBox.Show(""ExitCode: "" + ExitCode.ToString(), ""ExecuteCommand"");
}
</code></pre>

<p>The command string contains the name of the batch file (stored in system32) and some files it should manipulate. (Example: txtmanipulator file1.txt file2.txt file3.txt) When I execute the batch file manually it works correctly.</p>

<p>When executing the code it gives me an <strong>ExitCode: 1</strong> (Catch all for general errors)</p>

<p>What am I doing wrong?</p>
","<p>This should work. You could try to dump out the contents of the output and error streams in order to find out what's happening:</p>

<pre><code>static void ExecuteCommand(string command)
{
    int exitCode;
    ProcessStartInfo processInfo;
    Process process;

    processInfo = new ProcessStartInfo(""cmd.exe"", ""/c "" + command);
    processInfo.CreateNoWindow = true;
    processInfo.UseShellExecute = false;
    // *** Redirect the output ***
    processInfo.RedirectStandardError = true;
    processInfo.RedirectStandardOutput = true;

    process = Process.Start(processInfo);
    process.WaitForExit();

    // *** Read the streams ***
    // Warning: This approach can lead to deadlocks, see Edit #2
    string output = process.StandardOutput.ReadToEnd();
    string error = process.StandardError.ReadToEnd();

    exitCode = process.ExitCode;

    Console.WriteLine(""output&gt;&gt;"" + (String.IsNullOrEmpty(output) ? ""(none)"" : output));
    Console.WriteLine(""error&gt;&gt;"" + (String.IsNullOrEmpty(error) ? ""(none)"" : error));
    Console.WriteLine(""ExitCode: "" + exitCode.ToString(), ""ExecuteCommand"");
    process.Close();
}

static void Main()
{
    ExecuteCommand(""echo testing"");
}   
</code></pre>

<p><strong>* EDIT *</strong> </p>

<p>Given the extra information in your comment below I was able to recreate the problem. There seems to be some security setting that results in this behaviour (haven't investigated that in detail). </p>

<p>This <em>does</em> work if the bat file is not located in c:\windows\system32. Try moving it to some other location, e.g. the location of your executable. Note that keeping custom bat files or executables in the Windows directory is bad practice anyway.</p>

<p><strong>* EDIT 2 *</strong>
It <a href=""https://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput%28v=vs.110%29.aspx"">turns out</a> that if the streams are read synchronously, a deadlock can occur, either by reading synchronously before <code>WaitForExit</code> or by reading both stderr and stdout synchronously one after the other. </p>

<p>This should not happen if using the asynchronous read methods instead, as in the following example:</p>

<pre><code>static void ExecuteCommand(string command)
{
    var processInfo = new ProcessStartInfo(""cmd.exe"", ""/c "" + command);
    processInfo.CreateNoWindow = true;
    processInfo.UseShellExecute = false;
    processInfo.RedirectStandardError = true;
    processInfo.RedirectStandardOutput = true;

    var process = Process.Start(processInfo);

    process.OutputDataReceived += (object sender, DataReceivedEventArgs e) =&gt;
        Console.WriteLine(""output&gt;&gt;"" + e.Data);
    process.BeginOutputReadLine();

    process.ErrorDataReceived += (object sender, DataReceivedEventArgs e) =&gt;
        Console.WriteLine(""error&gt;&gt;"" + e.Data);
    process.BeginErrorReadLine();

    process.WaitForExit();

    Console.WriteLine(""ExitCode: {0}"", process.ExitCode);
    process.Close();
}
</code></pre>
","5519517"
"C# if/then directives for debug vs release","239912","","<p>In Solution properties, I have Configuration set to ""release"" for my one and only project. </p>

<p>At the beginning of the main routine, I have this code, and it is showing ""Mode=Debug"". 
I also have these two lines at the very top: </p>

<pre><code>#define DEBUG 
#define RELEASE
</code></pre>

<p>Am I testing the right variable? </p>

<pre><code>#if (DEBUG)
            Console.WriteLine(""Mode=Debug""); 
#elif (RELEASE)
            Console.WriteLine(""Mode=Release""); 
#endif
</code></pre>

<p>My goal is to set different defaults for variables based on debug vs release mode. </p>
","<p>Remove the <code>#define DEBUG</code> in your code. Set preprocessors in the build configuration for that specific build (DEBUG/_DEBUG should be defined in VS already).</p>

<p>The reason it prints ""Mode=Debug"" is because of your <code>#define</code> and then skips the <code>elif</code>.</p>

<p>Also, the right way to check is:</p>

<pre><code>#if DEBUG
    Console.WriteLine(""Mode=Debug""); 
#else
    Console.WriteLine(""Mode=Release""); 
#endif
</code></pre>

<p>Don't check for RELEASE</p>
","2104128"
"Copy rows from one Datatable to another DataTable?","239907","","<p>How can I copy specific rows from DataTable to another Datable in c#? There will be more than one row.</p>
","<pre><code>foreach (DataRow dr in dataTable1.Rows) {
    if (/* some condition */)
        dataTable2.Rows.Add(dr.ItemArray);
}
</code></pre>

<p>The above example assumes that <code>dataTable1</code> and <code>dataTable2</code> have the same number, type and order of columns.</p>
","4020284"
"Validate a DateTime in C#","239518","","<p>I doubt I am the only one who has come up with this solution, but if you have a better one please post it here. I simply want to leave this question here so I and others can search it later. </p>

<p>I needed to tell whether a valid date had been entered into a text box and this is the code that I came up with. I fire this when focus leaves the text box.</p>

<pre><code>try
{
    DateTime.Parse(startDateTextBox.Text);
}
catch
{
    startDateTextBox.Text = DateTime.Today.ToShortDateString();
}
</code></pre>
","<pre><code>DateTime.TryParse
</code></pre>

<p>This I believe is faster and it means you dont have to use ugly try/catches :)</p>

<p>e.g</p>

<pre><code>DateTime temp;
if(DateTime.TryParse(startDateTextBox.Text, out temp))
//yay
else
// :(
</code></pre>
","371993"
"How to write a simple Html.DropDownListFor()?","238729","","<p>In ASP.NET MVC 2, I'd like to write a very simple dropdown list which gives static options. For example I'd like to provide choices between ""Red"", ""Blue"", and ""Green"".</p>
","<p>See <a href=""http://msdn.microsoft.com/en-us/library/ee703573.aspx"" rel=""noreferrer"">this MSDN article</a> and an <a href=""https://stackoverflow.com/questions/1916462/dropdownlistfor-in-editortemplate-not-selecting-value"">example usage here on Stack Overflow</a>.</p>

<p>Let's say that you have the following Linq/POCO class:</p>

<pre><code>public class Color
{
    public int ColorId { get; set; }
    public string Name { get; set; }
}
</code></pre>

<p>And let's say that you have the following model:</p>

<pre><code>public class PageModel 
{
   public int MyColorId { get; set; }
}
</code></pre>

<p>And, finally, let's say that you have the following list of colors. They could come from a Linq query, from a static list, etc.:</p>

<pre><code>public static IEnumerable&lt;Color&gt; Colors = new List&lt;Color&gt; { 
    new Color {
        ColorId = 1,
        Name = ""Red""
    },
    new Color {
        ColorId = 2,
        Name = ""Blue""
    }
};
</code></pre>

<p>In your view, you can create a drop down list like so:</p>

<pre><code>&lt;%= Html.DropDownListFor(n =&gt; n.MyColorId, 
                         new SelectList(Colors, ""ColorId"", ""Name"")) %&gt;
</code></pre>
","3057931"
"How do you modify style in the code behind file for divs in ASP.net?","238572","","<p>Currently I am trying to modify a css style attribute for a div based on the information I get from a database table in the code behind of my aspx page.  In simplified form the following is essentially what I am trying to do but I get errors.</p>

<p>Here is my code:</p>

<p>ASPX:</p>

<pre><code>&lt;div id=""testSpace"" runat=""server""&gt;
    Test
&lt;/div&gt;
</code></pre>

<p>CODE BEHIND:</p>

<pre><code>testSpace.Style = ""display:none;""    
testSpace.Style(""display"") = ""none"";
</code></pre>

<p>Any help would be appreciated.  Thanks!</p>
","<pre><code>testSpace.Style.Add(""display"", ""none"");
</code></pre>
","657165"
"How do I split a string by a multi-character delimiter in C#?","237977","","<p>What if I want to split a string using a delimiter that is a word?</p>

<p>For example, <code>This is a sentence</code>.</p>

<p>I want to split on <code>is</code> and get <code>This</code> and <code>a sentence</code>.</p>

<p>In <code>Java</code>, I can send in a string as a delimiter, but how do I accomplish this in <code>C#</code>?</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/system.string.split.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.string.split.aspx</a></p>

<p>Example from the docs:</p>

<pre><code>string source = ""[stop]ONE[stop][stop]TWO[stop][stop][stop]THREE[stop][stop]"";
string[] stringSeparators = new string[] {""[stop]""};
string[] result;

// ...
result = source.Split(stringSeparators, StringSplitOptions.None);

foreach (string s in result)
{
    Console.Write(""'{0}' "", String.IsNullOrEmpty(s) ? ""&lt;&gt;"" : s);
}
</code></pre>
","1126933"
"Getting the thread ID from a thread","237154","","<p>In C# when debugging threads for example, you can see each thread's ID.</p>

<p>I couldn't find a way to get that same thread, programmatically. I could not even get the ID of the current thread (in the properties of the <code>Thread.currentThread</code>).</p>

<p>So, I wonder how does Visual Studio get the IDs of the threads, and is there a way to get the handle of the thread with id <code>2345</code>, for example?</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/ms683233(VS.85).aspx"" rel=""noreferrer""><code>GetThreadId</code></a> returns the ID of a given native thread. There are ways to make it work with managed threads, I'm sure, all you need to find is the thread handle and pass it to that function.</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/ms683183(VS.85).aspx"" rel=""noreferrer""><code>GetCurrentThreadId</code></a> returns the ID of the current thread. </p>

<p><code>GetCurrentThreadId</code> has been deprecated as of .NET 2.0: the recommended way is the <a href=""http://msdn.microsoft.com/en-us/library/system.threading.thread.managedthreadid.aspx"" rel=""noreferrer""><code>Thread.CurrentThread.ManagedThreadId</code></a> property.</p>
","1679269"
"Get selected value from combo box in c# wpf","236167","","<p>i think this might be a stupid question but I can't find it on the internet. </p>

<p>I have just started using WPF forms instead of WF forms. In a WF form I could just do:</p>

<pre><code>ComboBox.SelectedValue.toString();
</code></pre>

<p>and this would work fine. </p>

<p>How do I do this in WPF it doesn't seem to have the option. </p>

<p>Thanks</p>
","<p>I have figured it out a bit of strange way of doing it compared to the old WF forms:</p>

<pre><code>ComboBoxItem typeItem = (ComboBoxItem)cboType.SelectedItem;
string value = typeItem.Content.ToString();
</code></pre>
","4354705"
"ASP.NET Web Application Message Box","235590","","<p>In an asp.net windows forms application, in the C# code behind you can use: </p>

<pre><code>MessageBox.Show(""Here is my message"");
</code></pre>

<p>Is there any equivalent in a asp.net web application?
Can I call something from the C# code behind that will display a message box to the user?</p>

<p>Example usage of this:  I have a button that loads a file in the code behind.  When the file is loaded or if there is an error I would like to popup a message to the user stating the result.</p>

<p>Any ideas on this?</p>
","<p>You want to use an Alert. Unfortunately it's not as nice as with windows forms.</p>

<pre><code>ClientScript.RegisterStartupScript(this.GetType(), ""myalert"", ""alert('"" + myStringVariable + ""');"", true);
</code></pre>

<p>Similar to this question here:  <a href=""http://forums.asp.net/t/1461308.aspx/1"" rel=""noreferrer"">http://forums.asp.net/t/1461308.aspx/1</a></p>
","9720205"
"C# getting the path of %AppData%","235530","","<p>C# 2008 SP1</p>

<p>I am using the code below:</p>

<pre><code>dt.ReadXml(""%AppData%\\DateLinks.xml"");
</code></pre>

<p>However, I am getting an exception that points to the location of where my application is running from:</p>

<blockquote>
  <p>Could not find a part of the path
  'D:\Projects\SubVersionProjects\CatDialer\bin\Debug\%AppData%\DateLinks.xml'.</p>
</blockquote>

<p>I thought the <code>%AppData%</code> should find the relative path. When I go <code>Start|Run|%AppData%</code> windows explorer takes me to that directory.</p>

<p>I can not put the full path in, as the user is different on each client machine.</p>

<p>Many thanks for any advice,</p>
","<p>To get the <em>AppData</em> directory, it's best to use the <code>GetFolderPath</code> method:</p>

<pre><code>Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)
</code></pre>

<p><code>%AppData%</code> is an environment variable, and they are not automatically expanded anywhere in .NET, although you can explicitly use the <a href=""http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx"" rel=""noreferrer""><code>Environment.ExpandEnvironmentVariable</code></a> method to do so. I would still strongly suggest that you use <code>GetFolderPath</code> however, because as Johannes Rössel points out in the comment, <code>%AppData%</code> may not be set in certain circumstances.</p>

<p>Finally, to create the path as shown in your example:</p>

<pre><code>var fileName = Path.Combine(Environment.GetFolderPath(
    Environment.SpecialFolder.ApplicationData), ""DateLinks.xml"");
</code></pre>
","867493"
"Getting value from a cell from a gridview on RowDataBound event","235479","","<pre><code>string percentage = e.Row.Cells[7].Text;
</code></pre>

<p>I am trying to do some dynamic stuff with my GridView, so I have wired up some code to the RowDataBound event. I am trying to get the value from a particular cell, which is a TemplateField. But the code above always seems to be returning an empty string. </p>

<p>Any ideas?</p>

<p>To clarify, here is a bit the offending cell:</p>

<pre><code>&lt;asp:TemplateField HeaderText=""# Percentage click throughs""&gt;
&lt;ItemTemplate&gt;
    &lt;%# AddPercentClickThroughs((int)Eval(""EmailSummary.pLinksClicked""), (int)Eval(""NumberOfSends"")) %&gt;
&lt;/ItemTemplate&gt;
&lt;/asp:TemplateField&gt;
</code></pre>

<p>On a related note, does anyone know if there is a better way of selecting the cell in the row. It sucks putting in <code>cell[1]</code>. Couldn't I do <code>cell[""mycellname""]</code>, so if I decide to change the order of my cells, bugs wont appear?</p>
","<p>First you need to wrap your code in a <code>Label</code> or <code>Literal</code> control so that you can reference it properly. What's happening is that there's no way for the system to keep track of it, because there's no control associated with the text. It's the control's responsibility to add its contents to viewstate.</p>

<p>You need to use gridView.FindControl(""controlName""); to get the control in the row. From there you can get at its properties including <code>Text</code>.</p>

<p>You can also get at the DataItem property of the Row in question and cast it to the appropriate type and extract the information directly.</p>
","121740"
"Get Month name from month number","235291","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/975531/how-to-get-the-monthname-in-c"">How to get the MonthName in c#?</a>  </p>
</blockquote>



<p>I used the following c# syntax to get month name from month no but i get <code>August</code> i want only <code>Aug</code>..</p>

<pre><code>System.Globalization.DateTimeFormatInfo mfi = new 
System.Globalization.DateTimeFormatInfo();
string strMonthName = mfi.GetMonthName(8).ToString();
</code></pre>

<p>Any suggestion...</p>
","<p>For short month names use:</p>

<pre><code>string monthName = new DateTime(2010, 8, 1)
    .ToString(""MMM"", CultureInfo.InvariantCulture);
</code></pre>

<p>For long/full month names for Spanish (""es"") culture</p>

<pre><code>string fullMonthName = new DateTime(2015, i, 1).ToString(""MMMM"", CultureInfo.CreateSpecificCulture(""es""));
</code></pre>
","3184163"
"How to get values of selected items in CheckBoxList with foreach in ASP.NET C#?","235128","","<p>I have a CheckBoxList like this:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;asp:CheckBoxList ID=""CBLGold"" runat=""server"" CssClass=""cbl""&gt;
    &lt;asp:ListItem Value=""TGJU""&gt; TG &lt;/asp:ListItem&gt;
    &lt;asp:ListItem Value=""GOLDOZ""&gt; Gold &lt;/asp:ListItem&gt;
    &lt;asp:ListItem Value=""SILVEROZ""&gt; Silver &lt;/asp:ListItem&gt;
    &lt;asp:ListItem Value=""NERKH""&gt; NE &lt;/asp:ListItem&gt;
    &lt;asp:ListItem Value=""TALA""&gt; Tala &lt;/asp:ListItem&gt;
    &lt;asp:ListItem Value=""YARAN""&gt; Sekeh &lt;/asp:ListItem&gt;
&lt;/asp:CheckBoxList&gt;
</code></pre>

<p>Now I want to get the value of the selected items from this CheckBoxList using foreach, and put the values into a list.</p>

<p><strong>Note</strong>: I would prefer the code to be short.</p>
","<blockquote>
  <p>Note that I prefer the code to be short.</p>
</blockquote>

<pre><code>List&lt;ListItem&gt; selected = CBLGold.Items.Cast&lt;ListItem&gt;()
    .Where(li =&gt; li.Selected)
    .ToList();
</code></pre>

<p>or with a simple <code>foreach</code>:</p>

<pre><code>List&lt;ListItem&gt; selected = new List&lt;ListItem&gt;();
foreach (ListItem item in CBLGold.Items)
    if (item.Selected) selected.Add(item);
</code></pre>

<p>If you just want the <code>ListItem.Value</code>:</p>

<pre><code>List&lt;string&gt; selectedValues = CBLGold.Items.Cast&lt;ListItem&gt;()
   .Where(li =&gt; li.Selected)
   .Select(li =&gt; li.Value)
   .ToList();
</code></pre>
","18924206"
"Turn on IncludeExceptionDetailInFaults (either from ServiceBehaviorAttribute or from the <serviceDebug> configuration behavior) on the server","235102","","<p>I have a WCF service that has been working perfectly, and something has changed and I don't know what.</p>

<p>I get this exception:</p>

<blockquote>
  <p>System.ServiceModel.FaultException: The server was unable to process the request due to an internal error.  For more information about the error, either turn on IncludeExceptionDetailInFaults (either from ServiceBehaviorAttribute or from the  configuration behavior) on the server in order to send the exception information back to the client, or turn on tracing as per the Microsoft .NET Framework 3.0 SDK documentation and inspect the server trace logs.</p>
</blockquote>

<p>This is confusing because I am running .NET 4.0.</p>

<p>Where do I turn on <code>IncludeExceptionDetailInFaults</code>? I'm battling to find it.</p>
","<p>Define a <a href=""https://msdn.microsoft.com/en-us/library/aa967282%28v=vs.110%29.aspx"" rel=""noreferrer"">behavior</a> in your <code>.config</code> file:</p>



<pre class=""lang-xml prettyprint-override""><code>&lt;configuration&gt;
  &lt;system.serviceModel&gt;
    &lt;behaviors&gt;
      &lt;serviceBehaviors&gt;
        &lt;behavior name=""debug""&gt;
          &lt;serviceDebug includeExceptionDetailInFaults=""true"" /&gt;
        &lt;/behavior&gt;
      &lt;/serviceBehaviors&gt;
    &lt;/behaviors&gt;
    ...
  &lt;/system.serviceModel&gt;
&lt;/configuration&gt;
</code></pre>

<p>Then apply the behavior to your service along these lines:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;configuration&gt;
  &lt;system.serviceModel&gt;
    ...
    &lt;services&gt;
      &lt;service name=""MyServiceName"" behaviorConfiguration=""debug"" /&gt;
    &lt;/services&gt;
  &lt;/system.serviceModel&gt;
&lt;/configuration&gt;
</code></pre>

<p>You can also set it programmatically. See <a href=""https://stackoverflow.com/questions/2483178/set-includeexceptiondetailinfaults-to-true-in-code-for-wcf"">this question</a>.</p>
","8315680"
"Proper way to initialize a C# dictionary with values already in it?","234704","","<p>I am creating a dictionary in a C# file with the following code:</p>

<pre><code>private readonly Dictionary&lt;string, XlFileFormat&gt; FILE_TYPE_DICT
        = new Dictionary&lt;string, XlFileFormat&gt;
        {
            {""csv"", XlFileFormat.xlCSV},
            {""html"", XlFileFormat.xlHtml}
        };
</code></pre>

<p>There is a red line under <code>new</code> with the error: </p>

<blockquote>
  <p>Feature 'collection initilializer' cannot be used because it is not part of the ISO-2 C# language specification</p>
</blockquote>

<p>Can anyone explain what is going on here?</p>

<p><strong>EDIT:</strong> okay, so it turns out I was using .NET version 2.</p>
","<p>I can't reproduce this issue in a simple .NET 4.0 console application:</p>

<pre><code>static class Program
{
    static void Main(string[] args)
    {
        Dictionary&lt;string, string&gt; myDict = new Dictionary&lt;string, string&gt;
        {
            { ""key1"", ""value1"" },
            { ""key2"", ""value2"" }
        };

        Console.ReadKey();
    }
}
</code></pre>

<p>Can you try to reproduce it in a simple Console application and go from there? It seems likely that you're targeting .NET 2.0 (which doesn't support it) or client profile framework, rather than a version of .NET that supports initialization syntax.</p>
","17047702"
"Get a list of distinct values in List","234685","","<p>In C#, say I have a class called Note with three String member variables.</p>

<pre><code>public class Note
{
    public string Title;
    public string Author;
    public string Text;
}
</code></pre>

<p>And I have a list of type Note:</p>

<pre><code>List&lt;Note&gt; Notes = new List&lt;Note&gt;();
</code></pre>

<p>What would be the cleanest way to get a list of all distinct values in the Author column?  </p>

<p>I could iterate through the list and add all values that aren't duplicates to another list of strings, but this seems dirty and inefficient.  I have a feeling there's some magical Linq construction that'll do this in one line, but I haven't been able to come up with anything.</p>
","<pre><code>Notes.Select(x =&gt; x.Author).Distinct();
</code></pre>

<p>This will return a sequence (<code>IEnumerable&lt;string&gt;</code>) of <code>Author</code> values -- one per unique value.</p>
","10255134"
"Cross-thread operation not valid: Control 'textBox1' accessed from a thread other than the thread it was created on","234628","","<p>I want to send temperature value from a microcontroller using UART to C# interface and Display temperature on <code>Label.Content</code>. Here is my microcontroller code:</p>

<pre><code>   while(1){
   key_scan();// get value of temp
if (Usart_Data_Ready())
                {
                   while(temperature[i]!=0)
                    {
                    if(temperature[i]!=' ')
                    {
                      Usart_Write(temperature[i]);
                      Delay_ms(1000);
                    }
                    i = i + 1;
                    }
                  i =0;
                  Delay_ms(2000);
                }
     }
</code></pre>

<p>and my C# code is:</p>

<pre><code>private void serialPort1_DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
    {
        txt += serialPort1.ReadExisting().ToString();
        textBox1.Text = txt.ToString();
    }
</code></pre>

<p>but exception arises there ""<strong>Cross-thread operation not valid: Control 'textBox1' accessed from a thread other than the thread it was created on</strong>""
Please tell me how to get temperature string from my microcontroller and remove this Error!</p>
","<p>The data received in your <code>serialPort1_DataReceived</code> method is coming from another thread context than the UI thread, and that's the reason you see this error.<br>
To remedy this, you will have to use a dispatcher as descibed in the MSDN article:<br>
<a href=""http://msdn.microsoft.com/en-us/library/ms171728.aspx"" rel=""noreferrer"">How to: Make Thread-Safe Calls to Windows Forms Controls</a></p>

<p>So instead of setting the text property directly in the <code>serialport1_DataReceived</code> method, use this pattern:</p>

<pre><code>delegate void SetTextCallback(string text);

private void SetText(string text)
{
  // InvokeRequired required compares the thread ID of the
  // calling thread to the thread ID of the creating thread.
  // If these threads are different, it returns true.
  if (this.textBox1.InvokeRequired)
  { 
    SetTextCallback d = new SetTextCallback(SetText);
    this.Invoke(d, new object[] { text });
  }
  else
  {
    this.textBox1.Text = text;
  }
}
</code></pre>

<p>So in your case:</p>

<pre><code>private void serialPort1_DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
{
  txt += serialPort1.ReadExisting().ToString();
  SetText(txt.ToString());
}
</code></pre>
","10775421"
"How do I specify the exit code of a console application in .NET?","234627","","<p>I have a trivial console application in .NET. It's just a test part of a larger application. I'd like to specify the ""exit code"" of my console application. How do I do this?</p>
","<p>You can return it from <code>Main</code> if you declare your <code>Main</code> method to return <code>int</code>, or call <a href=""https://msdn.microsoft.com/en-us/library/system.environment.exit.aspx"" rel=""noreferrer""><code>Environment.Exit(code)</code></a>.</p>
","155619"
"Find text in string with C#","233592","","<p>How can I find given text within a string? After that, I'd like to create a new string between that and something else. For instance...</p>

<p>If the string was:</p>

<pre><code>This is an example string and my data is here
</code></pre>

<p>And I want to create a string with whatever is between ""my "" and "" is"" how could I do that? Sorry this is pretty pseudo, but hopefully it makes sense.</p>
","<p>Use this function.</p>

<pre><code>public static string getBetween(string strSource, string strStart, string strEnd)
{
    int Start, End;
    if (strSource.Contains(strStart) &amp;&amp; strSource.Contains(strEnd))
    {
        Start = strSource.IndexOf(strStart, 0) + strStart.Length;
        End = strSource.IndexOf(strEnd, Start);
        return strSource.Substring(Start, End - Start);
    }
    else
    {
        return """";
    }
}
</code></pre>

<p>How to use it:</p>

<pre><code>string text = ""This is an example string and my data is here"";
string data = getBetween(text, ""my"", ""is"");
</code></pre>
","10709874"
"How to 'foreach' a column in a DataTable using C#?","233582","","<p>How do I <code>foreach</code> each column is a datarow?</p>

<pre><code>DataTable dtTable = new DataTable();
MySQLProcessor.DTTable(mysqlCommand, out dtTable);

foreach (DataRow dtRow in dtTable.Rows)
{
    //foreach(DataColumn dc in dtRow)
}
</code></pre>
","<p>This should work:</p>

<pre><code>DataTable dtTable;

MySQLProcessor.DTTable(mysqlCommand, out dtTable);

// On all tables' rows
foreach (DataRow dtRow in dtTable.Rows)
{
    // On all tables' columns
    foreach(DataColumn dc in dtTable.Columns)
    {
      var field1 = dtRow[dc].ToString();
    }
}
</code></pre>
","7939179"
"Copy the entire contents of a directory in C#","233436","","<p>I want to copy the entire contents of a directory from one location to another in C#.</p>

<p>There doesn't appear to be a way to do this using <code>System.IO</code> classes without lots of recursion.</p>

<p>There is a method in VB that we can use if we add a reference to <code>Microsoft.VisualBasic</code>:</p>

<pre><code>new Microsoft.VisualBasic.Devices.Computer().
    FileSystem.CopyDirectory( sourceFolder, outputFolder );
</code></pre>

<p>This seems like a rather ugly hack. Is there a better way?</p>
","<p>Much easier</p>

<pre><code>//Now Create all of the directories
foreach (string dirPath in Directory.GetDirectories(SourcePath, ""*"", 
    SearchOption.AllDirectories))
    Directory.CreateDirectory(dirPath.Replace(SourcePath, DestinationPath));

//Copy all the files &amp; Replaces any files with the same name
foreach (string newPath in Directory.GetFiles(SourcePath, ""*.*"", 
    SearchOption.AllDirectories))
    File.Copy(newPath, newPath.Replace(SourcePath, DestinationPath), true);
</code></pre>
","3822913"
"Read SQL Table into C# DataTable","233426","","<p>I've read a lot of posts about inserting a DataTable into a SQL table, but is there an easy way to pull a SQL table into a .NET DataTable?</p>
","<p>Here, give this a shot (this is just a pseudocode)</p>

<pre><code>using System;
using System.Data;
using System.Data.SqlClient;


public class PullDataTest
{
    // your data table
    private DataTable dataTable = new DataTable();

    public PullDataTest()
    {
    }

    // your method to pull data from database to datatable   
    public void PullData()
    {
        string connString = @""your connection string here"";
        string query = ""select * from table"";

        SqlConnection conn = new SqlConnection(connString);        
        SqlCommand cmd = new SqlCommand(query, conn);
        conn.Open();

        // create data adapter
        SqlDataAdapter da = new SqlDataAdapter(cmd);
        // this will query your database and return the result to your datatable
        da.Fill(dataTable);
        conn.Close();
        da.Dispose();
    }
}
</code></pre>
","6073545"
"How do I convert Word files to PDF programmatically?","233310","","<p>I have found several open-source/freeware programs that allow you to convert .doc files to .pdf files, but they're all of the application/printer driver variety, with no SDK attached.</p>

<p>I have found several programs that do have an SDK allowing you to convert .doc files to .pdf files, but they're all of the proprietary type, $2,000 a license or thereabouts.</p>

<p>Does anyone know of any clean, inexpensive (preferably free) programmatic solution to my problem, using C# or VB.NET?</p>

<p>Thanks!</p>
","<p>Use a foreach loop instead of a for loop - it solved my problem.</p>

<pre><code>int j = 0;
foreach (Microsoft.Office.Interop.Word.Page p in pane.Pages)
{
    var bits = p.EnhMetaFileBits;
    var target = path1 +j.ToString()+  ""_image.doc"";
    try
    {
        using (var ms = new MemoryStream((byte[])(bits)))
        {
            var image = System.Drawing.Image.FromStream(ms);
            var pngTarget = Path.ChangeExtension(target, ""png"");
            image.Save(pngTarget, System.Drawing.Imaging.ImageFormat.Png);
        }
    }
    catch (System.Exception ex)
    {
        MessageBox.Show(ex.Message);  
    }
    j++;
}
</code></pre>

<p>Here is a modification of a program that worked for me.  It uses Word 2007 with the <a href=""http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041&amp;displaylang=en"" rel=""noreferrer"">Save As PDF add-in</a> installed.  It searches a directory for .doc files, opens them in Word and then saves them as a PDF.  Note that you'll need to add a reference to Microsoft.Office.Interop.Word to the solution.</p>

<pre><code>using Microsoft.Office.Interop.Word;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

...

// Create a new Microsoft Word application object
Microsoft.Office.Interop.Word.Application word = new Microsoft.Office.Interop.Word.Application();

// C# doesn't have optional arguments so we'll need a dummy value
object oMissing = System.Reflection.Missing.Value;

// Get list of Word files in specified directory
DirectoryInfo dirInfo = new DirectoryInfo(@""\\server\folder"");
FileInfo[] wordFiles = dirInfo.GetFiles(""*.doc"");

word.Visible = false;
word.ScreenUpdating = false;

foreach (FileInfo wordFile in wordFiles)
{
    // Cast as Object for word Open method
    Object filename = (Object)wordFile.FullName;

    // Use the dummy value as a placeholder for optional arguments
    Document doc = word.Documents.Open(ref filename, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing);
    doc.Activate();

    object outputFileName = wordFile.FullName.Replace("".doc"", "".pdf"");
    object fileFormat = WdSaveFormat.wdFormatPDF;

    // Save document into PDF Format
    doc.SaveAs(ref outputFileName,
        ref fileFormat, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing);

    // Close the Word document, but leave the Word application open.
    // doc has to be cast to type _Document so that it will find the
    // correct Close method.                
    object saveChanges = WdSaveOptions.wdDoNotSaveChanges;
    ((_Document)doc).Close(ref saveChanges, ref oMissing, ref oMissing);
    doc = null;
}

// word has to be cast to type _Application so that it will find
// the correct Quit method.
((_Application)word).Quit(ref oMissing, ref oMissing, ref oMissing);
word = null;
</code></pre>
","608153"
"Function that creates a timestamp in c#","233253","","<p>I was wondering, is there a way to create a timestamp in c# from a datetime?
I need a millisecond precision value that also works in Compact Framework(saying that since DateTime.ToBinary() does not exist in CF).</p>

<p>My problem is that i want to store this value in a database agnostic way so i can sortby it later and find out which value is greater from another etc.</p>
","<p>I always use something like the following:</p>

<pre><code>public static String GetTimestamp(this DateTime value)
{
    return value.ToString(""yyyyMMddHHmmssfff"");
}
</code></pre>

<p>This will give you a string like 200905211035131468, as the string goes from highest order bits of the timestamp to lowest order simple string sorting in your SQL queries can be used to order by date if you're sticking values in a database</p>
","892119"
"How to open an Excel file in C#?","233181","","<p>I am trying to convert some <a href=""http://en.wikipedia.org/wiki/Visual_Basic_for_Applications"" rel=""noreferrer"">VBA</a> code to C#. I am new to C#. Currently I am trying to open an Excel file from a folder and if it does not exist then create it. I am trying something like the following. How can I make it work?</p>

<pre><code>Excel.Application objexcel;
Excel.Workbook wbexcel;
bool wbexists;
Excel.Worksheet objsht;
Excel.Range objrange;

objexcel = new Excel.Application();
if (Directory(""C:\\csharp\\error report1.xls"") = """")
{
    wbexcel.NewSheet();
}

else
{
    wbexcel.Open(""C:\\csharp\\error report1.xls"");
    objsht = (""sheet1"");
}
objsht.Activate();
</code></pre>
","<p>You need to have installed Microsoft Visual Studio Tools for Office.</p>

<p>After that create common .NET project and add the reference to COM object <code>Microsoft.Office.Interop.Excel.dll</code> via 'Add Reference..' dialog.</p>

<pre><code>Application excel = new Application();
Workbook wb = excel.Workbooks.Open(path);
</code></pre>

<p><code>Missing.Value</code> is a special reflection struct for unnecessary parameters replacement</p>
","465676"
"Deserialize json object into dynamic object using Json.net","232992","","<p>Is it possible to return a dynamic object from a json deserialization using json.net? I would like to do something like this:</p>

<pre><code>dynamic jsonResponse = JsonConvert.Deserialize(json);
Console.WriteLine(jsonResponse.message);
</code></pre>
","<p>latest json.net version allow do this:</p>

<pre><code>dynamic d = JObject.Parse(""{number:1000, str:'string', array: [1,2,3,4,5,6]}"");

Console.WriteLine(d.number);
Console.WriteLine(d.str);
Console.WriteLine(d.array.Count);
</code></pre>

<p>output:</p>

<pre><code> 1000
 string
 6
</code></pre>

<p>Documentation here: <strong><a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/LINQtoJSON.htm"">LINQ to JSON with Json.NET</a></strong></p>
","8972079"
"extract the date part from DateTime in C#","232954","","<p>The line of code <code>DateTime d = DateTime.Today;</code> results in <code>10/12/2011 12:00:00 AM</code>. How can I get only the date part.I need to ignore the time part when I compare two dates. </p>
","<p><code>DateTime</code> is a DataType which is used to store both <code>Date</code> and <code>Time</code>. But it provides Properties to get the <code>Date</code> Part.</p>

<p>You can get the Date part from <code>Date</code> Property. </p>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx</a></p>

<pre><code>DateTime date1 = new DateTime(2008, 6, 1, 7, 47, 0);
Console.WriteLine(date1.ToString());

// Get date-only portion of date, without its time.
DateTime dateOnly = date1.Date;
// Display date using short date string.
Console.WriteLine(dateOnly.ToString(""d""));
// Display date using 24-hour clock.
Console.WriteLine(dateOnly.ToString(""g""));
Console.WriteLine(dateOnly.ToString(""MM/dd/yyyy HH:mm""));   
// The example displays the following output to the console:
//       6/1/2008 7:47:00 AM
//       6/1/2008
//       6/1/2008 12:00 AM
//       06/01/2008 00:00
</code></pre>
","7740509"
"How to copy data to clipboard in C#","232552","","<p>How can I copy a string (e.g ""hello"") to the System Clipboard in C#, so next time I press <kbd>CTRL+V</kbd> I'll get ""hello""?</p>
","<p>You'll need a namespace declaration:</p>

<pre><code>using System.Windows.Forms;
</code></pre>

<p>OR for WPF:</p>

<pre><code>using System.Windows;
</code></pre>

<p>To copy an exact string (literal in this case):</p>

<pre><code>Clipboard.SetText(""Hello, clipboard"");
</code></pre>

<p>To copy the contents of a textbox:</p>

<pre><code>Clipboard.SetText(txtClipboard.Text);
</code></pre>

<p><a href=""http://www.geekpedia.com/tutorial188_Clipboard-Copy-and-Paste-with-Csharp.html"" rel=""noreferrer"">See here for an example</a>.
Or... <a href=""http://msdn.microsoft.com/en-us/library/ydby206k.aspx"" rel=""noreferrer"">Official MSDN documentation</a> or <a href=""http://msdn.microsoft.com/en-gb/library/ms597043.aspx"" rel=""noreferrer"">Here for WPF</a>.</p>
","3546026"
"IOException: The process cannot access the file 'file path' because it is being used by another process","231772","","<p>I have some code and when it executes, it throws a <code>IOException</code>, saying that  </p>

<blockquote>
  <p>The process cannot access the file 'filename' because it is being used by
  another process</p>
</blockquote>

<p>What does this mean, and what can I do about it?</p>
","<h2>What is the cause?</h2>

<p>The error message is pretty clear: you're trying to access a file, and it's not accessible because another process (or even the same process) is doing something with it (and it didn't allow any sharing).</p>

<h2>Debugging</h2>

<p>It may be pretty easy to solve (or pretty hard to understand), depending on your specific scenario. Let's see some.</p>

<p><strong>Your process is the only one to access that file</strong><br/>
You're sure the <em>other</em> process is your own process. If you know you open that file in another part of your program, then first of all you have to check that you properly close the file handle after each use. Here is an example of code with this bug:</p>

<pre><code>var stream = new FileStream(path, FileAccess.Read);
var reader = new StreamReader(stream);
// Read data from this file, when I'm done I don't need it any more
File.Delete(path); // IOException: file is in use
</code></pre>

<p>Fortunately <code>FileStream</code> implements <code>IDisposable</code>, so it's easy to wrap all your code inside a <code>using</code> statement:</p>

<pre><code>using (var stream = File.Open(""myfile.txt"", FileMode.Open)) {
    // Use stream
}

// Here stream is not accessible and it has been closed (also if
// an exception is thrown and stack unrolled
</code></pre>

<p>This pattern will also ensure that the file won't be left open in case of exceptions (it may be the reason the file is in use: something went wrong, and no one closed it; see <a href=""https://stackoverflow.com/q/2641324/1207195"">this post</a> for an example).</p>

<p>If everything seems fine (you're sure you always close every file you open, even in case of exceptions) and you have multiple working threads, then you have two options: rework your code to serialize file access (not always doable and not always wanted) or apply a <em>retry pattern</em>. It's a pretty common pattern for I/O operations: you try to do something and in case of error you wait and try again (did you ask yourself why, for example, Windows Shell takes some time to inform you that a file is in use and cannot be deleted?). In C# it's pretty easy to implement (see also better examples about <a href=""https://stackoverflow.com/q/10295561/1207195"">disk I/O</a>, <a href=""https://stackoverflow.com/a/25014282/1207195"">networking</a> and <a href=""https://stackoverflow.com/a/24041546/1207195"">database access</a>).</p>

<pre><code>private const int NumberOfRetries = 3;
private const int DelayOnRetry = 1000;

for (int i=1; i &lt;= NumberOfRetries; ++i) {
    try {
        // Do stuff with file
        break; // When done we can break loop
    }
    catch (IOException e) when (i &lt;= NumberOfRetries) {
        // You may check error code to filter some exceptions, not every error
        // can be recovered.
        Thread.Sleep(DelayOnRetry);
    }
}
</code></pre>

<p>Please note a common error we see very often on StackOverflow:</p>

<pre><code>var stream = File.Open(path, FileOpen.Read);
var content = File.ReadAllText(path);
</code></pre>

<p>In this case <code>ReadAllText()</code> will fail because the file is in use (<code>File.Open()</code> in the line before). To open the file beforehand is not only unnecessary but also wrong. The same applies to all <code>File</code> functions that don't return a <em>handle</em> to the file you're working with: <code>File.ReadAllText()</code>, <code>File.WriteAllText()</code>, <code>File.ReadAllLines()</code>, <code>File.WriteAllLines()</code> and others  (like <code>File.AppendAllXyz()</code> functions) will all open and close the file by themselves. </p>

<p><strong>Your process is not the only one to access that file</strong><br/>
If your process is not the only one to access that file, then interaction can be harder. A <em>retry pattern</em> will help (if the file shouldn't be open by anyone else but it is, then you need a utility like Process Explorer to check <em>who</em> is doing <em>what</em>).</p>

<h2>Ways to avoid</h2>

<p>When applicable, always use <em>using</em> statements to open files. As said in previous paragraph, it'll actively help you to avoid many common errors (see <a href=""https://stackoverflow.com/q/3803929/1207195"">this post</a> for an example on <strong>how not to use it</strong>).</p>

<p>If possible, try to decide who owns access to a specific file and centralize access through a few well-known methods. If, for example, you have a data file where your program reads and writes, then you should box all I/O code inside a single class. It'll make debug easier (because you can always put a breakpoint there and see who is doing what) and also it'll be a synchronization point (if required) for multiple access.</p>

<p>Don't forget I/O operations can always fail, a common example is this:</p>

<pre><code>if (File.Exists(path))
    File.Delete(path);
</code></pre>

<p>If <em>someone</em> deletes the file after <code>File.Exists()</code> but before <code>File.Delete()</code>, then it'll throw an <code>IOException</code> in a place where you may wrongly feel safe.</p>

<p>Whenever it's possible, apply a <em>retry pattern</em>, and if you're using <code>FileSystemWatcher</code>, consider postponing action (because you'll get notified, but an application may still be working exclusively with that file).</p>

<p><strong>Advanced scenarios</strong><br/>
It's not always so easy, so you may need to share access with someone else. If, for example, you're reading from the beginning and writing to the end, you have at least two options.</p>

<p>1) share the same <code>FileStream</code> with proper synchronization functions (because <strong>it is not thread-safe</strong>). See <a href=""https://stackoverflow.com/q/3457725/1207195"">this</a> and <a href=""https://stackoverflow.com/q/8893449/1207195"">this</a> posts for an example.</p>

<p>2) use <code>FileShare</code> enumeration to instruct OS to allow other processes (or other parts of your own process) to access same file concurrently.</p>

<pre><code>using (var stream = File.Open(path, FileMode.Open, FileAccess.Write, FileShare.Read))
{
}
</code></pre>

<p>In this example I showed how to open a file for writing and share for reading; please note that when reading and writing overlaps, it results in undefined or invalid data. It's a situation that must be handled when reading. Also note that this doesn't make access to the <code>stream</code> thread-safe, so this object can't be shared with multiple threads unless access is synchronized somehow (see previous links). Other sharing options are available, and they open up more complex scenarios. Please refer to <a href=""http://msdn.microsoft.com/en-us/library/system.io.fileshare(v=vs.110).aspx"" rel=""noreferrer"">MSDN</a> for more details.</p>

<p>In general <em>N</em> processes can read from same file all together but only one should write, in a controlled scenario you may even enable concurrent writings but this can't be generalized in few text paragraphs inside this answer.</p>

<p>Is it possible to <strong>unlock</strong> a file used by another process? It's not always safe and not so easy but yes, <a href=""https://stackoverflow.com/a/35058113/1207195"">it's possible</a>.</p>
","26741192"
"Return list using select new in LINQ","230954","","<p>This is my method which gives me error.</p>

<pre><code>public List&lt;Project&gt; GetProjectForCombo()
{
    using (MyDataContext db = new MyDataContext (DBHelper.GetConnectionString()))
    {
        var query = from pro in db.Projects
                    select new { pro.ProjectName, pro.ProjectId };

        return query.ToList();
    }
}
</code></pre>

<p>If i change it with this:</p>

<pre><code>public List&lt;Project&gt; GetProjectForCombo()
{
    using (MyDataContext db = new MyDataContext (DBHelper.GetConnectionString()))
    {
        var query = from pro in db.Projects
                    select pro;

        return query.ToList();
    }
}
</code></pre>

<p>Then it works fine no error.</p>

<p>Can you please let me know that how can i return only ProjectId and ProjectName.</p>

<p>Thanks.</p>
","<p>Method can not return anonymous type. It has to be same as the type defined in method return type. Check the signature of GetProjectForCombo and see what return type you have specified.</p>

<p>Create a class ProjectInfo with required properties and then in new expression create object of ProjectInfo type.</p>

<pre><code>class ProjectInfo
{
   public string Name {get; set; }
   public long Id {get; set; }
}

public List&lt;ProjectInfo&gt; GetProjectForCombo()
{
    using (MyDataContext db = new MyDataContext (DBHelper.GetConnectionString()))
    {
        var query = from pro in db.Projects
                    select new ProjectInfo(){ Name = pro.ProjectName, Id = pro.ProjectId };

        return query.ToList();
    }
}
</code></pre>
","6370057"
"Get time in milliseconds using C#","230758","","<p>I'm making a program in which I need to get the time in milliseconds. By time, I mean a number that is never equal to itself, and is always 1000 numbers bigger than it was a second ago. I've tried converting <code>DateTime.Now</code> to a <code>TimeSpan</code> and getting the <code>TotalMilliseconds</code> from that... but I've heard it isn't perfectly accurate.</p>

<p>Is there an easier way to do this?</p>
","<p>Use the <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx"" rel=""noreferrer""><code>Stopwatch</code></a> class.</p>

<blockquote>
  <p>Provides a set of methods and
  properties that you can use to
  accurately measure elapsed time.</p>
</blockquote>

<p>There is some good info on implementing it here:</p>

<p><a href=""http://www.codeproject.com/KB/testing/stopwatch-measure-precise.aspx"" rel=""noreferrer"">Performance Tests: Precise Run Time Measurements with System.Diagnostics.Stopwatch</a></p>
","4016500"
"How do I skip an iteration of a `foreach` loop?","230758","","<p>In Perl I can skip a foreach (or any loop) iteration with a <code>next;</code> command.</p>

<p>Is there a way to skip over an iteration and jump to the next loop in C#?</p>

<pre><code> foreach (int number in numbers)
 {
     if (number &lt; 0)
     {
         // What goes here to skip over the loop?
     }

     // otherwise process number
 }
</code></pre>
","<p>You want:</p>

<pre><code>foreach (int number in numbers) //   &lt;--- go back to here --------+
{                               //                                |
    if (number &lt; 0)             //                                |
    {                           //                                |
        continue;   // Skip the remainder of this iteration. -----+
    }

    // do work
}
</code></pre>

<p>Here's more about the <a href=""http://msdn.microsoft.com/en-us/library/923ahwt1.aspx"" rel=""noreferrer""><strong><code>continue</code> keyword</strong></a>.</p>

<hr/>

<p><strong>Update:</strong> In response to Brian's follow-up question in the comments:</p>

<blockquote>
  <p>Could you further clarify what I would do if I had nested for loops, and wanted to skip the iteration of one of the extended ones?</p>

<pre><code>for (int[] numbers in numberarrays) {
  for (int number in numbers) { // What to do if I want to
                                // jump the (numbers/numberarrays)?
  }
}
</code></pre>
</blockquote>

<p>A <code>continue</code> always applies to the nearest enclosing scope, so you couldn't use it to break out of the outermost loop. If a condition like that arises, you'd need to do something more complicated depending on exactly what you want, like <code>break</code> from the inner loop, then <code>continue</code> on the outer loop. See here for the documentation on the <a href=""http://msdn.microsoft.com/en-us/library/adbctzc4.aspx"" rel=""noreferrer""><strong><code>break</code> keyword</strong></a>. The <code>break</code> C# keyword is similar to the Perl <code>last</code> keyword.</p>

<p>Also, consider taking Dustin's suggestion to just filter out values you don't want to process beforehand:</p>

<pre><code>foreach (var basket in baskets.Where(b =&gt; b.IsOpen())) {
  foreach (var fruit in basket.Where(f =&gt; f.IsTasty())) {
    cuteAnimal.Eat(fruit); // Om nom nom. You don't need to break/continue
                           // since all the fruits that reach this point are
                           // in available baskets and tasty.
  }
}
</code></pre>
","654126"
"Dynamic LINQ OrderBy on IEnumerable<T>","230511","","<p>I found an example in the <a href=""http://msdn2.microsoft.com/en-us/bb330936.aspx"" rel=""noreferrer"">VS2008 Examples</a> for Dynamic LINQ that allows you to use a sql-like string (e.g. <code>OrderBy(""Name, Age DESC""))</code> for ordering. Unfortunately, the method included only works on <code>IQueryable&lt;T&gt;</code>;. Is there any way to get this functionality on <code>IEnumerable&lt;T&gt;</code>?</p>
","<p>Just stumbled into this oldie...</p>

<p>To do this without the dynamic LINQ library, you just need the code as below. This covers most common scenarios including nested properties.</p>

<p>To get it working with <code>IEnumerable&lt;T&gt;</code> you could add some wrapper methods that go via <code>AsQueryable</code> - but the code below is the core <code>Expression</code> logic needed.</p>

<pre><code>public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T&gt;(
    this IQueryable&lt;T&gt; source, 
    string property)
{
    return ApplyOrder&lt;T&gt;(source, property, ""OrderBy"");
}

public static IOrderedQueryable&lt;T&gt; OrderByDescending&lt;T&gt;(
    this IQueryable&lt;T&gt; source, 
    string property)
{
    return ApplyOrder&lt;T&gt;(source, property, ""OrderByDescending"");
}

public static IOrderedQueryable&lt;T&gt; ThenBy&lt;T&gt;(
    this IOrderedQueryable&lt;T&gt; source, 
    string property)
{
    return ApplyOrder&lt;T&gt;(source, property, ""ThenBy"");
}

public static IOrderedQueryable&lt;T&gt; ThenByDescending&lt;T&gt;(
    this IOrderedQueryable&lt;T&gt; source, 
    string property)
{
    return ApplyOrder&lt;T&gt;(source, property, ""ThenByDescending"");
}

static IOrderedQueryable&lt;T&gt; ApplyOrder&lt;T&gt;(
    IQueryable&lt;T&gt; source, 
    string property, 
    string methodName) 
{
    string[] props = property.Split('.');
    Type type = typeof(T);
    ParameterExpression arg = Expression.Parameter(type, ""x"");
    Expression expr = arg;
    foreach(string prop in props) {
        // use reflection (not ComponentModel) to mirror LINQ
        PropertyInfo pi = type.GetProperty(prop);
        expr = Expression.Property(expr, pi);
        type = pi.PropertyType;
    }
    Type delegateType = typeof(Func&lt;,&gt;).MakeGenericType(typeof(T), type);
    LambdaExpression lambda = Expression.Lambda(delegateType, expr, arg);

    object result = typeof(Queryable).GetMethods().Single(
            method =&gt; method.Name == methodName
                    &amp;&amp; method.IsGenericMethodDefinition
                    &amp;&amp; method.GetGenericArguments().Length == 2
                    &amp;&amp; method.GetParameters().Length == 2)
            .MakeGenericMethod(typeof(T), type)
            .Invoke(null, new object[] {source, lambda});
    return (IOrderedQueryable&lt;T&gt;)result;
}
</code></pre>

<hr>

<p>Edit: it gets more fun if you want to mix that with <code>dynamic</code> - although note that <code>dynamic</code> only applies to LINQ-to-Objects (expression-trees for ORMs etc can't really represent <code>dynamic</code> queries - <code>MemberExpression</code> doesn't support it). But here's a way to do it with LINQ-to-Objects. Note that the choice of <code>Hashtable</code> is due to favorable locking semantics:</p>

<pre><code>using Microsoft.CSharp.RuntimeBinder;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Dynamic;
using System.Linq;
using System.Runtime.CompilerServices;
static class Program
{
    private static class AccessorCache
    {
        private static readonly Hashtable accessors = new Hashtable();

        private static readonly Hashtable callSites = new Hashtable();

        private static CallSite&lt;Func&lt;CallSite, object, object&gt;&gt; GetCallSiteLocked(
            string name) 
        {
            var callSite = (CallSite&lt;Func&lt;CallSite, object, object&gt;&gt;)callSites[name];
            if(callSite == null)
            {
                callSites[name] = callSite = CallSite&lt;Func&lt;CallSite, object, object&gt;&gt;
                    .Create(Binder.GetMember(
                                CSharpBinderFlags.None, 
                                name, 
                                typeof(AccessorCache),
                                new CSharpArgumentInfo[] { 
                                    CSharpArgumentInfo.Create(
                                        CSharpArgumentInfoFlags.None, 
                                        null) 
                                }));
            }
            return callSite;
        }

        internal static Func&lt;dynamic,object&gt; GetAccessor(string name)
        {
            Func&lt;dynamic, object&gt; accessor = (Func&lt;dynamic, object&gt;)accessors[name];
            if (accessor == null)
            {
                lock (accessors )
                {
                    accessor = (Func&lt;dynamic, object&gt;)accessors[name];
                    if (accessor == null)
                    {
                        if(name.IndexOf('.') &gt;= 0) {
                            string[] props = name.Split('.');
                            CallSite&lt;Func&lt;CallSite, object, object&gt;&gt;[] arr 
                                = Array.ConvertAll(props, GetCallSiteLocked);
                            accessor = target =&gt;
                            {
                                object val = (object)target;
                                for (int i = 0; i &lt; arr.Length; i++)
                                {
                                    var cs = arr[i];
                                    val = cs.Target(cs, val);
                                }
                                return val;
                            };
                        } else {
                            var callSite = GetCallSiteLocked(name);
                            accessor = target =&gt;
                            {
                                return callSite.Target(callSite, (object)target);
                            };
                        }
                        accessors[name] = accessor;
                    }
                }
            }
            return accessor;
        }
    }

    public static IOrderedEnumerable&lt;dynamic&gt; OrderBy(
        this IEnumerable&lt;dynamic&gt; source, 
        string property)
    {
        return Enumerable.OrderBy&lt;dynamic, object&gt;(
            source, 
            AccessorCache.GetAccessor(property), 
            Comparer&lt;object&gt;.Default);
    }

    public static IOrderedEnumerable&lt;dynamic&gt; OrderByDescending(
        this IEnumerable&lt;dynamic&gt; source, 
        string property)
    {
        return Enumerable.OrderByDescending&lt;dynamic, object&gt;(
            source, 
            AccessorCache.GetAccessor(property), 
            Comparer&lt;object&gt;.Default);
    }

    public static IOrderedEnumerable&lt;dynamic&gt; ThenBy(
        this IOrderedEnumerable&lt;dynamic&gt; source, 
        string property)
    {
        return Enumerable.ThenBy&lt;dynamic, object&gt;(
            source, 
            AccessorCache.GetAccessor(property), 
            Comparer&lt;object&gt;.Default);
    }

    public static IOrderedEnumerable&lt;dynamic&gt; ThenByDescending(
        this IOrderedEnumerable&lt;dynamic&gt; source, 
        string property)
    {
        return Enumerable.ThenByDescending&lt;dynamic, object&gt;(
            source, 
            AccessorCache.GetAccessor(property), 
            Comparer&lt;object&gt;.Default);
    }

    static void Main()
    {
        dynamic a = new ExpandoObject(), 
                b = new ExpandoObject(), 
                c = new ExpandoObject();
        a.X = ""abc"";
        b.X = ""ghi"";
        c.X = ""def"";
        dynamic[] data = new[] { 
            new { Y = a },
            new { Y = b }, 
            new { Y = c } 
        };

        var ordered = data.OrderByDescending(""Y.X"").ToArray();
        foreach (var obj in ordered)
        {
            Console.WriteLine(obj.Y.X);
        }
    }
}
</code></pre>
","233505"
"How to use DbContext.Database.SqlQuery<TElement>(sql, params) with stored procedure? EF Code First CTP5","230507","","<p>I have a stored procedure that has three parameters and I've been trying to use the following to return the results:</p>

<pre><code>context.Database.SqlQuery&lt;myEntityType&gt;(""mySpName"", param1, param2, param3);
</code></pre>

<p>At first I tried using <code>SqlParameter</code> objects as the params but this didn't work and threw a <code>SqlException</code> with the following message:</p>

<blockquote>
  <p>Procedure or function 'mySpName' expects parameter '@param1', which was not supplied.</p>
</blockquote>

<p>So my question is how you can use this method with a stored procedure that expects parameters?</p>

<p>Thanks.</p>
","<p>You should supply the SqlParameter instances in the following way:  </p>

<pre><code>context.Database.SqlQuery&lt;myEntityType&gt;(
    ""mySpName @param1, @param2, @param3"",
    new SqlParameter(""param1"", param1),
    new SqlParameter(""param2"", param2),
    new SqlParameter(""param3"", param3)
);
</code></pre>
","4874600"
"What is the use of static variable in C#? When to use it? Why can't I declare the static variable inside method?","230505","","<p>I have searched about static variables in C#, but I still am not getting what its use is. Also, if I try to declare the variable inside the method it will not give me the permission to do this. Why?</p>

<p>I have seen some examples about the static variable. I've seen that we don't need to create a instance of the class to access the variable, but that is not enough to understand what its use is and when to use it.</p>

<p><strong>Second thing</strong></p>

<pre><code>class Book
{
    public static int myInt = 0;
}

public class Exercise
{
    static void Main()
    {
        Book book = new Book();
        Console.WriteLine(book.myInt);//shows error why its shows me error?cant i access the static variable by making the instance of a class?
        Console.ReadKey();

    }
}
</code></pre>
","<p>A <code>static</code> variable shares the value of it among all instances of the class.</p>

<p>Example without declaring it static:</p>

<pre><code>public class Variable
{
    public int i = 5;
    public void test()
    {
        i = i + 5;
        Console.WriteLine(i);
    }
}


public class Exercise
{
    static void Main()
    {
        Variable var = new Variable();
        var.test();
        Variable var1 = new Variable();
        var1.test();
        Console.ReadKey();
    }
}
</code></pre>

<p>Explanation: If you look at the above example, I just declare the <code>int</code> variable. When I run this code the output will be <code>10</code> and <code>10</code>. Its simple.</p>

<p>Now let's look at the static variable here; I am declaring the variable as a <code>static</code>.</p>

<p>Example with static variable:</p>

<pre><code>public class Variable
{
    public static int i = 5;
    public void test()
    {
        i = i + 5;
        Console.WriteLine(i);
    }
}


public class Exercise
{
    static void Main()
    {
        Variable var = new Variable();
        var.test();
        Variable var1 = new Variable();
        var1.test();
        Console.ReadKey();
    }
}
</code></pre>

<p>Now when I run above code, the output will be <code>10</code> and <code>15</code>. So the static variable value is shared among all instances of that class.</p>
","10796792"
"Merge two (or more) lists into one, in C# .NET","230257","","<p>Is it possible to convert two or more lists into one single list, in .NET using C#?</p>

<p>For example, </p>

<pre><code>public static List&lt;Product&gt; GetAllProducts(int categoryId){ .... }
.
.
.
var productCollection1 = GetAllProducts(CategoryId1);
var productCollection2 = GetAllProducts(CategoryId2);
var productCollection3 = GetAllProducts(CategoryId3);
</code></pre>
","<p>You can use the LINQ <a href=""http://msdn.microsoft.com/en-us/library/bb302894.aspx""><code>Concat</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/bb342261.aspx""><code>ToList</code></a> methods:</p>

<pre><code>var allProducts = productCollection1.Concat(productCollection2)
                                    .Concat(productCollection3)
                                    .ToList();
</code></pre>

<p>Note that there are more efficient ways to do this - the above will basically loop through all the entries, creating a dynamically sized buffer. As you can predict the size to start with, you don't need this dynamic sizing... so you <em>could</em> use:</p>

<pre><code>var allProducts = new List&lt;Product&gt;(productCollection1.Count +
                                    productCollection2.Count +
                                    productCollection3.Count);
allProducts.AddRange(productCollection1);
allProducts.AddRange(productCollection2);
allProducts.AddRange(productCollection3);
</code></pre>

<p>(<code>AddRange</code> is special-cased for <code>ICollection&lt;T&gt;</code> for efficiency.)</p>

<p>I wouldn't take this approach unless you really have to though.</p>
","4488073"
"Converting Stream to String and back...what are we missing?","229152","","<p>I want to serialize objects to strings, and back.</p>

<p>We use protobuf-net to turn an object into a Stream and back, successfully.</p>

<p>However, Stream to string and back... not so successful. After going through <code>StreamToString</code> and <code>StringToStream</code>, the new <code>Stream</code>isn't
deserialized by protobuf-net; it raises an <code>Arithmetic Operation resulted in an Overflow</code> exception.  If we deserialize the original stream, it works.</p>

<p>Our methods:</p>

<pre><code>public static string StreamToString(Stream stream)
{
    stream.Position = 0;
    using (StreamReader reader = new StreamReader(stream, Encoding.UTF8))
    {
        return reader.ReadToEnd();
    }
}

public static Stream StringToStream(string src)
{
    byte[] byteArray = Encoding.UTF8.GetBytes(src);
    return new MemoryStream(byteArray);
}
</code></pre>

<p>Our example code using these two:</p>

<pre><code>MemoryStream stream = new MemoryStream();
Serializer.Serialize&lt;SuperExample&gt;(stream, test);
stream.Position = 0;
string strout = StreamToString(stream);
MemoryStream result = (MemoryStream)StringToStream(strout);
var other = Serializer.Deserialize&lt;SuperExample&gt;(result);
</code></pre>
","<p>This is so common but so profoundly wrong. Protobuf data is not string data. It certainly isn't ASCII. You are using the encoding <strong>backwards</strong>. A text encoding transfers:</p>

<ul>
<li>an arbitrary string to formatted bytes</li>
<li>formatted bytes to the original string</li>
</ul>

<p>You do not have ""formatted bytes"". You have <em>arbitrary bytes</em>. You need to use something like a base-n (commonly: base-64) encode. This transfers</p>

<ul>
<li>arbitrary bytes to a formatted string</li>
<li>a formatted string to the original bytes</li>
</ul>

<p>look at Convert.ToBase64String and Convert. FromBase64String</p>
","17830185"
"How do I copy the contents of one stream to another?","228894","","<p>What is the best way to copy the contents of one stream to another? Is there a standard utility method for this?</p>
","<p><strong>From .NET 4.5 on, there is the <a href=""http://msdn.microsoft.com/en-us/library/system.io.stream.copytoasync.aspx"" rel=""noreferrer""><code>Stream.CopyToAsync</code> method</a></strong></p>

<pre><code>input.CopyToAsync(output);
</code></pre>

<p>This will return a <a href=""http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx"" rel=""noreferrer""><code>Task</code></a> that can be continued on when completed, like so:</p>

<pre><code>await input.CopyToAsync(output)

// Code from here on will be run in a continuation.
</code></pre>

<p>Note that depending on where the call to <code>CopyToAsync</code> is made, the code that follows may or may not continue on the same thread that called it.</p>

<p>The <a href=""http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx"" rel=""noreferrer""><code>SynchronizationContext</code></a> that was captured when calling <a href=""http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx"" rel=""noreferrer""><code>await</code></a> will determine what thread the continuation will be executed on.</p>

<p>Additionally, this call (and this is an implementation detail subject to change) still sequences reads and writes (it just doesn't waste a threads blocking on I/O completion).</p>

<p><strong>From .NET 4.0 on, there's is the <a href=""http://msdn.microsoft.com/en-us/library/system.io.stream.copyto.aspx"" rel=""noreferrer""><code>Stream.CopyTo</code> method</a></strong></p>

<pre><code>input.CopyTo(output);
</code></pre>

<p><strong>For .NET 3.5 and before</strong></p>

<p>There isn't anything baked into the framework to assist with this; you have to copy the content manually, like so:</p>

<pre><code>public static void CopyStream(Stream input, Stream output)
{
    byte[] buffer = new byte[32768];
    int read;
    while ((read = input.Read(buffer, 0, buffer.Length)) &gt; 0)
    {
        output.Write (buffer, 0, read);
    }
}
</code></pre>
","230141"
"How to get the unix timestamp in C#","228740","","<p>I have had look around stackoverflow, and even looked at some of the suggested questions and none seem to answer, how do you get a unix timestamp in C#?</p>
","<p>You get a unix timestamp in C# by using DateTime.UtcNow and subtracting the epoc time of 1970-01-01.</p>

<p>e.g.</p>

<pre><code>Int32 unixTimestamp = (Int32)(DateTime.UtcNow.Subtract(new DateTime(1970, 1, 1))).TotalSeconds;
</code></pre>

<p><code>DateTime.Now</code> can be replaced with any <code>DateTime</code> object that you would like to get the unix timestamp for.</p>
","17632585"
"How to declare a local variable in Razor?","228729","","<p>I am developing a web application in asp.net mvc 3.
I am very new to it. In a view using razor, I'd like to declare some local variables and use it across the entire page. How can this be done?</p>

<p>It seems rather trivial to be able to do the following action:</p>

<pre><code>@bool isUserConnected = string.IsNullOrEmpty(Model.CreatorFullName);
@if (isUserConnected)
{ // meaning that the viewing user has not been saved
    &lt;div&gt;
        &lt;div&gt; click to join us &lt;/div&gt;
        &lt;a id=""login"" href=""javascript:void(0);"" style=""display: inline; ""&gt;join&lt;/a&gt;
    &lt;/div&gt;
}
</code></pre>

<p>But this doesn't work. Is this possible?</p>
","<p>I think you were pretty close, try this:</p>

<pre><code>@{bool isUserConnected = string.IsNullOrEmpty(Model.CreatorFullName);}
@if (isUserConnected)
{ // meaning that the viewing user has not been saved
    &lt;div&gt;
        &lt;div&gt; click to join us &lt;/div&gt;
        &lt;a id=""login"" href=""javascript:void(0);"" style=""display: inline; ""&gt;join&lt;/a&gt;
    &lt;/div&gt;
}
</code></pre>
","6601731"
"How to read data from excel file using c#","228659","","<p>My application needs to read data from an excel file. I am using .Net and c# for development. 
I cannot install MS office in the system. Because of that the my application fails to read excel file and throws an error while loading the dll for excel. </p>

<p>How can i access excel file in my application in a system where ms office is not installed?</p>
","<p>There is the option to use <code>OleDB</code> and use the Excel sheets like datatables in a database...</p>

<p>Just an example.....</p>

<pre><code>string con =
  @""Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\temp\test.xls;"" + 
  @""Extended Properties='Excel 8.0;HDR=Yes;'"";    
using(OleDbConnection connection = new OleDbConnection(con))
{
    connection.Open();
    OleDbCommand command = new OleDbCommand(""select * from [Sheet1$]"", connection); 
    using(OleDbDataReader dr = command.ExecuteReader())
    {
         while(dr.Read())
         {
             var row1Col0 = dr[0];
             Console.WriteLine(row1Col0);
         }
    }
}
</code></pre>

<p>This example use the <code>Microsoft.Jet.OleDb.4.0</code> provider to open and read the Excel file. However, if the file is of type xlsx (from Excel 2007 and later), then you need to download the <a href=""https://www.microsoft.com/en-us/download/details.aspx?id=13255"" rel=""noreferrer"">Microsoft Access Database Engine</a> components and install it on the target machine.  </p>

<p>The provider is called <code>Microsoft.ACE.OLEDB.12.0;</code>. Pay attention to the fact that there are two versions of this component, one for 32bit and one for 64bit. Choose the appropriate one for the bitness of your application and what Office version is installed (if any). There are a lot of quirks to have that driver correctly working for your application. <a href=""https://stackoverflow.com/questions/17716207/the-microsoft-ace-oledb-12-0-provider-is-not-registered-on-the-local-machine-w/17716238#17716238"">See this question for example</a>.</p>

<p>Of course you don't need Office installed on the target machine.</p>

<p>While this approach has some merits, I think you should pay particular attention to the link signaled by a comment in your question <a href=""https://stackoverflow.com/questions/15828/reading-excel-files-from-c-sharp"">Reading excel files from C#</a>. There are some problems regarding the correct interpretation of the data types and when the length of data, present in a single excel cell, is longer than 255 characters</p>
","15793583"
"LINQ query to select top five","228032","","<p>I have a LINQ query:</p>

<pre><code>var list = from t in ctn.Items
           where t.DeliverySelection == true &amp;&amp; t.Delivery.SentForDelivery == null
           orderby t.Delivery.SubmissionDate
           select t;
</code></pre>

<p>How can I modify this query to select just five results from the database?</p>
","<pre><code>var list = (from t in ctn.Items
           where t.DeliverySelection == true &amp;&amp; t.Delivery.SentForDelivery == null
           orderby t.Delivery.SubmissionDate
           select t).Take(5);
</code></pre>
","4872958"
"asp.net: Invalid postback or callback argument","227778","","<p>I am getting this error:</p>

<pre><code>Server Error in '/' Application.

Invalid postback or callback argument.  Event validation is enabled using &lt;pages enableEventValidation=""true""/&gt; in configuration or &lt;%@ Page EnableEventValidation=""true"" %&gt; in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.ArgumentException: Invalid postback or callback argument.  Event validation is enabled using &lt;pages enableEventValidation=""true""/&gt; in configuration or &lt;%@ Page EnableEventValidation=""true"" %&gt; in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 


[ArgumentException: Invalid postback or callback argument.  Event validation is enabled using &lt;pages enableEventValidation=""true""/&gt; in configuration or &lt;%@ Page EnableEventValidation=""true"" %&gt; in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.]
   System.Web.UI.ClientScriptManager.ValidateEvent(String uniqueId, String argument) +8627417
   System.Web.UI.WebControls.ListBox.LoadPostData(String postDataKey, NameValueCollection postCollection) +360
   System.Web.UI.WebControls.ListBox.System.Web.UI.IPostBackDataHandler.LoadPostData(String postDataKey, NameValueCollection postCollection) +13
   System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +346
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1743

Version Information: Microsoft .NET Framework Version:2.0.50727.3623; ASP.NET Version:2.0.50727.3618
</code></pre>

<p>What does it mean?</p>

<p>Here is my code:</p>

<pre><code>&lt;%@ Page EnableEventValidation=""true"" Language=""C#"" AutoEventWireup=""true"" CodeBehind=""WebForm1.aspx.cs"" Inherits=""EnterData.DataEntry.WebForm1"" %&gt;    

&lt;!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""&gt;

&lt;html xmlns=""http://www.w3.org/1999/xhtml"" &gt;
&lt;head runat=""server""&gt;
    &lt;title&gt;&lt;/title&gt;

    &lt;script src=""http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"" type=""text/javascript""&gt;&lt;/script&gt;
    &lt;script src=""https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"" type=""text/javascript""&gt;&lt;/script&gt;

    &lt;link href=""../niceforms/niceforms-default.css"" rel=""stylesheet"" type=""text/css"" /&gt;
    &lt;script src=""../niceforms/niceforms.js"" type=""text/javascript""&gt;&lt;/script&gt;

    &lt;link href=""../jquery-ui-1.8.16.custom.css"" rel=""stylesheet"" type=""text/css"" /&gt;
    &lt;style type=""text/css""&gt;
        .list-problems {
        height:600px !important;
        width:200px !important;
        display:inline-block;
    }
    &lt;/style&gt;

    &lt;script&gt;
        jQuery(function($) {
        //$(""#occurrence_dateTextBox"").mask(""99/99/9999"");
        //$(""#&lt;%= report_dateTextBox.ClientID %&gt;"").mask(""99/99/9999"");
        $(""#&lt;%= occurrence_dateTextBox.ClientID %&gt;"").datepicker();
        $(""#&lt;%= report_dateTextBox.ClientID %&gt;"").datepicker();
        //$("".datepicker"").datepicker(); 

    });
    $(function() {
        $.get('../file.txt', function(data) {
            var output = data.split('\n'),
            tmp = '';
            for (i = 0; i &lt; output.length; i++) {
                tmp += '&lt;option value=' + output[i] + '&gt;' + output[i] + '&lt;/option&gt;';
            }
            $('#lstProblems').html(tmp);

        });
    });

    $(function() {
        $(""select"").multiselect();
    });

    function getselectedproblems() {
        var selectedLanguages = new Array();
        jQuery('#lstProblems option:selected').each(function() {
            selectedLanguages.push(jQuery(this).val());
        });
    }

    &lt;/script&gt;

&lt;/head&gt;
&lt;body&gt;&lt;div id=""container""&gt;
    &lt;form id=""form1"" runat=""server"" class=""niceform""&gt;

        &lt;fieldset&gt;

        &lt;legend&gt;Section A&lt;/legend&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""occurrence_dateTextBox"" &gt;Occurrence Date:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""occurrence_dateTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""report_dateTextBox""&gt;Report Date:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""report_dateTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""spec_idTextBox""&gt;Specimen ID:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""spec_idTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""batch_idTextBox""&gt;Batch ID:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""batch_idTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""report_byTextBox""&gt;Report By:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""report_byTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""identified_byTextBox""&gt;Identified ID:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""identified_byTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Section B&lt;/legend&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""problemTextBox""&gt;Problem:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""problemTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;dl&gt;
            &lt;dt&gt;&lt;label for=""lstProblems""&gt;Problems List:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;
                &lt;asp:ListBox ID=""lstProblems"" runat=""server"" SelectionMode=""Multiple"" CssClass=""list-problems""&gt;&lt;/asp:ListBox&gt;
            &lt;/dd&gt;

        &lt;/dl&gt;  

        &lt;dl&gt;
                &lt;dd&gt;&lt;select size=""8"" multiple=""true"" &gt;
                &lt;optgroup label=""Europe""&gt;
                    &lt;option&gt;United Kingdom&lt;/option&gt;
                    &lt;option&gt;Luxembourg&lt;/option&gt;
                &lt;/optgroup&gt;    
                &lt;optgroup label=""Asia""&gt;
                    &lt;option&gt;India&lt;/option&gt;
                    &lt;option&gt;Dubai&lt;/option&gt;
                &lt;/optgroup&gt;
            &lt;/select&gt; &lt;/dd&gt;    
        &lt;/dl&gt;
        &lt;dl&gt;
            &lt;asp:ListBox ID=""ListBox1"" runat=""server"" DataSourceID=""SqlDataSource1"" 
                DataTextField=""batch"" DataValueField=""batch"" SelectionMode=""Multiple"" 
                Height=""100px"" Width=""329px""&gt;&lt;/asp:ListBox&gt;
            &lt;asp:SqlDataSource ID=""SqlDataSource1"" runat=""server"" 
                ConnectionString=""&lt;%$ ConnectionStrings:LOM %&gt;"" 
                SelectCommand=""SELECT [batch] FROM [lom_batch]""&gt;&lt;/asp:SqlDataSource&gt;
        &lt;/dl&gt;

        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Section C&lt;/legend&gt;
        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""section_c_issue_error_identified_byTextBox""&gt;Issue/Error Identified By:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""section_c_issue_error_identified_byTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""section_c_commentsTextBox""&gt;Comments:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""section_c_commentsTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;       

        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Section D&lt;/legend&gt;
        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""section_d_investigationTextBox""&gt;Investigation:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""section_d_investigationTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Section E&lt;/legend&gt;
        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""section_e_corrective_actionTextBox""&gt;Corrective Action:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""section_e_corrective_actionTextBox"" runat=""server"" height=""200"" TextMode=""MultiLine"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;


        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Section F&lt;/legend&gt;
        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""section_f_commentsTextBox""&gt;Comments:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""section_f_commentsTextBox"" runat=""server"" size=""50""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;/fieldset&gt;

        &lt;fieldset&gt;
        &lt;legend&gt;Pre-Analytical&lt;/legend&gt;
        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""prePracticeCodeTextBox""&gt;Practice Code:&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;&lt;asp:TextBox ID=""prePracticeCodeTextBox"" runat=""server"" Visible=""false""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;dl&gt;

            &lt;dt&gt;&lt;label for=""preContactTextBox1""&gt;Contact:&lt;/label&gt;&lt;/dt&gt;

            &lt;dd&gt;&lt;asp:TextBox ID=""preContactTextBox"" runat=""server"" Visible=""false""/&gt;&lt;/dd&gt;


        &lt;/dl&gt;

        &lt;dl&gt;
            &lt;dt&gt;&lt;label for=""CheckBox1""&gt;PreAnalytical?&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt; &lt;asp:CheckBox ID=""CheckBox1"" runat=""server"" CausesValidation=""false""
                            Visible=""true"" AutoPostBack=""true"" OnCheckChanged=""CheckBox1_CheckedChanged""/&gt;&lt;/dd&gt;
        &lt;/dl&gt;

        &lt;/fieldset&gt;

        &lt;asp:Button ID=""Button1"" runat=""server"" Text=""Button"" OnClick=""SubmitData""  OnClientClick=""JSfunction()""/&gt;

    &lt;/form&gt;

&lt;/div&gt;&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>What am I doing wrong? </p>

<p>I am getting this error after I press the submit button.</p>
","<p>in you aspx file  you should put the first line as this : </p>

<pre><code>&lt;%@ Page EnableEventValidation=""false"" %&gt;
</code></pre>

<p>if you already have something like  <code>&lt;%@ Page</code>  so just add the rest => <code>EnableEventValidation=""false"" %&gt;</code></p>

<p>I recommend not to do it.</p>
","7476352"
"How do I remove duplicates from a C# array?","227385","","<p>I have been working with a <code>string[]</code> array in C# that gets returned from a function call. I could possibly cast to a <code>Generic</code> collection, but I was wondering if there was a better way to do it, possibly by using a temp array.</p>

<p><strong>What is the best way to remove duplicates from a C# array?</strong></p>
","<p>You could possibly use a LINQ query to do this:</p>

<pre><code>int[] s = { 1, 2, 3, 3, 4};
int[] q = s.Distinct().ToArray();
</code></pre>
","9685"
"C# getting its own class name","227191","","<p>If I have a class called <code>MyProgram</code>, is there a way of retrieving ""<em>MyProgram</em>"" as a string?</p>
","<p>Try this:</p>

<pre><code>this.GetType().Name
</code></pre>
","2113076"
"Convert XML String to Object","227105","","<p>I am receiving XML strings over a socket, and would like to convert these to C# objects.</p>

<p>The messages are of the form:</p>

<pre><code>&lt;msg&gt;
   &lt;id&gt;1&lt;/id&gt;
   &lt;action&gt;stop&lt;/action&gt;
&lt;/msg&gt;
</code></pre>

<p>I am new to .Net, and am not sure the best practice for performing this. I've used JAXB for Java before, and wasn't sure if there is something similar, or if this would be handled a different way.</p>
","<p>You need to use the <code>xsd.exe</code> tool which gets installed with the Windows SDK into a directory something similar to: </p>

<pre><code>C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin
</code></pre>

<p>And on 64-bit computers:</p>

<pre><code>C:\Program Files (x86)\Microsoft SDKs\Windows\v6.0A\bin
</code></pre>

<p>And on Windows 10 computers:</p>

<pre><code>C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin
</code></pre>

<p>On the first run, you use <code>xsd.exe</code> and you convert your sample XML into a XSD file (XML schema file):</p>

<pre><code>xsd yourfile.xml
</code></pre>

<p>This gives you <code>yourfile.xsd</code>, which in a second step, you can convert again using <code>xsd.exe</code> into a C# class:</p>

<pre><code>xsd yourfile.xsd /c
</code></pre>

<p>This should give you a file <code>yourfile.cs</code> which will contain a C# class that you can use to deserialize the XML file you're getting - something like:</p>

<pre><code>XmlSerializer serializer = new XmlSerializer(typeof(msg));
msg resultingMessage = (msg)serializer.Deserialize(new XmlTextReader(""yourfile.xml""));
</code></pre>

<p>Should work pretty well for most cases.</p>

<p><strong>Update:</strong> the XML serializer will take any stream as its input - either a file or a memory stream will be fine:</p>

<pre><code>XmlSerializer serializer = new XmlSerializer(typeof(msg));
MemoryStream memStream = new MemoryStream(Encoding.UTF8.GetBytes(inputString));
msg resultingMessage = (msg)serializer.Deserialize(memStream);
</code></pre>

<p>or use a StringReader:</p>

<pre><code>XmlSerializer serializer = new XmlSerializer(typeof(msg));
StringReader rdr = new StringReader(inputString);
msg resultingMessage = (msg)serializer.Deserialize(rdr);
</code></pre>
","3187489"
"C# how to create a Guid value?","226182","","<p>One field of our struct is Guid type. How to generate a valid value for it?</p>
","<pre><code>Guid id = Guid.NewGuid();
</code></pre>
","2344107"
"Merging two arrays in .NET","226165","","<p>Is there a built in function in .NET 2.0 that will take two arrays and merge them into one array?</p>

<p>The arrays are both of the same type. I'm getting these arrays from a widely used function within my code base and can't modify the function to return the data in a different format.</p>

<p>I'm looking to avoid writing my own function to accomplish this if possible.</p>
","<p>If you can manipulate one of the arrays, you can resize it before performing the copy:</p>

<pre><code>T[] array1 = getOneArray();
T[] array2 = getAnotherArray();
int array1OriginalLength = array1.Length;
Array.Resize&lt;T&gt;(ref array1, array1OriginalLength + array2.Length);
Array.Copy(array2, 0, array1, array1OriginalLength, array2.Length);
</code></pre>

<p>Otherwise, you can make a new array</p>

<pre><code>T[] array1 = getOneArray();
T[] array2 = getAnotherArray();
T[] newArray = new T[array1.Length + array2.Length];
Array.Copy(array1, newArray, array1.Length);
Array.Copy(array2, 0, newArray, array1.Length, array2.Length);
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.array.aspx"" rel=""noreferrer"">More on available Array methods on MSDN</a>.</p>
","59250"
"Difference between ref and out parameters in .NET","225471","","<p>What is the difference between <code>ref</code> and <code>out</code> parameters in .NET? What are the situations where one can be more useful than the other? What would be a code snippet where one can be used and another can't?</p>
","<p>They're pretty much the same - the only difference is that a variable you pass as an <code>out</code> parameter doesn't need to be initialized but passing it as a <code>ref</code> parameter it has to be set to something.</p>

<pre><code>int x;
Foo(out x); // OK

int y;
Foo(ref y); // Error: y should be initialized before calling the method
</code></pre>

<p><code>Ref</code> parameters are for data that might be modified, <code>out</code> parameters are for data that's an additional output for the function (eg <code>int.TryParse</code>) that are already using the return value for something.</p>
","135257"
"How to hide TabPage from TabControl","225145","","<p>How to hide TabPage from TabControl in WinForms 2.0?</p>
","<p>No, this doesn't exist. You have to remove the tab and re-add it when you want it. Or use a different (3rd-party) tab control.</p>
","552588"
"Using Transactions or SaveChanges(false) and AcceptAllChanges()?","225059","","<p>I have been investigating transactions and it appears that they take care of themselves in EF as long as I pass <code>false</code> to <code>SaveChanges()</code> and then call <code>AcceptAllChanges()</code> if there are no errors:</p>

<pre><code>SaveChanges(false);
// ...
AcceptAllChanges();
</code></pre>

<p>What if something goes bad? don't I have to rollback or, as soon as my method goes out of scope, is the transaction ended?</p>

<p>What happens to any indentiy columns that were assigned half way through the transaction? I presume if somebody else added a record after mine before mine went bad then this means there will be a missing Identity value.</p>

<p>Is there any reason to use the standard <code>TransactionScope</code> class in my code?</p>
","<p>With the Entity Framework most of the time <code>SaveChanges()</code> is sufficient. This creates a transaction, or enlists in any ambient transaction, and does all the necessary work in that transaction.</p>

<p>Sometimes though the <code>SaveChanges(false) + AcceptAllChanges()</code> pairing is useful.</p>

<p>The most useful place for this is in situations where you want to do a distributed transaction across two different Contexts.</p>

<p>I.e. something like this (bad):</p>

<pre><code>using (TransactionScope scope = new TransactionScope())
{
    //Do something with context1
    //Do something with context2

    //Save and discard changes
    context1.SaveChanges();

    //Save and discard changes
    context2.SaveChanges();

    //if we get here things are looking good.
    scope.Complete();
}
</code></pre>

<p>If  <code>context1.SaveChanges()</code> succeeds but <code>context2.SaveChanges()</code> fails the whole distributed transaction is aborted. But unfortunately the Entity Framework has already discarded the changes on <code>context1</code>, so you can't replay or effectively log the failure.</p>

<p>But if you change your code to look like this:</p>

<pre><code>using (TransactionScope scope = new TransactionScope())
{
    //Do something with context1
    //Do something with context2

    //Save Changes but don't discard yet
    context1.SaveChanges(false);

    //Save Changes but don't discard yet
    context2.SaveChanges(false);

    //if we get here things are looking good.
    scope.Complete();
    context1.AcceptAllChanges();
    context2.AcceptAllChanges();

}
</code></pre>

<p>While the call to <code>SaveChanges(false)</code> sends the necessary commands to the database, the context itself is not changed, so you can do it again if necessary, or you can interrogate the <code>ObjectStateManager</code> if you want.</p>

<p>This means if the transaction actually throws an exception you can compensate, by either re-trying or logging state of each contexts <code>ObjectStateManager</code> somewhere.</p>

<p>See <a href=""http://twitter.com/adjames"" rel=""noreferrer"">my</a> <a href=""http://blogs.msdn.com/alexj/archive/2009/01/11/savechanges-false.aspx"" rel=""noreferrer"">blog post</a> for more.</p>
","815660"
"How to SELECT a dropdown list item by value programmatically","224858","","<p>How to SELECT a drop down list item by value programatically in C#.NET?</p>
","<p>If you know that the dropdownlist contains the value you're looking to select, use:</p>

<pre><code>ddl.SelectedValue = ""2"";
</code></pre>

<p>If you're not sure if the value exists, use (or you'll get a null reference exception):</p>

<pre><code>ListItem selectedListItem = ddl.Items.FindByValue(""2"");

if (selectedListItem != null)
{
    selectedListItem.Selected = true;
}
</code></pre>
","1249467"
"Comparing two strings, ignoring case in c#","224850","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/6120154/what-is-difference-between-different-string-compare-methods"">What is difference between different string compare methods</a>  </p>
</blockquote>



<p>Which of the following two is more efficient? (Or maybe is there a third option that's better still?)</p>

<pre><code>string val = ""AStringValue"";

if (val.Equals(""astringvalue"", StringComparison.InvariantCultureIgnoreCase))
</code></pre>

<p>OR</p>

<pre><code>if (val.ToLowerCase() == ""astringvalue"")
</code></pre>

<p>?</p>
","<p>The first one is the correct one, and imho the more efficient one, since the second 'solution' instantiates a new string instance.</p>
","6371239"
"IIS Express enable external request","224820","","<p>How can I enable remote requests in IIS Express? <a href=""http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx"" rel=""noreferrer"">Scott Guthrie wrote that is possible</a> but he didn't say how.</p>
","<p>There's a blog post up on the IIS team site now explaining how to <a href=""http://blogs.iis.net/vaidyg/archive/2010/07/29/serving-external-traffic-with-webmatrix-beta.aspx"" rel=""noreferrer"">enable remote connections on IIS Express</a>. Here is the pertinent part of that post summarized:</p>

<blockquote>
  <p>On Vista and Win7, run the following command from an administrative prompt:</p>
  
  <p><code>netsh http add urlacl url=http://vaidesg:8080/ user=everyone</code></p>
  
  <p>For XP, first install Windows XP Service Pack 2 Support Tools. Then run the following command from an administrative prompt:</p>
  
  <p><code>httpcfg set urlacl /u http://vaidesg1:8080/ /a D:(A;;GX;;;WD)</code></p>
</blockquote>
","3364468"
"Deleting specific rows from DataTable","224486","","<p>I want to delete some rows from DataTable, but it gives an error like this,</p>

<blockquote>
  <p>Collection was modified; enumeration operation might not execute  </p>
</blockquote>

<p>I use for deleting this code,  </p>

<pre><code>foreach(DataRow dr in dtPerson.Rows){
    if(dr[""name""].ToString()==""Joe"")
        dr.Delete();
}
</code></pre>

<p>So, what is the problem and how to fix it? Which method do you advise?  </p>
","<p>If you delete an item from a collection, that collection has been changed and you can't continue to enumerate through it. </p>

<p>Instead, use a For loop, such as:</p>

<pre><code>for(int i = dtPerson.Rows.Count-1; i &gt;= 0; i--)
{
    DataRow dr = dtPerson.Rows[i];
    if (dr[""name""] == ""Joe"")
        dr.Delete();
}
</code></pre>

<p>Note that you are iterating in reverse to avoid skipping a row after deleting the current index.</p>
","5648389"
"Compile to a stand-alone executable (.exe) in Visual Studio","223962","","<p>how can I make a stand-alone exe in Visual Studio. Its just a simple Console application that I think users would not like to install a tiny Console application. I compiled a simple cpp file using the visual studio command prompt. Will the exe work even if the .NET framework is not installed? I used native C++ code.</p>
","<p>Anything using the managed environment (which includes anything written in C# and VB.NET) requires the .NET framework.  You can simply redistribute your .EXE in that scenario, but they'll need to install the appropriate framework if they don't already have it.</p>
","2035104"
"How to get index using LINQ?","223818","","<p>Given a datasource like that:</p>

<pre><code>var c = new Car[]
{
  new Car{ Color=""Blue"", Price=28000},
  new Car{ Color=""Red"", Price=54000},
  new Car{ Color=""Pink"", Price=9999},
  // ..
};
</code></pre>

<p>How can I find the <strong>index</strong> of the first car satisfying a certain condition with LINQ?</p>

<p>EDIT:</p>

<p>I could think of something like this but it looks horrible:</p>

<pre><code>int firstItem = someItems.Select((item, index) =&gt; new    
{    
    ItemName = item.Color,    
    Position = index    
}).Where(i =&gt; i.ItemName == ""purple"")    
  .First()    
  .Position;
</code></pre>

<p>Will it be the best to solve this with a plain old loop?</p>
","<p>An <code>IEnumerable</code> is not an ordered set.<br>
Although most IEnumerables are ordered, some (such as <code>Dictionary</code> or <code>HashSet</code>) are not.</p>

<p>Therefore, LINQ does not have an <code>IndexOf</code> method.</p>

<p>However, you can write one yourself:</p>

<pre><code>///&lt;summary&gt;Finds the index of the first item matching an expression in an enumerable.&lt;/summary&gt;
///&lt;param name=""items""&gt;The enumerable to search.&lt;/param&gt;
///&lt;param name=""predicate""&gt;The expression to test the items against.&lt;/param&gt;
///&lt;returns&gt;The index of the first matching item, or -1 if no items match.&lt;/returns&gt;
public static int FindIndex&lt;T&gt;(this IEnumerable&lt;T&gt; items, Func&lt;T, bool&gt; predicate) {
    if (items == null) throw new ArgumentNullException(""items"");
    if (predicate == null) throw new ArgumentNullException(""predicate"");

    int retVal = 0;
    foreach (var item in items) {
        if (predicate(item)) return retVal;
        retVal++;
    }
    return -1;
}
///&lt;summary&gt;Finds the index of the first occurrence of an item in an enumerable.&lt;/summary&gt;
///&lt;param name=""items""&gt;The enumerable to search.&lt;/param&gt;
///&lt;param name=""item""&gt;The item to find.&lt;/param&gt;
///&lt;returns&gt;The index of the first matching item, or -1 if the item was not found.&lt;/returns&gt;
public static int IndexOf&lt;T&gt;(this IEnumerable&lt;T&gt; items, T item) { return items.FindIndex(i =&gt; EqualityComparer&lt;T&gt;.Default.Equals(item, i)); }
</code></pre>
","2471631"
"Use LINQ to get items in one List<>, that are not in another List<>","223538","","<p>I would assume there's a simple LINQ query to do this, I'm just not exactly sure how.  Please see code snippet below, the comment explains what I'd like to do:</p>

<pre><code>class Program
{
    static void Main(string[] args)
    {
        List&lt;Person&gt; peopleList1 = new List&lt;Person&gt;();
        peopleList1.Add(new Person() { ID = 1 });
        peopleList1.Add(new Person() { ID = 2 });
        peopleList1.Add(new Person() { ID = 3 });

        List&lt;Person&gt; peopleList2 = new List&lt;Person&gt;();
        peopleList2.Add(new Person() { ID = 1 });
        peopleList2.Add(new Person() { ID = 2 });
        peopleList2.Add(new Person() { ID = 3 });
        peopleList2.Add(new Person() { ID = 4 });
        peopleList2.Add(new Person() { ID = 5 });

        //I would like to perform a LINQ query to give me all
        //of the people in 'peopleList2' that are not in 'peopleList1'
        //this example should give me two people (ID = 4 &amp; ID = 5)
    }
}

class Person
{
    public int ID { get; set; }
}
</code></pre>
","<pre><code>var result = peopleList2.Where(p =&gt; !peopleList1.Any(p2 =&gt; p2.ID == p.ID));
</code></pre>
","3944816"
"Comparing two byte arrays in .NET","223493","","<p>How can I do this fast?</p>

<p>Sure I can do this:</p>

<pre><code>static bool ByteArrayCompare(byte[] a1, byte[] a2)
{
    if (a1.Length != a2.Length)
        return false;

    for (int i=0; i&lt;a1.Length; i++)
        if (a1[i]!=a2[i])
            return false;

    return true;
}
</code></pre>

<p>But I'm looking for either a <a href=""https://en.wikipedia.org/wiki/Standard_Libraries_%28CLI%29#Base_Class_Library"" rel=""noreferrer"">BCL</a> function or some highly optimized proven way to do this.</p>

<pre><code>java.util.Arrays.equals((sbyte[])(Array)a1, (sbyte[])(Array)a2);
</code></pre>

<p>works nicely, but it doesn't look like that would work for x64.</p>

<p>Note my super-fast answer <a href=""https://stackoverflow.com/a/8808245/4489"">here</a>.</p>
","<p>User <em>gil</em> suggested unsafe code which spawned this solution:</p>

<pre><code>// Copyright (c) 2008-2013 Hafthor Stefansson
// Distributed under the MIT/X11 software license
// Ref: http://www.opensource.org/licenses/mit-license.php.
static unsafe bool UnsafeCompare(byte[] a1, byte[] a2) {
  if(a1==a2) return true;
  if(a1==null || a2==null || a1.Length!=a2.Length)
    return false;
  fixed (byte* p1=a1, p2=a2) {
    byte* x1=p1, x2=p2;
    int l = a1.Length;
    for (int i=0; i &lt; l/8; i++, x1+=8, x2+=8)
      if (*((long*)x1) != *((long*)x2)) return false;
    if ((l &amp; 4)!=0) { if (*((int*)x1)!=*((int*)x2)) return false; x1+=4; x2+=4; }
    if ((l &amp; 2)!=0) { if (*((short*)x1)!=*((short*)x2)) return false; x1+=2; x2+=2; }
    if ((l &amp; 1)!=0) if (*((byte*)x1) != *((byte*)x2)) return false;
    return true;
  }
}
</code></pre>

<p>which does 64-bit based comparison for as much of the array as possible. This kind of counts on the fact that the arrays start qword aligned. It'll work if not qword aligned, just not as fast as if it were.</p>

<p><p>It performs about seven timers faster than the simple <code>for</code> loop. Using the J# library performed equivalently to the original <code>for</code> loop. Using .SequenceEqual runs around seven times slower; I think just because it is using IEnumerator.MoveNext. I imagine LINQ-based solutions being at least that slow or worse.</p>
","8808245"
"Convert Linq Query Result to Dictionary","223284","","<p>I want to add some rows to a database using Linq to SQL, but I want to make a ""custom check"" before adding the rows to know if I must add, replace or ignore the incomming rows.
I'd like to keep the trafic between the client and the DB server as low as possible and minimize the number of queries.</p>

<p>To do this, I want to fetch as little information as required for the validation, and only once at the beginning of the process.</p>

<p>I was thinking of doing something like this, but obviously, it doesn't work. Anyone have an idea?</p>

<pre><code>Dictionary&lt;int, DateTime&gt; existingItems = 
    (from ObjType ot in TableObj
        select (new KeyValuePair&lt;int, DateTime&gt;(ot.Key, ot.TimeStamp))
    )
</code></pre>

<p>What I'd like to have at the end would be a Dictionary, without having to download the whole ObjectType objects from TableObject.</p>

<p>I also considered the following code, but I was trying to find a proper way:</p>

<pre><code>List&lt;int&gt; keys = (from ObjType ot in TableObj orderby ot.Key select ot.Key).ToList&lt;int&gt;();
List&lt;DateTime&gt; values = (from ObjType ot in TableObj orderby ot.Key select ot.Value).ToList&lt;int&gt;();
Dictionary&lt;int, DateTime&gt; existingItems = new Dictionary&lt;int, DateTime&gt;(keys.Count);
for (int i = 0; i &lt; keys.Count; i++)
{
    existingItems.Add(keys[i], values[i]);
}
</code></pre>
","<p>Try using <a href=""https://msdn.microsoft.com/en-us/library/bb548657(v=vs.90).aspx"" rel=""noreferrer"">the <code>ToDictionary</code> method</a> like so:</p>

<pre><code>var dict = TableObj.Select( t =&gt; new { t.Key, t.TimeStamp } )
                   .ToDictionary( t =&gt; t.Key, t =&gt; t.TimeStamp );
</code></pre>
","954086"
"Selenium c# Webdriver: Wait Until Element is Present","223274","","<p>I want to make sure that an element is present before the webdriver starts doing stuff. </p>

<p>I'm trying to get something like this to work: </p>

<pre><code>WebDriverWait wait = new WebDriverWait(driver, new TimeSpan(0,0,5));
wait.Until(By.Id(""login""));
</code></pre>

<p>I'm  mainly struggling how to setup up the anynomous function..</p>
","<p>Alternatively you can use implicit wait:</p>

<pre><code>driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(10);
</code></pre>

<blockquote>
  <p>An implicit wait is to tell WebDriver to poll the DOM for a certain
  amount of time when trying to find an element or elements if they are
  not immediately available. The default setting is 0. Once set, the
  implicit wait is set for the life of the WebDriver object instance.</p>
</blockquote>
","6993597"
"How to access html form input from asp.net code behind","222979","","<p>I have a basic HTML form that gets inserted into a server side div tag based on how many records exist in the database. This HTML form comes out just fine, and everything looks good. But on my action page I cannot seem to access the input elements from the code behind. I have tried using the Request scope but have come up empty on that approach. Any other suggestions?</p>

<p>All of the below suggestions are great, and normally that is what I would do. But these forms are being built on the fly after the page is being compiled, so runat='server' did not do anything for me. It just passed that along to the html page.</p>
","<p>If you are accessing a plain HTML form, it has to be submitted to the server via a submit button (or via javascript post).  This usually means that your form definition will look like this (I'm going off of memory, make sure you check the html elements are correct):</p>

<pre><code>&lt;form method=""POST"" action=""page.aspx""&gt;

&lt;input id=""customerName"" name=""customerName"" type=""Text"" /&gt;
&lt;input id=""customerPhone"" name=""customerPhone"" type=""Text"" /&gt;
&lt;input value=""Save"" type=""Submit"" /&gt;

&lt;/form&gt;
</code></pre>

<p>You should be able to access the customerName and customerPhone data like this:</p>

<pre><code>string n = String.Format(""{0}"", Request.Form[""customerName""]);
</code></pre>

<p>If you have <code>method=""GET""</code> in the form (not recommended, it messes up your URL space), you will have to access the form data like this:</p>

<pre><code>string n = String.Format(""{0}"", Request.QueryString[""customerName""]);
</code></pre>

<p>This of course will only work if the form was 'Posted', 'Submitted', or done via a 'Postback'. (i.e. somebody clicked the 'Save' button, or this was done programatically via javascript.)</p>

<p>Also, keep in mind that accessing these elements in this manner can only be done when you are not using server controls (i.e. <code>runat=""server""</code>), with server controls the id and name are different.</p>
","389344"
"How to make method call another one in classes C#?","222752","","<p>Now I have two classes <code>AllMethods.cs</code> and <code>caller.cs</code>.</p>

<p>I have some methods in class <code>AllMethods.cs</code>. I want to write a code in <code>caller.cs</code> in order to call a certain method in the <code>AllMethods.cs</code>.</p>

<p>Example on code:</p>

<pre><code>public class allmethods
public static void Method1()
{
    // Method1
}

public static void Method2()
{
    // Method2
}

class caller
{
    public static void Main(string[] args)
    {
        // I want to write a code here to call Method2 for example from AllMethods Class
    }
}
</code></pre>

<p>How can I achieve that? Any Help?</p>

<p>Thanks.</p>
","<p>Because the <code>Method2</code> is static, all you have to do is call like this:</p>

<pre><code>public class AllMethods
{
    public static void Method2()
    {
        // code here
    }
}

class Caller
{
    public static void Main(string[] args)
    {
        AllMethods.Method2();
    }
}
</code></pre>

<p>If they are in different namespaces you will also need to add the namespace of <code>AllMethods</code> to caller.cs in a <code>using</code> statement.</p>

<p>If you wanted to call an instance method (non-static), you'd need an instance of the class to call the method on. For example:</p>

<pre><code>public class MyClass
{
    public void InstanceMethod() 
    { 
        // ...
    }
}

public static void Main(string[] args)
{
    var instance = new MyClass();
    instance.InstanceMethod();
}
</code></pre>

<p><strong>Further Reading</strong></p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/79b3xss3.aspx"">Static Classes and Static Class Members (C# Programming Guide)</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/ms173114.aspx"">Methods (C# Programming Guide)</a></li>
</ul>
","16226459"
"How to add new line into txt file","222446","","<p>I'd like to add new line with text to my date.txt file, but instead of adding it into existing date.txt, app is creating new date.txt file..</p>

<pre><code>TextWriter tw = new StreamWriter(""date.txt"");

// write a line of text to the file
tw.WriteLine(DateTime.Now);

// close the stream
tw.Close();
</code></pre>

<p>I'd like to open txt file, add some text, close it, and later after clicking something: open date.txt, add text, and close it again.</p>

<p>So i can get: </p>

<p>Button pressed: txt opened -> added current time, then close it. Another button pressed, txt opened -> added text ""OK"", or ""NOT OK"" in the same line, then close it again.</p>

<p>So my txt file will look like that:</p>

<pre><code>2011-11-24 10:00:00 OK
2011-11-25 11:00:00 NOT OK
</code></pre>

<p>How can i do this? Thanks!</p>
","<p>You could do it easily using</p>

<pre><code>File.AppendAllText(""date.txt"", DateTime.Now.ToString());
</code></pre>

<p>If you need newline</p>

<pre><code>File.AppendAllText(""date.txt"", 
                   DateTime.Now.ToString() + Environment.NewLine);
</code></pre>

<p>Anyway if you need your code do this:</p>

<pre><code>TextWriter tw = new StreamWriter(""date.txt"", true);
</code></pre>

<p>with second parameter telling to append to file.<br>
Check <a href=""http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx"">here</a> StreamWriter syntax.</p>
","8255544"
"500.19 - Internal Server Error - The requested page cannot be accessed because the related configuration data for the page is invalid","222415","","<p>Before everyone reads this, I just want to say that i know that there are related threads out there, but I have either tried them or do not understand. With that being said here goes nothing...</p>

<p>I am trying to get a MVC Web App running in my IIS. Unfortunately, I am absolutely stuck on this error:</p>

<pre><code>HTTP Error 500.19 - Internal Server Error

The Request page cannot be accessed becasue the related configuration data for 
the page is invalid.

Module: IIS Web Core
Notification: BeginRequest
Handler: Not yet determined
Error Code: 0x80070005
Config Error: Cannot read configuration file due to insufficient permissions
Config File: \foo\web.config
Request URL: http://localhost/WEBAPP
Logon Method: Not yet determined
Logon User: Not yet determined

Config Source
-1:
0:
</code></pre>

<p>I am not quite sure what else to do. I have also tried giving read permission to the web.config file and that did not seem to work.</p>

<p>If anyone has any information or would be able to help me work through this it would be much appreciated. Thanks!</p>
","<p>On this <a href=""http://blogs.msdn.com/b/webtopics/archive/2010/03/08/troubleshooting-http-500-19-errors-in-iis-7.aspx"">msdn blog: Troubleshooting HTTP 500.19 Errors in IIS 7</a> in sceanrio 8  for error code 0x80070005 (E_ACCESSDENIED - General access denied error)  it says:</p>

<p><code>Grant Read permission to the IIS_IUSRS group ...<br>
.... the worker process identity (and/or the IIS_IUSRS group) needs at least Read access to the directory so that it can check for a web.config file in that directory.</code></p>
","18621550"
"Enter key press in C#","222121","","<p>I tried this code:</p>

<pre><code>private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (Convert.ToInt32(e.KeyChar) == 13) 
    {
        MessageBox.Show("" Enter pressed "");
    }
}
</code></pre>

<p>and this:</p>

<pre><code>private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == Convert.ToChar(Keys.Enter))
    {
        MessageBox.Show("" Enter pressed "");
    }
}
</code></pre>

<p>and this:</p>

<pre><code>private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == Keys.Enter)
    {
        MessageBox.Show("" Enter pressed "");
    }
}
</code></pre>

<p>but they're not working...</p>

<p>When I write something and press <kbd>Enter</kbd>, it doesn't work. It only highlights my text.</p>
","<p>Try this code,might work (Assuming windows form):</p>

<pre><code>    private void CheckEnter(object sender, System.Windows.Forms.KeyPressEventArgs e)
    {
       if (e.KeyChar == (char)13)
       {
         // Enter key pressed
       }
    }
</code></pre>

<p>Register the event like this :</p>

<pre><code>this.textBox1.KeyPress += new System.Windows.Forms.KeyPressEventHandler(CheckEnter);
</code></pre>
","12318224"
"How to get the index of an item in a list in a single step?","221829","","<p>How can I find the index of an item in a list without looping through it?</p>

<p>Currently this doesn't look very nice - searching through the list for the same item twice, just to get the index:</p>

<pre><code>var oProp = something;

int theThingIActuallyAmInterestedIn = myList.IndexOf(myList.Single(i =&gt; i.Prop == oProp));
</code></pre>
","<p>How about the <a href=""http://msdn.microsoft.com/en-us/library/0k601hd9.aspx"">List.FindIndex Method</a>:</p>

<pre><code>int index = myList.FindIndex(a =&gt; a.Prop == oProp);
</code></pre>

<blockquote>
  <p>This method performs a linear search; therefore, this method is an
  O(n) operation, where n is Count.</p>
</blockquote>
","17995892"
"Filtering DataGridView without changing datasource","221686","","<p>I'm developing user control in C# Visual Studio 2010 - a kind of ""quick find"" textbox for filtering datagridview. It should work for 3 types of datagridview datasources: DataTable, DataBinding and DataSet.
My problem is with filtering DataTable from DataSet object, which is displayed on DataGridView.</p>

<p>There could be 3 cases (examples for standard WinForm application with DataGridView and TextBox on it) - first 2 are working OK, I've problem with 3rd one:</p>

<p><strong>1. datagridview.DataSource = dataTable : it works</strong><br>
so I can filter by setting: dataTable.DefaultView.RowFilter = ""country LIKE '%s%'"";  </p>

<pre><code>DataTable dt = new DataTable();

private void Form1_Load(object sender, EventArgs e)
{
    dt.Columns.Add(""id"", typeof(int));
    dt.Columns.Add(""country"", typeof(string));

    dt.Rows.Add(new object[] { 1, ""Belgium"" });
    dt.Rows.Add(new object[] { 2, ""France"" });
    dt.Rows.Add(new object[] { 3, ""Germany"" });
    dt.Rows.Add(new object[] { 4, ""Spain"" });
    dt.Rows.Add(new object[] { 5, ""Switzerland"" });
    dt.Rows.Add(new object[] { 6, ""United Kingdom"" });

    dataGridView1.DataSource = dt;
}

private void textBox1_TextChanged(object sender, EventArgs e)
{
    MessageBox.Show(""DataSource type BEFORE = "" + dataGridView1.DataSource.GetType().ToString());

    dt.DefaultView.RowFilter = string.Format(""country LIKE '%{0}%'"", textBox1.Text);

    MessageBox.Show(""DataSource type AFTER = "" + dataGridView1.DataSource.GetType().ToString());
} 
</code></pre>

<p><strong>2. datagridview.DataSource = bindingSource: it works</strong><br>
so I can filter by setting: bindingSource.Filter = ""country LIKE '%s%'"";  </p>

<pre><code>DataTable dt = new DataTable();
BindingSource bs = new BindingSource();

private void Form1_Load(object sender, EventArgs e)
{
    dt.Columns.Add(""id"", typeof(int));
    dt.Columns.Add(""country"", typeof(string));

    dt.Rows.Add(new object[] { 1, ""Belgium"" });
    dt.Rows.Add(new object[] { 2, ""France"" });
    dt.Rows.Add(new object[] { 3, ""Germany"" });
    dt.Rows.Add(new object[] { 4, ""Spain"" });
    dt.Rows.Add(new object[] { 5, ""Switzerland"" });
    dt.Rows.Add(new object[] { 6, ""United Kingdom"" });

    bs.DataSource = dt;
    dataGridView1.DataSource = bs;
}

private void textBox1_TextChanged(object sender, EventArgs e)
{
    MessageBox.Show(""DataSource type BEFORE = "" + dataGridView1.DataSource.GetType().ToString());

    bs.Filter = string.Format(""country LIKE '%{0}%'"", textBox1.Text);

    MessageBox.Show(""DataSource type AFTER = "" + dataGridView1.DataSource.GetType().ToString());
}
</code></pre>

<p><strong>3. datagridview.DataSource = dataSource; datagridview.DataMember = ""TableName"": it doesn't work</strong><br>
It happens when you design a table using designer: put the DataSet from toolbox on form, add dataTable to it and then set datagridview.DataSource = dataSource; and datagridview.DataMember = ""TableName"".<br>
Code below pretends these operations:  </p>

<pre><code>DataSet ds = new DataSet();
DataTable dt = new DataTable();

private void Form1_Load(object sender, EventArgs e)
{
    dt.Columns.Add(""id"", typeof(int));
    dt.Columns.Add(""country"", typeof(string));

    dt.Rows.Add(new object[] { 1, ""Belgium"" });
    dt.Rows.Add(new object[] { 2, ""France"" });
    dt.Rows.Add(new object[] { 3, ""Germany"" });
    dt.Rows.Add(new object[] { 4, ""Spain"" });
    dt.Rows.Add(new object[] { 5, ""Switzerland"" });
    dt.Rows.Add(new object[] { 6, ""United Kingdom"" });

    ds.Tables.Add(dt);
    dataGridView1.DataSource = ds;
    dataGridView1.DataMember = dt.TableName;
}

private void textBox1_TextChanged(object sender, EventArgs e)
{
    MessageBox.Show(""DataSource type BEFORE = "" + dataGridView1.DataSource.GetType().ToString());  
    //it is not working
    ds.Tables[0].DefaultView.RowFilter = string.Format(""country LIKE '%{0}%'"", textBox1.Text);

    MessageBox.Show(""DataSource type AFTER = "" + dataGridView1.DataSource.GetType().ToString());
}
</code></pre>

<p>If you test it - although datatable is filtered (ds.Tables[0].DefaultView.Count changes), datagridview is not updated...
I've been looking for a long time for any solution, but the problem is that <strong>DataSource cannot change</strong> - as it's additional control, I don't want it to mess up with programmer's code.  </p>

<p>I know possible solutions are:<br>
- to bind DataTable from DataSet using DataBinding and use it as example 2: but it's up to the programmer during code writing,<br>
- to change dataSource to BindingSource, dataGridView.DataSource = dataSet.Tables[0], or to DefaultView programatically: however, it changes the DataSource. So the solution:  </p>

<pre><code>private void textBox1_TextChanged(object sender, EventArgs e)
{
    MessageBox.Show(""DataSource type BEFORE = "" + dataGridView1.DataSource.GetType().ToString(), ds.Tables[0].DefaultView.Count.ToString());

    DataView dv = ds.Tables[0].DefaultView;
    dv.RowFilter = string.Format(""country LIKE '%{0}%'"", textBox1.Text);
    dataGridView1.DataSource = dv;

    MessageBox.Show(""DataSource type AFTER = "" + dataGridView1.DataSource.GetType().ToString(), ds.Tables[0].DefaultView.Count.ToString());
}
</code></pre>

<p>is not acceptable, as you see on MessageBox's dataSource is changing...  </p>

<p>I don't want to do that, because it's possible a programmer writes code similar to this:</p>

<pre><code>private void textBox1_TextChanged(object sender, EventArgs e)
{
    MessageBox.Show(""DataSource type BEFORE = "" + dataGridView1.DataSource.GetType().ToString(), ds.Tables[0].DefaultView.Count.ToString());

    DataSet dsTmp = (DataSet)(dataGridView1.DataSource);   //&lt;--- it is OK 

    DataView dv = ds.Tables[0].DefaultView;
    dv.RowFilter = string.Format(""country LIKE '%{0}%'"", textBox1.Text);
    dataGridView1.DataSource = dv;   //&lt;--- here the source is changeing from DataSet to DataView

    MessageBox.Show(""DataSource type AFTER = "" + dataGridView1.DataSource.GetType().ToString(), ds.Tables[0].DefaultView.Count.ToString());

    dsTmp = (DataSet)(dataGridView1.DataSource);    //&lt;-- throws an exception: Unable to cast object DataView to DataSet
}
</code></pre>

<p>He can do that, as he designed DataGridView with DataSet and DataMember in designer.
Code will be compiled, however, after using a filter, it will throw an exception...</p>

<p>So the question is: how can I filter DataTable in DataSet and show the results on DataGridView without changing DataSource to another? Why I can filter DataTable from example 1 directly, while filtering DataTable from DataSet is not working?
Maybe it's not DataTable bound to DataGridView in that case?  </p>

<p>Please note, that my problem takes from designing issues, so the solution MUST WORK on example 3. </p>
","<p>I just spent an hour on a similar problem.  For me the answer turned out to be embarrassingly simple.</p>

<pre><code>(dataGridViewFields.DataSource as DataTable).DefaultView.RowFilter = string.Format(""Field = '{0}'"", textBoxFilter.Text);
</code></pre>
","10049875"
".NET HttpClient. How to POST string value?","220392","","<p>How can I create using C# and HttpClient the following POST request:
<img src=""https://i.stack.imgur.com/yp8jr.png"" alt=""User-Agent: Fiddler Content-type: application/x-www-form-urlencoded Host: localhost:6740 Content-Length: 6""></p>

<p>I need such a request for my WEB API service:</p>

<pre><code>[ActionName(""exist"")]
[System.Web.Mvc.HttpPost]
public bool CheckIfUserExist([FromBody] string login)
{           
    bool result = _membershipProvider.CheckIfExist(login);
    return result;
}
</code></pre>
","<pre><code>using System;
using System.Collections.Generic;
using System.Net.Http;

class Program
{
    static void Main(string[] args)
    {
        Task.Run(() =&gt; MainAsync());
        Console.ReadLine();
    }

    static async Task MainAsync()
    {
        using (var client = new HttpClient())
        {
            client.BaseAddress = new Uri(""http://localhost:6740"");
            var content = new FormUrlEncodedContent(new[]
            {
                new KeyValuePair&lt;string, string&gt;("""", ""login"")
            });
            var result = await client.PostAsync(""/api/Membership/exists"", content);
            string resultContent = await result.Content.ReadAsStringAsync();
            Console.WriteLine(resultContent);
        }
    }
}
</code></pre>
","15176685"
"Getter and Setter declaration in .NET","220152","","<p>I was wondering what were the differences between those declaration of getters and setters and if there is a preferred method (and why). The first one can be generated automaticly by Visual Studio. How about the others ? Thanks</p>

<p>1st</p>

<pre><code>string _myProperty { get; set; }
</code></pre>

<p>2nd</p>

<pre><code>string _myProperty;

public string myProperty
{
    get { return _myProperty; }
    set { _myProperty = value; }
}
</code></pre>

<p>3rd</p>

<pre><code>string _myProperty;

public getMyProperty()
{
  return this._myProperty;
}

public setMyProperty(string value)
{
  this._myProperty = value;
}
</code></pre>
","<p>Properties are used to encapsulate some data. You could use a plain field:</p>

<pre><code>public string MyField
</code></pre>

<p>But this field can be accessed by all outside users of your class. People can insert illegal values or change the value in ways you didn't expect.</p>

<p>By using a property, you can encapsulate the way your data is accessed. C# has a nice syntax for turning a field into a property:</p>

<pre><code>string MyProperty { get; set; }
</code></pre>

<p>This is called an <a href=""http://msdn.microsoft.com/en-us/library/bb384054.aspx"">auto-implemented property</a>. When the need arises you can expand your property to:</p>

<pre><code>string _myProperty;

public string MyProperty
{
    get { return _myProperty; }
    set { _myProperty = value; }
}
</code></pre>

<p>Now you can add code that validates the value in your <code>setter</code>:</p>

<pre><code>set
{
    if (string.IsNullOrWhiteSpace(value))
        throw new ArgumentNullException();

    _myProperty = value;
}
</code></pre>

<p>Properties can also have different accessors for the getter and the setter:</p>

<pre><code>public string MyProperty { get; private set; }
</code></pre>

<p>This way you create a property that can be read by everyone but can only be modified by the class itself.</p>

<p>You can also add a completely custom implementation for your <code>getter</code>:</p>

<pre><code>public string MyProperty
{
    get
    {
        return DateTime.Now.Second.ToString();
    }
}
</code></pre>

<p>When C# compiles your auto-implemented property, it generates Intermediate Language (IL). In your IL you will see a <code>get_MyProperty</code> and <code>set_MyProperty</code> method. It also creates a backing field called <code>&lt;MyProperty&gt;k_BackingField</code> (normally this would be an illegal name in C# but in IL it's valid. This way you won't get any conflicts between generated types and your own code). However, you should use the official property syntax in C#. This creates a nicer experience in C# (for example with IntelliSense).</p>

<p>By convention, you shouldn't use properties for operations that take a long time.</p>
","17881367"
"#if DEBUG vs. Conditional(""DEBUG"")","219957","","<p>Which is better to use, and why, on a large project:</p>

<pre><code>#if DEBUG
    public void SetPrivateValue(int value)
    { ... }
#endif
</code></pre>

<p>or</p>

<pre><code>[System.Diagnostics.Conditional(""DEBUG"")]
public void SetPrivateValue(int value)
{ ... }
</code></pre>
","<p>It really depends on what you're going for:</p>

<ul>
<li><code>#if DEBUG</code>: The code in here won't even reach the IL on release.</li>
<li><code>[Conditional(""DEBUG"")]</code>: This code will reach the IL, however <em>calls</em> to the method will be omitted unless DEBUG is set when the caller is compiled.</li>
</ul>

<p>Personally I use both depending on the situation:</p>

<p><b>Conditional(""DEBUG"") Example:</b> I use this so that I don't have to go back and edit my code later during release, but during debugging I want to be sure I didn't make any typos. This function checks that I type a property name correctly when trying to use it in my INotifyPropertyChanged stuff.</p>

<pre><code>[Conditional(""DEBUG"")]
[DebuggerStepThrough]
protected void VerifyPropertyName(String propertyName)
{
    if (TypeDescriptor.GetProperties(this)[propertyName] == null)
        Debug.Fail(String.Format(""Invalid property name. Type: {0}, Name: {1}"",
            GetType(), propertyName));
}
</code></pre>

<p>You really don't want to create a function using <code>#if DEBUG</code> unless you are willing to wrap every call to that function with the same <code>#if DEBUG</code>:</p>

<pre><code>#if DEBUG
    public void DoSomething() { }
#endif

    public void Foo()
    {
#if DEBUG
        DoSomething(); //This works, but looks FUGLY
#endif
    }
</code></pre>

<p>versus:</p>

<pre><code>[Conditional(""DEBUG"")]
public void DoSomething() { }

public void Foo()
{
    DoSomething(); //Code compiles and is cleaner, DoSomething always
                   //exists, however this is only called during DEBUG.
}
</code></pre>

<hr>

<p><b>#if DEBUG example:</b> I use this when trying to setup different bindings for WCF communication.</p>

<pre><code>#if DEBUG
        public const String ENDPOINT = ""Localhost"";
#else
        public const String ENDPOINT = ""BasicHttpBinding"";
#endif
</code></pre>

<p>In the first example, the code all exists, but is just ignored unless DEBUG is on. In the second example, the const ENDPOINT is set to ""Localhost"" or ""BasicHttpBinding"" depending on if DEBUG is set or not.</p>

<hr>

<p>Update: Because this answer is the highest voted answer to the question, I am updating this answer to clarify an important and tricky point. If you choose to use the <code>ConditionalAttribute</code>, keep in mind that calls are omitted during compilation, and <strong>not runtime</strong>. That is:</p>

<p>MyLibrary.dll</p>

<pre><code>[Conditional(""DEBUG"")]
public void A()
{
    Console.WriteLine(""A"");
    B();
}

[Conditional(""DEBUG"")]
public void B()
{
    Console.WriteLine(""B"");
}
</code></pre>

<p>When the library is compiled against release mode (i.e. no DEBUG symbol), it will forever have the call to <code>B()</code> from within <code>A()</code> omitted, even if a call to <code>A()</code> is included because DEBUG is defined in the calling assembly.</p>
","3788719"
"SQL update statement in C#","219410","","<p>I have table  <strong>""Student""</strong></p>

<pre><code>   P_ID   LastName  FirstName  Address  City

   1        Hansen    Ola                
   2        Svendson   Tove
   3        Petterson   Kari
   4        Nilsen       Johan
...and so on 
</code></pre>

<p>How do i change edit code in C#</p>

<pre><code> string firstName = ""Ola"";
 string  lastName =""Hansen"";
 string  address = ""ABC"";
 string city = ""Salzburg"";

 string connectionString = System.Configuration.ConfigurationManager
                          .ConnectionStrings[""LocalDB""].ConnectionString;

 using (SqlConnection connection = new SqlConnection(connectionString))
     using (SqlCommand command = connection.CreateCommand())
 { 
   command.CommandText = ""INSERT INTO Student (LastName, FirstName, Address, City) 
                          VALUES (@ln, @fn, @add, @cit)"";

   command.Parameters.AddWithValue(""@ln"", lastName);
   command.Parameters.AddWithValue(""@fn"", firstName);
   command.Parameters.AddWithValue(""@add"", address);
   command.Parameters.AddWithValue(""@cit"", city);

   connection.Open();

   command.ExecuteNonQuery();

   connection.Close();
 } 
</code></pre>

<p>to edit entry  where <strong>Lastname</strong> field has lastname value and <strong>FirstName</strong> field has firstname  value.  </p>

<p>I dont want to use like this </p>

<pre><code> UPDATE Persons  SET Address='Nissestien 67', City='Sandnes' 
 WHERE LastName='Tjessem'     AND FirstName='Jakob'
</code></pre>

<p>and i edited my original statement to </p>

<pre><code> command.CommandText = ""UPDATE Student(LastName, FirstName, Address, City) 
   VALUES (@ln, @fn, @add, @cit) WHERE LastName='"" + lastName + 
                           ""' AND FirstName='"" +  firstName+""'"";
</code></pre>

<p>but the statement is not getting executed, why is it throwing SQL exception ? Is there nay solution to it ?</p>
","<p>This is not a correct method of updating record in SQL:</p>

<pre><code>command.CommandText = ""UPDATE Student(LastName, FirstName, Address, City) VALUES (@ln, @fn, @add, @cit) WHERE LastName='"" + lastName + ""' AND FirstName='"" + firstName+""'"";
</code></pre>

<p>You should write it like this:</p>

<pre><code>command.CommandText = ""UPDATE Student 
SET Address = @add, City = @cit Where FirstName = @fn and LastName = @add"";
</code></pre>

<p>Then you add the parameters same as you added them for the insert operation.</p>
","15246246"
"ASP.NET Custom Validator Client side & Server Side validation not firing","218954","","<p>This has not happened to me before, but for some reason both the client and server side validation events are not being triggered:</p>

<pre><code>&lt;asp:TextBox ID=""TextBoxDTownCity"" runat=""server"" CssClass=""contactfield"" /&gt;
&lt;asp:CustomValidator ID=""CustomValidator2"" runat=""server"" EnableClientScript=""true""
    ErrorMessage=""Delivery Town or City required""
    ClientValidationFunction=""TextBoxDTownCityClient"" 
    ControlToValidate=""TextBoxDTownCity""
    OnServerValidate=""TextBoxDTownCity_Validate"" Display=""Dynamic"" &gt;
&lt;/asp:CustomValidator&gt;
</code></pre>

<p>Server-side validation event:</p>

<pre><code>protected void TextBoxDTownCity_Validate(object source, ServerValidateEventArgs args)
{
    args.IsValid = false;
}
</code></pre>

<p>Client-side validation event:</p>

<pre><code>function TextBoxDCountyClient(sender, args) {
    args.IsValid = false;
    alert(""test"");
}
</code></pre>

<p>I thought at the least the Server Side validation would fire but no.  this has never happened to me before.  This has really got me stumped.</p>

<p>I looked at the output and ASP.NET is recognizing the client side function:</p>

<p>ASP.NET JavaScript output:</p>

<pre><code>var ctl00_ctl00_content_content_CustomValidator2 = document.all ? document.all[""ctl00_ctl00_content_content_CustomValidator2""] : document.getElementById(""ctl00_ctl00_content_content_CustomValidator2"");

ctl00_ctl00_content_content_CustomValidator2.controltovalidate = ""ctl00_ctl00_content_content_TextBoxDTownCity"";

ctl00_ctl00_content_content_CustomValidator2.errormessage = ""Delivery Town or City required"";

ctl00_ctl00_content_content_CustomValidator2.display = ""Dynamic"";

ctl00_ctl00_content_content_CustomValidator2.evaluationfunction = ""CustomValidatorEvaluateIsValid"";

ctl00_ctl00_content_content_CustomValidator2.clientvalidationfunction = ""TextBoxDTownCityClient"";
</code></pre>

<p>Rendered custom validator:</p>

<pre><code>&lt;span id=""ctl00_ctl00_content_content_CustomValidator2"" style=""color:Red;display:none;""&gt;Delivery Town or City required&lt;/span&gt; 
</code></pre>

<p>Can any one shed some light as to why both client and server side validation would not be firing.</p>

<p><strong>Edit: Typo I pasted in the wrong function, problem still the same</strong></p>

<p>Just another update to the last comment: where by the TextBox cannot be empty.  I tested this out and it is not true.  On a blank page the CustomValidator fired my client side validation function fine without a value:</p>

<pre><code>&lt;asp:TextBox ID=""TextBox1"" runat=""server"" /&gt;
&lt;asp:CustomValidator ID=""CustomValidator1"" runat=""server"" 
ErrorMessage=""CustomValidator"" ClientValidationFunction=""TextBoxDAddress1Client""&gt;&lt;/asp:CustomValidator&gt;
&lt;asp:Button ID=""Button1"" runat=""server"" Text=""Button"" onclick=""Button1_Click"" /&gt;
</code></pre>
","<p>Your <code>CustomValidator</code> will only fire when the <code>TextBox</code> isn't empty.</p>

<p>If you need to ensure that it's not empty then you'll need a <a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator.aspx"" rel=""noreferrer""><code>RequiredFieldValidator</code></a> too.</p>

<blockquote>
  <p><a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx"" rel=""noreferrer""><strong>Note:</strong> If the input control is empty,
  no validation functions are called and
  validation succeeds. Use a
  RequiredFieldValidator control to
  require the user to enter data in the
  input control.</a></p>
</blockquote>

<p><strong>EDIT:</strong></p>

<p>If your <code>CustomValidator</code> specifies the <code>ControlToValidate</code> attribute (and your original example does) then your validation functions will only be called when the control isn't empty.</p>

<p>If you don't specify <code>ControlToValidate</code> then your validation functions will be called every time.</p>

<p>This opens up a second possible solution to the problem. Rather than using a separate <code>RequiredFieldValidator</code>, you could omit the <code>ControlToValidate</code> attribute from the <code>CustomValidator</code> and setup your validation functions to do something like this:</p>

<p>Client Side code (Javascript):</p>

<pre><code>function TextBoxDCountyClient(sender, args) {
    var v = document.getElementById('&lt;%=TextBoxDTownCity.ClientID%&gt;').value;
    if (v == '') {
        args.IsValid = false;  // field is empty
    }
    else {
        // do your other validation tests here...
    }
}
</code></pre>

<p>Server side code (C#):</p>

<pre><code>protected void TextBoxDTownCity_Validate(
    object source, ServerValidateEventArgs args)
{
    string v = TextBoxDTownCity.Text;
    if (v == string.Empty)
    {
        args.IsValid = false;  // field is empty
    }
    else
    {
        // do your other validation tests here...
    }
}
</code></pre>
","701116"
"How to fix ""The ConnectionString property has not been initialized""","218803","","<p>When I start my application I get:  <strong><em>The ConnectionString property has not been initialized.</em></strong> </p>

<p>Web.config:</p>

<pre><code>&lt;connectionStrings&gt;
    &lt;add name=""MyDB""
         connectionString=""Data Source=localhost\sqlexpress;Initial Catalog=mydatabase;User Id=myuser;Password=mypassword;"" /&gt;
&lt;/connectionStrings&gt;
</code></pre>

<p>The stack being:</p>

<pre><code>System.Data.SqlClient.SqlConnection.PermissionDemand() +4876643
System.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection) +20
System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117
System.Data.SqlClient.SqlConnection.Open() +122
</code></pre>

<p>I'm fairly new to .NET and I don't get this one. I found a lot of answers on Google, but none really fixed my issue.</p>

<p>What does that mean? Is my web.config bad? Is my function bad? Is my SQL configuration not working correctly (I'm using sqlexpress)?</p>

<p>My main problem here is that I'm not sure where to start to debug this... anything would help.</p>

<p>EDIT: </p>

<p>Failling code:</p>

<pre><code>MySQLHelper.ExecuteNonQuery(
ConfigurationManager.AppSettings[""ConnectionString""],
CommandType.Text,
sqlQuery,
sqlParams);
</code></pre>

<p>sqlQuery is a query like ""select * from table"". sqlParams is not relevant here.</p>

<p>The other problem here is that my company uses MySQLHelper, and I have no visibility over it (only have a dll for a helper lib). It has been working fine in other projects, so I'm 99% that the error doesn't come from here. </p>

<p>I guess if there's no way of debuging it without seeing the code I'll have to wait to get in touch with the person who created this helper in order to get the code.</p>
","<p>Referencing the connection string should be done as such:</p>

<pre><code>MySQLHelper.ExecuteNonQuery(
ConfigurationManager.ConnectionStrings[""MyDB""].ConnectionString,
CommandType.Text,
sqlQuery,
sqlParams);
</code></pre>

<p><code>ConfigurationManager.AppSettings[""ConnectionString""]</code> would be looking in the <code>AppSettings</code> for something named <code>ConnectionString</code>, which it would not find. This is why your error message indicated the <code>""ConnectionString"" property has not been initialized</code>, because it is looking for an initialized property of <code>AppSettings</code> named <code>ConnectionString</code>.</p>

<p><code>ConfigurationManager.ConnectionStrings[""MyDB""].ConnectionString</code> instructs to look for the connection string named ""MyDB"".</p>

<p><a href=""http://weblogs.asp.net/owscott/archive/2005/08/26/Using-connection-strings-from-web.config-in-ASP.NET-v2.0.aspx"" rel=""noreferrer"">Here is someone talking about using web.config connection strings</a></p>
","1007934"
"What is the best way to convert seconds into (Hour:Minutes:Seconds:Milliseconds) time?","218316","","<p>What is the best way to convert seconds into (Hour:Minutes:Seconds:Milliseconds) time?</p>

<p>Let's say I have 80 seconds, are there any specialized classes/techniques in .NET that would allow me to convert those 80 seconds into (00h:00m:00s:00ms) format like to DateTime or something?</p>
","<p>For <strong>.Net &lt;= 4.0</strong> Use the TimeSpan class.</p>

<pre><code>TimeSpan t = TimeSpan.FromSeconds( secs );

string answer = string.Format(""{0:D2}h:{1:D2}m:{2:D2}s:{3:D3}ms"", 
                t.Hours, 
                t.Minutes, 
                t.Seconds, 
                t.Milliseconds);
</code></pre>

<p>(As noted by Inder Kumar Rathore) For <strong>.NET > 4.0</strong> you can use</p>

<pre><code>TimeSpan time = TimeSpan.FromSeconds(seconds);

//here backslash is must to tell that colon is
//not the part of format, it just a character that we want in output
string str = time .ToString(@""hh\:mm\:ss\:fff"");
</code></pre>

<p>(From Nick Molyneux) Ensure that seconds is less than <code>TimeSpan.MaxValue.TotalSeconds</code> to avoid an exception.</p>
","463668"
"Why is the console window closing immediately without displaying my output?","218089","","<p>I've decided to study some basic C# (though I have experience when it comes to programming) the thing is I am following the guides in MSDN, but the issue here is that their Hello World Program is showing up then it would immediately close. why is that?</p>

<pre><code>using System;

public class Hello1
{
    public static int Main()
    {
        Console.WriteLine(""Hello, World!"");
        return 0;
    }
}
</code></pre>
","<blockquote>
  <p>the issue here is that their Hello World Program is showing up then it would immediately close.<br>
  why is that?</p>
</blockquote>

<p><strong>Because it's finished.</strong> When console applications have completed executing and return from their <code>main</code> method, the associated console window automatically closes. This is expected behavior.</p>

<p>If you want to keep it open for debugging purposes, you'll need to instruct the computer to wait for a key press before ending the app and closing the window.</p>

<p>The <a href=""http://msdn.microsoft.com/en-us/library/system.console.readline.aspx"" rel=""noreferrer""><code>Console.ReadLine</code> method</a> is one way of doing that. Adding this line to the end of your code (just before the <code>return</code> statement) will cause the application to wait for you to press a key before exiting.</p>

<p>Alternatively, you could start the application without the debugger attached by pressing <kbd>Ctrl</kbd>+<kbd>F5</kbd> from within the Visual Studio environment, but this has the obvious disadvantage of preventing you from using the debugging features, which you probably want at your disposal when writing an application.</p>

<p>The best compromise is probably to call the <code>Console.ReadLine</code> method only when debugging the application by wrapping it in a preprocessor directive. Something like:</p>

<pre><code>#if DEBUG
    Console.WriteLine(""Press enter to close..."");
    Console.ReadLine();
#endif
</code></pre>
","8868363"
"How do I concatenate two arrays in C#?","218073","","<pre><code>int[] x = new int [] { 1, 2, 3};
int[] y = new int [] { 4, 5 };

int[] z = // your answer here...

Debug.Assert(z.SequenceEqual(new int[] { 1, 2, 3, 4, 5 }));
</code></pre>

<p>--</p>

<p>Right now I use </p>

<pre><code>int[] z = x.Concat(y).ToArray();
</code></pre>

<p>Is there an easier or more efficient method?</p>
","<pre><code>var z = new int[x.Length + y.Length];
x.CopyTo(z, 0);
y.CopyTo(z, x.Length);
</code></pre>
","1547276"
"Connection timeout for SQL server","217767","","<p>Can I increase the timeout by modifying the connection string in the <code>web.config</code>?</p>
","<p>Yes, you could append <code>;Connection Timeout=30</code> to your <a href=""http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectiontimeout.aspx"" rel=""noreferrer"">connection string</a> and specify the value you wish.</p>

<p>The timeout value set in the <code>Connection Timeout</code> property is a <strong>time expressed in seconds</strong>. If this property isn't set, the timeout value for the connection is the default value (15 seconds).</p>

<p>Moreover, setting the timeout value to <code>0</code>, you are specifying that your attempt to connect waits an infinite time. As described in the documentation, this is something that you shouldn't set in your connection string:</p>

<blockquote>
  <p>A value of 0 indicates no limit, and should be avoided in a
  ConnectionString because an attempt to connect waits indefinitely.</p>
</blockquote>
","4308425"
"Get url parameters from a string in .NET","217183","","<p>I've got a string in .NET which is actually a url.  I want an easy way to get the value from a particular parameter.  </p>

<p>Normally, I'd just use <code>Request.Params[""theThingIWant""]</code>, but this string isn't from the request.  I can create a new <code>Uri</code> item like so:</p>

<pre><code>Uri myUri = new Uri(TheStringUrlIWantMyValueFrom);
</code></pre>

<p>I can use <code>myUri.Query</code> to get the query string...but then I apparently have to find some regexy way of splitting it up.</p>

<p>Am I missing something obvious, or is there no built in way to do this short of creating a regex of some kind, etc?</p>
","<p>Use static <code>ParseQueryString</code> method of <code>System.Web.HttpUtility</code> class that returns <code>NameValueCollection</code>.</p>

<pre><code>Uri myUri = new Uri(""http://www.example.com?param1=good&amp;param2=bad"");
string param1 = HttpUtility.ParseQueryString(myUri.Query).Get(""param1"");
</code></pre>

<p>Check documentation at <a href=""http://msdn.microsoft.com/en-us/library/ms150046.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/ms150046.aspx</a></p>
","659929"
"A generic list of anonymous class","216896","","<p>In C# 3.0 you can create anonymous class with the following syntax</p>

<pre><code>var o = new { Id = 1, Name = ""Foo"" };
</code></pre>

<p>Is there a way to add these anonymous class to a generic list?</p>

<p>Example:</p>

<pre><code>var o = new { Id = 1, Name = ""Foo"" };
var o1 = new { Id = 2, Name = ""Bar"" };

List&lt;var&gt; list = new List&lt;var&gt;();
list.Add(o);
list.Add(o1);
</code></pre>

<p>Another Example:</p>

<pre><code>List&lt;var&gt; list = new List&lt;var&gt;();

while (....)
{
    ....
    list.Add(new {Id = x, Name = y});
    ....
}
</code></pre>
","<p>You could do:</p>

<pre><code>var list = new[] { o, o1 }.ToList();
</code></pre>

<p>There are lots of ways of skinning this cat, but basically they'll all use type inference somewhere - which means you've got to be calling a generic method (possibly as an extension method). Another example might be:</p>

<pre><code>public static List&lt;T&gt; CreateList&lt;T&gt;(params T[] elements)
{
     return new List&lt;T&gt;(elements);
}

var list = CreateList(o, o1);
</code></pre>

<p>You get the idea :)</p>
","612700"
"C# list.Orderby descending","216835","","<p>I would like to receive a <strong>list sorted</strong> by 'Product.Name' in <strong>descending order</strong>. </p>

<p>Similar to the function below which sorts the list in ascending order, just in reverse, is this possible?</p>

<pre><code>var newList = list.OrderBy(x =&gt; x.Product.Name).ToList();
</code></pre>
","<p>Sure:</p>

<pre><code>var newList = list.OrderByDescending(x =&gt; x.Product.Name).ToList();
</code></pre>

<p>Doc: <a href=""http://msdn.microsoft.com/en-us/library/system.linq.enumerable%28v=vs.110%29.aspx"" rel=""noreferrer"">OrderByDescending(IEnumerable, Func)</a>.</p>

<p>In response to your comment:</p>

<pre><code>var newList = list.OrderByDescending(x =&gt; x.Product.Name)
                  .ThenBy(x =&gt; x.Product.Price)
                  .ToList();
</code></pre>
","3925265"
"Convert integer to binary in C#","216718","","<p>How to convert an integer number into its binary representation?</p>

<p>I'm using this code:</p>

<pre><code>String input = ""8"";
String output = Convert.ToInt32(input, 2).ToString();
</code></pre>

<p>But it throws an exception:</p>

<blockquote>
  <p>Could not find any parsable digits</p>
</blockquote>
","<p>Your example has an integer expressed as a string. Let's say your integer was actually an integer, and you want to take the integer and convert it to a binary string. </p>

<pre><code>int value = 8;
string binary = Convert.ToString(value, 2);
</code></pre>

<p>Which returns 1000.</p>
","2955001"
"How to get a path to the desktop for current user in C#?","216672","","<p>How do I get a path to the desktop for current user in C#?</p>

<p>The only thing I could find was the VB.NET-only class <a href=""http://msdn.microsoft.com/en-us/library/e0be29hd.aspx"" rel=""noreferrer""><code>SpecialDirectories</code></a>, which has this property:</p>

<pre><code>My.Computer.FileSystem.SpecialDirectories.Desktop
</code></pre>

<p>How can I do this in C#?</p>
","<pre><code>string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
</code></pre>
","634145"
"A potentially dangerous Request.Path value was detected from the client (*)","216523","","<p>I am receiving the rather self explanatory error:</p>

<blockquote>
  <p>A potentially dangerous Request.Path value was detected from the client (*).</p>
</blockquote>

<p>The issue is due to <code>*</code> in the request URL:</p>

<pre><code>https://stackoverflow.com/Search/test*/0/1/10/1
</code></pre>

<p>This url is used to populate a search page where 'test*' is the search term and the rest of the url relates to various other filters.</p>

<p>Is there an easy way to allow these special characters in the URL? I've tried modifying the <code>web.config</code>, to no avail.</p>

<p>Should I manually encode / decode the special characters?
Or is there a best practice for doing this, I would like to avoid using query strings. - but it may be an option.</p>

<p>The application itself is a <code>c# asp.net</code> webforms application that uses routing to produce the nice URL above.</p>
","<p>The <code>*</code> character is not allowed in the path of the URL, but there is no problem using it in the query string:</p>

<pre><code>http://localhost:3286/Search/?q=test*
</code></pre>

<p>It's not an encoding issue, the <code>*</code> character has no special meaning in an URL, so it doesn't matter if you URL encode it or not. You would need to encode it using a different scheme, and then decode it.</p>

<p>For example using an arbitrary character as escape character:</p>

<pre><code>query = query.Replace(""x"", ""xxx"").Replace(""y"", ""xxy"").Replace(""*"", ""xyy"");
</code></pre>

<p>And decoding:</p>

<pre><code>query = query.Replace(""xyy"", ""*"").Replace(""xxy"", ""y"").Replace(""xxx"", ""x"");
</code></pre>
","5967251"
"Accessing a Dictionary.Keys Key through a numeric index","216500","","<p>I'm using a <code>Dictionary&lt;string, int&gt;</code> where the <code>int</code> is a count of the key.</p>

<p>Now, I need to access the last-inserted Key inside the Dictionary, but I do not know the name of it. The obvious attempt:</p>

<pre><code>int LastCount = mydict[mydict.keys[mydict.keys.Count]];
</code></pre>

<p>does not work, because <code>Dictionary.Keys</code> does not implement a []-indexer.</p>

<p>I just wonder if there is any similar class? I thought about using a Stack, but that only stores a string. I could now create my own struct and then use a <code>Stack&lt;MyStruct&gt;</code>, but I wonder if there is another alternative, essentially a Dictionary that implements an []-indexer on the Keys?</p>
","<p>As @Falanwe points out in a comment, doing something like this is <strong><em>incorrect</em></strong>:</p>

<pre><code>int LastCount = mydict.Keys.ElementAt(mydict.Count -1);
</code></pre>

<p>You <strong>should not</strong> depend on the order of keys in a Dictionary. If you need ordering, you should use an <a href=""https://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary.aspx"" rel=""noreferrer"">OrderedDictionary</a>, as suggested in this <a href=""https://stackoverflow.com/a/5540/1724702"">answer</a>. The other answers on this page are interesting as well.</p>
","4735712"
"C# Syntax - Split String into Array by Comma, Convert To Generic List, and Reverse Order","216381","","<p>What is the correct syntax for this:</p>

<pre><code>IList&lt;string&gt; names = ""Tom,Scott,Bob"".Split(',').ToList&lt;string&gt;().Reverse();
</code></pre>

<p>What am I messing up?
What does TSource mean?</p>
","<p>The problem is that you're calling <code>List&lt;T&gt;.Reverse()</code> which returns <code>void</code>.</p>

<p>You could either do:</p>

<pre><code>List&lt;string&gt; names = ""Tom,Scott,Bob"".Split(',').ToList&lt;string&gt;();
names.Reverse();
</code></pre>

<p>or:</p>

<pre><code>IList&lt;string&gt; names = ""Tom,Scott,Bob"".Split(',').Reverse().ToList&lt;string&gt;();
</code></pre>

<p>The latter is more expensive, as reversing an arbitrary <code>IEnumerable&lt;T&gt;</code> involves buffering all of the data and then yielding it all - whereas <code>List&lt;T&gt;</code> can do all the reversing ""in-place"". (The difference here is that it's calling the <code>Enumerable.Reverse&lt;T&gt;()</code> extension method, instead of the <code>List&lt;T&gt;.Reverse()</code> instance method.)</p>

<p>More efficient yet, you could use:</p>

<pre><code>string[] namesArray = ""Tom,Scott,Bob"".Split(',');
List&lt;string&gt; namesList = new List&lt;string&gt;(namesArray.Length);
namesList.AddRange(namesArray);
namesList.Reverse();
</code></pre>

<p>This avoids creating any buffers of an inappropriate size - at the cost of taking four statements where one will do... As ever, weigh up readability against performance in the real use case.</p>
","315369"
"How to open in default browser in C#","216045","","<p>I am designing a small C# application and there is a web browser in it. I currently have all of my defaults on my computer say google chrome is my default browser, yet when I click a link in my application to open in a new window, it opens internet explorer. Is there any way to make these links open in the default browser instead? Or is there something wrong on my computer?</p>

<p>My problem is that I have a webbrowser in the application, so say you go to google and type in ""stack overflow"" and right click the first link and click ""Open in new window"" it opens in IE instead of Chrome. Is this something I have coded improperly, or is there a setting not correct on my computer</p>

<p>===EDIT===</p>

<p>This is really annoying. I am already aware that the browser is IE, but I had it working fine before. When I clicked a link it opened in chrome. I was using sharp develop to make the application at that time because I could not get c# express to start up. I did a fresh windows install and since I wasn't too far along in my application, I decided to start over, and now I am having this problem. That is why I am not sure if it is my computer or not. Why would IE start up the whole browser when a link is clicked rather than simply opening the new link in the default browser?</p>
","<p>You can just write </p>

<pre><code>System.Diagnostics.Process.Start(""http://google.com"");
</code></pre>

<p><strong>EDIT</strong>: The <code>WebBrowser</code> control is an embedded copy of IE.<br>
Therefore, any links inside of it will open in IE.</p>

<p>To change this behavior, you can handle the <code>Navigating</code> event.</p>
","4580324"
"Using partial views in ASP.net MVC 4","215996","","<p>I have recently started playing around with ASP.net MVC (4), but I can't wrap my head around this one issue I'm having. I'm sure it's easy when you know it.</p>

<p>I'm essentially trying to do the the following in my Index view:</p>

<ol>
<li>List the current items in the database of type ""Note"" in the Index view (that's easy)</li>
<li>Creating new items in the same Index view (not so easy). </li>
</ol>

<p>So I figured I needed a partial view, and that I have created as following (_CreateNote.cshtml):</p>

<pre><code>@model QuickNotes.Models.Note
@using (Html.BeginForm()) {
@Html.ValidationSummary(true)

&lt;fieldset&gt;
    &lt;legend&gt;Note&lt;/legend&gt;

    &lt;div class=""editor-label""&gt;
        @Html.LabelFor(model =&gt; model.Content)
    &lt;/div&gt;
    &lt;div class=""editor-field""&gt;
        @Html.EditorFor(model =&gt; model.Content)
        @Html.ValidationMessageFor(model =&gt; model.Content)
    &lt;/div&gt;
    &lt;p&gt;
        &lt;input type=""submit"" value=""Create"" /&gt;
    &lt;/p&gt;
&lt;/fieldset&gt;
}
</code></pre>

<p>In my original Index view (Index.cshtml) I'm trying to render this partial view:</p>

<pre><code>@model IEnumerable&lt;QuickNotes.Models.Note&gt;


@{
    ViewBag.Title = ""Personal notes"";
}

&lt;h2&gt;Personal notes&lt;/h2&gt;

&lt;p&gt;
    @Html.ActionLink(""Create New"", ""Create"")
&lt;/p&gt;

&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;
            @Html.DisplayNameFor(model =&gt; model.Content)
        &lt;/th&gt;
        &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;

    @foreach (var item in Model) {
        &lt;tr&gt;
            &lt;td&gt;
                @Html.DisplayFor(modelItem =&gt; item.Content)
            &lt;/td&gt;
            &lt;td&gt;
                @Html.ActionLink(""Edit"", ""Edit"", new { id=item.ID }) |
                @Html.ActionLink(""Details"", ""Details"", new { id=item.ID }) |
                @Html.ActionLink(""Delete"", ""Delete"", new { id=item.ID })
            &lt;/td&gt;
        &lt;/tr&gt;
    }
&lt;/table&gt;

&lt;div&gt;
    @Html.Partial(""_CreateNote"")
&lt;/div&gt;
</code></pre>

<p>(using: @Html.Partial(""_CreateNote""))
However. This doesn't seem to work, as I get the following error message: </p>

<pre><code>Line 35: 
Line 36: &lt;div&gt;
Line 37:     @Html.Partial(""_CreateNote"");
Line 38: &lt;/div&gt;

Source File: c:\Dropbox\Projects\workspace .NET MVC\QuickNotes\QuickNotes\Views\Notes\Index.cshtml    Line: 37 

Stack Trace: 


[InvalidOperationException: The model item passed into the dictionary is of type 'System.Data.Entity.DbSet`1[QuickNotes.Models.Note]', but this dictionary requires a model item of type 'QuickNotes.Models.Note'.]
   System.Web.Mvc.ViewDataDictionary`1.SetModel(Object value) +405487
</code></pre>

<p>My NotesController looks like this:</p>

<pre><code>public ActionResult Index()
{

    var model = _db.Notes;

    return View(model);
}

//
// GET: /Notes/Create

public ActionResult Create()
{
    return View();
}

//
// GET: /Notes/_CreateNote - Partial view
public ViewResult _CreateNote()
{
    return View(""_CreateNote"");
}
</code></pre>

<p>I think it has to do with the fact that the Index view is using the model differently, as in @model IEnumerable, but no matter how I change it around, using RenderPartial, RenderAction, changing ActionResult to ViewResult etc, I can't get it to work.</p>

<p>Any tips would be greatly appreciated!
Please let me know if you need any more information. I'd be happy to zip down the entire project if needed.</p>
","<p>Change the code where you load the partial view to:</p>

<pre><code>@Html.Partial(""_CreateNote"", new QuickNotes.Models.Note())
</code></pre>

<p>This is because the partial view is expecting a Note but is getting passed the model of the parent view which is the IEnumerable</p>
","13934741"
"Do you need to dispose of objects and set them to null?","215554","","<p>Do you need to dispose of objects and set them to null, or will the garbage collector clean them up when they go out of scope?</p>
","<p>Objects will be cleaned up when they are no longer being used and when the garbage collector sees fit.  Sometimes, you may need to set an object to <code>null</code> in order to make it go out of scope (such as a static field whose value you no longer need), but overall there is usually no need to set to <code>null</code>.</p>

<p>Regarding disposing objects, I agree with @Andre.  If the object is <code>IDisposable</code> it is <strong>a good idea to dispose it</strong> when you no longer need it, especially if the object uses unmanaged resources. Not disposing unmanaged resources will <strong>lead to memory leaks</strong>.</p>

<p>You can use the <code>using</code> statement to automatically dispose an object once your program leaves the scope of the <code>using</code> statement.</p>

<pre><code>using (MyIDisposableObject obj = new MyIDisposableObject())
{
    // use the object here
} // the object is disposed here
</code></pre>

<p>Which is functionally equivalent to:</p>

<pre><code>MyIDisposableObject obj;
try
{
    obj = new MyIDisposableObject();
}
finally
{
    if (obj != null)
    {
        ((IDisposable)obj).Dispose();
    }
}
</code></pre>
","2926890"
"What is the equivalent of Java's final in C#?","215102","","<p>What is the equivalent of Java's <code>final</code> in C#?</p>
","<p>The <a href=""http://en.wikipedia.org/wiki/Final_%28Java%29"" rel=""noreferrer""><code>final</code></a> keyword has several usages in Java. It corresponds to both the <a href=""http://msdn.microsoft.com/en-us/library/88c54tsw.aspx"" rel=""noreferrer""><code>sealed</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/acdd6hb7.aspx"" rel=""noreferrer""><code>readonly</code></a> keywords in C#, depending on the context in which it is used.</p>

<h2>Classes</h2>

<p>To prevent subclassing (inheritance from the defined class):</p>

<p><strong>Java</strong>  </p>

<pre><code>public final class MyFinalClass {...}
</code></pre>

<p><strong>C#</strong></p>

<pre><code>public sealed class MyFinalClass {...}
</code></pre>

<h2>Methods</h2>

<p>Prevent overriding of a <code>virtual</code> method.</p>

<p><strong>Java</strong></p>

<pre><code>public class MyClass
{
    public final void myFinalMethod() {...}
}
</code></pre>

<p><strong>C#</strong></p>

<pre><code>public class MyClass : MyBaseClass
{
    public sealed override void MyFinalMethod() {...}
}
</code></pre>

<p>As Joachim Sauer points out, a notable difference between the two languages here is that Java by default marks all non-static methods as <code>virtual</code>, whereas C# marks them as <code>sealed</code>. Hence, you only need to use the <code>sealed</code> keyword in C# if you want to stop further overriding of a method that has been explicitly marked <code>virtual</code> in the base class.</p>

<h2>Variables</h2>

<p>To only allow a variable to be assigned once:</p>

<p><strong>Java</strong></p>

<pre><code>public final double pi = 3.14; // essentially a constant
</code></pre>

<p><strong>C#</strong></p>

<pre><code>public readonly double pi = 3.14; // essentially a constant
</code></pre>

<p>As a side note, the effect of the <code>readonly</code> keyword differs from that of the <a href=""http://msdn.microsoft.com/en-us/library/e6w8fe1b.aspx"" rel=""noreferrer""><code>const</code></a> keyword in that the <code>readonly</code> expression is evaluated at <em>runtime</em> rather than <em>compile-time</em>, hence allowing arbitrary expressions.</p>
","1327549"
"How to get number of rows using SqlDataReader in C#","214804","","<p>My question is how to get the number of rows returned by a query using <code>SqlDataReader</code> in C#. I've seen some answers about this but none were clearly defined except for one that states to do a while loop with <code>Read()</code> method and increment a counter.</p>

<p>My problem is that I am trying to fill a multi-dimensional array with the first row being the column header names and every row after that to the be the row data. </p>

<p>I know that I can just dump the stuff in a List control and not worry about it, but for my own personal edification and I would also like to pull the data in and out of the array as I choose and display it in different formats.</p>

<p>So I think I can't do the <code>Read()</code> and then increment ++ way because that means that I would have to open <code>Read()</code> and then open <code>Read()</code> again to get amount of rows and then column data.</p>

<p>Just a small example of what I'm talking about:</p>

<pre><code>int counter = 0;    

while (sqlRead.Read())
{
    //get rows
    counter++
}
</code></pre>

<p>and then a for loop to run through the columns and pop</p>

<pre><code>something.Read();

int dbFields = sqlRead.FieldCount;

for (int i = 0; i &lt; dbFields; i++)
{
   // do stuff to array
}
</code></pre>
","<p>There are only two options:</p>

<ul>
<li><p>Find out by reading all rows (and then you might as well store them)</p></li>
<li><p>run a specialized SELECT COUNT(*) query beforehand.</p></li>
</ul>

<p>Going twice through the DataReader loop is really expensive, you would have to re-execute the query.</p>

<p>And (thanks to Pete OHanlon) the second option is only concurrency-safe when you use a transaction with a Snapshot isolation level. </p>

<p>Since you want to end up storing all rows in memory anyway the only sensible option is to read all rows in a flexible storage (<code>List&lt;&gt;</code> or <code>DataTable</code>) and then copy the data to any format you want. The in-memory operation will always be much more efficient.</p>
","1383321"
"Capture screenshot of active window?","214595","","<p>I am making a screen capturing application and everything is going fine.  All I need to do is capture the active window and take a screenshot of this active window.  Does anyone know how I can do this?</p>
","<pre><code>ScreenCapture sc = new ScreenCapture();
// capture entire screen, and save it to a file
Image img = sc.CaptureScreen();
// display image in a Picture control named imageDisplay
this.imageDisplay.Image = img;
// capture this window, and save it
sc.CaptureWindowToFile(this.Handle,""C:\\temp2.gif"",ImageFormat.Gif);
</code></pre>

<p><a href=""http://www.developerfusion.com/code/4630/capture-a-screen-shot/"" rel=""noreferrer"">http://www.developerfusion.com/code/4630/capture-a-screen-shot/</a></p>
","1163781"
"Linq .Any VS .Exists - What's the difference?","214490","","<p>Using Linq on collections, what is the difference between the following lines of code?</p>

<pre><code>if(!coll.Any(i =&gt; i.Value))
</code></pre>

<p>and</p>

<pre><code>if(!coll.Exists(i =&gt; i.Value))
</code></pre>

<p><strong>Update 1</strong></p>

<p>When I disassemble <code>.Exists</code> it looks like there is no code.</p>

<p><strong>Update 2</strong></p>

<p>Anyone know why there is not code there for this one?</p>
","<p>See documentation</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/bfed8bca.aspx"" rel=""noreferrer"">List.Exists</a> (Object method - MSDN)</p>

<blockquote>
  <p>Determines whether the List(T) contains elements that match the conditions defined by the specified predicate.</p>
</blockquote>

<p>This exists since .NET 2.0, so before LINQ. Meant to be used with the Predicate <strong>delegate</strong>, but lambda expressions are backward compatible. Also, just List has this (not even IList)</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/bb534972.aspx"" rel=""noreferrer"">IEnumerable.Any</a> (Extension method - MSDN)   </p>

<blockquote>
  <p>Determines whether any element of a sequence satisfies a condition.</p>
</blockquote>

<p>This is new in .NET 3.5 and uses Func(TSource, bool) as argument, so this was intended to be used with lambda expressions and LINQ.</p>

<p>In behaviour, these are identical.</p>
","879533"
"Proper Linq where clauses","214250","","<p>I write a fair amount of linq in my day to day life, but mostly simple statements.  I have noticed that when using where clauses, there are many ways to write them and each have the same results as far as I can tell.  For example;</p>

<pre><code>from x in Collection
  where x.Age == 10
  where x.Name == ""Fido""
  where x.Fat == true
  select x;
</code></pre>

<p>Appears to be equivalent to this at least as far as the results are concerned:</p>

<pre><code>from x in Collection
  where x.Age == 10 &amp;&amp;
        x.Name == ""Fido"" &amp;&amp;
        x.Fat == true
  select x;
</code></pre>

<p>So is there really a difference other than syntax?  If so, what is the preferred style and why?</p>
","<p>The second one would be more efficient as it just has one predicate to evaluate against each item in the collection where as in the first one, it's applying the first predicate to all items first and the result (which is narrowed down at this point) is used for the second predicate and so on. The results get narrowed down every pass but still it involves multiple passes.</p>

<p>Also the chaining (first method) will work only if you are ANDing your predicates. Something like this <code>x.Age == 10 || x.Fat == true</code> will not work with your first method.</p>
","6360007"
"How to use WinForms progress bar?","214151","","<p>I want to show progress of calculations, which are performing in external library.  </p>

<p>For example if I have some calculate method, and I want to use it for 100000 values in my Form class I can write:</p>

<pre><code>public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }            

    private void Caluculate(int i)
    {
        double pow = Math.Pow(i, i);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        progressBar1.Maximum = 100000;
        progressBar1.Step = 1;

        for(int j = 0; j &lt; 100000; j++)
        {
            Caluculate(j);
            progressBar1.PerformStep();
        }
    }
}
</code></pre>

<p>I should perform step after each calculation. But what if I perform all 100000 calculations in external method. When should I ""perform step"" if I don't want to make this method dependant on progress bar? I can, for example, write</p>

<pre><code>public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void CaluculateAll(System.Windows.Forms.ProgressBar progressBar)
    {
        progressBar.Maximum = 100000;
        progressBar.Step = 1;

        for(int j = 0; j &lt; 100000; j++)
        {
            double pow = Math.Pow(j, j); //Calculation
            progressBar.PerformStep();
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        CaluculateAll(progressBar1);
    }
}
</code></pre>

<p>but I don't want to do like that.</p>
","<p>I would suggest you have a look at <a href=""https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.backgroundworker?view=netframework-4.7.1"" rel=""nofollow noreferrer"">BackgroundWorker</a>.  If you have a loop that large in your WinForm it will block and your app will look like it has hanged.</p>

<p>Look at <code>BackgroundWorker.ReportProgress()</code> to see how to report progress back to the UI thread.</p>

<p>For example:</p>

<pre><code>private void Calculate(int i)
{
    double pow = Math.Pow(i, i);
}

private void button1_Click(object sender, EventArgs e)
{
    progressBar1.Maximum = 100;
    progressBar1.Step = 1;
    progressBar1.Value = 0;
    backgroundWorker.RunWorkerAsync();
}

private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    var backgroundWorker = sender as BackgroundWorker;
    for (int j = 0; j &lt; 100000; j++)
    {
        Calculate(j);
        backgroundWorker.ReportProgress((j * 100) / 100000);
    }
}

private void backgroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    progressBar1.Value = e.ProgressPercentage;
}

private void backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    // TODO: do something with final calculation.
}
</code></pre>
","12127025"
"Reading an integer from user input","214137","","<p>What I am looking for is how to read an integer that was given by the user from the command line (console project). I primarily know C++ and have started down the C# path. I know that Console.ReadLine(); only takes a char/string. So in short I am looking for the integer version of this. </p>

<p>Just to give you an idea of what I'm doing exactly:</p>

<pre><code>Console.WriteLine(""1. Add account."");
Console.WriteLine(""Enter choice: "");
Console.ReadLine(); // Needs to take in int rather than string or char.
</code></pre>

<p>I have been looking for quite a while for this. I have found a lot on C but not C#. I did find however a thread, on another site, that suggested to convert from char to int. I'm sure there has to be a more direct way than converting. </p>
","<p>You can convert the string to integer using <a href=""http://msdn.microsoft.com/en-us/library/sf1aw27b(v=vs.110).aspx"">Convert.ToInt32()</a> function</p>

<pre><code>int intTemp = Convert.ToInt32(Console.ReadLine());
</code></pre>
","24443839"
"How to escape braces (curly brackets) in a format string in .NET","213888","","<p>How can brackets be escaped in using <code>string.Format</code>. For example:</p>

<pre><code>String val = ""1,2,3""
String.Format("" foo {{0}}"", val); 
</code></pre>

<p>This example doesn't throw an exception, but outputs the string <code>foo {0}</code></p>

<p>Is there a way to escape the brackets?</p>
","<p>For you to output <code>foo {1, 2, 3}</code> you have to do something like:</p>

<pre><code>string t = ""1, 2, 3"";
string v = String.Format("" foo {{{0}}}"", t);
</code></pre>

<p>To output a <code>{</code> you use <code>{{</code> and to output a <code>}</code> you use <code>}}</code>.</p>
","91375"
"Index was out of range. Must be non-negative and less than the size of the collection parameter name:index","213752","","<p>I'm trying to add data as one by one row to a datagridview here is my code and it says:
""Index was out of range. Must be non-negative and less than the size of the collection
parameter name:index"" what does this means ? is there any problem in my code</p>

<pre><code>String Sqlstr2 = ""select ItemName from Item where ItemID = '"" + tbItemID.Text + ""'"";
db.DataRead(Sqlstr2);
string ItemName = db.dr[""ItemName""].ToString(); 

DataGridView dataGridView1 = new DataGridView();

dataGridView1.Columns[0].Name = ""ItemID"";
dataGridView1.Columns[1].Name = ""ItemName"";
dataGridView1.Columns[2].Name = ""Qty"";
dataGridView1.Columns[3].Name = ""UnitPrice"";
dataGridView1.Columns[4].Name = ""Amount"";

string firstColum = tbItemID.Text;
string secondColum = ItemName;
string thirdColum = tbQuantity.Text;
string fourthColum = Convert.ToString(UnitPrice);
string fifthColum = Convert.ToString(sum);

string[] row = new string[]{ firstColum, secondColum, thirdColum, fourthColum, fifthColum };
dataGridView1.Rows.Add(row);
</code></pre>
","<p>You're not adding columns to your <code>DataGridView</code></p>

<pre><code>DataGridView dataGridView1 = new DataGridView();//Create new grid

dataGridView1.Columns[0].Name = ""ItemID"";// refer to column which is not there 
</code></pre>

<p>Is it clear now why you get an exception?</p>

<p>Add this line before you use columns to fix the error</p>

<pre><code>dataGridView1.ColumnCount = 5;
</code></pre>
","19162380"
"Left function in c#","213496","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/844059/net-equivalent-of-the-old-vb-leftstring-length-function"">.Net equivalent of the old vb left(string, length) function?</a>  </p>
</blockquote>



<p>what is the alternative for Left function in c#
i have this in </p>

<pre><code>Left(fac.GetCachedValue(""Auto Print Clinical Warnings"").ToLower + "" "", 1) == ""y"");
</code></pre>
","<p>It sounds like you're asking about a function</p>

<pre><code>string Left(string s, int left)
</code></pre>

<p>that will return the leftmost <code>left</code> characters of the string <code>s</code>. In that case you can just use <a href=""http://msdn.microsoft.com/en-us/library/aka44szs.aspx"" rel=""noreferrer""><code>String.Substring</code></a>. You can write this as an extension method:</p>

<pre><code>public static class StringExtensions
{
    public static string Left(this string value, int maxLength)
    {
        if (string.IsNullOrEmpty(value)) return value;
        maxLength = Math.Abs(maxLength);

        return ( value.Length &lt;= maxLength 
               ? value 
               : value.Substring(0, maxLength)
               );
    }
}
</code></pre>

<p>and use it like so:</p>

<pre><code>string left = s.Left(number);
</code></pre>

<p>For your specific example:</p>

<pre><code>string s = fac.GetCachedValue(""Auto Print Clinical Warnings"").ToLower() + "" "";
string left = s.Substring(0, 1);
</code></pre>
","7574615"
"Parsing CSV files in C#, with header","213488","","<p>Is there a default/official/recommended way to parse CSV files in C#? I don't want to roll my own parser.</p>

<p>Also, I've seen instances of people using ODBC/OLE DB to read CSV via the Text driver, and a lot of people discourage this due to its ""drawbacks."" What are these drawbacks?</p>

<p>Ideally, I'm looking for a way through which I can read the CSV by column name, using the first record as the header / field names. Some of the answers given are correct but work to basically deserialize the file into classes.</p>
","<p>Let a library handle all the nitty-gritty details for you! :-)</p>

<p>Check out <a href=""http://www.filehelpers.net"" rel=""noreferrer"">FileHelpers</a> and stay DRY - Don't Repeat Yourself - no need to re-invent the wheel a gazillionth time....</p>

<p>You basically just need to define that shape of your data - the fields in your individual line in the CSV - by means of a public class (and so well-thought out attributes like default values, replacements for NULL values and so forth), point the FileHelpers engine at a file, and bingo - you get back all the entries from that file. One simple operation - great performance!</p>
","2081425"
"C# char to int","212915","","<p>So I have a char in c#:</p>

<pre><code>char foo = '2';
</code></pre>

<p>Now I want to get the 2 into an int.  I find that Convert.ToInt32 returns the actual decimal value of the char and not the number 2.  The following will work:</p>

<pre><code>int bar = Convert.ToInt32(new string(foo, 1));
</code></pre>

<p>int.parse only works on strings as well.  </p>

<p>Is there no native function in C# to go from a char to int without making it a string?  I know this is trivial but it just seems odd that there's nothing native to directly make the conversion.</p>
","<p>Interesting answers but the docs say differently:</p>

<blockquote>
  <p>Use the GetNumericValue methods to
  convert a Char object that represents
  a number to a numeric value type. Use
  Parse and TryParse to convert a
  character in a string into a Char
  object. Use ToString to convert a Char
  object to a String object.</p>
</blockquote>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.char.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.char.aspx</a></p>
","795991"
"Getting attributes of Enum's value","212739","","<p>I would like to know if it is possible to get attributes of the enum values and not of the enum itself? For example, suppose I have the following enum:</p>

<pre><code>using System.ComponentModel; // for DescriptionAttribute

enum FunkyAttributesEnum
{
    [Description(""Name With Spaces1"")]
    NameWithoutSpaces1,    
    [Description(""Name With Spaces2"")]
    NameWithoutSpaces2
}
</code></pre>

<p>What I want is given the enum type, produce 2-tuples of enum string value and its description.</p>

<p>Value was easy:</p>

<pre><code>Array values = System.Enum.GetValues(typeof(FunkyAttributesEnum));
foreach (int value in values)
    Tuple.Value = Enum.GetName(typeof(FunkyAttributesEnum), value);
</code></pre>

<p>But how do I get description attribute's value, to populate Tuple.Desc? I can think of how to do it if the Attribute belongs to the enum itself, but I am at a loss as to how to get it from the value of the enum.</p>
","<p>This should do what you need.</p>

<pre><code>var type = typeof(FunkyAttributesEnum);
var memInfo = type.GetMember(FunkyAttributesEnum.NameWithoutSpaces1.ToString());
var attributes = memInfo[0].GetCustomAttributes(typeof(DescriptionAttribute), false);
var description = ((DescriptionAttribute)attributes[0]).Description;
</code></pre>
","1799401"
"How do I enable NuGet Package Restore in Visual Studio?","212479","","<p>There's a <a href=""https://stackoverflow.com/questions/15435366/vs2012-enable-nuget-package-restore-disappears-missing"">similar post</a> on stack but it doesn't help with my issue possibly because I am using Visual Studio 2015.</p>

<p>How do I get the ""Enable NuGet Package Restore"" option to appear in VS2015?</p>

<p>I chose File > New Project and created an <strong>empty ASP.NET Web Application</strong>. I'm looking for this menu option.</p>

<p><img src=""https://i.stack.imgur.com/uedbb.png"" alt=""enter image description here""></p>

<p>I should mention that I have looked for any pre-existing nuGet files in my project folder and there are none.</p>
","<p>It took far too long but I finally found this document on <a href=""http://docs.nuget.org/consume/package-restore/migrating-to-automatic-package-restore"">Migrating MSBuild-Integrated solutions to Automatic Package Restore</a> and I was able to resolve the issue using the methods described here. </p>

<ol>
<li>Remove the <code>'.nuget'</code> solution directory along from the solution </li>
<li>Remove all references to <code>nuget.targets</code> from your <code>.csproj</code> or <code>.vbproj</code> files. Though not officially supported, the document links to a <a href=""https://github.com/owen2/AutomaticPackageRestoreMigrationScript"">PowerShell script</a> if you have a lot of projects which need to be cleaned up. I manually edited mine by hand so I can't give any feedback regarding my experience with it.</li>
</ol>

<p>When editing your files by hand, here's what you'll be looking for:</p>

<p><strong>Solution File (.sln)</strong></p>

<pre><code>Project(""{2150E333-8FDC-42A3-9474-1A3956D46DE8}"") = "".nuget"", "".nuget"", ""{F4AEBB8B-A367-424E-8B14-F611C9667A85}""
ProjectSection(SolutionItems) = preProject
    .nuget\NuGet.Config = .nuget\NuGet.Config
    .nuget\NuGet.exe = .nuget\NuGet.exe
    .nuget\NuGet.targets = .nuget\NuGet.targets
EndProjectSection
EndProject
</code></pre>

<p><strong>Project File (.csproj / .vbproj)</strong></p>

<pre><code>  &lt;Import Project=""$(SolutionDir)\.nuget\NuGet.targets"" Condition=""Exists('$(SolutionDir)\.nuget\NuGet.targets')"" /&gt;
  &lt;Target Name=""EnsureNuGetPackageBuildImports"" BeforeTargets=""PrepareForBuild""&gt;
    &lt;PropertyGroup&gt;
      &lt;ErrorText&gt;This project references NuGet package(s) that are missing on this computer. Enable NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.&lt;/ErrorText&gt;
    &lt;/PropertyGroup&gt;
    &lt;Error Condition=""!Exists('$(SolutionDir)\.nuget\NuGet.targets')"" Text=""$([System.String]::Format('$(ErrorText)', '$(SolutionDir)\.nuget\NuGet.targets'))"" /&gt;
  &lt;/Target&gt;
</code></pre>
","30270034"
"Produce a random number in a range using C#","212410","","<p>How do I go about producing random numbers within a range?</p>
","<p>You can try</p>

<pre><code>Random r = new Random();
int rInt = r.Next(0, 100); //for ints
int range = 100;
double rDouble = r.NextDouble()* range; //for doubles
</code></pre>

<p>Have a look at</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.random.aspx"" rel=""noreferrer"">Random Class</a>, <a href=""http://msdn.microsoft.com/en-us/library/2dx6wyd4.aspx"" rel=""noreferrer"">Random.Next Method (Int32, Int32)</a> and <a href=""http://msdn.microsoft.com/en-us/library/system.random.nextdouble.aspx"" rel=""noreferrer"">Random.NextDouble Method </a></p>
","3975307"
"What are the uses of ""using"" in C#","212260","","<p>User <a href=""https://stackoverflow.com/users/1065/kokos"">kokos</a> answered the wonderful <a href=""https://stackoverflow.com/questions/9033/hidden-features-of-c"">Hidden Features of C#</a> question by mentioning the <code>using</code> keyword. Can you elaborate on that? What are the uses of <code>using</code>?</p>
","<p>The reason for the ""using"" statement is to ensure that the object is disposed as soon as it goes out of scope, and it doesn't require explicit code to ensure that this happens.</p>

<p>As per <a href=""http://www.codeproject.com/KB/cs/tinguusingstatement.aspx"" rel=""noreferrer"">http://www.codeproject.com/KB/cs/tinguusingstatement.aspx</a>, the .NET CLR converts</p>

<pre><code>using (MyResource myRes = new MyResource())
{
    myRes.DoSomething();
}
</code></pre>

<p>to</p>

<pre><code>{ // limits scope of myRes
    MyResource myRes= new MyResource();
    try
    {
        myRes.DoSomething();
    }
    finally
    {
        // Check for a null resource.
        if (myRes!= null)
            // Call the object's Dispose method.
            ((IDisposable)myRes).Dispose();
    }
}
</code></pre>
","75483"
"Interface defining a constructor signature?","212257","","<p>It's weird that this is the first time I've bumped into this problem, but:</p>

<p>How do you define a constructor in a C# interface?</p>

<p><strong>Edit</strong><br>
Some people wanted an example (it's a free time project, so yes, it's a game)</p>

<p>IDrawable<br>
 +Update<br>
 +Draw</p>

<p>To be able to Update (check for edge of screen etc) and draw itself it will always need a <code>GraphicsDeviceManager</code>. So I want to make sure the object has a reference to it. This would belong in the constructor.</p>

<p>Now that I wrote this down I think what I'm implementing here is <code>IObservable</code> and the <code>GraphicsDeviceManager</code> should take the <code>IDrawable</code>...
It seems either I don't get the XNA framework, or the framework is not thought out very well.</p>

<p><strong>Edit</strong><br>
There seems to be some confusion about my definition of constructor in the context of an interface. An interface can indeed not be instantiated so doesn't need a constructor. What I wanted to define was a signature to a constructor. Exactly like an interface can define a signature of a certain method, the interface could define the signature of a constructor.</p>
","<p>As already well noted, you can't have constructors on an Interface.  But since this is such a highly ranked result in Google some 7 years later, I thought I would chip in here - specifically to show how you could use an abstract base class in tandem with your existing Interface and maybe cut down on the amount of refactoring needed in the future for similar situations.  This concept has already been hinted at in some of the comments but I thought it would be worth showing how to actually do it.</p>

<p>So you have your main interface that looks like this so far:</p>

<pre><code>public interface IDrawable
{
    void Update();
    void Draw();
}
</code></pre>

<p>Now create an abstract class with the constructor you want to enforce.  Actually, since it's now available since the time you wrote your original question, we can get a little fancy here and use generics in this situation so that we can adapt this to other interfaces that might need the same functionality but have different constructor requirements:</p>

<pre><code>public abstract class MustInitialize&lt;T&gt;
{
    public MustInitialize(T parameters)
    {

    }
}
</code></pre>

<p>Now you'll need to create a new class that inherits from both the IDrawable interface and the MustInitialize abstract class:</p>

<pre><code>public class Drawable : MustInitialize&lt;GraphicsDeviceManager&gt;, IDrawable
{
    GraphicsDeviceManager _graphicsDeviceManager;

    public Drawable(GraphicsDeviceManager graphicsDeviceManager)
        : base (graphicsDeviceManager)
    {
        _graphicsDeviceManager = graphicsDeviceManager;
    }

    public void Update()
    {
        //use _graphicsDeviceManager here to do whatever
    }

    public void Draw()
    {
        //use _graphicsDeviceManager here to do whatever
    }
}
</code></pre>

<p>Then just create an instance of Drawable and you're good to go:</p>

<pre><code>IDrawable drawableService = new Drawable(myGraphicsDeviceManager);
</code></pre>

<p>The cool thing here is that the new Drawable class we created still behaves just like what we would expect from an IDrawable.</p>

<p>If you need to pass more than one parameter to the MustInitialize constructor, you can create a class that defines properties for all of the fields you'll need to pass in.</p>
","41685659"
"How to redirect to Index from another controller?","212235","","<p>I have been looking through trying to find some way to redirect to an <code>Index</code> view from another controller.</p>

<pre><code>public ActionResult Index()
{                
     ApplicationController viewModel = new ApplicationController();
     return RedirectToAction(""Index"", viewModel);
}
</code></pre>

<p>This is what I tried right now. Now the code I was given to has a <code>ActionLink</code> that links to the page I need to <code>Redirect</code> too.</p>

<pre><code>@Html.ActionLink(""Bally Applications"",""../Application"")
</code></pre>
","<p>Use the overloads that take the controller name too...</p>

<pre><code>return RedirectToAction(""Index"", ""MyController"");
</code></pre>

<p>and</p>

<pre><code>@Html.ActionLink(""Link Name"",""Index"", ""MyController"", null, null)
</code></pre>
","7892126"
"Convert String to System.IO.Stream","212037","","<p>I need to convert a String to System.IO.Stream type to pass to another method.</p>

<p>I tried this unsuccessfully.</p>

<pre><code>Stream stream = new StringReader(contents);
</code></pre>
","<p>Try this:</p>

<pre><code>// convert string to stream
byte[] byteArray = Encoding.UTF8.GetBytes(contents);
//byte[] byteArray = Encoding.ASCII.GetBytes(contents);
MemoryStream stream = new MemoryStream(byteArray);
</code></pre>

<p>and</p>

<pre><code>// convert stream to string
StreamReader reader = new StreamReader(stream);
string text = reader.ReadToEnd();
</code></pre>
","8047081"
"How to get first N elements of a list in C#?","211375","","<p>I would like to use Linq to query a bus schedule in my project, so that at any time I can get the next 5 bus arrival times. How can I limit my query to the first 5 results?</p>

<p>More generally, how can I take a slice of a list in C#? (In Python I would use <code>mylist[:5]</code> to get the first 5 elements.)</p>
","<pre><code>var firstFiveItems = myList.Take(5);
</code></pre>

<p>Or to slice:</p>

<pre><code>var secondFiveItems = myList.Skip(5).Take(5);
</code></pre>

<p>And of course often it's convenient to get the first five items according to some kind of order:</p>

<pre><code>var firstFiveArrivals = myList.OrderBy(i =&gt; i.ArrivalTime).Take(5);
</code></pre>
","319976"
"Unable to update the EntitySet - because it has a DefiningQuery and no <UpdateFunction> element exist","211322","","<p>I am using Entity Framework 1 with .net 3.5.</p>

<p>I am doing something simple like this:</p>

<pre><code>var RoomDetails = context.Rooms.ToList();

foreach (var Room in Rooms)
{        
   Room.LastUpdated = DateTime.Now;
}
</code></pre>

<p>I am getting this error when I try to do:</p>

<pre><code> context.SaveChanges();
</code></pre>

<p>I get the error:</p>

<blockquote>
  <p><strong>Unable to update the EntitySet - because it has a DefiningQuery and no &lt;UpdateFunction&gt; element exists in the &lt;ModificationFunctionMapping&gt; element to support the current operation.</strong></p>
</blockquote>

<p>I am doing lots of updates on the context and not having any issues, it's only when I try to update this particular entity.</p>

<p>All my searching shows up the same thing, that there is no primary key declared on the entity that I'm trying to update. But alas, I do have a Primary key declared...</p>
","<p>It usually happens because one of the following reasons:</p>

<ul>
<li>Entity Set is mapped from Database view</li>
<li>A custom Database query</li>
<li>Database table doesn't have a primary key</li>
</ul>

<p>After doing so, you may still need to update in the Entity Framework designer (or alternatively delete the entity and then add it) before you stop getting the error.</p>
","7583791"
"How do I replace multiple spaces with a single space in C#?","211195","","<p>How can I replace multiple spaces in a string with only one space in C#?</p>

<p>Example:</p>

<pre><code>1 2 3  4    5
</code></pre>

<p>would be:</p>

<pre><code>1 2 3 4 5
</code></pre>
","<pre><code>RegexOptions options = RegexOptions.None;
Regex regex = new Regex(""[ ]{2,}"", options);     
tempo = regex.Replace(tempo, "" "");
</code></pre>
","206720"
"How to do joins in LINQ on multiple fields in single join","210912","","<p>I need to do a LINQ2DataSet query that does a join on more than one field (as</p>

<pre><code>var result = from x in entity
join y in entity2 
       on x.field1 = y.field1 
and 
          x.field2 = y.field2
</code></pre>

<p>I have yet found a suitable solution (I can add the extra constraints to a where clause, but this is far from a suitable solution, or use <a href=""https://stackoverflow.com/questions/345427/linq-to-sql-join-multiple-columns-from-the-same-table"">this</a> solution, but that assumes an equijoin).</p>

<p>Is it possible in LINQ to join on multiple fields in a single join?</p>

<p><strong>EDIT</strong></p>

<pre><code>var result = from x in entity
             join y in entity2
             on new { x.field1, x.field2 } equals new { y.field1, y.field2 }
</code></pre>

<p>is the solution I referenced as assuming an equijoin above.</p>

<p>Further <strong>EDIT</strong></p>

<p>To answer criticism that my original example was an equijoin, I do acknowledge that, My current requirement is for an equijoin and I have already employed the solution I referenced above.</p>

<p>I am, however, trying to understand what possibilities and best practices I have / should employ with LINQ. I am going to need to do a Date range query join with a table ID soon, and was just pre-empting that issue, It looks like I shall have to add the date range in the where clause.</p>

<p>Thanks, as always, for all suggestions and comments given</p>
","<p>The solution with the anonymous type should work fine. LINQ <em>can</em> only represent equijoins (with join clauses, anyway), and indeed that's what you've said you want to express anyway based on your original query.</p>

<p>If you don't like the version with the anonymous type for some specific reason, you should explain that reason.</p>

<p>If you want to do something other than what you originally asked for, please give an example of what you <em>really</em> want to do.</p>

<p>EDIT: Responding to the edit in the question: yes, to do a ""date range"" join, you need to use a where clause instead. They're semantically equivalent really, so it's just a matter of the optimisations available. Equijoins provide simple optimisation (in LINQ to Objects, which includes LINQ to DataSets) by creating a lookup based on the inner sequence - think of it as a hashtable from key to a sequence of entries matching that key.</p>

<p>Doing that with date ranges is somewhat harder. However, depending on exactly what you mean by a ""date range join"" you may be able to do something <em>similar</em> - if you're planning on creating ""bands"" of dates (e.g. one per year) such that two entries which occur in the same year (but not on the same date) should match, then you can do it just by using that band as the key. If it's more complicated, e.g. one side of the join provides a range, and the other side of the join provides a single date, matching if it falls within that range, that would be better handled with a <code>where</code> clause (after a second <code>from</code> clause) IMO. You could do some particularly funky magic by ordering one side or the other to find matches more efficiently, but that would be a lot of work - I'd only do that kind of thing after checking whether performance is an issue.</p>
","373804"
"Configuration System Failed to Initialize","210788","","<p>I'm new to Visual Studio. I'm currently creating a Login form.</p>

<p>I have this code.</p>

<pre><code>string connectionString = ConfigurationManager.ConnectionStrings[""ConnectionString""].ConnectionString;
try
{
    using (OdbcConnection connect = new OdbcConnection(connectionString))
    {
        connect.Open();
        OdbcCommand cmd = new OdbcCommand(""SELECT username, password FROM receptionist"", connect);
        OdbcDataReader reader = cmd.ExecuteReader();

        if (username_login.Text == username &amp;&amp; password_login.Text == password)
        {
            this.Hide();
            MessageBox.Show(""Invalid User"", ""Login Error"", MessageBoxButtons.OK, MessageBoxIcon.Error);
            this.Close();
        }
        else 
            MessageBox.Show(""Invalid User"", ""Login Error"", MessageBoxButtons.OK, MessageBoxIcon.Error);
        connect.Close();
    }
}
catch (OdbcException ex)
{
    MessageBox.Show(ex.Message, ""error"", MessageBoxButtons.OK, MessageBoxIcon.Error);
}
</code></pre>

<p>But whenever I try to type in the username and password there is an error called <strong>Configuration system failed to initialize</strong>. I'm just wondering what kind of problem is this and how could I solve this?</p>

<p>Please help.</p>
","<p>Make sure that your config file (web.config if web, or app.config if windows) in your project starts as:</p>

<pre><code>&lt;?xml version=""1.0""?&gt;
&lt;configuration&gt;
    &lt;configSections&gt;
        &lt;sectionGroup name=""applicationSettings"" 
                      type=""System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" &gt;

            &lt;section name=""YourProjectName.Properties.Settings"" 
                     type=""System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" 
                     requirePermission=""false"" /&gt;

        &lt;/sectionGroup&gt;
    &lt;/configSections&gt;
&lt;/configuration&gt;
</code></pre>

<p>Note that inside the <code>configuration</code> element, the first child must be the <code>configSections</code> element.</p>

<p>In the <code>name</code> property on <code>section</code> element, make sure you replace <strong><em><code>YourProjectName</code></em></strong> with your actual project's name.</p>

<p>It happened to me that I created a webservice in a class library project, then I copied (overwriting) the config file (in order to bring the endpoints configuration) to my windows app and I started to have the same problem. I had inadvertently removed <code>configSections</code>.</p>

<p>it worked for me, hope it helps </p>
","6472696"
"What is the right way to populate a DropDownList from a database?","210648","","<p>I am populating a DropDownList from a SQL Server database as shown below. It works fine, but I'm not sure it's a good way. Can someone shed some light on this method, and give some improvements?</p>

<pre><code>private void LoadSubjects()
{
    ddlSubjects.Items.Clear();
    string selectSQL = ""SELECT SubjectID,SubjectName FROM Students.dbo.Subjects"";

    SqlConnection con = new SqlConnection(connectionString);
    SqlCommand cmd = new SqlCommand(selectSQL, con);
    SqlDataReader reader;

    try
    {
        ListItem newItem = new ListItem();
        newItem.Text = ""&lt;Select Subject&gt;"";
        newItem.Value = ""0"";
        ddlSubjects.Items.Add(newItem);

        con.Open();
        reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            newItem = new ListItem();
            newItem.Text = reader[""SubjectName""].ToString();
            newItem.Value = reader[""SubjectID""].ToString();
            ddlSubjects.Items.Add(newItem);
        }
        reader.Close();
    }
    catch (Exception err)
    {
        //TODO
    }
    finally
    {
        con.Close();
    }
}
</code></pre>
","<p>You could bind the DropDownList to a data source (DataTable, List, DataSet, SqlDataSource, etc).</p>

<p>For example, if you wanted to use a DataTable:</p>

<pre><code>ddlSubject.DataSource = subjectsTable;
ddlSubject.DataTextField = ""SubjectNamne"";
ddlSubject.DataValueField = ""SubjectID"";
ddlSubject.DataBind();
</code></pre>

<p><strong>EDIT - More complete example</strong></p>

<pre><code>private void LoadSubjects()
{

    DataTable subjects = new DataTable();

    using (SqlConnection con = new SqlConnection(connectionString))
    {

        try
        {
            SqlDataAdapter adapter = new SqlDataAdapter(""SELECT SubjectID, SubjectName FROM Students.dbo.Subjects"", con);
            adapter.Fill(subjects);

            ddlSubject.DataSource = subjects;
            ddlSubject.DataTextField = ""SubjectNamne"";
            ddlSubject.DataValueField = ""SubjectID"";
            ddlSubject.DataBind();
        }
        catch (Exception ex)
        {
            // Handle the error
        }

    }

    // Add the initial item - you can add this even if the options from the
    // db were not successfully loaded
    ddlSubject.Items.Insert(0, new ListItem(""&lt;Select Subject&gt;"", ""0""));

}
</code></pre>

<p>To set an initial value via the markup, rather than code-behind, specify the option(s) and set the AppendDataBoundItems attribute to true:</p>

<pre><code>&lt;asp:DropDownList ID=""ddlSubject"" runat=""server"" AppendDataBoundItems=""true""&gt;
    &lt;asp:ListItem Text=""&lt;Select Subject&gt;"" Value=""0"" /&gt;
&lt;/asp:DropDownList&gt;
</code></pre>

<p>You could then bind the DropDownList to a DataSource in the code-behind (just remember to remove:</p>

<pre><code>ddlSubject.Items.Insert(0, new ListItem(""&lt;Select Subject&gt;"", ""0""));
</code></pre>

<p>from the code-behind, or you'll have two """" items.</p>
","7227536"
"Download/Stream file from URL - asp.net","210219","","<p>I need to stream a file which will result in save as prompt in the browser.
The issue is, the directory that the file is located is virtually mapped, so I am unable to use Server.MapPath to determine it's actual location. The directory is not in the same location (or even phyical server on the live boxes) as the website.</p>

<p>I'd like something like the following, but that will allow me to pass a web URL, and not a server file path.</p>

<p>I may have to end up building my file path from a config base path, and then append on the rest of the path, but hopefully I can do it this way instead.</p>

<pre><code>var filePath = Server.MapPath(DOCUMENT_PATH);

if (!File.Exists(filePath))
    return;

var fileInfo = new System.IO.FileInfo(filePath);
Response.ContentType = ""application/octet-stream"";
Response.AddHeader(""Content-Disposition"", String.Format(""attachment;filename=\""{0}\"""", filePath));
Response.AddHeader(""Content-Length"", fileInfo.Length.ToString());
Response.WriteFile(filePath);
Response.End();
</code></pre>
","<p>You could use HttpWebRequest to get the file and stream it back to the client. This allows you to get the file with a url. An example of this that I found ( but can't remember where to give credit ) is</p>

<pre><code>    //Create a stream for the file
    Stream stream = null;

    //This controls how many bytes to read at a time and send to the client
    int bytesToRead = 10000;

    // Buffer to read bytes in chunk size specified above
    byte[] buffer = new Byte[bytesToRead];

    // The number of bytes read
    try
    {
      //Create a WebRequest to get the file
      HttpWebRequest fileReq = (HttpWebRequest) HttpWebRequest.Create(url);

      //Create a response for this request
      HttpWebResponse fileResp = (HttpWebResponse) fileReq.GetResponse();

      if (fileReq.ContentLength &gt; 0)
        fileResp.ContentLength = fileReq.ContentLength;

        //Get the Stream returned from the response
        stream = fileResp.GetResponseStream();

        // prepare the response to the client. resp is the client Response
        var resp = HttpContext.Current.Response;

        //Indicate the type of data being sent
        resp.ContentType = ""application/octet-stream"";

        //Name the file 
        resp.AddHeader(""Content-Disposition"", ""attachment; filename=\"""" + fileName + ""\"""");
        resp.AddHeader(""Content-Length"", fileResp.ContentLength.ToString());

        int length;
        do
        {
            // Verify that the client is connected.
            if (resp.IsClientConnected)
            {
                // Read data into the buffer.
                length = stream.Read(buffer, 0, bytesToRead);

                // and write it out to the response's output stream
                resp.OutputStream.Write(buffer, 0, length);

                // Flush the data
                resp.Flush();

                //Clear the buffer
                buffer = new Byte[bytesToRead];
            }
            else
            {
                // cancel the download if client has disconnected
                length = -1;
            }
        } while (length &gt; 0); //Repeat until no data is read
    }
    finally
    {
        if (stream != null)
        {
            //Close the input stream
            stream.Close();
        }
    }
</code></pre>
","5605490"
"Post parameter is always null","210089","","<p>Since upgrading to RC for WebAPI I'm having some real odd issue when calling POST on my WebAPI.
I've even gone back to the basic version generated on new project. So:</p>

<pre><code>public void Post(string value)
{
}
</code></pre>

<p>and calling from Fiddler:</p>

<pre><code>Header:
User-Agent: Fiddler
Host: localhost:60725
Content-Type: application/json
Content-Length: 29

Body:
{
    ""value"": ""test""
}
</code></pre>

<p>When I debug, the string ""value"" is never being assigned to. It's just always NULL.
Anyone having this issue?</p>

<p>(I first saw the issue with a more complex type)</p>

<p>The problem is not only bound to ASP.NET MVC 4, the same problem occurs for a fresh ASP.NET MVC 3 project after RC installation</p>
","<p>Since you have only one parameter, you could try decorating it with the <code>[FromBody]</code> attribute, or change the method to accept a DTO with value as a property, as I suggested here: <a href=""https://stackoverflow.com/questions/10955629/mvc4-rc-webapi-parameter-binding/10956025"">MVC4 RC WebApi parameter binding</a></p>

<p>UPDATE: The official ASP.NET site was updated today with an excellent explanation: <a href=""http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-1"" rel=""noreferrer"">http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-1</a></p>

<p>In a nutshell, when sending a single simple type in the body, send the just the value prefixed with an equal sign (=), e.g. body:</p>

<p><code>=test</code></p>
","10986030"
"DataGridView checkbox column - value and functionality","209779","","<p>I've added a checkbox column to a DataGridView in my C# form. The function needs to be dynamic - you select a customer and that brings up all of their items that could be serviced, and you select which of them you wish to be serviced this time around.</p>

<p>Anyway, the code will now add a chckbox to the beginning of the DGV. What I need to know is the following:</p>

<p>1) How do I make it so that the whole column is ""checked"" by default?
2) How can I make sure I'm only getting values from the ""checked"" rows when I click on a button just below the DGV?</p>

<p>Here's the code to get the column inserted:</p>

<pre><code>DataGridViewCheckBoxColumn doWork = new DataGridViewCheckBoxColumn();
            doWork.HeaderText = ""Include Dog"";
            doWork.FalseValue = ""0"";
            doWork.TrueValue = ""1"";
            dataGridView1.Columns.Insert(0, doWork);
</code></pre>

<p>So what next?
Any help would be greatly appreciated!</p>
","<ol>
<li><p>There is no way to do that directly.  Once you have your data in the grid, you can loop through the rows and check each box like this:</p>

<pre><code>foreach (DataGridViewRow row in dataGridView1.Rows)
{
    row.Cells[CheckBoxColumn1.Name].Value = true;
}
</code></pre></li>
<li><p>The Click event might look something like this:</p>

<pre><code>private void button1_Click(object sender, EventArgs e)
{
    List&lt;DataGridViewRow&gt; rows_with_checked_column = new List&lt;DataGridViewRow&gt;();
    foreach (DataGridViewRow row in dataGridView1.Rows)
    {
        if (Convert.ToBoolean(row.Cells[CheckBoxColumn1.Name].Value) == true)
        {
            rows_with_checked_column.Add(row);
        }
    }
    // Do what you want with the check rows
}
</code></pre></li>
</ol>
","1238495"
"How to detect the currently pressed key?","209729","","<p>In <a href=""http://en.wikipedia.org/wiki/Windows_Forms"" rel=""noreferrer"">Windows Forms</a>, you can know, at any time, the current position of the cursor thanks to the <a href=""https://msdn.microsoft.com/en-us/library/system.windows.forms.cursors%28v=vs.110%29.aspx"" rel=""noreferrer"">Cursors</a> class.</p>

<p>The same thing doesn't seem to be available for the keyboard. Is it possible to know if, for example, the <kbd>Shift</kbd> key is pressed?</p>

<p>Is it absolutely necessary to track down every keyboard notification (KeyDown and KeyUp events)?</p>
","<pre><code>if ((Control.ModifierKeys &amp; Keys.Shift) != 0) 
</code></pre>

<p>This will also be true if <kbd>Ctrl</kbd>+<kbd>Shift</kbd> is down.  If you want to check whether Shift alone is pressed,</p>

<pre><code>if (Control.ModifierKeys == Keys.Shift)
</code></pre>

<p>If you're in a class that inherits <code>Control</code> (such as a form), you can remove the <code>Control.</code></p>
","1100374"
"How do I convert a TimeSpan to a formatted string?","209650","","<p>I have two DateTime vars, beginTime and endTime. I have gotten the difference of them by doing the following:</p>

<pre><code>TimeSpan dateDifference = endTime.Subtract(beginTime);
</code></pre>

<p>How can I now return a string of this in hh hrs, mm mins, ss secs format using C#.</p>

<p>If the difference was 00:06:32.4458750</p>

<p>It should return this 00 hrs, 06 mins, 32 secs</p>
","<p>Would <a href=""http://msdn.microsoft.com/en-us/library/1ecy8h51.aspx"" rel=""noreferrer"">TimeSpan.ToString()</a> do the trick for you? If not, it looks like the code sample on that page describes how to do custom formatting of a <code>TimeSpan</code> object.</p>
","842067"
"Name does not exist in the current context","209339","","<p>So, I'm working on this project between my laptop and my desktop.</p>

<p>The project works on the laptop, but now having copied the updated source code onto the desktop, I have over 500 errors in the project, all of them are...</p>

<blockquote>
  <p>The name  does not exist in the current context</p>
</blockquote>

<p>Here's one example...</p>

<p><strong>Jobs.aspx</strong>  </p>

<pre><code>&lt;%@ Page Title="""" Language=""C#"" MasterPageFile=""~/Members/Members.master"" AutoEventWireup=""true"" CodeFile=""Jobs.aspx.cs"" Inherits=""Members_Jobs"" %&gt;

&lt;%@ Register Namespace=""AjaxControlToolkit"" Assembly=""AjaxControlToolkit"" TagPrefix=""aj"" %&gt;

&lt;asp:Content ID=""Content1"" ContentPlaceHolderID=""head"" runat=""server""&gt;
&lt;/asp:Content&gt;
&lt;asp:Content ID=""Content2"" ContentPlaceHolderID=""ContentPlaceHolder1"" runat=""server""&gt;
    &lt;asp:UpdatePanel runat=""server"" ID=""upJobs""&gt;
        &lt;ContentTemplate&gt;
            &lt;!-- page content goes here --&gt;
        &lt;/ContentTemplate&gt;
    &lt;/asp:UpdatePanel&gt;
&lt;/asp:Content&gt;
</code></pre>

<p><strong>Jobs.aspx.cs</strong>  </p>

<pre><code>public partial class Members_Jobs : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            loadJobs();
            gvItems.Visible = false;
            loadComplexes();
            loadBusinesses();
            loadSubcontractors();
            loadInsurers();

            pnlCallback.Visible = false;
            pnlInsurer.Visible = false;
        }
    }

    // more goes down here
}
</code></pre>

<p>Here's a sample of the designer.cs file...</p>

<pre><code>namespace stman.Members {


    public partial class Jobs {

        /// &lt;summary&gt;
        /// upJobs control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.UpdatePanel upJobs;
    }
}
</code></pre>

<p>I know this error means that the control being referenced generally doesn't exist or is not a part of the class that's referencing it, but as far as I can see, that isn't the case here.</p>

<p>Can anyone provide some insight?</p>

<p><img src=""https://i.stack.imgur.com/azFen.png"" alt=""VS2012 Screenshot""></p>
","<p><strong>Jobs.aspx</strong></p>

<p>This is the phyiscal file -> <code>CodeFile=""Jobs.aspx.cs""</code> </p>

<p>This is the class which handles the events of the page -> <code>Inherits=""Members_Jobs""</code></p>

<p><strong>Jobs.aspx.cs</strong></p>

<p>This is the <strong>partial</strong> class which manages the page events -> <code>public partial class Members_Jobs : System.Web.UI.Page</code></p>

<p>The other part of the <strong>partial</strong> class should be -> <code>public partial class Members_Jobs</code> this is usually the designer file.</p>

<p>you dont need to have partial classes and could declare your controls all in 1 class and not have a designer file.</p>

<p><strong>EDIT</strong> 27/09/2013 11:37</p>

<p>if you are still having issues with this I would do as Bharadwaj suggested and delete the designer file. You can then right-click on the page, in the solution explorer, and there is an option, something like ""Convert to Web Application"", which will regenerate your designer file</p>
","19027732"
"Messagebox with input field","209175","","<p>Is it possible to show (pop-up) a message box with an input field in it, possibly a text box? Is somewehre in the language or the framework?</p>
","<p>Unfortunately C# does not have anything like that, you will have to make one yourself. But, you can try referencing <code>Microsoft.VisualBasic.dll</code>.</p>

<p>Then using the code below.</p>

<pre><code>Microsoft.VisualBasic.Interaction.InputBox(""Question?"",""Title"",""Default Text"");
</code></pre>

<p>Alternatively, by adding a <code>using</code> directive allowing for a shorter syntax in your code (which I'd personally prefer).</p>

<pre><code>using Microsoft.VisualBasic;
...
Interaction.InputBox(""Question?"",""Title"",""Default Text"");
</code></pre>

<p>Or you can do what Pranay Rana suggests, that's what I would've done too...</p>
","10797790"
"How To Change DataType of a DataColumn in a DataTable?","209161","","<p>I have:</p>

<pre><code>DataTable Table = new DataTable;
SqlConnection = new System.Data.SqlClient.SqlConnection(""Data Source="" + ServerName + "";Initial Catalog="" + DatabaseName + "";Integrated Security=SSPI; Connect Timeout=120"");

SqlDataAdapter adapter = new SqlDataAdapter(""Select * from "" + TableName, Connection);
adapter.FillSchema(Table, SchemaType.Source);
adapter.Fill(Table);

DataColumn column = DataTable.Columns[0];
</code></pre>

<p>What I want to do is:</p>

<p><strong>Assume currently <em>column.DataType.Name</em> is <em>""Double""</em>. I want it to become <em>""Int32""</em>.</strong></p>

<p>How do I achieve this?</p>

<p>Thank you for your response if any.</p>
","<p>You cannot change the DataType after the Datatable is filled with data. However, you can clone the Data table, change the column type and load data from previous data table to the cloned table as shown below.</p>

<pre><code>DataTable dtCloned = dt.Clone();
dtCloned.Columns[0].DataType = typeof(Int32);
foreach (DataRow row in dt.Rows) 
{
    dtCloned.ImportRow(row);
}
</code></pre>
","9028087"
"How do you show animated GIFs on a Windows Form (c#)","209124","","<p>I have a form showing progress messages as a fairly long process runs. It's a call to a web service so I can't really show a percentage complete figure on a progress bar meaningfully. (I don't particularly like the Marquee property of the progress bar)</p>

<p>I would like to show an animated GIF to give the process the feel of some activity (e.g. files flying from one computer to another like Windows copy process).</p>

<p>How do you do this?</p>
","<p>It's not too hard.</p>

<ol>
<li>Drop a picturebox onto your form.</li>
<li>Add the .gif file as the image in the picturebox</li>
<li>Show the picturebox when you are loading.</li>
</ol>

<p><strong>Things to take into consideration:</strong></p>

<ul>
<li>Disabling the picturebox will prevent the gif from being animated.</li>
</ul>

<p><strong>Animated gifs:</strong></p>

<p>If you are looking for animated gifs you can generate them <a href=""http://ajaxload.info/"" rel=""noreferrer"">here</a></p>

<p><strong>Another way of doing it:</strong></p>

<p>Another way that I have found that works quite well is the async dialog control that I found on the <a href=""http://www.codeproject.com/KB/dialog/asyncdialog.aspx"" rel=""noreferrer"">code project</a></p>
","165746"
"Getting Checkbox Value in ASP.NET MVC 4","208792","","<p>I'm working on an ASP.NET MVC 4 app. This app has a basic form. The model for my form looks like the following:</p>

<pre><code>public class MyModel
{
    public string Name { get; set; }
    public bool Remember { get; set; }
}
</code></pre>

<p>In my form, I have the following HTML.</p>

<pre><code>&lt;input id=""Name"" name=""Name"" type=""text"" value=""@Model.Name"" /&gt;
&lt;input id=""Remember"" name=""Remember"" type=""checkbox"" value=""@Model.Remember"" /&gt;
&lt;label for=""Remember""&gt;&amp;nbsp;Remember Me?&lt;/label&gt;
</code></pre>

<p>When I post the form, the Remember value in the model is always false. However, the Name property in the model has a value. I've tested this by setting a breakpoint in the following:</p>

<pre><code>[HttpPost]
public ActionResult MyAction(MyModel model)
{
  Console.WriteLine(model.Remember.ToString());
}
</code></pre>

<p>I can't figure it out. Why isn't the Checkbox value getting set? </p>
","<pre><code>@Html.EditorFor(x =&gt; x.Remember)
</code></pre>

<p>Will generate:</p>

<pre><code>&lt;input id=""Remember"" type=""checkbox"" value=""true"" name=""Remember"" /&gt;
&lt;input type=""hidden"" value=""false"" name=""Remember"" /&gt;
</code></pre>

<p>How does it work:</p>

<ul>
<li>If <code>checkbox</code> not checked, form submit only <code>hidden</code> (false)</li>
<li>If checked, then form submit two fields (false and true) and MVC set
<code>true</code> for <code>bool</code> property</li>
</ul>

<p><code>&lt;input id=""Remember"" name=""Remember"" type=""checkbox"" value=""@Model.Remember"" /&gt;</code></p>

<p>This will always send default value, if checked</p>
","14731571"
"Read XML file into XmlDocument","208668","","<p>I am very new to C#. I have XML file (text.xml). I want to read that in <code>XmlDocument</code> and store the stream in string variable.</p>
","<p>Use <code>XmlDocument.Load()</code> method to load XML from your file. Then use <code>XmlDocument.InnerXml</code> property to get XML string.  </p>

<pre><code>XmlDocument doc = new XmlDocument();
doc.Load(""path to your file"");
string xmlcontents = doc.InnerXml;
</code></pre>
","9105064"
"Extract only right most n letters from a string","208615","","<p>How can I extract a substring which is composed of the rightmost six letters from another string?</p>

<p>Ex: my string is ""PER 343573"". Now I want to extract only ""343573"".</p>

<p>How can I do this?</p>
","<pre><code>string SubString = MyString.Substring(MyString.Length-6);
</code></pre>
","1722343"
"How do I get the name of the current executable in C#?","208405","","<p>I want to get the name of the currently running program, that is the executable name of the program. In C/C++ you get it from <code>args[0]</code>.</p>
","<pre><code>System.AppDomain.CurrentDomain.FriendlyName
</code></pre>
","616715"
"How to set a default value with Html.TextBoxFor?","208383","","<p>Simple question, if you use the Html Helper from ASP.NET MVC Framework 1 it is easy to set a default value on a textbox because there is an overload <code>Html.TextBox(string name, object value)</code>.  When I tried using the <em>Html.TextBoxFor</em> method, my first guess was to try the following which did not work:</p>

<pre><code>&lt;%: Html.TextBoxFor(x =&gt; x.Age, new { value = ""0""}) %&gt;
</code></pre>

<p>Should I just stick with Html.TextBox(string, object) for now?</p>
","<p>It turns out that if you don't specify the Model to the View method within your controller, it doesn't create a object for you with the default values.</p>

<pre><code>[AcceptVerbs(HttpVerbs.Get)]
public ViewResult Create()
{
  // Loads default values
  Instructor i = new Instructor();
  return View(""Create"", i);
}

[AcceptVerbs(HttpVerbs.Get)]
public ViewResult Create()
{
  // Does not load default values from instructor
  return View(""Create"");
}
</code></pre>
","3038589"
"Converting from IEnumerable to List","208250","","<p>I want to convert from <code>IEnumerable&lt;Contact&gt;</code> to <code>List&lt;Contact&gt;</code>.  How can I do this?</p>
","<p>You can do this very simply using LINQ.</p>

<p>Make sure this using is at the top of your C# file:</p>

<pre><code>using System.Linq;
</code></pre>

<p>Then use the <a href=""http://msdn.microsoft.com/en-us/library/bb342261(v=VS.95).aspx"" rel=""noreferrer""><code>ToList</code></a> extension method.</p>

<p>Example:</p>

<pre><code>IEnumerable&lt;int&gt; enumerable = Enumerable.Range(1, 300);
List&lt;int&gt; asList = enumerable.ToList();
</code></pre>
","7617783"
"Trim last character from a string","208119","","<p>I have a string say</p>

<pre><code>""Hello! world!"" 
</code></pre>

<p>I want to do a trim or a remove to take out the ! off world but not off Hello.</p>
","<pre><code>""Hello! world!"".TrimEnd('!');
</code></pre>

<p><a href=""https://msdn.microsoft.com/en-us/library/64zz6w66(v=vs.110).aspx"" rel=""noreferrer"">read more </a></p>

<p><strong>EDIT:</strong></p>

<p>What I've noticed in this type of questions that quite everyone suggest to remove the last char of given string. But this does not fulfill the definition of Trim method.</p>

<blockquote>
  <p>Trim - Removes all occurrences of
  white space characters from the
  beginning and end of this  instance.</p>
</blockquote>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.string.trim(VS.71).aspx"" rel=""noreferrer"">MSDN-Trim</a></p>

<p>Under this definition removing only last character from string is bad solution. </p>

<p>So if we want to ""Trim last character from string"" we should do something like this </p>

<p>Example as extension method:</p>

<pre><code>public static class MyExtensions
{
  public static string TrimLastCharacter(this String str)
  {
     if(String.IsNullOrEmpty(str)){
        return str;
     } else {
        return str.TrimEnd(str[str.Length - 1]);
     }
  }
}
</code></pre>

<p><strong>Note</strong> if you want to remove all characters of the same value i.e(!!!!)the method above removes all existences of '!' from the end of the string,
but if you want to remove only the last character you should use this :</p>

<pre><code>else { return str.Remove(str.Length - 1); }
</code></pre>
","3573322"
"Query an XDocument for elements by name at any depth","208094","","<p>I have an <code>XDocument</code> object.  I want to query for elements with a particular name at any depth using LINQ.  When I use <code>Descendants(""element_name"")</code>, I only get elements that are direct children of the current level.  What I'm looking for is the equivalent of ""//element_name"" in XPath...should I just use <code>XPath</code>, or is there a way to do it using LINQ methods?  Thanks.</p>
","<p>Descendants should work absolutely fine. Here's an example:</p>

<pre><code>using System;
using System.Xml.Linq;

class Test
{
    static void Main()
    {
        string xml = @""
&lt;root&gt;
  &lt;child id='1'/&gt;
  &lt;child id='2'&gt;
    &lt;grandchild id='3' /&gt;
    &lt;grandchild id='4' /&gt;
  &lt;/child&gt;
&lt;/root&gt;"";
        XDocument doc = XDocument.Parse(xml);

        foreach (XElement element in doc.Descendants(""grandchild""))
        {
            Console.WriteLine(element);
        }
    }
}
</code></pre>

<p>Results:</p>

<blockquote>
  <p><code>&lt;grandchild id=""3"" /&gt;</code><br/>
  <code>&lt;grandchild id=""4"" /&gt;</code></p>
</blockquote>
","566180"
"ASP.NET MVC 5 - Identity. How to get current ApplicationUser","207964","","<p>I have Article entity in my project which have <code>ApplicationUser</code> property named <code>Author</code>. How can I get full object of currently logged <code>ApplicationUser</code>. While creating new article I have to set <code>Author</code> property in <code>Article</code> to current <code>ApplicationUser</code>.</p>

<p>In old Membership mechanism it was simple but in the new Identity approach I don't know how to do this.</p>

<p>I tried to do this that way:</p>

<ul>
<li>Add using statement for Identity extensions: <code>using Microsoft.AspNet.Identity;</code></li>
<li>Then I try to get current user: <code>ApplicationUser currentUser = db.Users.FirstOrDefault(x =&gt; x.Id == User.Identity.GetUserId());</code></li>
</ul>

<p>But I get exception :</p>

<blockquote>
  <p>LINQ to Entities does not recognize the method 'System.String GetUserId(System.Security.Principal.IIdentity)' method, and this method cannot be translated into a store expression.
    Source=EntityFramework</p>
</blockquote>
","<h2>You should not need to query the database directly for the current ApplicationUser.</h2>

<p>That introduces a new dependency of having an extra context for starters, but going forward the user database tables change (3 times in the past 2 years) but the API is consistent. For example the <code>users</code> table is now called <code>AspNetUsers</code> in Identity Framework, and the names of several primary key fields kept changing, so the code in several answers will no longer work <em>as-is</em>.</p>

<p>Another problem is that the underlying OWIN access to the database will use a separate context, so changes from separate SQL access can produce invalid results (e.g. not seeing changes made to the database). Again the solution is to <em>work with</em> the supplied API and not try to <em>work-around</em> it.</p>

<p>The correct way to access the current user object in ASP.Net identity (as at this date) is:</p>

<pre><code>var user = UserManager.FindById(User.Identity.GetUserId());
</code></pre>

<p>or, if you have an async action, something like:</p>

<pre><code>var user = await UserManager.FindByIdAsync(User.Identity.GetUserId());
</code></pre>

<p><code>FindById</code> requires you have the following using statement so that the non-async <code>UserManager</code> methods are available (they are <em>extension methods</em> for UserManager, so if you do not include this you will only see <code>FindByIdAsync</code>):</p>

<pre><code>using Microsoft.AspNet.Identity;
</code></pre>

<p>If you are not in a controller at all (e.g. you are using IOC injection), then the user id is retrieved in full from:</p>

<pre><code>System.Web.HttpContext.Current.User.Identity.GetUserId();
</code></pre>

<p>If you are not in the standard Account controller you will need to add the following (as an example) to your controller:</p>

<h2>1. Add these two properties:</h2>

<pre><code>    /// &lt;summary&gt;
    /// Application DB context
    /// &lt;/summary&gt;
    protected ApplicationDbContext ApplicationDbContext { get; set; }

    /// &lt;summary&gt;
    /// User manager - attached to application DB context
    /// &lt;/summary&gt;
    protected UserManager&lt;ApplicationUser&gt; UserManager { get; set; }
</code></pre>

<h2>2. Add this in the Controller's constructor:</h2>

<pre><code>    this.ApplicationDbContext = new ApplicationDbContext();
    this.UserManager = new UserManager&lt;ApplicationUser&gt;(new UserStore&lt;ApplicationUser&gt;(this.ApplicationDbContext));
</code></pre>

<p><strong>Update March 2015</strong></p>

<p>Note: <em>The most recent update to Identity framework changes one of the underlying classes used for authentication.</em> You can now access it from the Owin Context of the current HttpContent.</p>

<pre><code>ApplicationUser user = System.Web.HttpContext.Current.GetOwinContext().GetUserManager&lt;ApplicationUserManager&gt;().FindById(System.Web.HttpContext.Current.User.Identity.GetUserId());
</code></pre>

<h2>Addendum:</h2>

<p>When using EF and Identity Framework with Azure, over a remote database connection (e.g. local host testing to Azure database), you can randomly hit the dreaded “error: 19 - Physical connection is not usable”. As the cause is buried away inside Identity Framework, where you cannot add retries (or what appears to be a missing <code>.Include(x-&gt;someTable)</code>), you need to implement a custom <code>SqlAzureExecutionStrategy</code> in your project.</p>
","22835540"
"Using JsonConvert.DeserializeObject to deserialize Json to a C# POCO class","207906","","<p>Here is my simple <code>User</code> POCO class:</p>

<pre><code>/// &lt;summary&gt;
/// The User class represents a Coderwall User.
/// &lt;/summary&gt;
public class User
{
    /// &lt;summary&gt;
    /// A User's username. eg: ""sergiotapia, mrkibbles, matumbo""
    /// &lt;/summary&gt;
    public string Username { get; set; }

    /// &lt;summary&gt;
    /// A User's name. eg: ""Sergio Tapia, John Cosack, Lucy McMillan""
    /// &lt;/summary&gt;
    public string Name { get; set; }

    /// &lt;summary&gt;
    /// A User's location. eh: ""Bolivia, USA, France, Italy""
    /// &lt;/summary&gt;
    public string Location { get; set; }

    public int Endorsements { get; set; } //Todo.
    public string Team { get; set; } //Todo.

    /// &lt;summary&gt;
    /// A collection of the User's linked accounts.
    /// &lt;/summary&gt;
    public List&lt;Account&gt; Accounts { get; set; }

    /// &lt;summary&gt;
    /// A collection of the User's awarded badges.
    /// &lt;/summary&gt;
    public List&lt;Badge&gt; Badges { get; set; }

}
</code></pre>

<p>And the method I'm using to deserialize a JSON response into a <code>User</code> object (this actual <a href=""http://coderwall.com/sergiotapia.json"" rel=""noreferrer"">JSON call is here</a>):</p>

<pre><code>private User LoadUserFromJson(string response)
{
    var outObject = JsonConvert.DeserializeObject&lt;User&gt;(response);
    return outObject;
}
</code></pre>

<p>This fires an exception:</p>

<blockquote>
  <p>Cannot deserialize the current JSON object (e.g. {""name"":""value""})
  into type
  'System.Collections.Generic.List`1[CoderwallDotNet.Api.Models.Account]'
  because the type requires a JSON array (e.g. [1,2,3]) to deserialize
  correctly. </p>
  
  <p>To fix this error either change the JSON to a JSON array
  (e.g. [1,2,3]) or change the deserialized type so that it is a normal
  .NET type (e.g. not a primitive type like integer, not a collection
  type like an array or List) that can be deserialized from a JSON
  object. JsonObjectAttribute can also be added to the type to force it
  to deserialize from a JSON object. Path 'accounts.github', line 1,
  position 129.</p>
</blockquote>

<p>Having never worked with this DeserializeObject method before, I'm kind of stuck here.</p>

<p>I've made sure that the property names in the POCO class are the same as the names in the JSON response. </p>

<p>What can I try to deserialize JSON into this POCO class?</p>
","<p>Here is a working example. </p>

<p>Keypoints are:</p>

<ul>
<li>Declaration of <code>Accounts</code></li>
<li>Use of <code>JsonProperty</code> attribute</li>
</ul>

<p>.</p>

<pre><code>using (WebClient wc = new WebClient())
{
    var json = wc.DownloadString(""http://coderwall.com/mdeiters.json"");
    var user = JsonConvert.DeserializeObject&lt;User&gt;(json);
}
</code></pre>

<p>-</p>

<pre><code>public class User
{
    /// &lt;summary&gt;
    /// A User's username. eg: ""sergiotapia, mrkibbles, matumbo""
    /// &lt;/summary&gt;
    [JsonProperty(""username"")]
    public string Username { get; set; }

    /// &lt;summary&gt;
    /// A User's name. eg: ""Sergio Tapia, John Cosack, Lucy McMillan""
    /// &lt;/summary&gt;
    [JsonProperty(""name"")]
    public string Name { get; set; }

    /// &lt;summary&gt;
    /// A User's location. eh: ""Bolivia, USA, France, Italy""
    /// &lt;/summary&gt;
    [JsonProperty(""location"")]
    public string Location { get; set; }

    [JsonProperty(""endorsements"")]
    public int Endorsements { get; set; } //Todo.

    [JsonProperty(""team"")]
    public string Team { get; set; } //Todo.

    /// &lt;summary&gt;
    /// A collection of the User's linked accounts.
    /// &lt;/summary&gt;
    [JsonProperty(""accounts"")]
    public Account Accounts { get; set; }

    /// &lt;summary&gt;
    /// A collection of the User's awarded badges.
    /// &lt;/summary&gt;
    [JsonProperty(""badges"")]
    public List&lt;Badge&gt; Badges { get; set; }
}

public class Account
{
    public string github;
}

public class Badge
{
    [JsonProperty(""name"")]
    public string Name;
    [JsonProperty(""description"")]
    public string Description;
    [JsonProperty(""created"")]
    public string Created;
    [JsonProperty(""badge"")]
    public string BadgeUrl;
}
</code></pre>
","11127428"
"How to find out if a file exists in C# / .NET?","207847","","<p>I would like to test a string containing a path to a file for existence of that file (something like the <code>-e</code> test in Perl or the <code>os.path.exists()</code> in Python) in C#.</p>
","<p>Use:</p>

<pre><code>File.Exists(path)
</code></pre>

<p>MSDN: <a href=""http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx</a></p>

<p>Edit: In System.IO</p>
","38962"
"How to generate and validate a software license key?","207729","","<p>I'm currently involved in developing a product (developed in C#) that'll be available for downloading and installing for free but in a very limited version. To get access to all the features the user has to pay a license fee and receive a key. That key will then be entered into the application to ""unlock"" the full version.</p>

<p>As using a license key like that is kind of usual I'm wondering :  </p>

<ol>
<li>How's that usually solved?</li>
<li>How can I generate the key and how can it be validated by the application?</li>
<li>How can I also avoid having a key getting published on the Internet and used by others that haven't payed the license (a key that basically isn't ""theirs""). </li>
</ol>

<p>I guess I should also tie the key to the version of application somehow so it'll be possible to charge for new keys in feature versions.</p>

<p>Anything else I should think about in this scenario?</p>
","<p>Caveat: you can't prevent users from pirating, but only make it easier for honest users to do the right thing.</p>

<p>Assuming you don't want to do a special build for each user, then:</p>

<ul>
<li>Generate yourself a secret key for the product</li>
<li>Take the user's name</li>
<li>Concatentate the users name and the secret key and hash with (for example) SHA1</li>
<li>Unpack the SHA1 hash as an alphanumeric string. This is the individual user's ""Product Key""</li>
<li>Within the program, do the same hash, and compare with the product key. If equal, OK.</li>
</ul>

<p>But, I repeat: <strong>this won't prevent piracy</strong> </p>

<hr>

<p>I have recently read that this approach is not cryptographically very sound. But this solution is already weak (<strong>as the software itself has to include the secret key somewhere</strong>), so I don't think this discovery invalidates the solution as far as it goes.</p>

<p>Just thought I really ought to mention this, though; if you're planning to derive something else from this, beware.</p>
","599853"
"Cannot find JavaScriptSerializer in .Net 4.0","207708","","<p>I cannot seem to find the <a href=""http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx""><code>JavaScriptSerializer</code></a> object nor the the <code>System.Web.Script.Serialization</code> namespace within Visual Studio 2010.  I need to serialize something to JSON what am I supposed to use?</p>

<p>And yes, I already included the <code>System.Web.Extensions</code> (in System.Web.Extensions.dll) within the project.  Which is why I am shocked?</p>

<ul>
<li>I do know <code>System.Web.Extensions</code> was marked as <a href=""http://weblogs.asp.net/jeff/archive/2008/07/09/any-bets-on-whether-or-not-javascriptserializer-will-really-be-obsolete.aspx"">obsolete</a> in 3.5</li>
</ul>
","<p>Check if you included the .net 4 version of <code>System.Web.Extensions</code> - there's a 3.5 version as well, but I don't think that one works.</p>

<p>These steps work for me:</p>

<ol>
<li>Create a new console application</li>
<li>Change the target to .net 4 instead of Client Profile</li>
<li>Add a reference to <code>System.Web.Extensions</code> (4.0)</li>
<li>Have access to <code>JavaScriptSerializer</code> in Program.cs now :-)</li>
</ol>
","8265420"
"How to show Error & Warning Message Box in .NET/ How to Customize MessageBox","207684","","<p>Using C# .NET (Winforms). </p>

<p>I want to know how can I show the message boxes with  a <code>Ding!!</code> sound &amp; a red colored cross mark in it. This is what I'm talking about:</p>

<p><a href=""https://i.stack.imgur.com/FEweg.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/FEweg.jpg"" alt=""screenshot""></a></p>

<p>How to do such things for my software, with custom errors and custom warnings?</p>

<pre><code>MessageBox.Show(""asdf"");
</code></pre>

<p>doesn't give me customize. </p>
","<p>Try this:</p>

<pre><code>MessageBox.Show(""Some text"", ""Some title"", 
    MessageBoxButtons.OK, MessageBoxIcon.Error);
</code></pre>
","2109455"
"How to calculate the angle between a line and the horizontal axis?","207566","","<p>In a programming language (Python, C#, etc) I need to determine how to calculate the angle between a line and the horizontal axis?</p>

<p>I think an image describes best what I want:</p>

<p><img src=""https://i.stack.imgur.com/HUKbR.png"" alt=""no words can describe this""></p>

<p>Given (P1<sub>x</sub>,P1<sub>y</sub>) and (P2<sub>x</sub>,P2<sub>y</sub>) what is the best way to calculate this angle? The origin is in the topleft and only the positive quadrant is used.</p>
","<p>First find the difference between the start point and the end point (here, this is more of a directed line segment, not a ""line"", since lines extend infinitely and don't start at a particular point).</p>

<pre><code>deltaY = P2_y - P1_y
deltaX = P2_x - P1_x
</code></pre>

<p>Then calculate the angle (which runs from the positive X axis at <code>P1</code> to the positive Y axis at <code>P1</code>).</p>

<pre><code>angleInDegrees = arctan(deltaY / deltaX) * 180 / PI
</code></pre>

<p>But <code>arctan</code> may not be ideal, because dividing the differences this way will erase the distinction needed to distinguish which quadrant the angle is in (see below). Use the following instead if your language includes an <code>atan2</code> function:</p>

<pre><code>angleInDegrees = atan2(deltaY, deltaX) * 180 / PI
</code></pre>

<p>EDIT (Feb. 22, 2017): In general, however, calling <code>atan2(deltaY,deltaX)</code> just to get the proper angle for <code>cos</code> and <code>sin</code> may be inelegant. In those cases, you can often do the following instead:</p>

<ol>
<li>Treat <code>(deltaX, deltaY)</code> as a vector.</li>
<li>Normalize that vector to a unit vector. To do so, divide <code>deltaX</code> and <code>deltaY</code> by the vector's length (<code>sqrt(deltaX*deltaX+deltaY*deltaY)</code>), unless the length is 0.</li>
<li>After that, <code>deltaX</code> will now be the cosine of the angle between the vector and the horizontal axis (in the direction from the positive X to the positive Y axis at <code>P1</code>).</li>
<li>And <code>deltaY</code> will now be the sine of that angle.</li>
<li>If the vector's length is 0, it won't have an angle between it and the horizontal axis (so it won't have a meaningful sine and cosine).</li>
</ol>

<p>EDIT (Feb. 28, 2017): Even without normalizing <code>(deltaX, deltaY)</code>:</p>

<ul>
<li>The sign of <code>deltaX</code> will tell you whether the cosine described in step 3 is positive or negative.</li>
<li>The sign of <code>deltaY</code> will tell you whether the sine described in step 4 is positive or negative.</li>
<li>The signs of <code>deltaX</code> and <code>deltaY</code> will tell you which quadrant the angle is in, in relation to the positive X axis at <code>P1</code>:

<ul>
<li><code>+deltaX</code>, <code>+deltaY</code>: 0 to 90 degrees.</li>
<li><code>-deltaX</code>, <code>+deltaY</code>: 90 to 180 degrees.</li>
<li><code>-deltaX</code>, <code>-deltaY</code>: 180 to 270 degrees (-180 to -90 degrees).</li>
<li><code>+deltaX</code>, <code>-deltaY</code>: 270 to 360 degrees (-90 to 0 degrees).</li>
</ul></li>
</ul>

<hr>

<p><strong>An implementation in Python using radians (provided on July 19, 2015 by Eric Leschinski, who edited my answer):</strong></p>

<pre><code>from math import *
def angle_trunc(a):
    while a &lt; 0.0:
        a += pi * 2
    return a

def getAngleBetweenPoints(x_orig, y_orig, x_landmark, y_landmark):
    deltaY = y_landmark - y_orig
    deltaX = x_landmark - x_orig
    return angle_trunc(atan2(deltaY, deltaX))

angle = getAngleBetweenPoints(5, 2, 1,4)
assert angle &gt;= 0, ""angle must be &gt;= 0""
angle = getAngleBetweenPoints(1, 1, 2, 1)
assert angle == 0, ""expecting angle to be 0""
angle = getAngleBetweenPoints(2, 1, 1, 1)
assert abs(pi - angle) &lt;= 0.01, ""expecting angle to be pi, it is: "" + str(angle)
angle = getAngleBetweenPoints(2, 1, 2, 3)
assert abs(angle - pi/2) &lt;= 0.01, ""expecting angle to be pi/2, it is: "" + str(angle)
angle = getAngleBetweenPoints(2, 1, 2, 0)
assert abs(angle - (pi+pi/2)) &lt;= 0.01, ""expecting angle to be pi+pi/2, it is: "" + str(angle)
angle = getAngleBetweenPoints(1, 1, 2, 2)
assert abs(angle - (pi/4)) &lt;= 0.01, ""expecting angle to be pi/4, it is: "" + str(angle)
angle = getAngleBetweenPoints(-1, -1, -2, -2)
assert abs(angle - (pi+pi/4)) &lt;= 0.01, ""expecting angle to be pi+pi/4, it is: "" + str(angle)
angle = getAngleBetweenPoints(-1, -1, -1, 2)
assert abs(angle - (pi/2)) &lt;= 0.01, ""expecting angle to be pi/2, it is: "" + str(angle)
</code></pre>

<p>All tests pass. See <a href=""https://en.wikipedia.org/wiki/Unit_circle"" rel=""noreferrer"">https://en.wikipedia.org/wiki/Unit_circle</a></p>
","7586218"
"Programmatically close aspx page from code behind","206801","","<p>What is the best way to close an ASPX page from the code-behind?  </p>

<p>I have a button event handler that I want to close the page after the user has clicked an ASP.NET button on the page.  I have tried to programmatically add a JavaScript method that contains a <code>window.close()</code> command to the <code>OnClientClick</code> event to close the page but it does not work.  The button is also a <code>asp:AsyncPostBoskTrigger</code> for an AJAX Update Panel.</p>

<p>The application uses .NET Framework 3.5.</p>
","<p><b>UPDATE:</b> I have taken all of your input and came up with the following solution: </p>

<p>In code behind:</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)    
{
    Page.ClientScript.RegisterOnSubmitStatement(typeof(Page), ""closePage"", ""window.onunload = CloseWindow();"");
}
</code></pre>

<p>In aspx page:</p>

<pre><code>function CloseWindow() {
    window.close();
}
</code></pre>
","375529"
"How do I get the time difference between two DateTime objects using C#?","206411","","<p>How do I get the time difference between two <code>DateTime</code> objects using C#?</p>
","<p>The following example demonstrates how to do this:</p>

<pre><code>DateTime a = new DateTime(2010, 05, 12, 13, 15, 00);
DateTime b = new DateTime(2010, 05, 12, 13, 45, 00);
Console.WriteLine(b.Subtract(a).TotalMinutes);
</code></pre>

<p>When executed this prints ""30"" since there is a 30 minute difference between the date/times.</p>

<p>The result of <code>DateTime.Subtract(DateTime x)</code> is a <a href=""http://msdn.microsoft.com/en-us/library/system.timespan.aspx"" rel=""noreferrer"">TimeSpan Object</a> which gives other useful properties.</p>
","2821078"
"How to get the name of the current method from code","206399","","<p>I know you can do</p>

<pre><code>this.GetType().FullName
</code></pre>

<p><strong>Edit courtesy of @Pasi Savolainen</strong></p>

<p>To get</p>

<blockquote>
  <p>My.Current.Class</p>
</blockquote>

<p>But what can I call to get</p>

<blockquote>
  <p>My.Current.Class.CurrentMethod</p>
</blockquote>
","<pre><code>StackTrace st = new StackTrace ();
StackFrame sf = st.GetFrame (0);

MethodBase currentMethodName = sf.GetMethod ();
</code></pre>

<p>Or, if you'd like to have a helper method:</p>

<pre><code>[MethodImpl(MethodImplOptions.NoInlining)]
public string GetCurrentMethod ()
{
    StackTrace st = new StackTrace ();
    StackFrame sf = st.GetFrame (1);

    return sf.GetMethod().Name;
}
</code></pre>

<p>Updated with credits to @stusmith.</p>
","2652481"
"How to open second window from first window in wpf?","206382","","<p>I am new to wpf.I have two window such as window1 and window2. i have one button in window1. if i click that button, the window2 has to open. what should i do for that.Here the code what i tried.</p>

<pre><code>window2.show();
</code></pre>
","<p>Write your code in <code>window1</code>.</p>

<pre><code>private void Button_Click(object sender, RoutedEventArgs e)
{
    window2 win2 = new window2();
    win2.Show();
    this.Close();
}
</code></pre>
","11134633"
"How do you get the file size in C#?","206341","","<p>I need a way to get the size of a file using C#, and not the size on disk. How is this possible?</p>

<p>Currently I have this loop</p>

<pre><code>foreach (FileInfo file in downloadedMessageInfo.GetFiles())
{
    //file.Length (will this work)
}
</code></pre>

<p>Will this return the size or the size on disk?</p>
","<p><code>FileInfo.Length</code> will return the length of file, in bytes (not size on disk), so this is what you are looking for, I think.</p>
","1380846"
"Convert DateTime in C# to yyyy-MM-dd format and Store it to MySql DateTime Field","206196","","<p>I am trying to convert <code>DateTime</code> format to <code>yyyy-MM-dd</code> format and store it to <code>DateTime</code> object. But it gives me the System <code>DateTime</code> format that is <code>MM/dd/yyyy</code>.<br>
I am using following code to convert.  </p>

<pre><code>string dateTime = DateTime.Now.ToString();
string createddate = Convert.ToDateTime(dateTime).ToString(""yyyy-MM-dd h:mm tt"");         
DateTime dt = DateTime.ParseExact(createddate, ""yyyy-MM-dd h:mm tt"",CultureInfo.InvariantCulture);
</code></pre>

<p>but non of the above line converts into the specified format.<br>
Can any one help to solve this.</p>

<p>I am getting the DateTime from one application and passing this object to other application and That application is storing that date into MySql's DateTime field which is in the format ""yyyy-MM-dd"".<br>
This is why I have posted this question.  </p>

<p>Project 1 has class from that I am getting the date.
and the processor class which is the middle ware of the application it processes the DateTime format to convert in specific format. And passes to the Other project which consumes the DateTime and stores that in the MySql field.</p>
","<p>Use <code>DateTime.Now.ToString(""yyyy-MM-dd h:mm tt"");</code>. See <a href=""http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx"">this</a>.</p>
","19296461"
"How to know user has clicked ""X"" or the ""Close"" button?","206139","","<p>In MSDN I found <code>CloseReason.UserClosing</code> to know that the user had decided to close the form
but I guess it is the same for both clicking the X button or clicking the close button.
So how can I differentiate between these two in my code?</p>

<p>Thanks all.</p>
","<p>Assuming you're asking for WinForms, you may use the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.closing.aspx"" rel=""noreferrer"">FormClosing() event</a>. The event FormClosing() is triggered any time a form is to get closed.</p>

<p>To detect if the user clicked either X or your CloseButton, you may get it through the sender object. Try to cast sender as a Button control, and verify perhaps for its name ""CloseButton"", for instance.</p>

<pre><code>private void Form1_FormClosing(object sender, FormClosingEventArgs e) {
    if (string.Equals((sender as Button).Name, @""CloseButton""))
        // Do something proper to CloseButton.
    else
        // Then assume that X has been clicked and act accordingly.
}
</code></pre>

<p>Otherwise, I have never ever needed to differentiate whether X or CloseButton was clicked, as I wanted to perform something specific on the FormClosing event, like closing all MdiChildren before closing the MDIContainerForm, or event checking for unsaved changes. Under these circumstances, we don't need, according to me, to differentiate from either buttons.</p>

<p>Closing by <kbd>ALT</kbd>+<kbd>F4</kbd> will also trigger the FormClosing() event, as it sends a message to the Form that says to close. You may cancel the event by setting the </p>

<pre><code>FormClosingEventArgs.Cancel = true. 
</code></pre>

<p>In our example, this would translate to be </p>

<pre><code>e.Cancel = true.
</code></pre>

<p>Notice the difference between the FormClosing() and the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.closed.aspx"" rel=""noreferrer"">FormClosed()</a> events. </p>

<p>FormClosing occurs when the form received the message to be closed, and verify whether it has something to do before it is closed.</p>

<p>FormClosed occurs when the form is actually closed, so after it is closed.</p>

<p>Does this help?</p>
","2683716"
"Enter key pressed event handler","205460","","<p>I want to capture the text from the textbox when enter key is hit.  I am using WPF/visual studio 2010/.NET 4.  I dont know what event handler to be used in the  tag ?  I also want to do the same for maskedtextbox.</p>
","<p>Either KeyDown or KeyUp.</p>

<pre><code>TextBox tb = new TextBox();
tb.KeyDown += new KeyEventHandler(tb_KeyDown);

static void tb_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.Enter)
    {
        //enter key is down
    }
}
</code></pre>
","3752506"
"How to get the connection String from a database","204725","","<p>I have created a database with SQL Server Management Studio, I would like to now use it in my C# application. I need the connection string?</p>

<p>Where can I find the connection string, and where is my database stored?</p>

<p>Do I have to publish it or something like that, or is it in my documents somewhere?</p>

<pre><code>using (var conn = new SqlConnection(""your connection string to the database""))
</code></pre>

<p>How do I obtain the <strong>connection string</strong>? Where can I find the connection string to copy paste into the above section?</p>

<p>How to I publish my database so that Visual Studio can pick it up? Then I can just pull the connection string of there?</p>
","<p>The easiest way to get the connection string is using the ""Server Explorer"" window in Visual Studio (menu <em>View</em>, <em>Server Explorer</em>) and connect to the server from that window.</p>

<p>Then you can see the connection string in the properties of the connected server (choose the connection and press F4 or Alt+Enter or choose Properties on the right click menu).</p>

<p><strong>Advanced connection string settings:</strong> when creating the connection, you can modify any of the advanced connection string options, like MARS, resiliency, timeot, pooling configuration, etc. by clicking on the ""Advanced..."" button on the bottom of the ""Add connection"" dialog. You can access this dialog later by right clicking the Data Connection, and choosing ""Modify connection..."". The available advanced options vary by server type.</p>

<p>If you create the database using SQL Server Management Studio, the database will be created in a server instance, so that, to deploy your application you'll have to make a backup of the database and deploy it in the deployment SQL Server. Alternatively, you can use a data file using SQL Server Express (localDB in SQL Server 2012), that will be easily distributed with your app.</p>

<p>I.e. if it's an ASP.NET app, there's an App_Datafolder. If you right click it you can add a new element, which can be a SQL Server Database. This file will be on that folder, will work with SQL Express, and will be easy to deploy. You need SQL Express / localDB installed on your machine for this to work.</p>
","10479937"
"Setting a property by reflection with a string value","204675","","<p>I'd like to set a property of an object through Reflection, with a value of type <code>string</code>.
So, for instance, suppose I have a <code>Ship</code> class, with a property of <code>Latitude</code>, which is a <code>double</code>.</p>

<p>Here's what I'd like to do:</p>

<pre><code>Ship ship = new Ship();
string value = ""5.5"";
PropertyInfo propertyInfo = ship.GetType().GetProperty(""Latitude"");
propertyInfo.SetValue(ship, value, null);
</code></pre>

<p>As is, this throws an <code>ArgumentException</code>:</p>

<blockquote>
  <p>Object of type 'System.String' cannot be converted to type 'System.Double'.</p>
</blockquote>

<p>How can I convert value to the proper type, based on <code>propertyInfo</code>?</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/ms130977.aspx"" rel=""noreferrer""><code>Convert.ChangeType()</code></a> - It allows you to use runtime information on any <code>IConvertible</code> type to change representation formats. Not all conversions are possible, though, and you may need to write special case logic if you want to support conversions from types that are not <code>IConvertible</code>.</p>

<p>The corresponding code (without exception handling or special case logic) would be:</p>

<pre><code>Ship ship = new Ship();
string value = ""5.5"";
PropertyInfo propertyInfo = ship.GetType().GetProperty(""Latitude"");
propertyInfo.SetValue(ship, Convert.ChangeType(value, propertyInfo.PropertyType), null);
</code></pre>
","1089130"
"How do I set up HttpContent for my HttpClient PostAsync second parameter?","204382","","<pre><code>public static async Task&lt;string&gt; GetData(string url, string data)
{
    UriBuilder fullUri = new UriBuilder(url);

    if (!string.IsNullOrEmpty(data))
        fullUri.Query = data;

    HttpClient client = new HttpClient();

    HttpResponseMessage response = await client.PostAsync(new Uri(url), /*expects HttpContent*/);

    response.Content.Headers.ContentType = new MediaTypeHeaderValue(""application/json"");
    response.EnsureSuccessStatusCode();
    string responseBody = await response.Content.ReadAsStringAsync();

    return responseBody;
}
</code></pre>

<p>The <code>PostAsync</code> takes another parameter that needs to be <code>HttpContent</code>.</p>

<p>How do I set up an <code>HttpContent</code>? There Is no documentation anywhere that works for Windows Phone 8.</p>

<p>If I do <code>GetAsync</code>, it works great! but it needs to be POST with the content of key=""bla"", something=""yay""</p>

<p><strong>//EDIT</strong></p>

<p>Thanks so much for the answer... This works well, but still a few unsures here:</p>

<pre><code>    public static async Task&lt;string&gt; GetData(string url, string data)
    {
        data = ""test=something"";

        HttpClient client = new HttpClient();
        StringContent queryString = new StringContent(data);

        HttpResponseMessage response = await client.PostAsync(new Uri(url), queryString );

        //response.Content.Headers.ContentType = new MediaTypeHeaderValue(""application/json"");
        response.EnsureSuccessStatusCode();
        string responseBody = await response.Content.ReadAsStringAsync();

        return responseBody;
    }
</code></pre>

<p>The data ""test=something"" I assumed would pick up on the api side as post data ""test"", evidently it does not. On another matter, I may need to post entire objects/arrays through post data, so I assume json will be best to do so. Any thoughts on how I get post data through?</p>

<p>Perhaps something like:</p>

<pre><code>class SomeSubData
{
    public string line1 { get; set; }
    public string line2 { get; set; }
}

class PostData
{
    public string test { get; set; }
    public SomeSubData lines { get; set; }
}

PostData data = new PostData { 
    test = ""something"",
    lines = new SomeSubData {
        line1 = ""a line"",
        line2 = ""a second line""
    }
}
StringContent queryString = new StringContent(data); // But obviously that won't work
</code></pre>
","<p>This is answered in some of the answers to <a href=""https://stackoverflow.com/questions/11145053"">Can&#39;t find how to use HttpContent</a> as well as in this <a href=""http://pfelix.wordpress.com/2012/01/16/the-new-system-net-http-classes-message-content/"" rel=""noreferrer"">blog post</a>.</p>

<p>In summary, you can't directly set up an instance of <code>HttpContent</code> because it is an <em>abstract class</em>. You need to use one the classes derived from it depending on your need. Most likely <code>StringContent</code>, which lets you set the string value of the response, the encoding, and the media type in the constructor. See: <a href=""http://msdn.microsoft.com/en-us/library/system.net.http.stringcontent.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/system.net.http.stringcontent.aspx</a></p>
","18971787"
"The name 'controlname' does not exist in the current context","204316","","<p>I have a web application that I'm working on (ASP.NET2.0 with C#, using VS2005). Everything was working fine, and all of a sudden I get the error:</p>

<p><code>Error  1   The name 'Label1' does not exist in the current context</code></p>

<p>and 43 others of the sort for each time that I used a control in my codebehind of the page.</p>

<p>This is only happening for 1 page. And it's as if the codebehind isn't recognizing the controls. Another interesting thing is that the intellisense isn't picking up any of the controls either..</p>

<p>I have tried to  clean the solution file, delete the obj file, exclude the files from the project then re-add them, close VS and restart it, and even restart my computer, but none of these have worked.</p>
","<p>Check your code behind file name and Inherits property on the @Page directive, make sure they both match.</p>
","706617"
"Difference in months between two dates","204239","","<p>How to calculate the difference in months between two dates in C#?</p>

<p>Is there is equivalent of VB's <code>DateDiff()</code> method in C#. I need to find difference in months between two dates that are years apart. The documentation says that I can use <code>TimeSpan</code> like:</p>

<pre><code>TimeSpan ts = date1 - date2;
</code></pre>

<p>but this gives me data in Days. <strong>I don't want to divide this number by 30</strong> because not every month is 30 days and since the two operand values are quite apart from each other, I am afraid dividing by 30 might give me a wrong value.</p>

<p>Any suggestions?</p>
","<p>Assuming the day of the month is irrelevant (i.e. the diff between 2011.1.1 and 2010.12.31 is 1), with date1 > date2 giving a positive value and date2 > date1 a negative value</p>

<pre><code>((date1.Year - date2.Year) * 12) + date1.Month - date2.Month
</code></pre>

<p>Or, assuming you want an approximate number of 'average months' between the two dates, the following should work for all but very huge date differences.</p>

<pre><code>date1.Subtract(date2).Days / (365.25 / 12)
</code></pre>

<p>Note, if you were to use the latter solution then your unit tests should state the widest date range which your application is designed to work with and validate the results of the calculation accordingly.</p>

<hr>

<p><em>Update (with thanks to <a href=""https://stackoverflow.com/users/393004/gary"">Gary</a>)</em></p>

<p>If using the 'average months' method, a slightly more accurate number to use for the 'average number of days per year' is <a href=""https://en.wikipedia.org/wiki/Year"" rel=""noreferrer"">365.2425</a>.</p>
","4639057"
"MVC3 DropDownListFor - a simple example?","203693","","<p>I'm having trouble with <code>DropDownListFor</code> in my MVC3 app.   I was able to use StackOverflow to figure out how to get them to appear on the View, but now I don't know how to capture the values in its corresponding properties on the View Model when it's submitted.  In order to get this to work I had to create an inner class that had an ID and a value property, then I had to use an <code>IEnumerable&lt;Contrib&gt;</code> to satisfy the <code>DropDownListFor</code> parameter requirements.   Now, however, how is MVC FW supposed to map the value that is selected on this drop-down back into the simple string property on my view model? </p>

<pre><code>public class MyViewModelClass
{
    public class Contrib
    {
        public int ContribId { get; set; }
        public string Value { get; set; }
    }

    public IEnumerable&lt;Contrib&gt; ContribTypeOptions = 
        new List&lt;Contrib&gt;
        {
            new Contrib {ContribId = 0, Value = ""Payroll Deduction""},
            new Contrib {ContribId = 1, Value = ""Bill Me""}
        };

    [DisplayName(""Contribution Type"")]
    public string ContribType { get; set; }
}
</code></pre>

<p>In my View I place the dropdown on the page like this:</p>

<pre><code>&lt;div class=""editor-label""&gt;
    @Html.LabelFor(m =&gt; m.ContribType)
&lt;/div&gt;
&lt;div class=""editor-field""&gt;
    @Html.DropDownListFor(m =&gt; m.ContribTypeOptions.First().ContribId, 
             new SelectList(Model.ContribTypeOptions, ""ContribId"", ""Value""))
&lt;/div&gt;
</code></pre>

<p>When I submit the form the <code>ContribType</code> is (of course) null. </p>

<p>What is the correct way to do this?</p>
","<p>You should do like this:</p>

<pre><code>@Html.DropDownListFor(m =&gt; m.ContribType, 
                new SelectList(Model.ContribTypeOptions, 
                               ""ContribId"", ""Value""))
</code></pre>

<p>Where:</p>

<pre><code>m =&gt; m.ContribType
</code></pre>

<p>is a property where the result value will be. </p>
","7143621"
"Proper use of 'yield return'","203594","","<p>The <a href=""https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/yield"" rel=""noreferrer"">yield</a> keyword is one of those <a href=""https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/"" rel=""noreferrer"">keywords</a> in C# that continues to mystify me, and I've never been confident that I'm using it correctly.</p>

<p>Of the following two pieces of code, which is the preferred and why?</p>

<p><strong>Version 1:</strong> Using yield return</p>

<pre><code>public static IEnumerable&lt;Product&gt; GetAllProducts()
{
    using (AdventureWorksEntities db = new AdventureWorksEntities())
    {
        var products = from product in db.Product
                       select product;

        foreach (Product product in products)
        {
            yield return product;
        }
    }
}
</code></pre>

<p><strong>Version 2:</strong> Return the list</p>

<pre><code>public static IEnumerable&lt;Product&gt; GetAllProducts()
{
    using (AdventureWorksEntities db = new AdventureWorksEntities())
    {
        var products = from product in db.Product
                       select product;

        return products.ToList&lt;Product&gt;();
    }
}
</code></pre>
","<p>I tend to use yield-return when I calculate the next item in the list (or even the next group of items).   </p>

<p>Using your Version 2, you must have the complete list before returning.
By using yield-return, you really only need to have the next item before returning.</p>

<p>Among other things, this helps spread the computational cost of complex calculations over a larger time-frame.  For example, if the list is hooked up to a GUI and the user never goes to the last page, you never calculate the final items in the list. </p>

<p>Another case where yield-return is preferable is if the IEnumerable represents an infinite set.  Consider the list of Prime Numbers, or an infinite list of random numbers.  You can never return the full IEnumerable at once,  so you use yield-return to return the list incrementally.</p>

<p>In your particular example, you have the full list of products, so I'd use Version 2.</p>
","410058"
"Add item to Listview control","203581","","<p>I have a <code>listview</code> in c# with three columns and the view is details. I need to add a item to each specific column but I am having a hard time with this. I have tried several things. Here is what I got so far. Thanks for any help in advance.</p>

<pre><code>// Add the pet to our listview
ListViewItem lvi = new ListViewItem();
lvi.SubItems.Add(pet.Name);
lvi.SubItems.Add(pet.Type);
lvi.SubItems.Add(pet.Age);

listView.Items.Add(lvi);
</code></pre>

<p><img src=""https://i.stack.imgur.com/PXQ78.png"" alt=""Here is the result""></p>
","<p>I have done it like this and it seems to work:</p>

<pre><code>public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        string[] row = { textBox1.Text, textBox2.Text, textBox3.Text };
        var listViewItem = new ListViewItem(row); 
        listView1.Items.Add(listViewItem);
    }
}
</code></pre>
","9951865"
"How to fix ""Referenced assembly does not have a strong name"" error?","203514","","<p>I've added a weakly named assembly to my <a href=""http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005"" rel=""noreferrer"">Visual&nbsp;Studio&nbsp;2005</a> project (which is strongly named). I'm now getting the error:</p>

<blockquote>
  <p>""Referenced assembly 'xxxxxxxx' does not have a strong name""</p>
</blockquote>

<p>Do I need to sign this third-party assembly?</p>
","<p>To avoid this error you could either:</p>

<ul>
<li>Load the assembly dynamically, or</li>
<li>Sign the third-party assembly. </li>
</ul>

<p>You will find instructions on signing third-party assemblies in <em><a href=""http://buffered.io/post/2008-07-09-net-fu-signing-an-unsigned-assembly-without-delay-signing/"" rel=""noreferrer"">.NET-fu: Signing an Unsigned Assembly (Without Delay Signing)</a></em>. </p>

<h3>Signing Third-Party Assemblies</h3>

<p>The basic principle to sign a thirp-party is to </p>

<ol>
<li><p>Disassemble the assembly using <code>ildasm.exe</code> and save the intermediate language (IL):</p>

<pre><code>ildasm /all /out=thirdPartyLib.il thirdPartyLib.dll 
</code></pre></li>
<li><p>Rebuild and sign the assembly:</p>

<pre><code>ilasm /dll /key=myKey.snk thirdPartyLib.il
</code></pre></li>
</ol>

<h3>Fixing Additional References</h3>

<p>The above steps work fine unless your third-party assembly (<em>A.dll</em>) references another library (<em>B.dll</em>) which also has to be signed. You can disassemble, rebuild and sign both <em>A.dll</em> and <em>B.dll</em> using the commands above, but at runtime, loading of <em>B.dll</em> will fail because <em>A.dll</em> was originally built with a reference to the <em>unsigned</em> version of <em>B.dll</em>. </p>

<p>The fix to this issue is to patch the IL file generated in step 1 above. You will need to add the public key token of B.dll to the reference. You get this token by calling </p>

<pre><code>sn -Tp B.dll 
</code></pre>

<p>which will give you the following output:</p>

<pre><code>Microsoft (R) .NET Framework Strong Name Utility  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Public key (hash algorithm: sha1):
002400000480000094000000060200000024000052534131000400000100010093d86f6656eed3
b62780466e6ba30fd15d69a3918e4bbd75d3e9ca8baa5641955c86251ce1e5a83857c7f49288eb
4a0093b20aa9c7faae5184770108d9515905ddd82222514921fa81fff2ea565ae0e98cf66d3758
cb8b22c8efd729821518a76427b7ca1c979caa2d78404da3d44592badc194d05bfdd29b9b8120c
78effe92

Public key token is a8a7ed7203d87bc9
</code></pre>

<p>The last line contains the public key token. You then have to search the IL of <em>A.dll</em> for the reference to <em>B.dll</em> and add the token as follows:</p>

<pre><code>.assembly extern /*23000003*/ MyAssemblyName
{
  .publickeytoken = (A8 A7 ED 72 03 D8 7B C9 )                         
  .ver 10:0:0:0
}
</code></pre>
","331555"
"Path.Combine for URLs?","203375","","<p><a href=""https://msdn.microsoft.com/en-us/library/system.io.path.combine%28v=vs.110%29.aspx"" rel=""noreferrer"">Path.Combine</a> is handy, but is there a similar function in the .NET framework for <a href=""http://en.wikipedia.org/wiki/Uniform_resource_locator"" rel=""noreferrer"">URLs</a>?</p>

<p>I'm looking for syntax like this:</p>

<pre><code>Url.Combine(""http://MyUrl.com/"", ""/Images/Image.jpg"")
</code></pre>

<p>which would return:</p>

<p><code>""http://MyUrl.com/Images/Image.jpg""</code></p>
","<p><a href=""https://msdn.microsoft.com/en-us/library/system.uri(v=vs.110).aspx"" rel=""noreferrer""><code>Uri</code></a> has a constructor that should do this for you: <code>new Uri(Uri baseUri, string relativeUri)</code></p>

<p>Here's an example:</p>

<pre><code>Uri baseUri = new Uri(""http://www.contoso.com"");
Uri myUri = new Uri(baseUri, ""catalog/shownew.htm"");
</code></pre>
","1527643"
"How to elegantly check if a number is within a range?","203211","","<p>How can I do this elegantly with C# and .NET 3.5/4?</p>

<p>For example, a number can be between 1 and 100.</p>

<p>I know a simple if would suffice; but the keyword to this question is elegance. It's for my toy project not for production.</p>

<p>This questions wasn't about speed, but about code beauty. Stop talking about efficiency and such; remember you're preaching to the choir.</p>
","<p>There are a lot of options:</p>

<pre><code>int x = 30;
if (Enumerable.Range(1,100).Contains(x))
    //true

if (x &gt;= 1 &amp;&amp; x &lt;= 100)
    //true
</code></pre>

<p>Also, check out this <a href=""https://stackoverflow.com/questions/681357/regex-numeric-check"">SO post</a> for regex options.</p>
","3188768"
"Routing with Multiple Parameters using ASP.NET MVC","203027","","<p>Our company is developing an API for our products and we are thinking about using ASP.NET MVC.  While designing our API, we decided to use calls like the one below for the user to request information from the API in XML format:</p>

<p><a href=""http://ws.audioscrobbler.com/2.0/?method=artist.getimages&amp;artist=cher&amp;api_key=b25b959554ed76058ac220b7b2e0a026"" rel=""noreferrer"">http://ws.audioscrobbler.com/2.0/?method=artist.getimages&amp;artist=cher&amp;api_key=b25b959554ed76058ac220b7b2e0a026</a></p>

<p>As you can see, multiple parameters are passed (i.e. <code>artist</code> and <code>api_key</code>).  In ASP.NET MVC, <code>artist</code> would be the <code>controller</code>, <code>getImages</code> the action, but how would I pass multiple parameters to the action?  </p>

<p>Is this even possible using the format above?</p>
","<p>Parameters are directly supported in MVC by simply adding parameters onto your action methods. Given an action like the following:</p>

<pre><code>public ActionResult GetImages(string artistName, string apiKey)
</code></pre>

<p>MVC will auto-populate the parameters when given a URL like: </p>

<pre><code>/Artist/GetImages/?artistName=cher&amp;apiKey=XXX
</code></pre>

<p>One additional special case is parameters named ""id"". Any parameter named ID can be put into the path rather than the querystring, so something like:</p>

<pre><code>public ActionResult GetImages(string id, string apiKey)
</code></pre>

<p>would be populated correctly with a URL like the following:</p>

<pre><code>/Artist/GetImages/cher?apiKey=XXX
</code></pre>

<p>In addition, if you have more complicated scenarios, you can customize the routing rules that MVC uses to locate an action. Your global.asax file contains routing rules that can be customized. By default the rule looks like this:</p>

<pre><code>routes.MapRoute(
            ""Default"",                                              // Route name
            ""{controller}/{action}/{id}"",                           // URL with parameters
            new { controller = ""Home"", action = ""Index"", id = """" }  // Parameter defaults
        );
</code></pre>

<p>If you wanted to support a url like </p>

<pre><code>/Artist/GetImages/cher/api-key
</code></pre>

<p>you could add a route like:</p>

<pre><code>routes.MapRoute(
            ""ArtistImages"",                                              // Route name
            ""{controller}/{action}/{artistName}/{apikey}"",                           // URL with parameters
            new { controller = ""Home"", action = ""Index"", artistName = """", apikey = """" }  // Parameter defaults
        );
</code></pre>

<p>and a method like the first example above.</p>
","2246508"
"C# difference between == and Equals()","202938","","<p>I have a condition in a silverlight application that compares 2 strings, for some reason when I use <code>==</code> it returns <strong>false</strong> while <code>.Equals()</code> returns <strong>true</strong>.</p>

<p>Here is the code:</p>

<pre><code>if (((ListBoxItem)lstBaseMenu.SelectedItem).Content.Equals(""Energy Attack""))
{
    // Execute code
}

if (((ListBoxItem)lstBaseMenu.SelectedItem).Content == ""Energy Attack"")
{
    // Execute code
}
</code></pre>

<p>Any reason as to why this is happening?</p>
","<p>When <code>==</code> is used on an expression of type <code>object</code>, it'll resolve to <a href=""https://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx"" rel=""noreferrer""><code>System.Object.ReferenceEquals</code></a>.</p>

<p><a href=""https://msdn.microsoft.com/en-us/library/bsc2ak47.aspx"" rel=""noreferrer""><code>Equals</code></a> is just a <code>virtual</code> method and behaves as such, so the overridden version will be used (which, for <code>string</code> type compares the contents).</p>
","814880"
"What's the main difference between int.Parse() and Convert.ToInt32","202919","","<ul>
<li>What is the main difference between <code>int.Parse()</code> and <code>Convert.ToInt32()</code>?</li>
<li>Which one is to be preferred</li>
</ul>
","<ul>
<li><p>If you've got a string, and you expect it to always be an integer (say, if some web service is handing you an integer in string format), you'd use <a href=""http://msdn.microsoft.com/en-us/library/system.int32.parse.aspx"" rel=""noreferrer""><strong><code>Int32.Parse()</code></strong></a>.  </p></li>
<li><p>If you're collecting input from a user, you'd generally use <a href=""http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx"" rel=""noreferrer""><strong><code>Int32.TryParse()</code></strong></a>, since it allows you more fine-grained control over the situation when the user enters invalid input. </p></li>
<li><p><a href=""http://msdn.microsoft.com/en-us/library/System.Convert.ToInt32.aspx"" rel=""noreferrer""><strong><code>Convert.ToInt32()</code></strong></a> takes an object as its argument.  (See Chris S's answer for how it works)</p>

<p><code>Convert.ToInt32()</code> also does not throw <code>ArgumentNullException</code> when its argument is null the way <code>Int32.Parse()</code> does. That also means that <code>Convert.ToInt32()</code> is probably a wee bit slower than <code>Int32.Parse()</code>, though in practice, unless you're doing a very large number of iterations in a loop, you'll never notice it.</p></li>
</ul>
","199484"
"How to display a Windows Form in full screen on top of the taskbar?","202749","","<p>I have a .net windows application that needs to run in full screen. When the application starts however the taskbar is shown on top of the main form and it only disappears when activating the form by clicking on it or using ALT-TAB. The form's current properties are as follow:  </p>

<ul>
<li>WindowState=FormWindowState.Normal  </li>
<li>TopMost=Normal  </li>
<li>Size=1024,768 (this is the screen resolution of the machines it's going to be running on)  </li>
<li>FormBorderStyle = None</li>
</ul>

<p>I've tried adding the followings on form load but none worked for me:  </p>

<ul>
<li>this.Focus(); (after giving the focus this.Focus property is always false)</li>
<li>this.BringToFront();</li>
<li>this.TopMost = true; (this however would not be ideal in my scenario)</li>
<li>this.Bounds = Screen.PrimaryScreen.Bounds;</li>
<li>this.Bounds = Screen.PrimaryScreen.Bounds;</li>
</ul>

<p>Is there a way to do it within .NET or would I have to invoke native windows methods and if so a code snippet would very much be appreciated.</p>

<p>many thanks</p>
","<p>My simple fix it turned out to be calling the form's <code>Activate()</code> method, so there's no need to use <code>TopMost</code> (which is what I was aiming at).</p>
","2272312"
"Convert datatable to JSON in C#","202725","","<ol>
<li>I want to get records from database into a <code>DataTable</code>.  </li>
<li>Then convert the <code>DataTable</code> into a JSON object.  </li>
<li>Return the JSON object to my JavaScript function.</li>
</ol>

<p>I use <a href=""https://stackoverflow.com/questions/11138035/convert-datatable-to-json-with-key-per-row#answers-header"">this</a> code by calling:</p>

<pre><code>string result = JsonConvert.SerializeObject(DatatableToDictionary(queryResult, ""Title""), Newtonsoft.Json.Formatting.Indented);
</code></pre>

<p>To convert a DataTable to JSON, it works correctly and return the following:</p>

<pre><code>{
    ""1"": {
    ""viewCount"": 703,
    ""clickCount"": 98
    },
    ""2"": {
    ""viewCount"": 509,
    ""clickCount"": 85
    },
    ""3"": {
    ""viewCount"": 578,
    ""clickCount"": 86
    },
    ""4"": {
    ""viewCount"": 737,
    ""clickCount"": 108
    },
    ""5"": {
    ""viewCount"": 769,
    ""clickCount"": 130
    }
} 
</code></pre>

<p>But I would like it to return the following:</p>

<pre><code>{""records"":[
{
""Title"": 1,
""viewCount"": 703,
""clickCount"": 98
},
{
""Title"": 2,
""viewCount"": 509,
""clickCount"": 85
},
{
""Title"": 3,
""viewCount"": 578,
""clickCount"": 86
},
{
""Title"": 4,
""viewCount"": 737,
""clickCount"": 108
},
{
""Title"": 5,
""viewCount"": 769,
""clickCount"": 130
}
]} 
</code></pre>

<p><strong>How can I do this?</strong></p>
","<p>This code snippet from  <a href=""http://www.aspdotnet-suresh.com/2013/05/c-convert-datatable-to-json-string-in-c.html"">Convert Datatable to JSON String in C#, VB.NET</a> might help you.
It uses <a href=""http://msdn.microsoft.com/en-us/library/vstudio/system.web.script.serialization.javascriptserializer.deserializeobject%28v=vs.110%29.aspx"">System.Web.Script.Serialization.JavaScriptSerializer</a> to serialize the contents to JSON format:</p>

<pre><code>public string ConvertDataTabletoString()
{
    DataTable dt = new DataTable();
    using (SqlConnection con = new SqlConnection(""Data Source=SureshDasari;Initial Catalog=master;Integrated Security=true""))
    {
        using (SqlCommand cmd = new SqlCommand(""select title=City,lat=latitude,lng=longitude,description from LocationDetails"", con))
        {
            con.Open();
            SqlDataAdapter da = new SqlDataAdapter(cmd);
            da.Fill(dt);
            System.Web.Script.Serialization.JavaScriptSerializer serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
            List&lt;Dictionary&lt;string, object&gt;&gt; rows = new List&lt;Dictionary&lt;string, object&gt;&gt;();
            Dictionary&lt;string, object&gt; row;
            foreach (DataRow dr in dt.Rows)
            {
                row = new Dictionary&lt;string, object&gt;();
                foreach (DataColumn col in dt.Columns)
                {
                    row.Add(col.ColumnName, dr[col]);
                }
                rows.Add(row);
            }
            return serializer.Serialize(rows);
        }
    }
}
</code></pre>
","17398078"
"How to read attribute value from XmlNode in C#?","202701","","<p>Suppose I get a XmlNode and I want to attribute value of attirbute ""Name"".
How can I do that??</p>

<pre><code>XmlTextReader reader = new XmlTextReader(path);

XmlDocument doc = new XmlDocument();
XmlNode node = doc.ReadNode(reader);

foreach (XmlNode chldNode in node.ChildNodes)
{
     **//Read the attribute Name**
     if (chldNode.Name == Employee)
     {                    
         if (chldNode.HasChildNodes)
         {
             foreach (XmlNode item in node.ChildNodes)
             { 

             }
         }
      }
}
</code></pre>

<p>XMl Doc:</p>

<pre><code>&lt;Root&gt;
    &lt;Employee Name =""TestName""&gt;
    &lt;Childs/&gt;
&lt;/Root&gt;
</code></pre>
","<p>Try this:</p>

<pre><code>string employeeName = chldNode.Attributes[""Name""].Value;
</code></pre>
","1600086"
"Sending email with attachments from C#, attachments arrive as Part 1.2 in Thunderbird","202561","","<p>I have a C# application which emails out Excel spreadsheet reports via an Exchange 2007 server using SMTP. These arrive fine for Outlook users, but for Thunderbird and Blackberry users the attachments have been renamed as ""Part 1.2"".</p>

<p>I found this <a href=""http://www.dwheeler.com/essays/microsoft-outlook-tnef.html"" rel=""noreferrer"">article</a> which describes the problem, but doesn't seem to give me a workaround. I don't have control of the Exchange server so can't make changes there. Is there anything I can do on the C# end? I have tried using short filenames and HTML encoding for the body but neither made a difference.</p>

<p>My mail sending code is simply this:</p>

<pre><code>public static void SendMail(string recipient, string subject, string body, string attachmentFilename)
{
    SmtpClient smtpClient = new SmtpClient();
    NetworkCredential basicCredential = new NetworkCredential(MailConst.Username, MailConst.Password);
    MailMessage message = new MailMessage();
    MailAddress fromAddress = new MailAddress(MailConst.Username);

    // setup up the host, increase the timeout to 5 minutes
    smtpClient.Host = MailConst.SmtpServer;
    smtpClient.UseDefaultCredentials = false;
    smtpClient.Credentials = basicCredential;
    smtpClient.Timeout = (60 * 5 * 1000);

    message.From = fromAddress;
    message.Subject = subject;
    message.IsBodyHtml = false;
    message.Body = body;
    message.To.Add(recipient);

    if (attachmentFilename != null)
        message.Attachments.Add(new Attachment(attachmentFilename));

    smtpClient.Send(message);
}
</code></pre>

<p>Thanks for any help.</p>
","<p>Explicitly filling in the ContentDisposition fields did the trick.</p>

<pre><code>if (attachmentFilename != null)
{
    Attachment attachment = new Attachment(attachmentFilename, MediaTypeNames.Application.Octet);
    ContentDisposition disposition = attachment.ContentDisposition;
    disposition.CreationDate = File.GetCreationTime(attachmentFilename);
    disposition.ModificationDate = File.GetLastWriteTime(attachmentFilename);
    disposition.ReadDate = File.GetLastAccessTime(attachmentFilename);
    disposition.FileName = Path.GetFileName(attachmentFilename);
    disposition.Size = new FileInfo(attachmentFilename).Length;
    disposition.DispositionType = DispositionTypeNames.Attachment;
    message.Attachments.Add(attachment);                
}
</code></pre>
","2828438"
"How to handle click event in Button Column in Datagridview?","202525","","<p>I am developing a windows application using C#. I am using <code>DataGridView</code> to display data. I have added a button column in that. I want to know how can I handle click event on that button in DataGridView.</p>
","<p>You've added a button to your <code>DataGridView</code> and you want to run some code when it's clicked.<br>
Easy peasy - just follow these steps:</p>

<h3>Don'ts:</h3>

<p>First, here's what <strong>NOT</strong> to do:</p>

<p>I would avoid the suggestions in some of the other answers here and even provided by the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewbuttoncolumn.aspx"" rel=""noreferrer"">documentation at MSDN</a> to hardcode the column index or column name in order to determine if a button was clicked.  The click event registers for the entire grid, so somehow you need to determine that a button was clicked, but you should not do so by assuming that your button lives in a particular column name or index... there's an easier way...</p>

<p>Also, be careful which event you want to handle.  Again, the documentation and many examples get this wrong.  Most examples handle the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellclick.aspx"" rel=""noreferrer""><code>CellClick</code></a> event which will fire:</p>

<blockquote>
  <p>when any part of a cell is clicked.</p>
</blockquote>

<p>...but will also fire whenever the <em>row</em> header is clicked.  This necessitates adding extra code simply to determine if the <code>e.RowIndex</code> value is less than 0</p>

<p>Instead handle the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellcontentclick.aspx"" rel=""noreferrer""><code>CellContentClick</code></a> which only occurs:</p>

<blockquote>
  <p>when the content within a cell is clicked</p>
</blockquote>

<p>For whatever reason, the <em>column</em> header is also considered 'content' within a cell, so we'll still have to check for that below.</p>

<h3>Dos:</h3>

<p>So here's what you should do:</p>

<p>First, <em>cast</em> the sender to type <code>DataGridView</code> to expose it's internal properties at design time.  You can modify the type on the parameter, but that can sometimes make adding or removing handlers tricky.</p>

<p>Next, to see if a button was clicked, just check to make sure that the column raising the event is of type <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewbuttoncolumn.aspx"" rel=""noreferrer""><code>DataGridViewButtonColumn</code></a>.  Because we already cast the sender to type <code>DataGridView</code>, we can get the <code>Columns</code> collection and select the current column using <code>e.ColumnIndex</code>.  Then check if that object is of type <code>DataGridViewButtonColumn</code>.</p>

<p>Of course, if you need to distinguish between multiple buttons per grid, you can then select based on the column name or index, but that shouldn't be your first check.  Always make sure a button was clicked first and then handle anything else appropriately.  In most cases where you only have a single button per grid, you can jump right off to the races.</p>

<h3>Putting it all together:</h3>

<p><strong>C#</strong>:</p>

<pre class=""lang-cs prettyprint-override""><code>private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
    var senderGrid = (DataGridView)sender;

    if (senderGrid.Columns[e.ColumnIndex] is DataGridViewButtonColumn &amp;&amp;
        e.RowIndex &gt;= 0)
    {
        //TODO - Button Clicked - Execute Code Here
    }
}
</code></pre>

<p><strong>VB</strong>:</p>

<pre class=""lang-vb prettyprint-override""><code>Private Sub DataGridView1_CellContentClick(sender As System.Object, e As DataGridViewCellEventArgs) _
                                           Handles DataGridView1.CellContentClick
    Dim senderGrid = DirectCast(sender, DataGridView)

    If TypeOf senderGrid.Columns(e.ColumnIndex) Is DataGridViewButtonColumn AndAlso
       e.RowIndex &gt;= 0 Then
        'TODO - Button Clicked - Execute Code Here
    End If

End Sub
</code></pre>

<hr>

<h3>Update 1 - Custom Event</h3>

<p>If you wanted to have a little bit of fun, you can add your own event to be raised whenever a button is clicked on the DataGrid.  You can't add it to the DataGrid itself, without getting messy with inheritance etc., but you can add a custom event to your form and fire it when appropriate.  It's a little more code, but the upside is that you've separated out what you want to do when a button is clicked with how to determine if a button was clicked. </p>

<p>Just declare an event, raise it when appropriate, and handle it.   It will look like this:</p>

<pre class=""lang-vb prettyprint-override""><code>Event DataGridView1ButtonClick(sender As DataGridView, e As DataGridViewCellEventArgs)

Private Sub DataGridView1_CellContentClick(sender As System.Object, e As DataGridViewCellEventArgs) Handles DataGridView1.CellContentClick
    Dim senderGrid = DirectCast(sender, DataGridView)
    If TypeOf senderGrid.Columns(e.ColumnIndex) Is DataGridViewButtonColumn AndAlso e.RowIndex &gt;= 0 Then
        RaiseEvent DataGridView1ButtonClick(senderGrid, e)
    End If
End Sub

Private Sub DataGridView1_ButtonClick(sender As DataGridView, e As DataGridViewCellEventArgs) Handles Me.DataGridView1ButtonClick
    'TODO - Button Clicked - Execute Code Here
End Sub
</code></pre>

<hr>

<h3>Update 2 - Extended Grid</h3>

<p>What would be great is if we were working with a grid that just did these things for us.  We could answer the initial question easily: <code>you've added a button to your DataGridView and you want to run some code when it's clicked</code>.  Here's an approach that extends the <code>DataGridView</code>.  It might not be worth the hassle of having to deliver a custom control with every library, but at least it maximally reuses the code used for determining if a button was clicked.</p>

<p>Just add this to your assembly:</p>

<pre class=""lang-vb prettyprint-override""><code>Public Class DataGridViewExt : Inherits DataGridView

    Event CellButtonClick(sender As DataGridView, e As DataGridViewCellEventArgs)

    Private Sub CellContentClicked(sender As System.Object, e As DataGridViewCellEventArgs) Handles Me.CellContentClick
        If TypeOf Me.Columns(e.ColumnIndex) Is DataGridViewButtonColumn AndAlso e.RowIndex &gt;= 0 Then
            RaiseEvent CellButtonClick(Me, e)
        End If
    End Sub

End Class
</code></pre>

<p>That's it.  Never touch it again.  Make sure your DataGrid is of type <code>DataGridViewExt</code> which should work exactly the same as a DataGridView.  Except it will also raise an extra event that you can handle like this:</p>

<pre class=""lang-vb prettyprint-override""><code>Private Sub DataGridView1_ButtonClick(sender As DataGridView, e As DataGridViewCellEventArgs) _
                                      Handles DataGridView1.CellButtonClick
    'TODO - Button Clicked - Execute Code Here
End Sub
</code></pre>
","13687844"
"Remove duplicates in the list using linq","202318","","<p>I have a class <code>Items</code> with <code>properties (Id, Name, Code, Price)</code>.</p>

<p>The List of <code>Items</code> is populated with duplicated items. </p>

<p>For ex.: </p>

<pre><code>1         Item1       IT00001        $100
2         Item2       IT00002        $200
3         Item3       IT00003        $150
1         Item1       IT00001        $100
3         Item3       IT00003        $150
</code></pre>

<p>How to remove the duplicates in the list using linq?</p>
","<pre><code>var distinctItems = items.Distinct();
</code></pre>

<p>To match on only some of the properties, create a custom equality comparer, e.g.:</p>

<pre><code>class DistinctItemComparer : IEqualityComparer&lt;Item&gt; {

    public bool Equals(Item x, Item y) {
        return x.Id == y.Id &amp;&amp;
            x.Name == y.Name &amp;&amp;
            x.Code == y.Code &amp;&amp;
            x.Price == y.Price;
    }

    public int GetHashCode(Item obj) {
        return obj.Id.GetHashCode() ^
            obj.Name.GetHashCode() ^
            obj.Code.GetHashCode() ^
            obj.Price.GetHashCode();
    }
}
</code></pre>

<p>Then use it like this:</p>

<pre><code>var distinctItems = items.Distinct(new DistinctItemComparer());
</code></pre>
","1606686"
"Define: What is a HashSet?","201807","","<p><strong>HashSet</strong>
The C# HashSet data structure was introduced in the .NET Framework 3.5. A full list of the implemented members can be found at the <a href=""http://msdn.microsoft.com/en-us/library/bb359438.aspx"" rel=""noreferrer"">HashSet MSDN</a> page.</p>

<ol start=""2"">
<li>Where is it used?</li>
<li>Why would you want to use it?</li>
</ol>
","<ol>
<li><ol>
<li><p>A <code>HashSet</code> holds a set of objects, but in a way that it allows you to easily and quickly determine whether an object is already in the set or not. It does so by internally managing an array and storing the object using an index which is calculated from the hashcode of the object. <a href=""http://www.esus.com/docs/GetQuestionPage.jsp?uid=804"">Take a look here</a></p></li>
<li><p><code>HashSet</code> is an unordered collection containing unique elements. It has the standard collection operations Add, Remove, Contains, but since it uses a hash-based implementation, these operations are O(1). (As opposed to List for example, which is O(n) for Contains and Remove.) <code>HashSet</code> also provides standard set operations such as <em>union</em>, <em>intersection</em>, and <em>symmetric difference</em>.<a href=""http://blogs.msdn.com/b/bclteam/archive/2006/11/09/introducing-hashset-t-kim-hamilton.aspx"">Take a look here</a></p></li>
</ol></li>
<li><p>There are different implementations of Sets. Some make insertion and lookup operations super fast by hashing elements. However, that means that the order in which the elements were added is lost. Other implementations preserve the added order at the cost of slower running times.</p></li>
</ol>

<p>The <code>HashSet</code> class in C# goes for the first approach, thus <strong>not</strong> preserving the order of elements. It is much faster than a regular <code>List</code>. Some basic benchmarks showed that HashSet is decently faster when dealing with primary types (int, double, bool, etc.). It is a lot faster when working with class objects. So that point is that HashSet is fast.</p>

<p>The only catch of <code>HashSet</code> is that there is no access by indices. To access elements you can either use an enumerator or use the built-in function to convert the <code>HashSet</code> into a <code>List</code> and iterate through that.<a href=""http://ezinearticles.com/?C-HashSet-Advantages&amp;id=1761474"">Take a look here</a></p>
","4558802"
"Visual Studio ""Could not copy"" .... during build","201726","","<p>I keep getting this error during the build of my VS2012 C# project</p>

<pre><code>Error   41  Could not copy ""obj\Debug\WeinGartner.WeinCad.exe"" to
 ""bin\Debug\WeinGartner.WeinCad.exe"". 
 Exceeded retry count of 10. Failed.    


Error   42  Unable to copy file ""obj\Debug\WeinGartner.WeinCad.exe"" to
""bin\Debug\WeinGartner.WeinCad.exe"". The process cannot access the file
'bin\Debug\WeinGartner.WeinCad.exe' because it is being used by another 
process.    
</code></pre>

<p>Now I've figured out that killing the process</p>

<pre><code>Weingartner.WeinCad.vhost.exe
</code></pre>

<p>works (sometimes ) but this is getting on my nerves. Any way to stop this happening at all?</p>

<p>My debugger settings are</p>

<p><img src=""https://i.stack.imgur.com/wNEu1.png"" alt=""enter image description here"">
<img src=""https://i.stack.imgur.com/z4Xoc.png"" alt=""enter image description here""></p>
","<p>I encountered the error message(s) in VS 2013.<br>
Mostly it occured when the debug proces was stopped somewhere in an exception.<br>
When clean+build has no effect, closing VS, deleting 'bin' and 'obj' folders en openening VS again has till now always resolved the issue.</p>

<p>The bug exists since VS2003.
Also: renaming the file is often possible and then you can delete it.</p>
","19710027"
"Which passwordchar shows a black dot (•) in a winforms textbox?","201692","","<p>Short question here:</p>

<p>In <strong>.Net 4.0 Winforms</strong>, how do I use the <code>PasswordChar</code> property of a <code>Textbox</code> to show a common <strong>black dot</strong> as a <strong>character</strong>? Is there perhaps some font I can use that has this as a character?</p>

<p>If I use '<code>UseSystemPasswordChar = true</code>' it shows an asterisk (*). </p>
","<p>You can use this one: <a href=""http://www.fileformat.info/info/unicode/char/2022/index.htm"" rel=""noreferrer"">•</a> You can type it by pressing Alt key and typing 0149.</p>
","4051330"
"Better way to cast object to int","201691","","<p>This is probably trivial, but I can't think of a better way to do it. I have a COM object that returns a variant which becomes an object in C#. The only way I can get this into an int is </p>

<pre><code>int test = int.Parse(string.Format(""{0}"", myobject))
</code></pre>

<p>Is there a cleaner way to do this? Thanks</p>
","<p>You have several options:</p>

<ul>
<li><p><code>(int)</code> &mdash; Cast operator.  Works if the object <em>already is</em> an integer at some level in the inheritance hierarchy or if there is an implicit conversion defined.</p></li>
<li><p><code>int.Parse()/int.TryParse()</code> &mdash; For converting from a string of unknown format.</p></li>
<li><p><code>int.ParseExact()/int.TryParseExact()</code> &mdash; For converting from a string in a specific format</p></li>
<li><p><code>Convert.ToInt32()</code>  &mdash; For converting an object of unknown type.  It will use an explicit and implicit conversion or IConvertible implementation if any are defined.</p></li>
<li><p><code>as int?</code> &mdash; Note the ""?"". The <code>as</code> operator is only for reference types, and so I used ""?"" to signify a <code>Nullable&lt;int&gt;</code>.  The ""<code>as</code>"" operator works like <code>Convert.To____()</code>, but think <code>TryParse()</code> rather than <code>Parse()</code>: it returns <code>null</code> rather than throwing an exception if the conversion fails.</p></li>
</ul>

<p>Of these, I would prefer <code>(int)</code> if the object really is just a boxed integer.  Otherwise use <a href=""http://msdn.microsoft.com/en-us/library/system.convert.toint32.aspx"" rel=""noreferrer""><code>Convert.ToInt32()</code></a> in this case.</p>

<p>Note that this is a very <em>general</em> answer:  I want to throw some attention to Darren Clark's response because I think it does a good job addressing the <em>specifics</em> here, but came in late and wasn't voted as well yet.  He gets my vote for ""accepted answer"", anyway, for also recommending (int), for pointing out that if it fails <code>(int)(short)</code> might work instead, and for recommending you check your debugger to find out the actual runtime type.</p>
","745204"
"iif equivalent in c#","201665","","<p>Is there a <code>IIf</code> equivalent in <code>C#</code>? Or similar shortcut?</p>
","<p>C# has the ""?"" ternary operator, like other C-style languages.  However, this is not perfectly equivalent to iif.  There are two important differences.</p>

<p>To explain the first, this <code>iif()</code> call would cause a DivideByZero exception even though the expression is true because <code>iif</code> is just a function and all arguments must be evaluated before calling:</p>

<pre><code>iif(true, 1, 1/0)
</code></pre>

<p>Put another way, iif does <em>not</em> short circuit in the traditional sense, as your question indicates.  On the other hand, this ternary expression does and so is perfectly fine:</p>

<pre><code>(true)?1:1/0;
</code></pre>

<p>The other difference is that <code>iif</code> is not type safe.  It accepts and returns arguments of type <code>object</code>.  The ternary operator uses type inference to know what type it's dealing with.  Note that you can fix this very easily with a generic implementation, but out of the box that's the way it is.</p>

<p>If you really want iif() in C#, you can have it:</p>

<pre><code>object iif(bool expression, object truePart, object falsePart) 
{return expression?truePart:falsePart; }
</code></pre>

<p>or a generic/type-safe implementation:</p>

<pre><code>T iif&lt;T&gt;(bool expression, T truePart, T falsePart) 
{ return expression?truePart:falsePart;}
</code></pre>

<p>On the other hand, if you want the ternary operator in VB, Visual Studio 2008 and later provide a new <code>If</code> <em>operator</em> that works more like C#'s ternary.  It uses type inference to know what it's returning, and it's an operator rather than a function so there's no pesky divide-by-zero issues.</p>
","822869"
"How to correctly use Html.ActionLink with ASP.NET MVC 4 Areas","201487","","<p>I recently discovered <a href=""http://www.codeproject.com/Articles/714356/Areas-in-ASP-NET-MVC"" rel=""noreferrer"">Areas in ASP.NET MVC 4</a>, which I have successfully implemented, but I'm running into troubles with the <code>@Html.ActionLink</code> helper in my Razor views. The URL this helper generates always seems to be relative to the URL of the current page.</p>

<p>I have my web site configured in IIS 7 (Win7) as an Application virtual directory at <code>/Foo</code>.</p>

<p>I have two Areas registered: Admin and Blogs. I have the default code in the <code>AdminAreaRegistration.cs</code> and <code>BlogsAreaRegistration.cs</code> files. I added <code>namespaces = new[] { ""MvcProject.Controllers"" }</code> to the defaults of the default RouteConfig:</p>

<pre><code>public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute(""{resource}.axd/{*pathInfo}"");

        routes.MapRoute(
            name: ""Default"",
            url: ""{controller}/{action}/{id}"",
            defaults: new {
                controller = ""Home"", action = ""Index"", id = UrlParameter.Optional,
                namespaces = new[] { ""MvcProject.Controllers"" }
            }
        );
    }
}
</code></pre>

<p>When I go to the home page for my site: <code>http://localhost/Foo</code>, it correctly loads the ""home"" page for my site. At this point, all the action links have their correct URLs.</p>

<p>Sample code from <code>MvcProject/Views/Shared/_Layout.cshtml</code></p>

<pre class=""lang-html prettyprint-override""><code>&lt;h2&gt;Main Navigation&lt;/h2&gt;
&lt;ul&gt;
    &lt;li&gt;@Html.ActionLink(""Home"", ""Index"", ""Home"")&lt;/li&gt;
    &lt;li&gt;@Html.ActionLink(""Blogs"", ""Index"", ""Blogs/Home"")&lt;/li&gt;
    &lt;li&gt;@Html.ActionLink(""Admin"", ""Index"", ""Admin/Home"")&lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>This is correctly rendering the HTML as:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;h2&gt;Main Navigation&lt;/h2&gt;
&lt;ul&gt;
    &lt;li&gt;&lt;a href=""/Foo""&gt;Home&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=""/Foo/Blogs/Home""&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=""/Foo/Admin/Home""&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>When I navigate in the browser to ""Blogs"" for instance, this URL correctly loads in the browser: <code>/Foo/Blogs/Home</code>.</p>

<p>Now the links in my main navigation change their URLs to:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;h2&gt;Main Navigation&lt;/h2&gt;
&lt;ul&gt;
    &lt;li&gt;&lt;a href=""/Foo/Blogs/Home""&gt;Home&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=""/Foo/Blogs/Blogs/Home""&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=""/Foo/Blogs/Admin/Home""&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>Notice that ""Blogs/"" is appended to the IIS virtual directory name, so that <code>/Foo/Blogs/Home</code> is now <code>/Foo/Blogs/Blogs/Home</code>.</p>

<p>The controllers and views are rendering fine, it's just the calls to <code>@Html.ActionLink</code> in my <code>MvcProject/Views/Shared/_Layout.cshtml</code> view are not working as I expected.</p>

<p>It feels like I'm missing something trivial, but no amount of searching has come up with an answer. Every blog post and tutorial I've found for implementing Areas in ASP.NET MVC4 makes no mention of changes in how <code>@Html.ActionLink</code> behaves.</p>
","<p>I hate answering my own question, but @Matt Bodily put me on the right track.</p>

<p>The <code>@Html.Action</code> method actually invokes a controller and renders the view, so that wouldn't work to create a snippet of HTML in my case, as this was causing a recursive function call resulting in a StackOverflowException. The <code>@Url.Action(action, controller, { area = ""abc"" })</code> does indeed return the URL, but I finally discovered an overload of <code>Html.ActionLink</code> that provided a better solution for my case:</p>

<pre><code>@Html.ActionLink(""Admin"", ""Index"", ""Home"", new { area = ""Admin"" }, null)
</code></pre>

<p><strong>Note:</strong> <code>, null</code> is significant in this case, to match the right signature.</p>

<p>Documentation: <a href=""http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.actionlink%28v=vs.118%29.aspx"">@Html.ActionLink (LinkExtensions.ActionLink)</a></p>

<p>Documentation for this particular overload:</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/dd504972%28v=vs.118%29.aspx"">LinkExtensions.ActionLink(Controller, Action, Text, RouteArgs, HtmlAttributes)</a></p>

<p>It's been difficult to find documentation for these helpers. I tend to search for ""Html.ActionLink"" when I probably should have searched for ""LinkExtensions.ActionLink"", if that helps anyone in the future.</p>

<p>Still marking Matt's response as the answer.</p>

<p>Edit: Found yet another HTML helper to solve this:</p>

<pre><code>@Html.RouteLink(""Admin"", new { action = ""Index"", controller = ""Home"", area = ""Admin"" })
</code></pre>
","22408581"
"Best way to check if a Data Table has a null value in it","201366","","<p>what is the best way to check if a Data Table has a null value in it ?</p>

<p>Most of the time in our scenario, one column will have all null values.</p>

<p>(This datatable is returned by a 3rd party application - we are trying to put a valiadation before our application processes the data-table)</p>
","<p>Try comparing the value of the column to the <code>DBNull.Value</code> value to filter and manage null values in whatever way you see fit.</p>

<pre><code>foreach(DataRow row in table.Rows)
{
    object value = row[""ColumnName""];
    if (value == DBNull.Value)
        // do something
    else
        // do something else
}
</code></pre>

<p><a href=""http://msdn.microsoft.com/us-en/library/system.dbnull.aspx"" rel=""noreferrer"">More information about the DBNull class</a></p>

<hr>

<p>If you want to check if a null value exists in the table you can use this method:</p>

<pre><code>public static bool HasNull(this DataTable table)
{
    foreach (DataColumn column in table.Columns)
    {
        if (table.Rows.OfType&lt;DataRow&gt;().Any(r =&gt; r.IsNull(column)))
            return true;
    }

    return false;
}
</code></pre>

<p>which will let you write this:</p>

<pre><code>table.HasNull();
</code></pre>
","4604459"
"Simple insecure two-way ""obfuscation"" for C#","201025","","<p>I'm looking for very simple obfuscation (like encrypt and decrypt but not necessarily secure) functionality for some data. It's not mission critical. I need something to keep honest people honest, but something a little stronger than <a href=""http://en.wikipedia.org/wiki/ROT13"" rel=""noreferrer"">ROT13</a> or <a href=""http://en.wikipedia.org/wiki/Base64"" rel=""noreferrer"">Base64</a>.</p>

<p>I'd prefer something that is already included in the <a href=""http://en.wikipedia.org/wiki/.NET_Framework"" rel=""noreferrer"">.NET</a> framework 2.0, so I don't have to worry about any external dependencies.</p>

<p>I really don't want to have to mess around with public/private keys, etc. I don't know much about encryption, but I do know enough to know that anything I wrote would be less than worthless... In fact, I'd probably screw up the math and make it trivial to crack.</p>
","<p>Other answers here work fine, but AES is a more secure and up-to-date encryption algorithm.  This is a class that I obtained a few years ago to perform AES encryption that I have modified over time to be more friendly for web applications (e,g. I've built Encrypt/Decrypt methods that work with URL-friendly string).  It also has the methods that work with byte arrays.  </p>

<p>NOTE: you should use different values in the Key (32 bytes) and Vector (16 bytes) arrays!  You wouldn't want someone to figure out your keys by just assuming that you used this code as-is!  All you have to do is change some of the numbers (must be &lt;= 255) in the Key and Vector arrays (I left one invalid value in the Vector array to make sure you do this...).  You can use <a href=""https://www.random.org/bytes/"" rel=""nofollow noreferrer"">https://www.random.org/bytes/</a> to generate a new set easily:</p>

<ul>
<li><a href=""https://www.random.org/cgi-bin/randbyte?nbytes=32&amp;format=d"" rel=""nofollow noreferrer"">generate <code>Key</code></a></li>
<li><a href=""https://www.random.org/cgi-bin/randbyte?nbytes=16&amp;format=d"" rel=""nofollow noreferrer"">generate <code>Vector</code></a></li>
</ul>

<p>Using it is easy: just instantiate the class and then call (usually) EncryptToString(string StringToEncrypt) and DecryptString(string StringToDecrypt) as methods.  It couldn't be any easier (or more secure) once you have this class in place.</p>

<hr>

<pre><code>using System;
using System.Data;
using System.Security.Cryptography;
using System.IO;


public class SimpleAES
{
    // Change these keys
    private byte[] Key = __Replace_Me__({ 123, 217, 19, 11, 24, 26, 85, 45, 114, 184, 27, 162, 37, 112, 222, 209, 241, 24, 175, 144, 173, 53, 196, 29, 24, 26, 17, 218, 131, 236, 53, 209 });

    // a hardcoded IV should not be used for production AES-CBC code
    // IVs should be unpredictable per ciphertext
    private byte[] Vector = __Replace_Me__({ 146, 64, 191, 111, 23, 3, 113, 119, 231, 121, 2521, 112, 79, 32, 114, 156 });


    private ICryptoTransform EncryptorTransform, DecryptorTransform;
    private System.Text.UTF8Encoding UTFEncoder;

    public SimpleAES()
    {
        //This is our encryption method
        RijndaelManaged rm = new RijndaelManaged();

        //Create an encryptor and a decryptor using our encryption method, key, and vector.
        EncryptorTransform = rm.CreateEncryptor(this.Key, this.Vector);
        DecryptorTransform = rm.CreateDecryptor(this.Key, this.Vector);

        //Used to translate bytes to text and vice versa
        UTFEncoder = new System.Text.UTF8Encoding();
    }

    /// -------------- Two Utility Methods (not used but may be useful) -----------
    /// Generates an encryption key.
    static public byte[] GenerateEncryptionKey()
    {
        //Generate a Key.
        RijndaelManaged rm = new RijndaelManaged();
        rm.GenerateKey();
        return rm.Key;
    }

    /// Generates a unique encryption vector
    static public byte[] GenerateEncryptionVector()
    {
        //Generate a Vector
        RijndaelManaged rm = new RijndaelManaged();
        rm.GenerateIV();
        return rm.IV;
    }


    /// ----------- The commonly used methods ------------------------------    
    /// Encrypt some text and return a string suitable for passing in a URL.
    public string EncryptToString(string TextValue)
    {
        return ByteArrToString(Encrypt(TextValue));
    }

    /// Encrypt some text and return an encrypted byte array.
    public byte[] Encrypt(string TextValue)
    {
        //Translates our text value into a byte array.
        Byte[] bytes = UTFEncoder.GetBytes(TextValue);

        //Used to stream the data in and out of the CryptoStream.
        MemoryStream memoryStream = new MemoryStream();

        /*
         * We will have to write the unencrypted bytes to the stream,
         * then read the encrypted result back from the stream.
         */
        #region Write the decrypted value to the encryption stream
        CryptoStream cs = new CryptoStream(memoryStream, EncryptorTransform, CryptoStreamMode.Write);
        cs.Write(bytes, 0, bytes.Length);
        cs.FlushFinalBlock();
        #endregion

        #region Read encrypted value back out of the stream
        memoryStream.Position = 0;
        byte[] encrypted = new byte[memoryStream.Length];
        memoryStream.Read(encrypted, 0, encrypted.Length);
        #endregion

        //Clean up.
        cs.Close();
        memoryStream.Close();

        return encrypted;
    }

    /// The other side: Decryption methods
    public string DecryptString(string EncryptedString)
    {
        return Decrypt(StrToByteArray(EncryptedString));
    }

    /// Decryption when working with byte arrays.    
    public string Decrypt(byte[] EncryptedValue)
    {
        #region Write the encrypted value to the decryption stream
        MemoryStream encryptedStream = new MemoryStream();
        CryptoStream decryptStream = new CryptoStream(encryptedStream, DecryptorTransform, CryptoStreamMode.Write);
        decryptStream.Write(EncryptedValue, 0, EncryptedValue.Length);
        decryptStream.FlushFinalBlock();
        #endregion

        #region Read the decrypted value from the stream.
        encryptedStream.Position = 0;
        Byte[] decryptedBytes = new Byte[encryptedStream.Length];
        encryptedStream.Read(decryptedBytes, 0, decryptedBytes.Length);
        encryptedStream.Close();
        #endregion
        return UTFEncoder.GetString(decryptedBytes);
    }

    /// Convert a string to a byte array.  NOTE: Normally we'd create a Byte Array from a string using an ASCII encoding (like so).
    //      System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding();
    //      return encoding.GetBytes(str);
    // However, this results in character values that cannot be passed in a URL.  So, instead, I just
    // lay out all of the byte values in a long string of numbers (three per - must pad numbers less than 100).
    public byte[] StrToByteArray(string str)
    {
        if (str.Length == 0)
            throw new Exception(""Invalid string value in StrToByteArray"");

        byte val;
        byte[] byteArr = new byte[str.Length / 3];
        int i = 0;
        int j = 0;
        do
        {
            val = byte.Parse(str.Substring(i, 3));
            byteArr[j++] = val;
            i += 3;
        }
        while (i &lt; str.Length);
        return byteArr;
    }

    // Same comment as above.  Normally the conversion would use an ASCII encoding in the other direction:
    //      System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();
    //      return enc.GetString(byteArr);    
    public string ByteArrToString(byte[] byteArr)
    {
        byte val;
        string tempStr = """";
        for (int i = 0; i &lt;= byteArr.GetUpperBound(0); i++)
        {
            val = byteArr[i];
            if (val &lt; (byte)10)
                tempStr += ""00"" + val.ToString();
            else if (val &lt; (byte)100)
                tempStr += ""0"" + val.ToString();
            else
                tempStr += val.ToString();
        }
        return tempStr;
    }
}
</code></pre>
","212707"
"OWIN Startup Class Missing","200514","","<p>I'm getting this error as my project is not able to find the reference for <code>OWIN</code> startup class. I've even installed all the OWIN reference packages through Nuget still getting the same issue. I'm using <code>Visual Studio 2012</code> and <code>MVC4</code>. </p>

<p>The following errors occurred while attempting to load the app.</p>

<blockquote>
  <ul>
  <li>No assembly found containing an OwinStartupAttribute.</li>
  <li>No assembly found containing a Startup or [AssemblyName].Startup class. To disable OWIN startup discovery, add the appSetting
  owin:AutomaticAppStartup with a value of ""false"" in your web.config.
  To specify the OWIN startup Assembly, Class, or Method, add the
  appSetting owin:AppStartup with the fully qualified startup class or
  configuration method name in your web.config.</li>
  </ul>
</blockquote>
","<p>Create One Class With Name Startup this will help you.. </p>

<pre><code>public class Startup
{
   public void Configuration(IAppBuilder app)
   {
      app.MapSignalR();
   }
}
</code></pre>
","20068419"
"How to compare only Date without Time in DateTime types in Linq to SQL with Entity Framework?","200227","","<p>Is there a way to compare 2 DateTime variables in Linq2Sql but to disregard the Time part.</p>

<p>The app stores items in the DB and adds a published date. I want to keep the exact time but still be able to pull by the date itself.</p>

<p>I want to compare 12/3/89 12:43:34 and 12/3/89 11:22:12 and have it disregard the actual time of day so both of these are considered the same.</p>

<p>I guess I can set all the times of day to 00:00:00 before I compare but I actually do want to know the time of day I just also want to be able to compare by date only.</p>

<p>I found some code that has the same issue and they compare the year, month and day separately. Is there a better way to do this?</p>
","<p>try using the <code>Date</code> property on the <code>DateTime</code> Object...</p>

<pre><code>if(dtOne.Date == dtTwo.Date)
    ....
</code></pre>
","683042"
"What is the yield keyword used for in C#?","199761","","<p>In the <a href=""https://stackoverflow.com/questions/39447/how-can-i-expose-only-a-fragment-of-ilist"">How Can I Expose Only a Fragment of IList&lt;></a> question one of the answers had the following code snippet:</p>

<pre><code>IEnumerable&lt;object&gt; FilteredList()
{
    foreach( object item in FullList )
    {
        if( IsItemInPartialList( item )
            yield return item;
    }
}
</code></pre>

<p>What does the yield keyword do there?  I've seen it referenced in a couple places, and one other question, but I haven't quite figured out what it actually does.  I'm used to thinking of yield in the sense of one thread yielding to another, but that doesn't seem relevant here.</p>
","<p>The yield keyword actually does quite a lot here. The function returns an object that implements the IEnumerable interface. If a calling function starts foreach-ing over this object the function is called again until it ""yields"". This is syntactic sugar introduced in C# 2.0. In earlier versions you had to create your own IEnumerable and IEnumerator objects to do stuff like this.</p>

<p>The easiest way understand code like this is to type in an example, set some breakpoints and see what happens.</p>

<p>Try stepping through this for example:</p>

<pre><code>public void Consumer()
{
    foreach(int i in Integers())
    {
        Console.WriteLine(i.ToString());
    }
}

public IEnumerable&lt;int&gt; Integers()
{
    yield return 1;
    yield return 2;
    yield return 4;
    yield return 8;
    yield return 16;
    yield return 16777216;
}
</code></pre>

<p>When you step through the example you'll find the first call to Integers() returns 1. The second call returns 2 and the line ""yield return 1"" is not executed again.</p>

<p>Here is a real-life example</p>

<pre><code>public IEnumerable&lt;T&gt; Read&lt;T&gt;(string sql, Func&lt;IDataReader, T&gt; make, params object[] parms)
{
    using (var connection = CreateConnection())
    {
        using (var command = CreateCommand(CommandType.Text, sql, connection, parms))
        {
            command.CommandTimeout = dataBaseSettings.ReadCommandTimeout;
            using (var reader = command.ExecuteReader())
            {
                while (reader.Read())
                {
                    yield return make(reader);
                }
            }
        }
    }
}
</code></pre>
","39496"
"How do I get the AM/PM value from a DateTime?","199754","","<p>The code in question is below:  </p>

<pre><code>public static string ChangePersianDate(DateTime dateTime)
{
    System.Globalization.GregorianCalendar PC = new System.Globalization.GregorianCalendar();
    PC.CalendarType = System.Globalization.GregorianCalendarTypes.USEnglish;
    return
    PC.GetYear(dateTime).ToString()
    + ""/""
    + PC.GetMonth(dateTime).ToString()
    + ""/""
    + PC.GetDayOfMonth(dateTime).ToString()
    + """"
    + PC.GetHour(dateTime).ToString()
    + "":""
    + PC.GetMinute(dateTime).ToString()
    + "":""
    + PC.GetSecond(dateTime).ToString()
    + "" ""
    ????????????????
}
</code></pre>

<p>how can I get the AM/PM from the <code>dateTime</code> value?  </p>
","<p>How about:</p>

<pre><code>dateTime.ToString(""tt"", CultureInfo.InvariantCulture);
</code></pre>
","7875351"
"What is the difference between an int and an Integer in Java and C#?","199721","","<p>I was reading <em><a href=""http://rads.stackoverflow.com/amzn/click/1430209879"" rel=""noreferrer"">More Joel on Software</a></em> when I came across <a href=""http://en.wikipedia.org/wiki/Joel_Spolsky"" rel=""noreferrer"">Joel Spolsky</a> saying something about a particular type of programmer knowing the difference between an <code>int</code> and an <code>Integer</code> in Java/C# (Object Oriented Programming Languages).</p>

<p>So, what is the difference?</p>
","<p><strong>In Java,</strong> the 'int' type is a primitive , whereas the 'Integer' type is an object.</p>

<p><strong>In C#,</strong> the 'int' type is the same as <code>System.Int32</code> and is <a href=""http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx"" rel=""noreferrer"">a value type</a> (ie more like the java 'int'). An integer (just like any other value types) can be <a href=""http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx"" rel=""noreferrer"">boxed</a> (""wrapped"") into an object. </p>

<hr>

<p>The differences between objects and primitives are somewhat beyond the scope of this question, but to summarize: </p>

<p><strong>Objects</strong> provide facilities for polymorphism, are passed by reference (or more accurately have references passed by value), and are allocated from the <a href=""http://en.wikipedia.org/wiki/Dynamic_memory_allocation"" rel=""noreferrer"">heap</a>. Conversely, <strong>primitives</strong> are immutable types that are passed by value and are often allocated from the <a href=""http://en.wikipedia.org/wiki/Stack-based_memory_allocation"" rel=""noreferrer"">stack</a>.</p>
","566"
"Entity Framework Timeouts","199673","","<p>I am getting timeouts using the Entity Framework (EF) when using a function import that takes over 30 seconds to complete. I tried the following and have not been able to resolve this issue:</p>

<p>I added <code>Default Command Timeout=300000</code> to the connection string in the <em>App.Config</em> file in the project that has the EDMX file as suggested <a href=""https://stackoverflow.com/questions/1718739/entity-framework-with-mysql-timeout-expired-while-generating-model"">here</a>.</p>

<p>This is what my connection string looks like:</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;add 
    name=""MyEntityConnectionString"" 
    connectionString=""metadata=res://*/MyEntities.csdl|res://*/MyEntities.ssdl|
       res://*/MyEntities.msl;
       provider=System.Data.SqlClient;provider connection string=&amp;quot;
       Data Source=trekdevbox;Initial Catalog=StarTrekDatabase;
       Persist Security Info=True;User ID=JamesTKirk;Password=IsFriendsWithSpock;
       MultipleActiveResultSets=True;Default Command Timeout=300000;&amp;quot;""
    providerName=""System.Data.EntityClient"" /&gt;
</code></pre>

<p>I tried setting the CommandTimeout in my repository directly like so:</p>

<pre><code>private TrekEntities context = new TrekEntities();

public IEnumerable&lt;TrekMatches&gt; GetKirksFriends()
{
    this.context.CommandTimeout = 180;
    return this.context.GetKirksFriends();
}
</code></pre>

<p>What else can I do to get the EF from timing out? This only happens for very large datasets. Everything works fine with small datasets.</p>

<p>Here is one of the errors I'm getting:</p>

<blockquote>
  <p>System.Data.EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.</p>
</blockquote>

<hr>

<p>OK - I got this working and it's silly what happened. I had both the connection string with <code>Default Command Timeout=300000</code> and the CommandTimeout set to 180. When I removed the <code>Default Command Timeout</code> from the connection string, it worked. So the answer is to manually set the CommandTimeout in your repository on your context object like so:</p>

<pre><code>this.context.CommandTimeout = 180;
</code></pre>

<p>Apparently setting the timeout settings in the connection string has no effect on it.</p>
","<p>There is a known bug with specifying default command timeout within the EF connection string.</p>

<p><a href=""http://bugs.mysql.com/bug.php?id=56806"" rel=""noreferrer"">http://bugs.mysql.com/bug.php?id=56806</a></p>

<p>Remove the value from the connection string and set it on the data context object itself. This will work if you remove the conflicting value from the connection string.</p>

<h2>Entity Framework Core 1.0:</h2>

<pre><code>this.context.Database.SetCommandTimeout(180);
</code></pre>

<h2>Entity Framework 6:</h2>

<pre><code>this.context.Database.CommandTimeout = 180;
</code></pre>

<h2>Entity Framework 5:</h2>

<pre><code>((IObjectContextAdapter)this.context).ObjectContext.CommandTimeout = 180;
</code></pre>

<h2>Entity Framework 4 and below:</h2>

<pre><code>this.context.CommandTimeout = 180;
</code></pre>
","6234593"
"Member '<method>' cannot be accessed with an instance reference","199485","","<p>I am getting into C# and I am having this issue:</p>

<pre><code>namespace MyDataLayer
{
    namespace Section1
    {
        public class MyClass
        {
            public class MyItem
            {
                public static string Property1{ get; set; }
            }
            public static MyItem GetItem()
            {
                MyItem theItem = new MyItem();
                theItem.Property1 = ""MyValue"";
                return theItem;
            }
        }
     }
 }
</code></pre>

<p>I have this code on a UserControl:</p>

<pre><code>using MyDataLayer.Section1;

public class MyClass
{
    protected void MyMethod
    {
        MyClass.MyItem oItem = new MyClass.MyItem();
        oItem = MyClass.GetItem();
        someLiteral.Text = oItem.Property1;
    }
}
</code></pre>

<p>Everything works fine, except when I go to access <code>Property1</code>. The intellisense only gives me ""<code>Equals</code>, <code>GetHashCode</code>, <code>GetType</code>, and <code>ToString</code>"" as options. When I mouse over the <code>oItem.Property1</code>, Visual Studio gives me this explanation:</p>

<blockquote>
  <p><code>Member</code>MyDataLayer.Section1.MyClass.MyItem.Property1.get<code>cannot be accessed with an instance reference, qualify it with a type name instead</code></p>
</blockquote>

<p>I am unsure of what this means, I did some googling but wasn't able to figure it out. </p>
","<p>In C#, unlike VB.NET and Java, you can't access <code>static</code> members with instance syntax. You should do:</p>

<pre><code>MyClass.MyItem.Property1
</code></pre>

<p>to refer to that property or remove the <code>static</code> modifier from <code>Property1</code> (which is what you probably want to do). For a conceptual idea about what <a href=""https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-java/413904#413904""><code>static</code> is, see my other answer</a>.</p>
","1100023"
"Entity Framework Provider type could not be loaded?","199173","","<p>I am trying to run my tests on TeamCity which is currently installed on my machine.</p>

<blockquote>
  <p><code>System.InvalidOperationException</code>: </p>
  
  <p>The Entity Framework provider type
  '<code>System.Data.Entity.SqlServer.SqlProviderServices,
  EntityFramework.SqlServer</code>, <code>Version=6.0.0.0, Culture=neutral,
  PublicKeyToken=b77a5c561934e089'</code> for the '<code>System.Data.SqlClient</code>'
  ADO.NET provider could not be loaded. Make sure the provider assembly
  is available to the running application. </p>
  
  <p>See <a href=""http://go.microsoft.com/fwlink/?LinkId=260882"">http://go.microsoft.com/fwlink/?LinkId=260882</a> for more
  information..</p>
</blockquote>

<p>I have no reference to <code>System.Data.Entity</code> in any of my projects as was suggested on codeplex for upgrading to EF6.</p>

<p>So, I am not sure why am I getting this exception.
I do not get any such exception when I run the tests from VS.</p>

<p>I did try to set CopyLocal to false then again to true.. but that does not seem to work either.</p>

<p>Update </p>

<p>My app.config has the following . Does this cause some behavior that I don't understand ?</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;configuration&gt;
  &lt;configSections&gt;
    &lt;section name=""entityFramework"" type=""System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" requirePermission=""false"" /&gt;
    &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;
  &lt;/configSections&gt;
  &lt;entityFramework&gt;
    &lt;defaultConnectionFactory type=""System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework"" /&gt;
  &lt;/entityFramework&gt;
&lt;/configuration&gt;
</code></pre>

<p>I get the following stacktrace in teamcity .</p>

<pre><code>[MSTest] IntegrationTests.CrudTest+QuestionTest.Create
[03:59:11][IntegrationTests.CrudTest+QuestionTest.Create] Initialization method IntegrationTests.CrudTest+QuestionTest.Initialize threw exception. System.InvalidOperationException: System.InvalidOperationException: The Entity Framework provider type 'System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' for the 'System.Data.SqlClient' ADO.NET provider could not be loaded. Make sure the provider assembly is available to the running application. See http://go.microsoft.com/fwlink/?LinkId=260882 for more information..
[03:59:11]
[IntegrationTests.CrudTest+QuestionTest.Create]     at System.Data.Entity.Config.ProviderServicesFactory.GetInstance(String providerTypeName, String providerInvariantName)
   at System.Data.Entity.Config.ProviderServicesFactory.GetInstanceByConvention(String providerInvariantName)
   at System.Data.Entity.Config.DefaultProviderServicesResolver.GetService(Type type, Object key)
   at System.Data.Entity.Config.CachingDependencyResolver.&lt;&gt;c__DisplayClass1.&lt;GetService&gt;b__0(Tuple`2 k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at System.Data.Entity.Config.CachingDependencyResolver.GetService(Type type, Object key)
   at System.Data.Entity.Config.ResolverChain.&lt;&gt;c__DisplayClass3.&lt;GetService&gt;b__0(IDbDependencyResolver r)
   at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext()
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source, Func`2 predicate)
   at System.Data.Entity.Config.ResolverChain.GetService(Type type, Object key)
   at System.Data.Entity.Config.RootDependencyResolver.GetService(Type type, Object key)
   at System.Data.Entity.Config.ResolverChain.&lt;&gt;c__DisplayClass3.&lt;GetService&gt;b__0(IDbDependencyResolver r)
   at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext()
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source, Func`2 predicate)
   at System.Data.Entity.Config.ResolverChain.GetService(Type type, Object key)
   at System.Data.Entity.Config.CompositeResolver`2.GetService(Type type, Object key)
   at System.Data.Entity.Config.IDbDependencyResolverExtensions.GetService[T](IDbDependencyResolver resolver, Object key)
   at System.Data.Entity.Config.InternalConfiguration.GetService[TService](Object key)
   at System.Data.Entity.Config.DbConfiguration.GetService[TService](Object key)
   at System.Data.Entity.Utilities.DbProviderFactoryExtensions.GetProviderServices(DbProviderFactory factory)
   at System.Data.Entity.Infrastructure.DefaultManifestTokenService.GetProviderManifestToken(DbConnection connection)
   at System.Data.Entity.Utilities.DbConnectionExtensions.GetProviderInfo(DbConnection connection, DbProviderManifest&amp; providerManifest)
   at System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection)
   at System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext)
   at System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input)
   at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
   at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)
   at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()
   at System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext()
   at System.Data.Entity.Internal.Linq.InternalSet`1.ActOnSet(Action action, EntityState newState, Object entity, String methodName)
   at System.Data.Entity.Internal.Linq.InternalSet`1.Add(Object entity)
   at System.Data.Entity.DbSet`1.Add(TEntity entity)
   at EFRepository.Infrastructure.EFRepository`1.Add(T item) in c:\TeamCity\buildAgent\work\da2ea4e72c0e77f0\Repository\Infrastructure\EFRepository.cs:line 22
   at IntegrationTests.CrudTest.Initialize() in c:\TeamCity\buildAgent\work\da2ea4e72c0e77f0\IntegrationTests\CrudTest.cs:line 34
</code></pre>
","<p>Same problem, but i installed EF 6 through Nuget. EntityFramework.SqlServer was missing for another executable. I simply added the nuget package to that project.</p>
","15358941"
"How to add a line to a multiline TextBox?","199141","","<p>How can i add a line of text to a <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.multiline%28v=VS.80%29.aspx"" rel=""noreferrer"">multi-line</a> <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox%28v=VS.80%29.aspx"" rel=""noreferrer""><code>TextBox</code></a>?</p>

<p>e.g. pseudocode;</p>

<pre><code>textBox1.Clear();
textBox1.Lines.Add(""1000+"");
textBox1.Lines.Add(""750-999"");
textBox1.Lines.Add(""400-749"");
...snip...
textBox1.Lines.Add(""40-59"");
</code></pre>

<p>or</p>

<pre><code>textBox1.Lines.Append(""brown"");
textBox1.Lines.Append(""brwn"");
textBox1.Lines.Append(""brn"");
textBox1.Lines.Append(""brow"");
textBox1.Lines.Append(""br"");
textBox1.Lines.Append(""brw"");
textBox1.Lines.Append(""brwm"");
textBox1.Lines.Append(""bron"");
textBox1.Lines.Append(""bwn"");
textBox1.Lines.Append(""brnw"");
textBox1.Lines.Append(""bren"");
textBox1.Lines.Append(""broe"");
textBox1.Lines.Append(""bewn"");
</code></pre>

<p>The only methods that <a href=""http://msdn.microsoft.com/en-US/library/system.windows.forms.textboxbase.lines%28v=VS.80%29.aspx"" rel=""noreferrer"">TextBox.Lines</a> implements (that i can see) are:</p>

<ul>
<li>Clone</li>
<li>CopyTo</li>
<li>Equals</li>
<li>GetType</li>
<li>GetHashCode</li>
<li>GetEnumerator</li>
<li>Initialize</li>
<li>GetLowerBound</li>
<li>GetUpperBound</li>
<li>GetLength</li>
<li>GetLongLength</li>
<li>GetValue</li>
<li>SetValue</li>
<li>ToString</li>
</ul>

<p><img src=""https://i.stack.imgur.com/faVJn.png"" alt=""enter image description here""></p>
","<p>@Casperah pointed out that i'm thinking about it wrong. A <code>TextBox</code> doesn't <em>have</em> lines, it has <strong>text</strong>. That text can be split on the CRLF into lines, if requested - but there is no notion of lines.</p>

<p>The question then is how to accomplish what i want, rather than what WinForms lets me. </p>

<p>Other given variants have a subtle bug:</p>

<ul>
<li><code>textBox1.AppendText(""Hello"" + Environment.NewLine);</code></li>
<li><code>textBox1.AppendText(""Hello"" + ""\r\n"");</code></li>
<li><code>textBox1.Text += ""Hello\r\n""</code></li>
<li><code>textbox1.Text += System.Environment.NewLine + ""brown"";</code></li>
</ul>

<p>They either append or prepend a newline when one (might) not be required.</p>

<p>So, extension helper:</p>

<pre><code>public static class WinFormsExtensions
{
   public static void AppendLine(this TextBox source, string value)
   {
      if (source.Text.Length==0)
         source.Text = value;
      else
         source.AppendText(""\r\n""+value);
   }
}
</code></pre>

<p>So now:</p>

<pre><code>textBox1.Clear();
textBox1.AppendLine(""red"");
textBox1.AppendLine(""green"");
textBox1.AppendLine(""blue"");
</code></pre>

<p>and</p>

<pre><code>textBox1.AppendLine(String.Format(""Processing file {0}"", filename));
</code></pre>

<blockquote>
  <p><strong>Note</strong>: Any code is released into the public domain. No attribution required.</p>
</blockquote>
","8537564"
"get dictionary value by key","199087","","<p>How can I get the dictionary value by key on function</p>

<p>my function code is this ( and the command what I try but didn't work ):</p>

<pre><code>static void XML_Array(Dictionary&lt;string, string&gt; Data_Array)
{
    String xmlfile = Data_Array.TryGetValue(""XML_File"", out value);
}
</code></pre>

<p>my button code is this</p>

<pre><code>private void button2_Click(object sender, EventArgs e)
{
    Dictionary&lt;string, string&gt; Data_Array = new Dictionary&lt;string, string&gt;();
    Data_Array.Add(""XML_File"", ""Settings.xml"");

    XML_Array(Data_Array);
}
</code></pre>

<p>I want something like this:<br />
on <code>XML_Array</code> function to be<br />
string xmlfile = Settings.xml</p>
","<p>It's as simple as this:</p>

<pre><code>String xmlfile = Data_Array[""XML_File""];
</code></pre>

<p>Note that if the dictionary doesn't have a key that equals <code>""XML_File""</code>, that code will throw an exception. If you want to check first, you can use TryGetValue like this:</p>

<pre><code>string xmlfile;
if (!Data_Array.TryGetValue(""XML_File"", out xmlfile)) {
   // the key isn't in the dictionary.
   return; // or whatever you want to do
}
// xmlfile is now equal to the value
</code></pre>
","12169455"
"Read Post Data submitted to ASP.Net Form","198819","","<p>I have a working login form in an asp.net application.  Standard stuff with a username and password text box and a button to process the login.  Works fine.</p>

<p>I have a new requirement to allow the user to input the username and password from a separate plain html page that is not a part of my asp.net application.  I plan on achieving this using standard html - form, input, submit button etc.  The form action will be the URL of my asp.net login page and its method will be POST.  </p>

<p>What I want to do in the C# code behind page of the asp.net login form, presumably in the Page_Load event, is to check if the request for the page contains a username and password value being passed in.  If it does then I need to read those values and process the login as if someone had clicked the login button on the asp.net page.  If not then I will display the login form as usual.  </p>

<p>How do I check for the existence of, and read, the username and password values in the request for my page. </p>
","<p>Read the Request.Form NameValueCollection and process your logic accordingly:</p>

<pre><code>NameValueCollection nvc = Request.Form;
string userName, password;
if (!string.IsNullOrEmpty(nvc[""txtUserName""]))
{
  userName = nvc[""txtUserName""];
}

if (!string.IsNullOrEmpty(nvc[""txtPassword""]))
{
  password = nvc[""txtPassword""];
}

//Process login
CheckLogin(userName, password);
</code></pre>

<p>... where ""txtUserName"" and ""txtPassword"" are the <strong>Names</strong> of the controls on the posting page. </p>
","564314"
"EditorFor() and html properties","198596","","<p>Asp.Net MVC 2.0 preview builds provide helpers like </p>

<pre><code>Html.EditorFor(c =&gt; c.propertyname)
</code></pre>

<p>If the property name is string, the above code renders a texbox.</p>

<p>What if I want to pass in MaxLength and Size properties to the text box or my own css class property?</p>

<p>Do I need to create one template for each size and length combinations in my application? If so, that doesn't make the default templates that usable.</p>
","<p>I wrote a blog entry to answer my own question</p>

<p><a href=""http://aspadvice.com/blogs/kiran/archive/2009/11/29/Adding-html-attributes-support-for-Templates-_2D00_-ASP.Net-MVC-2.0-Beta_2D00_1.aspx"" rel=""nofollow"">Adding html attributes support for Templates - ASP.Net MVC 2.0 Beta</a></p>
","4530282"
"How do I truncate a .NET string?","198417","","<p>I would like to truncate a string such that its length is not longer than a given value.  I am writing to a database table and want to ensure that the values I write meet the constraint of the column's datatype.</p>

<p>For instance, it would be nice if I could write the following:</p>

<pre><code>string NormalizeLength(string value, int maxLength)
{
    return value.Substring(0, maxLength);
}
</code></pre>

<p>Unfortunately, this raises an exception because <code>maxLength</code> generally exceeds the boundaries of the string <code>value</code>.  Of course, I could write a function like the following, but I was hoping that something like this already exists.</p>

<pre><code>string NormalizeLength(string value, int maxLength)
{
    return value.Length &lt;= maxLength ? value : value.Substring(0, maxLength);
} 
</code></pre>

<p>Where is the elusive API that performs this task?  Is there one?</p>
","<p><strong>There isn't a <code>Truncate()</code> method on string, unfortunately.</strong> You have to write this kind of logic yourself. What you can do, however, is wrap this in an extension method so you don't have to duplicate it everywhere:</p>

<pre><code>public static class StringExt
{
    public static string Truncate(this string value, int maxLength)
    {
        if (string.IsNullOrEmpty(value)) return value;
        return value.Length &lt;= maxLength ? value : value.Substring(0, maxLength); 
    }
}
</code></pre>

<p>Now we can write:</p>

<pre><code>var someString = ""..."";
someString = someString.Truncate(2);
</code></pre>
","2776689"
"C# How can I check if a URL exists/is valid?","198369","","<p>I am making a simple program in visual c# 2005 that looks up a stock symbol on Yahoo! Finance, downloads the historical data, and then plots the price history for the specified ticker symbol.</p>

<p>I know the exact URL that I need to acquire the data, and if the user inputs an existing ticker symbol (or at least one with data on Yahoo! Finance) it works perfectly fine. However, I have a run-time error if the user makes up a ticker symbol, as the program tries to pull data from a non-existent web page.</p>

<p>I am using the WebClient class, and using the DownloadString function. I looked through all the other member functions of the WebClient class, but didn't see anything I could use to test a URL.</p>

<p>How can I do this?</p>
","<p>You could issue a <a href=""http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4"" rel=""noreferrer"">""HEAD""</a> request rather than a ""GET""?</p>

<p>(edit) - lol! Looks like I've <a href=""https://stackoverflow.com/questions/153451#156750"">done this before</a>!; changed to wiki to avoid accusations of rep-garnering. So to test a URL without the cost of downloading the content:</p>

<pre><code>// using MyClient from linked post
using(var client = new MyClient()) {
    client.HeadOnly = true;
    // fine, no content downloaded
    string s1 = client.DownloadString(""http://google.com"");
    // throws 404
    string s2 = client.DownloadString(""http://google.com/silly"");
}
</code></pre>

<p>You would <code>try</code>/<code>catch</code> around the <code>DownloadString</code> to check for errors; no error? It exists...</p>

<hr>

<p>With C# 2.0 (VS2005):</p>

<pre><code>private bool headOnly;
public bool HeadOnly {
    get {return headOnly;}
    set {headOnly = value;}
}
</code></pre>

<p>and</p>

<pre><code>using(WebClient client = new MyClient())
{
    // code as before
}
</code></pre>
","924682"
"Getting ""type or namespace name could not be found"" but everything seems ok?","198265","","<p>I'm getting a:</p>

<blockquote>
  <p>type or namespace name could not be found</p>
</blockquote>

<p>error for a C# WPF app in VS2010. This area of code was compiling fine, but suddenly I'm getting this error. I've tried removing the Project Reference and the <code>using</code> statement, shutting VS2010 and restarting, but still I have this issue.</p>

<p>Any ideas why this might be occurring, where it seems like I'm doing the write thing re Reference &amp; <code>using</code> statement?</p>

<p>I also noted in VS2010 that intellisense for that namespace is working ok, so it seems like VS2010 has the project reference and seeing the namespace on one hand, but during compile doesn't see it?</p>
","<p>This can be the result of a .Net framework version incompatibility between two projects. </p>

<p>It can happen in two ways: </p>

<ol>
<li>a client profile project referencing a full framework project; or </li>
<li>an older framework version targeting a newer framework version</li>
</ol>

<p>For example it will happen when an application is set to target the .Net 4 Client Profile framework, and the project it references targets the full .Net 4 framework.</p>

<p>So to make that clearer:</p>

<ul>
<li>Project A targets the Client Profile framework</li>
<li>Project A references Project B</li>
<li>Project B targets the full framework</li>
</ul>

<p>The solution in this case is to either upgrade the framework target of the application (Project A), or downgrade the target of referenced assembly (Project B). It is okay for a full framework app to reference/consume a client profile framework assembly, but not the other way round (client profile cannot reference full framework targeted assembly).</p>

<p>Note that you can also get this error when you create a new project in VS2012 or VS2013 (which uses .Net 4.5 as the default framework) and:  </p>

<ul>
<li><p>the referencing project(s) use .Net 4.0 (this is common when you have migrated from VS2010 to VS2012 or VS2013 and you then add a new project)  </p></li>
<li><p>the referenced projects use a greater version i.e. 4.5.1 or 4.5.3 (you've re-targeted your existing projects to the latest version, but VS still creates new projects targeting v4.5, and you then reference those older projects from the new project)</p></li>
</ul>
","3304899"
"How can I calculate divide and modulo for integers?","197973","","<p>How can I calculate division and modulo for integer numbers in C#?</p>
","<p>Before asking questions of this kind, please check <a href=""http://msdn.microsoft.com/en-us/library/3b1ff23f%28v=VS.100%29.aspx"" rel=""noreferrer"">MSDN documentation</a>.</p>

<blockquote>
  <p>When you divide two integers, the result is always an integer. For example, the result of 5 / 2 is 2. To determine the remainder of 5 / 2, use the modulo operator (%).</p>
</blockquote>

<pre><code>int a = 5;
int b = 3;

int div = a / b; //div is 1
int mod = a % b; //mod is 2
</code></pre>
","5383059"
"jQuery returning ""parsererror"" for ajax request","197803","","<p>Been getting a ""parsererror"" from jquery for an Ajax request, I have tried changing the POST to a GET, returning the data in a few different ways (creating classes, etc.) but I cant seem to figure out what the problem is.</p>

<p>My project is in MVC3 and I'm using jQuery 1.5
I have a Dropdown and on the onchange event I fire off a call to get some data based on what was selected.</p>

<p>Dropdown: (this loads the ""Views"" from the list in the Viewbag and firing the event works fine)</p>

<pre><code>@{
    var viewHtmls = new Dictionary&lt;string, object&gt;();
    viewHtmls.Add(""data-bind"", ""value: ViewID"");
    viewHtmls.Add(""onchange"", ""javascript:PageModel.LoadViewContentNames()"");
}
@Html.DropDownList(""view"", (List&lt;SelectListItem&gt;)ViewBag.Views, viewHtmls)
</code></pre>

<p>Javascript:</p>

<pre><code>this.LoadViewContentNames = function () {
    $.ajax({
        url: '/Admin/Ajax/GetViewContentNames',
        type: 'POST',
        dataType: 'json',
        data: { viewID: $(""#view"").val() },
        success: function (data) {
            alert(data);
        },
        error: function (data) {
            debugger;
            alert(""Error"");
        }
    });
};
</code></pre>

<p>The above code successfully calls the MVC method and returns:</p>

<pre><code>[{""ViewContentID"":1,""Name"":""TopContent"",""Note"":""Content on the top""},
 {""ViewContentID"":2,""Name"":""BottomContent"",""Note"":""Content on the bottom""}]
</code></pre>

<p>But jquery fires the error event for the $.ajax() method saying ""parsererror"".</p>
","<p>I recently encountered this problem and stumbled upon this question.</p>

<p>I resolved it with a much easier way.</p>

<p><strong>Method One</strong></p>

<p>You can either remove the <code>dataType: 'json'</code> property from the object literal...</p>

<p><strong>Method Two</strong></p>

<p>Or you can do what @Sagiv was saying by returning your data as <code>Json</code>.</p>

<p>The reason why this <code>parserror</code> message occurs is that when you simply return a string or another value, it is not really <code>Json</code>, so the parser fails when parsing it.</p>

<p>So if you remove the <code>dataType: json</code> property, it will not try to parse it as <code>Json</code>. </p>

<p>With the other method if you make sure to return your data as <code>Json</code>, the parser will know how to handle it properly.</p>
","11507572"
"LINQ Using Max() to select a single row","197747","","<p>I'm using LINQ on an IQueryable returned from NHibernate and I need to select the row with the maximum value(s) in a couple of fields. </p>

<p>I've simplified the bit that I'm sticking on. I need to select the one row from my table with the maximum value in one field.</p>

<pre class=""lang-cs prettyprint-override""><code>var table = new Table { new Row(id: 1, status: 10), new Row(id: 2, status: 20) }

from u in table
group u by 1 into g
where u.Status == g.Max(u =&gt; u.Status)
select u
</code></pre>

<p>This is incorrect but I can't work out the right form.</p>

<p>BTW, what I'm actually trying to achieve is approximately this:</p>

<pre class=""lang-cs prettyprint-override""><code>var clientAddress = this.repository.GetAll()
    .GroupBy(a =&gt; a)
    .SelectMany(
            g =&gt;
            g.Where(
                a =&gt;
                a.Reference == clientReference &amp;&amp; 
                a.Status == ClientStatus.Live &amp;&amp; 
                a.AddressReference == g.Max(x =&gt; x.AddressReference) &amp;&amp; 
                a.StartDate == g.Max(x =&gt; x.StartDate)))
    .SingleOrDefault();
</code></pre>

<p>I started with the above lambda but I've been using LINQPad to try and work out the syntax for selecting the Max().</p>

<p><strong>UPDATE</strong></p>

<p>Removing the GroupBy was key.</p>

<pre class=""lang-cs prettyprint-override""><code>var all = this.repository.GetAll();

var address = all
            .Where(
                a =&gt;
                a.Reference == clientReference &amp;&amp; 
                a.Status == ClientStatus.Live &amp;&amp; 
                a.StartDate == all.Max(x =&gt; x.StartDate) &amp;&amp;
                a.AddressReference == all.Max(x =&gt; x.AddressReference))
            .SingleOrDefault();
</code></pre>
","<p>I don't see why you are grouping here.</p>

<p>Try this:</p>

<pre><code>var maxValue = table.Max(x =&gt; x.Status)
var result = table.First(x =&gt; x.Status == maxValue);
</code></pre>

<p>An alternate approach that would iterate <code>table</code> only once would be this:</p>

<pre><code>var result = table.OrderByDescending(x =&gt; x.Status).First();
</code></pre>

<p>This is helpful if <code>table</code> is an <code>IEnumerable&lt;T&gt;</code> that is not present in memory or that is calculated on the fly.</p>
","9115016"
"Run an exe from C# code","197504","","<p>I have an exe file reference in my C# project.  How do I invoke that exe from my code?</p>
","<pre><code>using System.Diagnostics;

class Program
{
    static void Main()
    {
        Process.Start(""C:\\"");
    }
}
</code></pre>

<p>If your application needs cmd arguments, use something like this:</p>

<pre><code>using System.Diagnostics;

class Program
{
    static void Main()
    {
        LaunchCommandLineApp();
    }

    /// &lt;summary&gt;
    /// Launch the legacy application with some options set.
    /// &lt;/summary&gt;
    static void LaunchCommandLineApp()
    {
        // For the example
        const string ex1 = ""C:\\"";
        const string ex2 = ""C:\\Dir"";

        // Use ProcessStartInfo class
        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.CreateNoWindow = false;
        startInfo.UseShellExecute = false;
        startInfo.FileName = ""dcm2jpg.exe"";
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.Arguments = ""-f j -o \"""" + ex1 + ""\"" -z 1.0 -s y "" + ex2;

        try
        {
            // Start the process with the info we specified.
            // Call WaitForExit and then the using statement will close.
            using (Process exeProcess = Process.Start(startInfo))
            {
                exeProcess.WaitForExit();
            }
        }
        catch
        {
             // Log error.
        }
    }
}
</code></pre>
","9679614"
"Listen for key press in .NET console app","196739","","<p>How can I continue to run my console application until a key press (like <kbd>Esc</kbd> is pressed?)</p>

<p>I'm assuming its wrapped around a while loop. I don't like <code>ReadKey</code> as it blocks operation and asks for a key, rather than just continue and listen for the key press. </p>

<p>How can this be done?</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.console.keyavailable%28v=VS.100%29.aspx"" rel=""noreferrer""><code>Console.KeyAvailable</code></a> so that you only call <code>ReadKey</code> when you know it won't block:</p>

<pre><code>Console.WriteLine(""Press ESC to stop"");
do {
    while (! Console.KeyAvailable) {
        // Do something
   }       
} while (Console.ReadKey(true).Key != ConsoleKey.Escape);
</code></pre>
","5891612"
"Get HTML code from website in C#","196711","","<p>How to get the HTML code from a website, save it, and find some text by a LINQ expression?</p>

<p>I'm using the following code to get the source of a web page:</p>

<pre><code>public static String code(string Url)
{
    HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(Url);
    myRequest.Method = ""GET"";
    WebResponse myResponse = myRequest.GetResponse();
    StreamReader sr = new StreamReader(myResponse.GetResponseStream(), System.Text.Encoding.UTF8);
    string result = sr.ReadToEnd();
    sr.Close();
    myResponse.Close();

    return result;
 }
</code></pre>

<p>How do I find the text in a div in the source of the web page?</p>
","<p>Getting HTML code from a website. You can use code like this.</p>

<pre><code>string urlAddress = ""http://google.com"";

HttpWebRequest request = (HttpWebRequest)WebRequest.Create(urlAddress);
HttpWebResponse response = (HttpWebResponse)request.GetResponse();

if (response.StatusCode == HttpStatusCode.OK)
{
  Stream receiveStream = response.GetResponseStream();
  StreamReader readStream = null;

  if (response.CharacterSet == null)
  {
     readStream = new StreamReader(receiveStream);
  }
  else
  {
     readStream = new StreamReader(receiveStream, Encoding.GetEncoding(response.CharacterSet));
  }

  string data = readStream.ReadToEnd();

  response.Close();
  readStream.Close();
}
</code></pre>

<p>This will give you the returned <strong>HTML</strong> code from the website. But find text via <strong>LINQ</strong> is not that easy.
Perhaps it is better to use regular expression but that does not play well with <strong>HTML</strong> code</p>
","16642279"
"Why use String.Format?","196625","","<p>Why would anyone use <code>String.Format</code> in C# and VB .NET as opposed to the concatenation operators (<code>&amp;</code> in VB, and <code>+</code> in C#)?</p>

<p>What is the main difference? Why are everyone so interested in using <code>String.Format</code>? I am very curious.</p>
","<p>I can see a number of reasons:</p>

<p><strong>Readability</strong></p>

<pre><code>string s = string.Format(""Hey, {0} it is the {1}st day of {2}.  I feel {3}!"", _name, _day, _month, _feeling);
</code></pre>

<p>vs:</p>

<pre><code>string s = ""Hey,"" + _name + "" it is the "" + _day + ""st day of "" + _month + "".  I feel "" + feeling + ""!"";
</code></pre>

<p><strong>Format Specifiers</strong>
(and this includes the fact you can write custom formatters)</p>

<pre><code>string s = string.Format(""Invoice number: {0:0000}"", _invoiceNum);
</code></pre>

<p>vs:</p>

<pre><code>string s = ""Invoice Number = "" + (""0000"" + _invoiceNum).Substr(..... /*can't even be bothered to type it*/)
</code></pre>

<p><strong>String Template Persistence</strong></p>

<p>What if I want to store string templates in the database?  With string formatting:</p>

<pre><code>_id         _translation
  1         Welcome {0} to {1}.  Today is {2}.
  2         You have {0} products in your basket.
  3         Thank-you for your order.  Your {0} will arrive in {1} working days.
</code></pre>

<p>vs:</p>

<pre><code>_id         _translation
  1         Welcome
  2         to
  3         .  Today is
  4         . 
  5         You have
  6         products in your basket.
  7         Someone
  8         just shoot
  9         the developer.
</code></pre>
","4671668"
"C# int to byte[]","196553","","<p>I need to convert an <code>int</code> to a <code>byte[]</code> one way of doing it is to use <code>BitConverter.GetBytes()</code>. But im unsure if that matches the following specification: </p>

<blockquote>
  <p>An XDR signed integer is a 32-bit datum that encodes an integer in
     the range [-2147483648,2147483647].  The integer is represented in
     two's complement notation.  The most and least significant bytes are
     0 and 3, respectively.  Integers are declared as follows:</p>
</blockquote>

<p>Source: <code>RFC1014 3.2</code></p>

<p>How could i do a int to byte transformation that would satisfy the above specification?</p>
","<p>The RFC is just trying to say that a signed integer is a normal 4-byte integer with bytes ordered in a big-endian way.</p>

<p>Now, you are most probably working on a little-endian machine and <code>BitConverter.GetBytes()</code> will give you the <code>byte[]</code> reversed. So you could try:</p>

<pre><code>int intValue;
byte[] intBytes = BitConverter.GetBytes(intValue);
Array.Reverse(intBytes);
byte[] result = intBytes;
</code></pre>

<p>For the code to be most portable, however, you can do it like this:</p>

<pre><code>int intValue;
byte[] intBytes = BitConverter.GetBytes(intValue);
if (BitConverter.IsLittleEndian)
    Array.Reverse(intBytes);
byte[] result = intBytes;
</code></pre>
","1318948"
"How can I easily convert DataReader to List<T>?","196404","","<p>I have data in a <code>DataReader</code> which I want to be converted to a <code>List&lt;T&gt;</code>.
What is a possible simple solution for this?</p>

<p>For e.g. in CustomerEntity class, I have CustomerId and CustomerName properties.If my DataReader returns these two columns as data, then how can I convert it into <code>List&lt;CustomerEntity&gt;</code>.</p>
","<p>I have seen systems that use Reflection and attributes on Properties or fields to maps DataReaders to objects.  (A bit like what LinqToSql does.)  They save a bit of typing and may reduce the number of errors when coding for DBNull etc.  Once you cache the generated code they can be faster then most hand written code as well, so do <em>consider</em> the “high road” if you are doing this a lot.</p>

<p>See <a href=""http://www.simple-talk.com/dotnet/.net-framework/a-defense-of-reflection-in-.net/"" rel=""noreferrer"">""A Defense of Reflection in .NET""</a> for one example of this. </p>

<p>You can then write code like</p>

<pre><code>class CustomerDTO  
{
    [Field(""id"")]
    public int? CustomerId;

    [Field(""name"")]
    public string CustomerName;
}
</code></pre>

<p>...</p>

<pre><code>using (DataReader reader = ...)
{    
   List&lt;CustomerDTO&gt; customers = reader.AutoMap&lt;CustomerDTO&gt;()
                                    .ToList();
}
</code></pre>

<p>(AutoMap(), is an extension method)</p>

<hr>

<p>@Stilgar, thanks for a <strong>great</strong> comment</p>

<p>If are <strong>able to</strong> you are likely to be better of using  <a href=""https://stackoverflow.com/questions/1377236/nhibernate-entity-framework-active-records-or-linq2sql/"">NHibernate, EF or Linq to Sql, etc</a>  However on old project (or for other (sometimes valid) reasons, e.g. “not invented here”, “love of stored procs” etc)  It is not always possible to use a ORM, so a lighter weight system can be useful to have “up your sleeves”</p>

<p>If you every needed too write lots of IDataReader loops, you will see the benefit of reducing the coding (and errors) <strong>without having to change the architecture</strong> of the system you are working on.  That is not to say it’s a good architecture to start with..</p>

<p>I am assuming that CustomerDTO will not get out of the data access layer and composite objects etc will be built up by the data access layer using the DTO objects.</p>
","1465183"
"What reference do I need to use Microsoft.Office.Interop.Excel in .NET?","196055","","<p>I am interested in using C# to manipulate/Automate Excel files.</p>

<p>After browsing the web I have found <a href=""http://msdn.microsoft.com/en-us/office/hh133430"" rel=""noreferrer"">VSTO</a> but it seems you can not use that in Visual Studio Express Edition so I can not use that.</p>

<p>Just few minutes ago I noticed a question in this site that used this namespace in its code:</p>

<p><strong>Microsoft.Office.Interop.Excel</strong></p>

<p>So I am wondering if all I need to use that is add necessary reference and if so which reference to add? </p>

<p><strong>UPDATE</strong></p>

<p>I installed ""Primary Interop Assemblies"" as the accepted answer suggested but for some reason they are still missing in the Add Reference dialog under "".NET"" but they are present in GAC. </p>

<p>So I just added the reference using ""Browse"" and located <code>Microsoft.Office.Interop.Excel.dll</code> in GAC folder.</p>

<p>But looking for similar questions on this site regarding adding reference from GAC it seems this is not recommended.</p>
","<h1>Update (thanks user2347528)</h1>

<p>These assemblies are available as NuGet packages, which is much easier than my original answer.</p>

<p>You can install by either right clicking on <strong>References</strong> in your project and selecting <strong>Manage NuGet packages...</strong> and searching for one of the packages listed below, or install using the Package Manager Console:</p>

<pre><code>PM&gt; Install-Package Microsoft.Office.Interop.Excel
</code></pre>

<ul>
<li><a href=""https://www.nuget.org/packages/Microsoft.Office.Interop.Excel"">Microsoft.Office.Interop.Excel</a></li>
<li><a href=""https://www.nuget.org/packages/Microsoft.Office.Interop.Word"">Microsoft.Office.Interop.Word</a></li>
<li><a href=""https://www.nuget.org/packages/Microsoft.Office.Interop.Outlook"">Microsoft.Office.Interop.Outlook</a></li>
<li><a href=""https://www.nuget.org/packages/Microsoft.Office.Interop.PowerPoint"">Microsoft.Office.Interop.PowerPoint</a></li>
<li><a href=""https://www.nuget.org/packages/Microsoft.Office.Interop.Graph"">Microsoft.Office.Interop.Graph</a></li>
</ul>

<hr>

<p>These are available as ""Primary Interop Assemblies"", which can be installed with Office, or downloaded and installed separately. <a href=""http://msdn.microsoft.com/en-us/library/kh3965hw%28v=vs.100%29.aspx"">How to: Install Office Primary Interop Assemblies</a>. </p>

<p>Once those are installed, you can reference them in your project in the Add Reference dialog, under .NET. If you do not see those Microsoft.Office.Interop assemblies listed, then they have not been installed yet. Install them from your setup, or download and install them separately (see my link above for the downloads).</p>
","10478021"
"XmlSerializer - There was an error reflecting type","196034","","<p>Using C# .NET 2.0, I have a composite data class that does have the <code>[Serializable]</code> attribute on it.  I am creating an <code>XMLSerializer</code> class and passing that into the constructor:</p>

<pre><code>XmlSerializer serializer = new XmlSerializer(typeof(DataClass));
</code></pre>

<p>I am getting an exception saying: </p>

<blockquote>
  <p>There was an error reflecting type.</p>
</blockquote>

<p>Inside the data class there is another composite object.  Does this also need to have the <code>[Serializable]</code> attribute, or by having it on the top object, does it recursively apply it to all objects inside?</p>
","<p>Look at the inner exception that you are getting.  It will tell you which field/property it is having trouble serializing.  </p>

<p>You can exclude fields/properties from xml serialization by decorating them with the <code>[XmlIgnore]</code> attribute.  </p>

<p>I don't think that <code>XmlSerializer</code> uses the <code>[Serializable]</code> attribute, so I doubt that is the problem.</p>
","60581"
"Calculate MD5 checksum for a file","195920","","<p>I'm using <a href=""https://en.wikipedia.org/wiki/IText"" rel=""noreferrer"">iTextSharp</a> to read the text from a PDF file. However, there are times I cannot extract text, because the PDF file is only containing images. I download the same PDF files everyday, and I want to see if the PDF has been modified. If the text and modification date cannot be obtained, is a <a href=""http://en.wikipedia.org/wiki/MD5"" rel=""noreferrer"">MD5</a> checksum the most reliable way to tell if the file has changed? </p>

<p>If it is, some code samples would be appreciated, because I don't have much experience with cryptography.</p>
","<p>It's very simple using <a href=""https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5(v=vs.110).aspx"" rel=""noreferrer"">System.Security.Cryptography.MD5</a>:</p>

<pre><code>using (var md5 = MD5.Create())
{
    using (var stream = File.OpenRead(filename))
    {
        return md5.ComputeHash(stream);
    }
}
</code></pre>

<p>(I believe that <em>actually</em> the MD5 implementation used doesn't need to be disposed, but I'd probably still do so anyway.)</p>

<p>How you compare the results afterwards is up to you; you can convert the byte array to base64 for example, or compare the bytes directly. (Just be aware that arrays don't override <code>Equals</code>. Using base64 is simpler to get right, but slightly less efficient if you're really only interested in comparing the hashes.)</p>

<p>If you need to represent the hash as a string, you could convert it to hex using <code>BitConverter</code>:</p>

<pre><code>static string CalculateMD5(string filename)
{
    using (var md5 = MD5.Create())
    {
        using (var stream = File.OpenRead(filename))
        {
            var hash = md5.ComputeHash(stream);
            return BitConverter.ToString(hash).Replace(""-"", """").ToLowerInvariant();
        }
    }
}
</code></pre>
","10520086"
"How do I get column names to print in this C# program?","195580","","<p>I've cobbled together a C# program that takes a <code>.csv</code> file and writes it to a <code>DataTable</code>.  Using this program, I can loop through each row of the <code>DataTable</code> and print out the information contained in the row.  The console output looks like this:</p>

<pre><code>--- Row ---
Item: 1
Item: 545
Item: 507
Item: 484
Item: 501
</code></pre>

<p>I'd like to print the column name beside each value, as well, so that it looks like this:</p>

<pre><code>--- Row ---
Item: 1   Hour
Item: 545 Day1 KW
Item: 507 Day2 KW
Item: 484 Day3 KW
Item: 501 Day4 KW
</code></pre>

<p>Can someone look at my code and tell me what I can add so that the column names will print?  I am very new to C#, so please forgive me if I've overlooked something.  </p>

<p>Here is my code:</p>

<pre><code>// Write load_forecast data to datatable.
DataTable loadDT = new DataTable();
StreamReader sr = new StreamReader(@""c:\load_forecast.csv"");                      

string[] headers = sr.ReadLine().Split(',');
foreach (string header in headers)
{
    loadDT.Columns.Add(header); // I've added the column headers here.
}

while (sr.Peek() &gt; 0)
{
    DataRow loadDR = loadDT.NewRow();
    loadDR.ItemArray = sr.ReadLine().Split(',');
    loadDT.Rows.Add(loadDR);
}

foreach (DataRow row in loadDT.Rows)
{
    Console.WriteLine(""--- Row ---"");
    foreach (var item in row.ItemArray)
    {
        Console.Write(""Item:"");
        Console.WriteLine(item); // Can I add something here to also print the column names?
    }
}
</code></pre>
","<p>You need to loop over <code>loadDT.Columns</code>, like this:</p>

<pre><code>foreach (DataColumn column in loadDT.Columns)
{
    Console.Write(""Item: "");
    Console.Write(column.ColumnName);
    Console.Write("" "");
    Console.WriteLine(row[column]);
}
</code></pre>
","2557943"
"The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required?","195529","","<p>I want to send an email from my application and i have written following code for sending mail</p>

<pre><code>    MailMessage msg = new MailMessage();

    msg.From = new MailAddress(""mymailid"");
    msg.To.Add(""receipientid"");
    msg.Subject = ""test"";
    msg.Body = ""Test Content"";
    msg.Priority = MailPriority.High;

    SmtpClient client = new SmtpClient();

    client.Credentials = new NetworkCredential(""mymailid"", ""mypassword"", ""smtp.gmail.com"");
    client.Host = ""smtp.gmail.com"";
    client.Port = 587;
    client.DeliveryMethod = SmtpDeliveryMethod.Network;
    client.EnableSsl = true;
    client.UseDefaultCredentials = true;

    client.Send(msg);
</code></pre>

<p>I am running it on localhost so what mistake i am doing to send it.</p>

<p>When i send button it gives an error like</p>

<blockquote>
  <p><em>The SMTP server requires a secure connection or the client was not
  authenticated. The server response was: 5.5.1 Authentication
  Required.</em></p>
</blockquote>

<p>Code in Web.config file</p>

<pre><code> &lt;appSettings&gt;
    &lt;add key=""webpages:Version"" value=""2.0.0.0"" /&gt;
    &lt;add key=""webpages:Enabled"" value=""false"" /&gt;
    &lt;add key=""PreserveLoginUrl"" value=""true"" /&gt;
    &lt;add key=""ClientValidationEnabled"" value=""true"" /&gt;
    &lt;add key=""UnobtrusiveJavaScriptEnabled"" value=""true"" /&gt;   
    &lt;add key=""smtpServer"" value=""smtp.gmail.com"" /&gt;
    &lt;add key=""EnableSsl"" value = ""true""/&gt;
    &lt;add key=""smtpPort"" value=""587"" /&gt;
    &lt;add key=""smtpUser"" value=""sender@gmail.com"" /&gt;
    &lt;add key=""smtpPass"" value=""mypassword"" /&gt;
    &lt;add key=""adminEmail"" value=""sender@gmail.com"" /&gt;
  &lt;/appSettings&gt;
  &lt;system.net&gt;
    &lt;mailSettings&gt;
      &lt;smtp from=""sender@gmail.com""&gt;
        &lt;network host=""smtp.gmail.com"" password=""mypassword"" port=""587"" userName=""sender@gmail.com""  enableSsl=""true""/&gt;
      &lt;/smtp&gt;
    &lt;/mailSettings&gt;
  &lt;/system.net&gt;
</code></pre>

<p>what should i do to solve this error and send mail??</p>
","<p>First check for gmail's security related issues. You may have enabled double authentication in gmail. Also check your gmail inbox if you are getting any security alerts. In such cases check other answer of @mjb as below</p>

<p>Below is the very general thing that i always check first for such issues</p>

<pre><code>client.UseDefaultCredentials = true;
</code></pre>

<p>set it to false.</p>

<p>Note @Joe King's <a href=""https://stackoverflow.com/a/27896975/52277"">answer</a> - you must set client.UseDefaultCredentials <strong>before</strong> you set client.Credentials</p>
","18503540"
"How do I automatically scroll to the bottom of a multiline text box?","195499","","<p>I have a textbox with the .Multiline property set to true.  At regular intervals, I am adding new lines of text to it.  I would like the textbox to automatically scroll to the bottom-most entry (the newest one) whenever a new line is added.  How do I accomplish this?</p>
","<blockquote>
  <p>At regular intervals, I am adding new lines of text to it. I would like the textbox to automatically scroll to the bottom-most entry (the newest one) whenever a new line is added.</p>
</blockquote>

<p>If you use <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.appendtext.aspx"" rel=""noreferrer""><code>TextBox.AppendText(string text)</code></a>, it will automatically scroll to the end of the newly appended text. It avoids the flickering scrollbar if you're calling it in a loop.</p>

<p>It also happens to be an order of magnitude faster than concatenating onto the <code>.Text</code> property. Though that might depend on how often you're calling it; I was testing with a tight loop.</p>

<hr>

<p>This will not scroll if it is called before the textbox is shown, or if the textbox is otherwise not visible (e.g. in a different tab of a TabPanel). See <a href=""https://stackoverflow.com/questions/18260702/textbox-appendtext-not-autoscrolling"">TextBox.AppendText() not autoscrolling</a>. This may or may not be important, depending on if you require autoscroll when the user can't see the textbox.</p>

<p>It seems that the alternative method from the other answers also don't work in this case. One way around it is to perform additional scrolling on the <code>VisibleChanged</code> event:</p>

<pre><code>textBox.VisibleChanged += (sender, e) =&gt;
{
    if (textBox.Visible)
    {
        textBox.SelectionStart = textBox.TextLength;
        textBox.ScrollToCaret();
    }
};
</code></pre>

<hr>

<p>Internally, <code>AppendText</code> does something like this:</p>

<pre><code>textBox.Select(textBox.TextLength + 1, 0);
textBox.SelectedText = textToAppend;
</code></pre>

<p>But there should be no reason to do it manually.</p>

<p><sup>(If you decompile it yourself, you'll see that it uses some possibly more efficient internal methods, and has what seems to be a minor special case.)</sup></p>
","14886915"
"C# Lambda expressions: Why should I use them?","195429","","<p>I have quickly read over the <a href=""http://msdn.microsoft.com/en-us/library/bb397687.aspx"" rel=""noreferrer"">Microsoft Lambda Expression</a> documentation.</p>

<p>This kind of example has helped me to understand better, though: </p>

<pre><code>delegate int del(int i);
del myDelegate = x =&gt; x * x;
int j = myDelegate(5); //j = 25
</code></pre>

<p>Still, I don't understand why it's such an innovation. It's just a method that dies when the ""method variable"" ends, right? Why should I use this instead of a real method?</p>
","<p><a href=""http://weblogs.asp.net/scottgu/archive/2007/04/08/new-orcas-language-feature-lambda-expressions.aspx"" rel=""noreferrer"">Lambda expressions</a> are a simpler syntax for anonymous delegates and can be used everywhere an anonymous delegate can be used.  However, the opposite is not true; lambda expressions can be converted to expression trees which allows for a lot of the magic like LINQ to SQL.  </p>

<p>The following is an example of a <a href=""http://msdn.microsoft.com/en-us/library/bb397919.aspx"" rel=""noreferrer"">LINQ to Objects</a> expression using anonymous delegates then lambda expressions to show how much easier on the eye they are:</p>

<pre><code>// anonymous delegate
var evens = Enumerable
                .Range(1, 100)
                .Where(delegate(int x) { return (x % 2) == 0; })
                .ToList();

// lambda expression
var evens = Enumerable
                .Range(1, 100)
                .Where(x =&gt; (x % 2) == 0)
                .ToList();
</code></pre>

<p>Lambda expressions and anonymous delegates have an advantage over writing a separate function: they implement <a href=""http://en.wikipedia.org/wiki/Closure_(computer_science)"" rel=""noreferrer"">closures</a> which can allow you to <a href=""http://www.srtsolutions.com/Looking-Inside-C-Closures"" rel=""noreferrer"">pass local state to the function without adding parameters</a> to the function or creating one-time-use objects.</p>

<p><a href=""http://www.interact-sw.co.uk/iangblog/2005/09/30/expressiontrees"" rel=""noreferrer"">Expression trees</a> are a very powerful new feature of C# 3.0 that allow an API to look at the structure of an expression instead of just getting a reference to a method that can be executed.  An API just has to make a delegate parameter into an <code>Expression&lt;T&gt;</code> parameter and the compiler will generate an expression tree from a lambda instead of an anonymous delegate:</p>

<pre><code>void Example(Predicate&lt;int&gt; aDelegate);
</code></pre>

<p>called like:</p>

<pre><code>Example(x =&gt; x &gt; 5);
</code></pre>

<p>becomes:</p>

<pre><code>void Example(Expression&lt;Predicate&lt;int&gt;&gt; expressionTree);
</code></pre>

<p>The latter will get passed a representation of the <a href=""http://en.wikipedia.org/wiki/Abstract_syntax_tree"" rel=""noreferrer"">abstract syntax tree</a> that describes the expression <code>x &gt; 5</code>.  LINQ to SQL relies on this behavior to be able to turn C# expressions in to the SQL expressions desired for filtering / ordering / etc. on the server side.</p>
","167392"
"Best way to combine two or more byte arrays in C#","195099","","<p>I have 3 byte arrays in C# that I need to combine into one. What would be the most efficient method to complete this task?</p>
","<p>For primitive types (including bytes), use <code>System.Buffer.BlockCopy</code> instead of <code>System.Array.Copy</code>. It's faster.</p>

<p>I timed each of the suggested methods in a loop executed 1 million times using 3 arrays of 10 bytes each. Here are the results:</p>

<ol>
<li>New Byte Array using <code>System.Array.Copy</code>        - 0.2187556 seconds</li>
<li>New Byte Array using <code>System.Buffer.BlockCopy</code>  - 0.1406286 seconds</li>
<li>IEnumerable&lt;byte> using C# yield operator    - 0.0781270 seconds</li>
<li>IEnumerable&lt;byte> using LINQ's Concat&lt;>      - 0.0781270 seconds</li>
</ol>

<p>I increased the size of each array to 100 elements and re-ran the test:</p>

<ol>
<li>New Byte Array using <code>System.Array.Copy</code>        - 0.2812554 seconds</li>
<li>New Byte Array using <code>System.Buffer.BlockCopy</code>  - 0.2500048 seconds</li>
<li>IEnumerable&lt;byte> using C# yield operator    - 0.0625012 seconds</li>
<li>IEnumerable&lt;byte> using LINQ's Concat&lt;>      - 0.0781265 seconds</li>
</ol>

<p>I increased the size of each array to 1000 elements and re-ran the test:</p>

<ol>
<li>New Byte Array using <code>System.Array.Copy</code>        - 1.0781457 seconds</li>
<li>New Byte Array using <code>System.Buffer.BlockCopy</code>  - 1.0156445 seconds</li>
<li>IEnumerable&lt;byte> using C# yield operator    - 0.0625012 seconds</li>
<li>IEnumerable&lt;byte> using LINQ's Concat&lt;>      - 0.0781265 seconds</li>
</ol>

<p>Finally, I increased the size of each array to 1 million elements and re-ran the test, executing each loop <strong>only</strong> 4000 times:</p>

<ol>
<li>New Byte Array using <code>System.Array.Copy</code>        - 13.4533833 seconds</li>
<li>New Byte Array using <code>System.Buffer.BlockCopy</code>  - 13.1096267 seconds</li>
<li>IEnumerable&lt;byte> using C# yield operator    - 0 seconds</li>
<li>IEnumerable&lt;byte> using LINQ's Concat&lt;>      - 0 seconds</li>
</ol>

<p>So, if you need a new byte array, use</p>

<pre><code>byte[] rv = new byte[a1.Length + a2.Length + a3.Length];
System.Buffer.BlockCopy(a1, 0, rv, 0, a1.Length);
System.Buffer.BlockCopy(a2, 0, rv, a1.Length, a2.Length);
System.Buffer.BlockCopy(a3, 0, rv, a1.Length + a2.Length, a3.Length);
</code></pre>

<p>But, if you can use an <code>IEnumerable&lt;byte&gt;</code>, <strong><em>DEFINITELY</em></strong> prefer LINQ's Concat&lt;> method. It's only slightly slower than the C# yield operator, but is more concise and more elegant.</p>

<pre><code>IEnumerable&lt;byte&gt; rv = a1.Concat(a2).Concat(a3);
</code></pre>

<p>If you have an arbitrary number of arrays and are using .NET 3.5, you can make the <code>System.Buffer.BlockCopy</code> solution more generic like this:</p>

<pre><code>private byte[] Combine(params byte[][] arrays)
{
    byte[] rv = new byte[arrays.Sum(a =&gt; a.Length)];
    int offset = 0;
    foreach (byte[] array in arrays) {
        System.Buffer.BlockCopy(array, 0, rv, offset, array.Length);
        offset += array.Length;
    }
    return rv;
}
</code></pre>

<p>*Note: The above block requires you adding the following namespace at the the top for it to work.</p>

<pre><code>using System.Linq;
</code></pre>

<p>To Jon Skeet's point regarding iteration of the subsequent data structures (byte array vs. IEnumerable&lt;byte>), I re-ran the last timing test (1 million elements, 4000 iterations), adding a loop that iterates over the full array with each pass:</p>

<ol>
<li>New Byte Array using <code>System.Array.Copy</code>        -  78.20550510 seconds</li>
<li>New Byte Array using <code>System.Buffer.BlockCopy</code>  -  77.89261900 seconds</li>
<li>IEnumerable&lt;byte> using C# yield operator    - 551.7150161  seconds</li>
<li>IEnumerable&lt;byte> using LINQ's Concat&lt;>      - 448.1804799  seconds</li>
</ol>

<p>The point is, it is <strong><em>VERY</em></strong> important to understand the efficiency of both the creation <em>and the usage</em> of the resulting data structure. Simply focusing on the efficiency of the creation may overlook the inefficiency associated with the usage. Kudos, Jon.</p>
","415396"
"How do you add a timer to a C# console application","195025","","<p>Just this - How do you add a timer to a C# console application? It would be great if you could supply some example coding.</p>
","<p>That's very nice, however in order to simulate some time passing we need to run a command that takes some time and that's very clear in second example.</p>

<p>However, the style of using a for loop to do some functionality forever takes a lot of device resources and instead we can use the Garbage Collector to do some thing like that.</p>

<p>We can see this modification in the code from the same book CLR Via C# Third Ed.</p>

<pre><code>using System;
using System.Threading;

public static class Program {

   public static void Main() {
      // Create a Timer object that knows to call our TimerCallback
      // method once every 2000 milliseconds.
      Timer t = new Timer(TimerCallback, null, 0, 2000);
      // Wait for the user to hit &lt;Enter&gt;
      Console.ReadLine();
   }

   private static void TimerCallback(Object o) {
      // Display the date/time when this method got called.
      Console.WriteLine(""In TimerCallback: "" + DateTime.Now);
      // Force a garbage collection to occur for this demo.
      GC.Collect();
   }
}
</code></pre>
","7865126"
"ToList().ForEach in Linq","195004","","<p>I am new to Linq.</p>

<p>I want to set two values in foreach statement like this</p>

<p>My actual code is this</p>

<pre><code>foreach (Employee emp in employees)
{
    foreach(Department dept in emp.Departments)
    {
        dept.SomeProperty = null;
    }
    collection.AddRange(emp.Departments);              
}
</code></pre>

<p>Little refactoring turns the above into this</p>

<pre><code>foreach (Employee emp in employees)
{
    emp.Departments.ToList().ForEach(u =&gt; u.SomeProperty = null))
    collection.AddRange(emp.Departments);              
}
</code></pre>

<p>But I want something like this</p>

<pre><code>employees.ToList().Foreach(collection.AddRange(emp.Departments),
emp.Departments.ToList().ForEach(u =&gt; u.SomeProperty = null))
</code></pre>
","<p>You shouldn't use <code>ForEach</code> in that way. Read Lippert's <a href=""http://blogs.msdn.com/b/ericlippert/archive/2009/05/18/foreach-vs-foreach.aspx"" rel=""noreferrer"">“foreach” vs “ForEach”</a></p>

<p>If you want to be cruel with yourself (and the world), at least don't create useless <code>List</code></p>

<pre><code>employees.All(p =&gt; {
    collection.AddRange(p.Departments);
    p.Departments.All(u =&gt; { u.SomeProperty = null; return true; } );
    return true;
});
</code></pre>

<p>Note that the result of the <code>All</code> expression is a <code>bool</code> value that we are discarding (we are using it only because it ""cycles"" all the elements)</p>

<p>I'll repeat. You shouldn't use <code>ForEach</code> to change objects. LINQ should be used in a ""functional"" way (you can create new objects but you can't change old objects nor you can create side-effects). And what you are writing is creating so many useless <code>List</code> only to gain two lines of code...</p>
","7816840"
"Delete a single record from Entity Framework?","194885","","<p>(Reworded)</p>

<p>I have a SQL Server table in Entity Framework named <code>employ</code> with a single key column named <code>ID</code>.</p>

<p>How do I delete a single record from the table using Entity Framework?</p>
","<p>It's not necessary to query the object first, you can attach it to the context by its id.
Like this:</p>

<pre><code>var employer = new Employ { Id = 1 };
ctx.Employ.Attach(employer);
ctx.Employ.Remove(employer);
ctx.SaveChanges();
</code></pre>

<p>Alternatively, you can set the attached entry's state to deleted *Thanks to Simon Belanger *:</p>

<pre><code>var employer = new Employ { Id = 1 };
ctx.Entry(employer).State = EntityState.Deleted;
ctx.SaveChanges();
</code></pre>
","17723658"
"Extracting Path from OpenFileDialog path/filename","194791","","<p>I'm writing a little utility that starts with selecting a file, and then I need to select a folder. I'd like to default the folder to where the selected file was.</p>

<p>OpenFileDialog.FileName returns the full path &amp; filename - what I want is to obtain just the path portion (sans filename), so I can use that as the initial selected folder </p>

<pre><code>    private System.Windows.Forms.OpenFileDialog ofd;
    private System.Windows.Forms.FolderBrowserDialog fbd;
    ...
    if (ofd.ShowDialog() == DialogResult.OK)
    {
        string sourceFile = ofd.FileName;
        string sourceFolder = ???;
    }
    ...
    fbd.SelectedPath = sourceFolder; // set initial fbd.ShowDialog() folder
    if (fbd.ShowDialog() == DialogResult.OK)
    {
       ...
    }
</code></pre>

<p>Are there any .NET methods to do this, or do I need to use regex, split, trim, etc??</p>
","<p>Use the <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.aspx"" rel=""noreferrer""><code>Path</code></a> class from <a href=""http://msdn.microsoft.com/en-us/library/system.io.aspx"" rel=""noreferrer""><code>System.IO</code></a>. It contains useful calls for manipulating file paths, including <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx"" rel=""noreferrer""><code>GetDirectoryName</code></a> which does what you want, returning the directory portion of the file path.</p>

<p>Usage is simple.</p>

<pre><code>string directoryPath = Path.GetDirectoryName(filePath);
</code></pre>
","439025"
"How to recursively list all the files in a directory in C#?","194454","","<p>How to recursively list all the files in a directory and child directories in C#?</p>
","<p><a href=""http://support.microsoft.com/kb/303974"" rel=""noreferrer"">This</a> article covers all you need. Except as opposed to searching the files and comparing names, just print out the names.</p>

<p>It can be modified like so:</p>

<pre><code>static void DirSearch(string sDir)
{
    try
    {
        foreach (string d in Directory.GetDirectories(sDir))
        {
            foreach (string f in Directory.GetFiles(d))
            {
                Console.WriteLine(f);
            }
            DirSearch(d);
        }
    }
    catch (System.Exception excpt)
    {
        Console.WriteLine(excpt.Message);
    }
}
</code></pre>
","929277"
"Using IQueryable with Linq","194300","","<p>What is the use of <code>IQueryable</code> in the context of LINQ?</p>

<p>Is it used for developing extension methods or any other purpose?</p>
","<p><a href=""https://stackoverflow.com/questions/1578778/using-iqueryable-with-linq/1578809#1578809"">Marc Gravell's answer</a> is very complete, but I thought I'd add something about this from the user's point of view, as well...</p>

<hr>

<p>The main difference, from a user's perspective, is that, when you use <code>IQueryable&lt;T&gt;</code> (with a provider that supports things correctly), you can save a lot of resources.</p>

<p>For example, if you're working against a remote database, with many ORM systems, you have the option of fetching data from a table in two ways, one which returns <code>IEnumerable&lt;T&gt;</code>, and one which returns an <code>IQueryable&lt;T&gt;</code>.  Say, for example, you have a Products table, and you want to get all of the products whose cost is >$25.</p>

<p>If you do:</p>

<pre><code> IEnumerable&lt;Product&gt; products = myORM.GetProducts();
 var productsOver25 = products.Where(p =&gt; p.Cost &gt;= 25.00);
</code></pre>

<p>What happens here, is the database loads all of the products, and passes them across the wire to your program.  Your program then filters the data.  In essence, the database does a <code>SELECT * FROM Products</code>, and returns EVERY product to you.</p>

<p>With the right <code>IQueryable&lt;T&gt;</code> provider, on the other hand, you can do:</p>

<pre><code> IQueryable&lt;Product&gt; products = myORM.GetQueryableProducts();
 var productsOver25 = products.Where(p =&gt; p.Cost &gt;= 25.00);
</code></pre>

<p>The code looks the same, but the difference here is that the SQL executed will be <code>SELECT * FROM Products WHERE Cost &gt;= 25</code>.</p>

<p>From your POV as a developer, this looks the same.  However, from a performance standpoint, you may only return 2 records across the network instead of 20,000....</p>
","1578977"
"Assign null to a SqlParameter","194119","","<p>The following code gives an error - ""No implicit conversion from DBnull to int.""</p>

<pre><code>SqlParameter[] parameters = new SqlParameter[1];    
SqlParameter planIndexParameter = new SqlParameter(""@AgeIndex"", SqlDbType.Int);
planIndexParameter.Value = (AgeItem.AgeIndex== null) ? DBNull.Value : AgeItem.AgeIndex;
parameters[0] = planIndexParameter;
</code></pre>
","<p>The problem is that the <code>?:</code> operator cannot determine the return type because you are either returning an <code>int</code> value or a DBNull type value, which are not compatible.</p>

<p>You can of course cast the instance of AgeIndex to be type <code>object</code> which would satisfy the <code>?:</code> requirement.</p>

<p>You can use the <code>??</code> null-coalescing operator as follows</p>

<pre><code>SqlParameter[] parameters = new SqlParameter[1];     
SqlParameter planIndexParameter = new SqlParameter(""@AgeIndex"", SqlDbType.Int);
planIndexParameter.Value = (object)AgeItem.AgeIndex ?? DBNull.Value;
parameters[0] = planIndexParameter; 
</code></pre>

<p>Here is a quote from the <a href=""http://msdn.microsoft.com/en-us/library/ty67wk28.aspx"" rel=""noreferrer"">MSDN documentation</a> for the <code>?:</code> operator that explains the problem</p>

<blockquote>
  <p>Either the type of first_expression and second_expression must be the same, or an implicit conversion must exist from one type to the other.</p>
</blockquote>
","4556007"
"Handler ""ExtensionlessUrlHandler-Integrated-4.0"" has a bad module ""ManagedPipelineHandler"" in its module list","193543","","<p>To be honest, I've tried to turn a dirty trick on IIS and just when I thought that I was going to get away with it, I realized my workaround doesn't work. Here's what I've tried to do:</p>

<p>1) I have ASP.NET application which has <strong>Preloader</strong> class that inherits <strong>IProcessHostPreloadClient</strong> and does all the heavy initialization in <em>Preload</em> method implementation (application is complex and it's a part of an enormous system, so it requires approximately 2 minutes to establish connections to all necessary services and pre-instantiate some Unity registrations).</p>

<p>2) I have a lot of work that needs to be done on application shutdown (unsubscribing, disconnecting, disposing,...), and I guess the best place to do it is in *Application_End* method located in <strong>Global.asax</strong>.</p>

<p>3) Everything works just fine when I have user activity (first request after the Application Pool that contains aforementioned web application is started will cause *Application_Start* to be called and afterwards *Application_End* is called on Application Pool stop or recycle), but problems occur when there is no user activity and application tries to restart itself after being active for 48 hours (configured requirement). Since there was no requests, application officially didn't get started. Ergo, it can't be gracefully stopped since *Application_End* won't be called.</p>

<p>4) Now comes the messy part... I've tried to make a GET request from code at the end of the <em>Preload</em> method, and it worked. But this solution seemed bad to me, even though it worked. So, I've tried a lot of things, and the last thing I tried was this:</p>

<pre><code>SimpleWorkerRequest swr = new SimpleWorkerRequest(string.Empty, string.Empty, tw);
HttpRuntime.ProcessRequest(swr);
</code></pre>

<p>... and that has done it's purpose. *Application_Start* was called, (I've checked response, it was containing login page that was supposed to be displayed in initial request) and on Application Pool shutdown application ended gracefully by doing necessary work in *Application_End*.</p>

<p><strong>BUT</strong></p>

<p>After the application was started (preloaded and initiated) in this manner, this is what happened when I wanted to reach application via Web browser:</p>

<blockquote>
  <p>HTTP Error 500.21 - Internal Server Error
  Handler ""ExtensionlessUrlHandler-Integrated-4.0"" has a bad module ""ManagedPipelineHandler"" in its module list</p>
</blockquote>

<p>I am unable to figure this out. Can anybody tell me why this happens and how to fix it?</p>

<p>If I don't figure this out, I will go back to first solution (sending GET request from code) but this problem will bug me since I don't even have an idea what's wrong.</p>
","<p><strong>The problem</strong></p>

<p>You are using <a href=""http://msdn.microsoft.com/en-us/library/system.web.hosting.simpleworkerrequest(v=vs.110).aspx"" rel=""noreferrer"">SimpleWorkerRequest</a> in a scenario that it wasn't designed for. You are using it <strong>inside of IIS</strong>. If you look at the prior MSDN link (emphasis is mine):</p>

<blockquote>
  <p>Provides a simple implementation of the HttpWorkerRequest abstract class that can be <strong>used to host ASP.NET applications outside an Internet Information Services (IIS) application</strong>. You can employ SimpleWorkerRequest directly or extend it.</p>
</blockquote>

<p>Also, if you look at the MSDN documentation for the <a href=""http://msdn.microsoft.com/en-us/library/System.Web.Hosting(v=vs.110).aspx"" rel=""noreferrer"">System.Web.Hosting namespace</a>  (<code>SimpleWorkerRequest</code> is in this namespace), you will also see something similar to the above (again, emphasis is mine):</p>

<blockquote>
  <p>The System.Web.Hosting namespace provides the functionality for hosting ASP.NET applications from managed applications <strong>outside Microsoft Internet Information Services (IIS)</strong>.</p>
</blockquote>

<p><strong>The solution</strong></p>

<p>I would recommend removing the call to <code>SimpleWorkerRequest</code>. Instead, you can use a Microsoft solution to make sure your web site automatically starts up after it recycles. What you need is the Microsoft <a href=""http://www.iis.net/downloads/microsoft/application-initialization"" rel=""noreferrer"">Application Initialization Module for IIS 7.5</a>. It is not complicated to configure, but you need to understand the exact options. This is why I would also recommend the <a href=""http://blogs.msdn.com/b/amol/archive/2013/01/25/application-initialization-ui-for-iis-7-5.aspx"" rel=""noreferrer"">Application Initialization UI for IIS 7.5</a>. The UI is written by an MSDN blogger.</p>

<p>So what exactly does the Microsoft solution do? It does what you are trying to do - IIS sends a ""get"" request to your website after the application pool is started.</p>
","20228452"
"Extension methods must be defined in a non-generic static class","193530","","<p>I'm getting the error:</p>

<blockquote>
  <p>Extension methods must be defined in a non-generic static class</p>
</blockquote>

<p>On the line:</p>

<pre><code>public class LinqHelper
</code></pre>

<p>Here is the helper class, based on Mark Gavells code.  I'm really confused as to what this error means as I am sure it was working fine when I left it on Friday!</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Linq.Expressions;
using System.Reflection;

/// &lt;summary&gt;
/// Helper methods for link
/// &lt;/summary&gt;
public class LinqHelper
{
    public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)
    {
        return ApplyOrder&lt;T&gt;(source, property, ""OrderBy"");
    }
    public static IOrderedQueryable&lt;T&gt; OrderByDescending&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)
    {
        return ApplyOrder&lt;T&gt;(source, property, ""OrderByDescending"");
    }
    public static IOrderedQueryable&lt;T&gt; ThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)
    {
        return ApplyOrder&lt;T&gt;(source, property, ""ThenBy"");
    }
    public static IOrderedQueryable&lt;T&gt; ThenByDescending&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)
    {
        return ApplyOrder&lt;T&gt;(source, property, ""ThenByDescending"");
    }
    static IOrderedQueryable&lt;T&gt; ApplyOrder&lt;T&gt;(IQueryable&lt;T&gt; source, string property, string methodName)
    {
        string[] props = property.Split('.');
        Type type = typeof(T);
        ParameterExpression arg = Expression.Parameter(type, ""x"");
        Expression expr = arg;
        foreach (string prop in props)
        {
            // use reflection (not ComponentModel) to mirror LINQ
            PropertyInfo pi = type.GetProperty(prop);
            expr = Expression.Property(expr, pi);
            type = pi.PropertyType;
        }
        Type delegateType = typeof(Func&lt;,&gt;).MakeGenericType(typeof(T), type);
        LambdaExpression lambda = Expression.Lambda(delegateType, expr, arg);

        object result = typeof(Queryable).GetMethods().Single(
                method =&gt; method.Name == methodName
                        &amp;&amp; method.IsGenericMethodDefinition
                        &amp;&amp; method.GetGenericArguments().Length == 2
                        &amp;&amp; method.GetParameters().Length == 2)
                .MakeGenericMethod(typeof(T), type)
                .Invoke(null, new object[] { source, lambda });
        return (IOrderedQueryable&lt;T&gt;)result;
    }
}
</code></pre>
","<p>change </p>

<pre><code>public class LinqHelper
</code></pre>

<p>to </p>

<pre><code>public static class LinqHelper
</code></pre>

<p>Following points need to be considered when creating an extension method:</p>

<ol>
<li>The class which defines an extension method must be <em><code>non-generic</code></em>, <code>static</code> and <code>non-nested</code></li>
<li>Every extension method must be a <code>static</code> method</li>
<li>The first parameter of the extension method should use the <code>this</code> keyword.  </li>
</ol>
","6096330"
"Determine the number of lines within a text file","193412","","<p>Is there an easy way to programmatically determine the number of lines within a text file? </p>
","<p><strong>Seriously belated edit: If you're using .NET 4.0 or later</strong></p>

<p>The <code>File</code> class has a new <a href=""http://msdn.microsoft.com/en-us/library/dd383503.aspx"" rel=""noreferrer""><code>ReadLines</code></a> method which lazily enumerates lines rather than greedily reading them all into an array like <code>ReadAllLines</code>. So now you can have both efficiency and conciseness with:</p>

<pre><code>var lineCount = File.ReadLines(@""C:\file.txt"").Count();
</code></pre>

<hr>

<p><strong>Original Answer</strong></p>

<p>If you're not too bothered about efficiency, you can simply write:</p>

<pre><code>var lineCount = File.ReadAllLines(@""C:\file.txt"").Length;
</code></pre>

<p>For a more efficient method you could do:</p>

<pre><code>var lineCount = 0;
using (var reader = File.OpenText(@""C:\file.txt""))
{
    while (reader.ReadLine() != null)
    {
        lineCount++;
    }
}
</code></pre>

<p><strong>Edit: In response to questions about efficiency</strong></p>

<p>The reason I said the second was more efficient was regarding memory usage, not necessarily speed. The first one loads the entire contents of the file into an array which means it must allocate at least as much memory as the size of the file. The second merely loops one line at a time so it never has to allocate more than one line's worth of memory at a time. This isn't that important for small files, but for larger files it could be an issue (if you try and find the number of lines in a 4GB file on a 32-bit system, for example, where there simply isn't enough user-mode address space to allocate an array this large).</p>

<p>In terms of speed I wouldn't expect there to be a lot in it. It's possible that ReadAllLines has some internal optimisations, but on the other hand it may have to allocate a massive chunk of memory. I'd guess that ReadAllLines might be faster for small files, but significantly slower for large files; though the only way to tell would be to measure it with a Stopwatch or code profiler.</p>
","119572"
"How does lock work exactly?","193306","","<p>I see that for using objects which are not thread safe we wrap the code with a lock like this:</p>

<pre><code>private static readonly Object obj = new Object();

lock (obj)
{
    // thread unsafe code
}
</code></pre>

<p>So what happens when multiple threads access the same code (let's assume that it is running in a ASP.NET web application). Are they queued? If so how long will they wait? </p>

<p>What is the performance impact because of using locks?</p>
","<p>The <code>lock</code> statement is translated by C# 3.0 to the following:</p>

<pre><code>var temp = obj;

Monitor.Enter(temp);

try
{
    // body
}
finally
{
    Monitor.Exit(temp);
}
</code></pre>

<p>In C# 4.0 <a href=""http://blogs.msdn.com/b/ericlippert/archive/2009/03/06/locks-and-exceptions-do-not-mix.aspx"">this has changed</a> and it is now generated as follows:</p>

<pre><code>bool lockWasTaken = false;
var temp = obj;
try
{
    Monitor.Enter(temp, ref lockWasTaken);
    // body
}
finally
{
    if (lockWasTaken)
    {
        Monitor.Exit(temp); 
    }
}
</code></pre>

<p>You can find more info about what <code>Monitor.Enter</code> does <a href=""http://msdn.microsoft.com/en-us/library/de0542zz.aspx"">here</a>. To quote MSDN:</p>

<blockquote>
  <p>Use <code>Enter</code> to acquire the Monitor on
  the object passed as the parameter. If
  another thread has executed an <code>Enter</code>
  on the object but has not yet executed
  the corresponding <code>Exit</code>, the current
  thread will block until the other
  thread releases the object. It is
  legal for the same thread to invoke
  <code>Enter</code> more than once without it
  blocking; however, an equal number of
  <code>Exit</code> calls must be invoked before
  other threads waiting on the object
  will unblock.</p>
</blockquote>

<p>The <code>Monitor.Enter</code> method will wait infinitely; it will <em>not</em> time out.</p>
","6029829"
"convert double to int","193226","","<p>What is the best way to convert a <code>double</code> to an <code>int</code>? Should a cast be used?</p>
","<p>You can use a cast if you want the default truncate-towards-zero behaviour. Alternatively, you might want to use <code>Math.Ceiling</code>, <code>Math.Round</code>, <code>Math.Floor</code> etc - although you'll still need a cast afterwards.</p>

<p>Don't forget that the range of <code>int</code> is much smaller than the range of <code>double</code>. A cast from <code>double</code> to <code>int</code> won't throw an exception if the value is outside the range of <code>int</code> in an unchecked context, whereas a call to <code>Convert.ToInt32(double)</code> will. The result of the cast (in an unchecked context) is explicitly undefined if the value is outside the range.</p>
","4181954"
"Invoke(Delegate)","193210","","<p>Can anybody please explain this statement written on this <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx"">link</a></p>

<pre><code>Invoke(Delegate):
</code></pre>

<p>Executes the specified delegate on the thread that owns the <strong>control's underlying window handle.</strong></p>

<p>Can anybody explain what this means (especially the bold one) I am not able to get it clearly</p>
","<p>The answer to this question lies in how C# Controls work</p>

<blockquote>
  <p>Controls in Windows Forms are bound to a specific thread and are not
  thread safe. Therefore, if you are calling a control's method from a
  different thread, you must use one of the control's invoke methods to
  marshal the call to the proper thread. This property can be used to
  determine if you must call an invoke method, which can be useful if
  you do not know what thread owns a control.</p>
</blockquote>

<p>From <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired%28v=vs.90%29.aspx"" rel=""noreferrer"">Control.InvokeRequired</a></p>

<p>Effectively, what Invoke does is ensure that the code you are calling occurs on the thread that the control ""lives on"" effectively preventing cross threaded exceptions.</p>

<p>From a historical perspective, in .Net 1.1, this was actually allowed. What it meant is that you could try and execute code on the ""GUI"" thread from any background thread and this would mostly work. Sometimes it would just cause your app to exit because you were effectively interupting the GUI thread while it was doing something else. This is the <em>Cross Threaded Exception</em> - imagine trying to update a TextBox while the GUI is painting something else. </p>

<ul>
<li>Which action takes priority?  </li>
<li>Is it even possible for both to happen at once?  </li>
<li>What happens to all of the other commands the GUI needs to run?</li>
</ul>

<p>Effectively, you are interupting a queue, which can have lots of unforseen consequences. Invoke is effectively the ""polite"" way of getting what you want to do into that queue, and this rule was enforced from .Net 2.0 onwards via a thrown <a href=""http://msdn.microsoft.com/en-gb/library/system.invalidoperationexception.aspx"" rel=""noreferrer"">InvalidOperationException</a>.</p>

<p>To understand what is actually going on behind the scenes, and what is meant by ""GUI Thread"", it's useful to understand what a Message Pump or Message Loop is. </p>

<p>This is actually already answered in the question ""<a href=""https://stackoverflow.com/questions/2222365/what-is-a-message-pump"">What is a Message Pump</a>"" and is recommended reading for understanding the actual mechanism that you are tying into when interacting with controls.</p>

<p>Other reading you may find useful includes:</p>

<p><a href=""http://www.codeproject.com/Articles/10311/What-s-up-with-BeginInvoke"" rel=""noreferrer"">What's up with Begin Invoke</a></p>

<blockquote>
  <p>One of the cardinal rules of Windows GUI programming is that only the
  thread that created a control can access and/or modify its contents
  (except for a few documented exceptions). Try doing it from any other
  thread and you'll get unpredictable behavior ranging from deadlock, to
  exceptions to a half updated UI. The right way then to update a
  control from another thread is to post an appropriate message to the
  application message queue. When the message pump gets around to
  executing that message, the control will get updated, on the same
  thread that created it (remember, the message pump runs on the main
  thread).</p>
</blockquote>

<p>and, for a more code heavy overview with a representative sample:</p>

<p><a href=""http://www.perceler.com/articles1.php?art=crossthreads1"" rel=""noreferrer"">Invalid Cross-thread Operations</a></p>

<pre><code>// the canonical form (C# consumer)

public delegate void ControlStringConsumer(Control control, string text);  // defines a delegate type

public void SetText(Control control, string text) {
    if (control.InvokeRequired) {
        control.Invoke(new ControlStringConsumer(SetText), new object[]{control, text});  // invoking itself
    } else {
        control.Text=text;      // the ""functional part"", executing only on the main thread
    }
}
</code></pre>

<p>Once you have an appreciation for InvokeRequired, you may wish to consider using an extension method for wrapping these calls up. This is ably covered in the Stack Overflow question <a href=""https://stackoverflow.com/questions/3874134/cleaning-up-code-littered-with-invokerequired"">Cleaning Up Code Littered with Invoke Required</a>. </p>

<p>There is also a further <a href=""http://ikriv.com/dev/dotnet/MysteriousHang.html"" rel=""noreferrer"">write up of what happened historically</a> that may be of interest.</p>
","14703806"
"C# Convert string from UTF-8 to ISO-8859-1 (Latin1) H","193182","","<p>I have googled on this topic and I have looked at every answer, but I still don't get it.</p>

<p>Basically I need to convert UTF-8 string to ISO-8859-1 and I do it using following code:</p>

<pre><code>Encoding iso = Encoding.GetEncoding(""ISO-8859-1"");
Encoding utf8 = Encoding.UTF8;
string msg = iso.GetString(utf8.GetBytes(Message));
</code></pre>

<p>My source string is</p>

<pre><code>Message = ""ÄäÖöÕõÜü""
</code></pre>

<p>But unfortunately my result string becomes</p>

<pre><code>msg = ""Ã?Ã¤Ã?Ã¶Ã?ÃµÃ?Ã¼
</code></pre>

<p>What I'm doing wrong here?</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.text.encoding.convert.aspx"" rel=""noreferrer"">Encoding.Convert</a> to adjust the byte array before attempting to decode it into your destination encoding.</p>

<pre><code>Encoding iso = Encoding.GetEncoding(""ISO-8859-1"");
Encoding utf8 = Encoding.UTF8;
byte[] utfBytes = utf8.GetBytes(Message);
byte[] isoBytes = Encoding.Convert(utf8, iso, utfBytes);
string msg = iso.GetString(isoBytes);
</code></pre>
","1922253"
"Convert a positive number to negative in C#","193016","","<p>You can convert a negative number to positive like this:</p>

<pre><code>int myInt = System.Math.Abs(-5);
</code></pre>

<p>Is there an equivalent method to make a positive number negative?</p>
","<p>How about</p>

<pre><code>myInt = myInt * -1
</code></pre>

<p></p>
","1348090"
"Sending and receiving data over a network using TcpClient","192823","","<p>I need to develop a service that will connect to a TCP server. Main tasks are reading incoming messages and also sending commands to the server in ten minutes, like a synchronize command. For example, I used the TcpClient object as shown below:</p>

<pre><code>...
TcpClient tcpClient = new TcpClient();
tcpClient.Connect(""x.x.x.x"", 9999);
networkStream = tcpClient.GetStream();
clientStreamReader = new StreamReader(networkStream);
clientStreamWriter = new  StreamWriter(networkStream);
while(true)
{
   clientStreamReader.Read()
}
</code></pre>

<p>Also, when I need to write out something in any method, I use:</p>

<pre><code> clientStreamWriter.write(""xxx"");
</code></pre>

<p>Is this usage correct? Or is there a better way?</p>
","<p>By the way, you can use serialization technology to send strings, numbers or any objects which are support serialization (most of .NET data-storing classes &amp; structs are [Serializable]).
There, you should at first send Int32-length in four bytes to the stream and then send binary-serialized (System.Runtime.Serialization.Formatters.Binary.BinaryFormatter) data into it.</p>

<p>On the other side or the connection (on both sides actually) you definetly should have a byte[] buffer which u will append and trim-left at runtime when data is coming. </p>

<p>Something like that I am using:</p>

<pre><code>namespace System.Net.Sockets
{
    public class TcpConnection : IDisposable
    {
        public event EvHandler&lt;TcpConnection, DataArrivedEventArgs&gt; DataArrive = delegate { };
        public event EvHandler&lt;TcpConnection&gt; Drop = delegate { };

        private const int IntSize = 4;
        private const int BufferSize = 8 * 1024;

        private static readonly SynchronizationContext _syncContext = SynchronizationContext.Current;
        private readonly TcpClient _tcpClient;
        private readonly object _droppedRoot = new object();
        private bool _dropped;
        private byte[] _incomingData = new byte[0];
        private Nullable&lt;int&gt; _objectDataLength;

        public TcpClient TcpClient { get { return _tcpClient; } }
        public bool Dropped { get { return _dropped; } }

        private void DropConnection()
        {
            lock (_droppedRoot)
            {
                if (Dropped)
                    return;

                _dropped = true;
            }

            _tcpClient.Close();
            _syncContext.Post(delegate { Drop(this); }, null);
        }

        public void SendData(PCmds pCmd) { SendDataInternal(new object[] { pCmd }); }
        public void SendData(PCmds pCmd, object[] datas)
        {
            datas.ThrowIfNull();
            SendDataInternal(new object[] { pCmd }.Append(datas));
        }
        private void SendDataInternal(object data)
        {
            if (Dropped)
                return;

            byte[] bytedata;

            using (MemoryStream ms = new MemoryStream())
            {
                BinaryFormatter bf = new BinaryFormatter();

                try { bf.Serialize(ms, data); }
                catch { return; }

                bytedata = ms.ToArray();
            }

            try
            {
                lock (_tcpClient)
                {
                    TcpClient.Client.BeginSend(BitConverter.GetBytes(bytedata.Length), 0, IntSize, SocketFlags.None, EndSend, null);
                    TcpClient.Client.BeginSend(bytedata, 0, bytedata.Length, SocketFlags.None, EndSend, null);
                }
            }
            catch { DropConnection(); }
        }
        private void EndSend(IAsyncResult ar)
        {
            try { TcpClient.Client.EndSend(ar); }
            catch { }
        }

        public TcpConnection(TcpClient tcpClient)
        {
            _tcpClient = tcpClient;
            StartReceive();
        }

        private void StartReceive()
        {
            byte[] buffer = new byte[BufferSize];

            try
            {
                _tcpClient.Client.BeginReceive(buffer, 0, buffer.Length, SocketFlags.None, DataReceived, buffer);
            }
            catch { DropConnection(); }
        }

        private void DataReceived(IAsyncResult ar)
        {
            if (Dropped)
                return;

            int dataRead;

            try { dataRead = TcpClient.Client.EndReceive(ar); }
            catch
            {
                DropConnection();
                return;
            }

            if (dataRead == 0)
            {
                DropConnection();
                return;
            }

            byte[] byteData = ar.AsyncState as byte[];
            _incomingData = _incomingData.Append(byteData.Take(dataRead).ToArray());
            bool exitWhile = false;

            while (exitWhile)
            {
                exitWhile = true;

                if (_objectDataLength.HasValue)
                {
                    if (_incomingData.Length &gt;= _objectDataLength.Value)
                    {
                        object data;
                        BinaryFormatter bf = new BinaryFormatter();

                        using (MemoryStream ms = new MemoryStream(_incomingData, 0, _objectDataLength.Value))
                            try { data = bf.Deserialize(ms); }
                            catch
                            {
                                SendData(PCmds.Disconnect);
                                DropConnection();
                                return;
                            }

                        _syncContext.Post(delegate(object T)
                        {
                            try { DataArrive(this, new DataArrivedEventArgs(T)); }
                            catch { DropConnection(); }
                        }, data);

                        _incomingData = _incomingData.TrimLeft(_objectDataLength.Value);
                        _objectDataLength = null;
                        exitWhile = false;
                    }
                }
                else
                    if (_incomingData.Length &gt;= IntSize)
                    {
                        _objectDataLength = BitConverter.ToInt32(_incomingData.TakeLeft(IntSize), 0);
                        _incomingData = _incomingData.TrimLeft(IntSize);
                        exitWhile = false;
                    }
            }
            StartReceive();
        }


        public void Dispose() { DropConnection(); }
    }
}
</code></pre>

<p>That is just an example, you should edit it for your use.</p>
","5818061"
"How to crop an image using C#?","192401","","<p>How can I write an application that will crop images in C#?</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/ktyfbs10.aspx"" rel=""noreferrer""><code>Graphics.DrawImage</code></a> to draw a cropped image onto the graphics object from a bitmap.</p>

<pre><code>Rectangle cropRect = new Rectangle(...);
Bitmap src = Image.FromFile(fileName) as Bitmap;
Bitmap target = new Bitmap(cropRect.Width, cropRect.Height);

using(Graphics g = Graphics.FromImage(target))
{
   g.DrawImage(src, new Rectangle(0, 0, target.Width, target.Height), 
                    cropRect,                        
                    GraphicsUnit.Pixel);
}
</code></pre>
","734941"
"How can I get the DateTime for the start of the week?","192321","","<p>How do I find the start of the week (both Sunday and Monday) knowing just the current time in C#?</p>

<p>Something like:</p>

<pre><code>DateTime.Now.StartWeek(Monday);
</code></pre>
","<p>Use an extension method. They're the answer to everything, you know! ;)</p>

<pre><code>public static class DateTimeExtensions
{
    public static DateTime StartOfWeek(this DateTime dt, DayOfWeek startOfWeek)
    {
        int diff = (7 + (dt.DayOfWeek - startOfWeek)) % 7;
        return dt.AddDays(-1 * diff).Date;
    }
}
</code></pre>

<p>Which can be used as follows:</p>

<pre><code>DateTime dt = DateTime.Now.StartOfWeek(DayOfWeek.Monday);
DateTime dt = DateTime.Now.StartOfWeek(DayOfWeek.Sunday);
</code></pre>
","38064"
"aspx page to redirect to a new page","192061","","<p>What is the code required to redirect the browser to a new page with an ASPX page?</p>

<p>I have tried this on my page default.aspx :</p>

<pre><code>&lt;% Response.Redirect(""new.aspx"", true); %&gt;
</code></pre>

<p>or</p>

<pre><code>&lt;%@ Response.Redirect(""new.aspx"", true); %&gt;
</code></pre>

<p>And these resulted in a server error that is undetermined. I cannot see the error code; because the server is not in my control and the errors are not public.</p>

<p>Please provide all necessary code from line 1 of the page to the end, and I would really appreciate it.</p>
","<pre><code>&lt;%@ Page Language=""C#"" %&gt;
&lt;script runat=""server""&gt;
  protected override void OnLoad(EventArgs e)
  {
      Response.Redirect(""new.aspx"");
  }
&lt;/script&gt;
</code></pre>
","1093094"
"Easier way to debug a Windows service","191931","","<p>Is there an easier way to step through the code than to start the service through the Windows Service Control Manager and then attaching the debugger to the thread? It's kind of cumbersome and I'm wondering if there is a more straightforward approach.</p>
","<p>If I want to quickly debug the service, I just drop in a <code>Debugger.Break()</code> in there. When that line is reached, it will drop me back to VS. Don't forget to remove that line when you are done.</p>

<p>UPDATE: As an alternative to #if DEBUG pragmas, you can also use <code>Conditional(""DEBUG_SERVICE"")</code> attribute.</p>

<pre><code>[Conditional(""DEBUG_SERVICE"")]
private static void DebugMode()
{
    Debugger.Break();
}
</code></pre>

<p>On your OnStart, just call this method:</p>

<pre><code>public override void OnStart()
{
     DebugMode();
     /* ... do the rest */
}
</code></pre>

<p>There, the code will only be enabled during Debug builds. While your at it, it might be useful to create a separate Build Configuration for service debugging.</p>
","126016"
"Remove characters after specific character in string, then remove substring?","191912","","<p>I feel kind of dumb posting this when this seems kind of simple and there are tons of questions on strings/characters/regex, but I couldn't find quite what I needed (except in another language: <a href=""https://stackoverflow.com/questions/2176544/remove-all-text-after-certain-point"">Remove All Text After Certain Point</a>).</p>

<p>I've got the following code:</p>

<pre><code>[Test]
    public void stringManipulation()
    {
        String filename = ""testpage.aspx"";
        String currentFullUrl = ""http://localhost:2000/somefolder/myrep/test.aspx?q=qvalue"";
        String fullUrlWithoutQueryString = currentFullUrl.Replace(""?.*"", """");
        String urlWithoutPageName = fullUrlWithoutQueryString.Remove(fullUrlWithoutQueryString.Length - filename.Length);

        String expected = ""http://localhost:2000/somefolder/myrep/"";
        String actual = urlWithoutPageName;
        Assert.AreEqual(expected, actual);
    }
</code></pre>

<p>I tried the solution in the question above (hoping the syntax would be the same!) but nope. I want to first remove the queryString which could be any variable length, then remove the page name, which again could be any length.</p>

<p>How can I get the remove the query string from the full URL such that this test passes?</p>
","<p>For string manipulation, if you just want to kill everything after the ?, you can do this </p>

<pre><code>string input = ""http://www.somesite.com/somepage.aspx?whatever"";
int index = input.IndexOf(""?"");
if (index &gt; 0)
   input = input.Substring(0, index);
</code></pre>

<p>Edit: If everything after the last slash, do something like </p>

<pre><code>string input = ""http://www.somesite.com/somepage.aspx?whatever"";
int index = input.LastIndexOf(""/"");
if (index &gt; 0)
    input = input.Substring(0, index); // or index + 1 to keep slash
</code></pre>

<p>Alternately, since you're working with a URL, you can do something with it like this code </p>

<pre><code>System.Uri uri = new Uri(""http://www.somesite.com/what/test.aspx?hello=1"");
string fixedUri = uri.AbsoluteUri.Replace(uri.Query, string.Empty);
</code></pre>
","2660734"
"GridView Hide Column by code","191823","","<p>I want to hide ID column in my GridView, I knew the code </p>

<pre><code>GridView1.Columns[0].Visible = false;
</code></pre>

<p>but the surprise was that my count property for my <code>GridView</code> columns is 0 !!! while I can see data in the <code>GridView</code>, so any ideas?</p>

<p>Thank you,</p>

<p>Update:</p>

<p>here is the complete code for the method which populate the <code>GridView</code></p>

<pre><code>public DataSet GetAllPatients()
{
    SqlConnection connection = new SqlConnection(this.ConnectionString);

    String sql = ""SELECT [ID],[Name],[Age],[Phone],[MedicalHistory],[Medication],[Diagnoses] FROM [dbo].[AwadyClinc_PatientTbl]order by ID desc"";

    SqlCommand command = new SqlCommand(sql, connection);

    SqlDataAdapter da = new SqlDataAdapter(command);

    DataSet ds = new DataSet();

    da.Fill(ds);

    return ds;

}
</code></pre>
","<p><code>GridView.Columns.Count</code> will always be 0 when your GridView has its <code>AutoGenerateColumns</code> property set to <code>true</code> (default is <code>true</code>).</p>

<p>You can explicitly declare your columns and set the <code>AutoGenerateColumns</code> property to <code>false</code>, or you can use this in your codebehind:</p>

<p><code>GridView.Rows[0].Cells.Count</code> </p>

<p>to get the column count once your GridView data has been bound, or this: </p>

<pre><code>protected void GridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    e.Row.Cells[index].Visible = false;
}
</code></pre>

<p>to set a column invisible using your GridView's <code>RowDataBound</code> event.</p>
","3819831"
"Access cell value of datatable","191622","","<p>Can anyone help me how to access for example value of first cell in 4th column?</p>

<pre><code>a b c d
1 2 3 5
g n m l
</code></pre>

<p>for example, how to access to value d, if that would be datatable?</p>

<p>Thanks.</p>
","<p>If you need a weak reference to the cell value:</p>

<pre><code>object field = d.Rows[0][3]
</code></pre>

<p>or</p>

<pre><code>object field = d.Rows[0].ItemArray[3]
</code></pre>

<p>Should do it</p>

<p>If you need a strongly typed reference (string in your case) you can use the <a href=""https://msdn.microsoft.com/en-us/library/system.data.datarowextensions.field(v=vs.110).aspx"">DataRowExtensions.Field</a> extension method:</p>

<pre><code>string field = d.Rows[0].Field&lt;string&gt;(3);
</code></pre>

<p>(make sure System.Data is in listed in the namespaces in this case)</p>

<p>Indexes are 0 based so we first access the first row (0) and then the 4th column in this row (3)</p>
","9022197"
"How to execute an .SQL script file using c#","191493","","<p>I'm sure this question has been answered already, however I was unable to find an answer using the search tool.</p>

<p>Using c# I'd like to run a .sql file. The sql file contains multiple sql statements, some of which are broken over multiple lines. I tried reading in the file and tried executing the file using ODP.NET ... however I don't think ExecuteNonQuery is really designed to do this.</p>

<p>So I tried using sqlplus via spawning a process ... however unless I spawned the process with UseShellExecute set to true sqlplus would hang and never exit. Here's the code that DOESN'T WORK.</p>

<pre><code>Process p = new Process();
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = ""sqlplus"";
p.StartInfo.Arguments = string.Format(""xx/xx@{0} @{1}"", in_database, s);
p.StartInfo.CreateNoWindow = true;

bool started = p.Start();
p.WaitForExit();
</code></pre>

<p>WaitForExit never returns .... Unless I set UseShellExecute to true. A side effect of UseShellExecute is that you can no capture the redirected output.</p>
","<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Microsoft.SqlServer.Management.Smo;
using Microsoft.SqlServer.Management.Common;
using System.IO;
using System.Data.SqlClient;

public partial class ExcuteScript : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
    string sqlConnectionString = @""Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=ccwebgrity;Data Source=SURAJIT\SQLEXPRESS"";

    string script = File.ReadAllText(@""E:\Project Docs\MX462-PD\MX756_ModMappings1.sql"");

    SqlConnection conn = new SqlConnection(sqlConnectionString);

    Server server = new Server(new ServerConnection(conn));

    server.ConnectionContext.ExecuteNonQuery(script);
    }
}
</code></pre>
","1728859"
"How to get DropDownList SelectedValue in Controller in MVC","191269","","<p>I have dropdownlist, which i have filled from database. Now i need to get the selected value in Controller do some manipulation. But not getting the idea. Code which i have tried.</p>

<h2>Model</h2>

<pre><code>public class MobileViewModel 
{          
    public List&lt;tbInsertMobile&gt; MobileList;
    public SelectList Vendor { get; set; }
}
</code></pre>

<h2>Controller</h2>

<pre><code> public ActionResult ShowAllMobileDetails()
    {
        MobileViewModel MV = new MobileViewModel();
        MV.MobileList = db.Usp_InsertUpdateDelete(null, """", """", null, """", 4, MergeOption.AppendOnly).ToList();
        MV.Vendor = new SelectList(db.Usp_VendorList(), ""VendorId"", ""VendorName"");
        return View(MV);
    }

    [HttpPost]
    public ActionResult ShowAllMobileDetails(MobileViewModel MV)
    {           
        string strDDLValue = """"; // Here i need the dropdownlist value

        return View(MV);
    }
</code></pre>

<h2>View</h2>

<pre><code>   &lt;table&gt;           
        &lt;tr&gt;
            &lt;td&gt;Mobile Manufacured&lt;/td&gt;
            &lt;td&gt;@Html.DropDownList(""ddlVendor"", Model.Vendor, ""Select Manufacurer"") &lt;/td&gt;
        &lt;/tr&gt;         
        &lt;tr&gt;
            &lt;td&gt;

            &lt;/td&gt;
            &lt;td&gt;
                &lt;input id=""Submit1"" type=""submit"" value=""search"" /&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
</code></pre>
","<h2>1st Approach (via Request or FormCollection):</h2>

<p>You can read it from <code>Request</code> using <code>Request.Form</code> , your dropdown name is <code>ddlVendor</code> so pass <code>ddlVendor</code> key in the formCollection to get its value that is posted by form:</p>

<pre><code>string strDDLValue = Request.Form[""ddlVendor""].ToString();
</code></pre>

<p>or Use <code>FormCollection</code>:</p>

<pre><code>[HttpPost]
public ActionResult ShowAllMobileDetails(MobileViewModel MV,FormCollection form)
{           
  string strDDLValue = form[""ddlVendor""].ToString();

  return View(MV);
}
</code></pre>

<h2>2nd Approach (Via Model):</h2>

<p>If you want with Model binding then add a property in Model:</p>

<pre><code>public class MobileViewModel 
{          
    public List&lt;tbInsertMobile&gt; MobileList;
    public SelectList Vendor { get; set; }
    public string SelectedVendor {get;set;}
}
</code></pre>

<p>and in View:</p>

<pre><code>@Html.DropDownListFor(m=&gt;m.SelectedVendor , Model.Vendor, ""Select Manufacurer"")
</code></pre>

<p>and in Action:</p>

<pre><code>[HttpPost]
public ActionResult ShowAllMobileDetails(MobileViewModel MV)
{           
   string SelectedValue = MV.SelectedVendor;
   return View(MV);
}
</code></pre>

<h2>UPDATE:</h2>

<p>If you want to post the text of selected item as well, you have to add a hidden field and on drop down selection change set selected item text in the hidden field:</p>

<pre><code>public class MobileViewModel 
{          
    public List&lt;tbInsertMobile&gt; MobileList;
    public SelectList Vendor { get; set; }
    public string SelectVendor {get;set;}
    public string SelectedvendorText { get; set; }
}
</code></pre>

<p>use jquery to set hidden field:</p>

<pre><code>&lt;script type=""text/javascript""&gt;
$(function(){
$(""#SelectedVendor"").on(""change"", function {
   $(""#SelectedvendorText"").val($(this).text());
 });
});
&lt;/script&gt;

@Html.DropDownListFor(m=&gt;m.SelectedVendor , Model.Vendor, ""Select Manufacurer"")
@Html.HiddenFor(m=&gt;m.SelectedvendorText)
</code></pre>
","27901225"
"Getting full URL of action in ASP.NET MVC","190630","","<p>Is there a built-in way of getting the full URL of an action?</p>

<p>I am looking for something like <code>GetFullUrl(""Action"", ""Controller"")</code> that would return something like <code>http://www.fred.com/Controller/Action</code>.</p>

<p>The reason I am looking for this is to avoid hardcoding URLs in automated emails that are generated so that the URLs can always be generated relative to the current location of the site.</p>
","<p>There is an overload of Url.Action that takes your desired protocol (e.g. http, https) as an argument - if you specify this, you get a fully qualified URL.</p>

<p>Here's an example that uses the protocol of the current request in an action method:</p>

<pre><code>var fullUrl = this.Url.Action(""Edit"", ""Posts"", new { id = 5 }, this.Request.Url.Scheme);
</code></pre>

<p>HtmlHelper (@Html) also has an overload of the ActionLink method that you can use in razor to create an anchor element, but it also requires the hostName and fragment parameters. So I'd just opt to use @Url.Action again:</p>

<pre><code>&lt;span&gt;
  Copy
  &lt;a href='@Url.Action(""About"", ""Home"", null, Request.Url.Scheme)'&gt;this link&lt;/a&gt; 
  and post it anywhere on the internet!
&lt;/span&gt;
</code></pre>
","2005404"
"Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<AnonymousType#1>' to 'System.Collections.Generic.List<string>","190560","","<p>I have the code below:</p>

<pre><code>List&lt;string&gt; aa = (from char c in source
                   select new { Data = c.ToString() }).ToList();
</code></pre>

<p>But what about </p>

<pre><code>List&lt;string&gt; aa = (from char c1 in source
                   from char c2 in source
                   select new { Data = string.Concat(c1, ""."", c2)).ToList&lt;string&gt;();
</code></pre>

<p>While compile getting error</p>

<blockquote>
  <p>Cannot implicitly convert type <code>'System.Collections.Generic.List&lt;AnonymousType#1&gt;'</code> to <code>'System.Collections.Generic.List&lt;string&gt;'</code></p>
</blockquote>

<p>Need help.</p>
","<pre><code>IEnumerable&lt;string&gt; e = (from char c in source
                        select new { Data = c.ToString() }).Select(t = &gt; t.Data);
// or
IEnumerable&lt;string&gt; e = from char c in source
                        select c.ToString();
// or
IEnumerable&lt;string&gt; e = source.Select(c = &gt; c.ToString());
</code></pre>

<hr>

<p>Then you can call <code>ToList()</code>:</p>

<pre><code>List&lt;string&gt; l = (from char c in source
                  select new { Data = c.ToString() }).Select(t = &gt; t.Data).ToList();
// or
List&lt;string&gt; l = (from char c in source
                  select c.ToString()).ToList();
// or
List&lt;string&gt; l = source.Select(c = &gt; c.ToString()).ToList();
</code></pre>
","4256387"
"How can I format a number into a string with leading zeros?","190339","","<p>I have a number that I need to convert to a string. First I used this:</p>

<pre><code>Key = i.ToString();
</code></pre>

<p>But I realize it's being sorted in a strange order and so I need to pad it with zeros. How could I do this?</p>
","<p>Rather simple:</p>

<pre><code>Key = i.ToString(""D2"");
</code></pre>

<p><code>D</code> stands for ""decimal number"", <code>2</code> for the number of digits to print.</p>
","5418425"
"Are 2 dimensional Lists possible in c#?","190105","","<p>I'd like to set up a multidimensional list.
For reference, I am working on a playlist analyzer.</p>

<p>I have a file/file-list, which my program saves in a standard list. One line from the file in each list entry.</p>

<p>I then analyze the list with regular-expressions to find specific lines.
Some of the data/results from the lines needs to be put into a new <strong>multidimensional</strong> list; since I don't know how many results/data I'll end up with, I can't use a multidimensional array.</p>

<p>Here is the data I want to insert:</p>

<pre>
List
(
    [0] => List
        (
            [0] => Track ID
            [1] => Name
            [2] => Artist
            [3] => Album
            [4] => Play Count
            [5] => Skip Count

        )
    [1] => List
        (
And so on....
</pre>

<p>Real Example:</p>

<pre>
List
(
    [0] => List
        (
            [0] => 2349
            [1] => The Prime Time of Your Life
            [2] => Daft Punk
            [3] => Human After All
            [4] => 3
            [5] => 2

        )
    [1] => List
        (
</pre>

<p>So yeah, mlist[0][0] would get TrackID from song 1, mlist[1][0] from song 2 etc.</p>

<p>But I am having huge issues creating a multidimensional list.
So far I have come up with </p>

<pre><code>List&lt;List&lt;string&gt;&gt; matrix = new List&lt;List&lt;string&gt;&gt;();
</code></pre>

<p>But I haven't really had much more progress :(</p>
","<p>Well you certainly <em>can</em> use a <code>List&lt;List&lt;string&gt;&gt;</code> where you'd then write:</p>

<pre><code>List&lt;string&gt; track = new List&lt;string&gt;();
track.Add(""2349"");
track.Add(""The Prime Time of Your Life"");
// etc
matrix.Add(track);
</code></pre>

<p>But why would you do that instead of building your own class to represent a track, with Track ID, Name, Artist, Album, Play Count and Skip Count properties? Then just have a <code>List&lt;Track&gt;</code>.</p>
","665304"
"Best Regular Expression for Email Validation in C#","189859","","<p>I have seen a multitude of regular expressions for different programming languages that all purport to validate email addresses.  I have seen many comments saying that the expressions in question do not work for certain cases and that they are either too strict or too permissive.  What I'm looking for is a regular expression that I can use in my C# code that is definitive.</p>

<p>The best thing I have found is this</p>

<pre><code>^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$
</code></pre>

<p>Is there something better?</p>
","<blockquote>
  <p>Email address: RFC 2822 Format <br>
  Matches a normal email address. 
  Does not check the top-level domain.<br> Requires the ""case insensitive""
  option to be ON.</p>
</blockquote>

<pre><code>[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?
</code></pre>

<p>Usage : </p>

<pre><code>bool isEmail = Regex.IsMatch(emailString, @""\A(?:[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)\Z"", RegexOptions.IgnoreCase);
</code></pre>
","16168103"
"get path for my .exe","189638","","<p>how can I get my .exe path because if I copy my .exe I can get my new path ?</p>
","<pre><code>System.Reflection.Assembly.GetEntryAssembly().Location;
</code></pre>
","3991953"
"How do I show a console output/window in a forms application?","189638","","<p>To get stuck in straight away, a very basic example:</p>

<pre><code>using System;
using System.Windows.Forms;

class test
{ 
    static void Main()
    { 
        Console.WriteLine(""test"");
        MessageBox.Show(""test"");
    }
}
</code></pre>

<p>If I compile this with default options (using csc at command line), as expected, it will compile to a console application. Also, because I imported <code>System.Windows.Forms</code>, it will also show a message box.</p>

<p>Now, if I use the option <code>/target:winexe</code>, which I think is the same as choosing <code>Windows Application</code> from within project options, as expected I will only see the Message Box and no console output.</p>

<p>(In fact, the moment it is launched from command line, I can issue the next command before the application has even completed).</p>

<p>So, my question is - I know that you can have ""windows""/forms output from a console application, but is there anyway to show the console from a Windows application?</p>
","<p>this one should work.</p>

<pre><code>using System.Runtime.InteropServices;

private void Form1_Load(object sender, EventArgs e)
{
    AllocConsole();
}

[DllImport(""kernel32.dll"", SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool AllocConsole();
</code></pre>
","4363184"
"How to add browse file button to Windows Form using C#","189487","","<p>I want to select a file on the local hard disk when I click a ""Browse"" button.</p>

<p>I don't have any idea how to use the <code>OpenFileDialog</code> control. Can anyone help me?</p>
","<p>These links explain it with examples </p>

<p><a href=""http://dotnetperls.com/openfiledialog"" rel=""noreferrer"">http://dotnetperls.com/openfiledialog</a></p>

<p><a href=""http://www.geekpedia.com/tutorial67_Using-OpenFileDialog-to-open-files.html"" rel=""noreferrer"">http://www.geekpedia.com/tutorial67_Using-OpenFileDialog-to-open-files.html</a></p>

<pre><code>private void button1_Click(object sender, EventArgs e)
{
    int size = -1;
    DialogResult result = openFileDialog1.ShowDialog(); // Show the dialog.
    if (result == DialogResult.OK) // Test result.
    {
       string file = openFileDialog1.FileName;
       try
       {
          string text = File.ReadAllText(file);
          size = text.Length;
       }
       catch (IOException)
       {
       }
    }
    Console.WriteLine(size); // &lt;-- Shows file size in debugging mode.
    Console.WriteLine(result); // &lt;-- For debugging use.
}
</code></pre>
","4999747"
"System.Net.Http: missing from namespace? (using .net 4.5)","189412","","<p>TL; DR: I'm new to this language and have no idea what I'm doing</p>

<p>here is my class so far:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Net.Http;
using System.Web;
using System.Net;
using System.IO;

public class MyClass
    {
        private const string URL = ""https://sub.domain.com/objects.json?api_key=123"";
        private const string data = @""{""""object"""":{""""name"""":""""Title""""}}"";

        public static void CreateObject()
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);
            request.Method = ""POST"";
            request.ContentType = ""application/json"";
            request.ContentLength = data.Length;
            StreamWriter requestWriter = new StreamWriter(request.GetRequestStream(), System.Text.Encoding.ASCII);
            requestWriter.Write(data);
            requestWriter.Close();

            try
            {
                // get the response
                WebResponse webResponse = request.GetResponse();
                Stream webStream = webResponse.GetResponseStream();
                StreamReader responseReader = new StreamReader(webStream);
                string response = responseReader.ReadToEnd();
                responseReader.Close();
            }
            catch (WebException we)
            {
                string webExceptionMessage = we.Message;
            }
            catch (Exception ex)
            {
                // no need to do anything special here....
            }
        }

        static void Main(string[] args)
        {
            MyClass.CreateObject();
        }
}
</code></pre>

<p>when I do csc filename.cs, I get the following error:</p>

<blockquote>
  <p>The type or namespace name 'Http' does not exist in the namespace 'System.Net' (are you missing an assembly reference?)</p>
</blockquote>
","<p><a href=""https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(v=vs.110).aspx"" rel=""noreferrer""><code>HttpClient</code></a> lives in the <a href=""https://msdn.microsoft.com/en-us/library/system.net.http(v=vs.110).aspx"" rel=""noreferrer""><code>System.Net.Http</code></a> namespace.</p>

<p>You'll need to add:</p>

<pre><code>using System.Net.Http;
</code></pre>

<p>And make sure you are referencing <code>System.Net.Http.dll</code> in .NET 4.5.</p>

<hr>

<p>The code posted doesn't appear to do anything with <code>webClient</code>. Is there something wrong with the code that is actually compiling using <code>HttpWebRequest</code>?</p>

<hr>

<p><strong>Update</strong></p>

<p>To open the <em>Add Reference</em> dialog right-click on your project in <em>Solution Explorer</em> and select <em>Add Reference...</em>. It should look something like:</p>

<p><img src=""https://i.stack.imgur.com/XVEoQ.png"" alt=""enter image description here""></p>
","9611353"
"Create an instance of a class from a string","189149","","<p>Is there a way to create an instance of a class based on the fact I know the name of the class at runtime. Basically I would have the name of the class in a string.</p>
","<p>Take a look at the <a href=""http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx"" rel=""noreferrer"">Activator.CreateInstance</a> method.</p>
","223957"
"Attempted to read or write protected memory. This is often an indication that other memory is corrupt","189038","","<p>I'm hoping someone can enlighten me as to what could possibly be causing this error:</p>

<blockquote>
  <p>Attempted to read or write protected memory. This is often an indication that other memory is corrupt.</p>
</blockquote>

<p>I cannot really post code because this error seems to get thrown in any random area of the application. The application will run anywhere from 12-48 hours before throwing the error. Sometimes it will stop in a seemingly random spot and throw the above error, other times the entire application stops and I get a screen with an error that says something along the lines of ""There was a fatal error in... This may be a bug in the CLR or..."" something about PInvoke or other non relevant info. When this happens all threads show terminated and there is no debugging information available. </p>

<p>In a nutshell this is what the application does:</p>

<p>Its a multi-threaded server application written in entirely in C#. Clients connect to the server via socket. The server runs a virtual ""environment"" for the clients where they can interact with each other and the environment. It consumes quite a bit of memory but I do not see it leaking. It typically consumes about 1.5GB.  I dont think its leaking because the memory usage stays relatively constant the entire time the application is running. Its constantly running code to maintain the environment even if the clients are not doing anything. It uses no 3rd party software or other APIs. The only outside resources this application uses is socket connections and SQL database connections. Its running on a 64bit server. I have tried debugging this in VS2008 &amp; VS2010 using .net 2.0, 3.5, and 4.0 and on multiple servers and the problem still eventually occurs. </p>

<p>I've tried turning off compiler optimizations and several microsoft hot-fixes. Nothing seems to make this issue go away. It would be appreciated if anyone knows any possible causes, or some kind of way to identify whats causing the problem.</p>
","<p>Finally tracked this down with the help of WinDBG and SOS.  Access violation was being thrown by some unknown DLL. Turns out a piece of software called ""Nvidia Network Manager"" was causing the problems. I'd read countless times how this issue can be caused by firewalls or antivirus, neither of which I am using so I dismissed this idea. Also, I was under the assumption that it was not environmental because it occurs on more than 1 server using different hardware. Turns out all the machines I tested this on were running ""NVidia Network Manager"". I believe it installs with the rest of the motherboard drivers.  </p>

<p>Hopefully this helps someone as this issue was plaguing my application for a very long time. </p>
","4961803"
"how to check if List<T> element contains an item with a Particular Property Value","188738","","<pre><code>public class PricePublicModel
{
    public PricePublicModel() { }

    public int PriceGroupID { get; set; }
    public double Size { get; set; }
    public double Size2 { get; set; }
    public int[] PrintType { get; set; }
    public double[] Price { get; set; }
}

List&lt;PricePublicModel&gt; pricePublicList = new List&lt;PricePublicModel&gt;();
</code></pre>

<p>How to check if element of <code>pricePublicList</code> contains certain value. To be more precise, I want to check if there exists <code>pricePublicModel.Size == 200</code>? Also, if this element exists, how to know which one it is?</p>

<p>EDIT If Dictionary is more suitable for this then I could use Dictionary, but I would need to know how :) </p>
","<p>If you have a list and you want to know where within the list an element exists that matches a given criteria, you can use the <code>FindIndex</code> instance method. Such as </p>

<pre><code>int index = list.FindIndex(f =&gt; f.Bar == 17);
</code></pre>

<p>Where <code>f =&gt; f.Bar == 17</code> is a predicate with the matching criteria.</p>

<p>In your case you might write </p>

<pre><code>int index = pricePublicList.FindIndex(item =&gt; item.Size == 200);
if (index &gt;= 0) 
{
    // element exists, do what you need
}
</code></pre>
","4937099"
"Remove columns from DataTable in C#","188549","","<p>I have a DataSet which I get a DataTable from that I am being passed back from a function call. It has 15-20 columns, however I only want 10 columns of the data.</p>

<p>Is there a way to remove those columns that I don't want, copy the DataTable to another that has only the columns defined that I want or is it just better to iterate the collection and just use the columns I need.</p>

<p>I need to write the values out to a fixed length data file.</p>
","<p>Aside from limiting the columns selected to reduce bandwidth and memory:</p>

<blockquote>
<pre><code>       DataTable t;
       t.Columns.Remove(""columnName"");
       t.Columns.RemoveAt(columnIndex);
</code></pre>
</blockquote>
","75178"
"What is the best data type to use for money in c#?","188542","","<p>What is the best data type to use for money in c#?</p>
","<p>As it is described at <a href=""https://msdn.microsoft.com/en-us/library/364x0z75(v=vs.140).aspx"" rel=""noreferrer"">decimal</a> as:</p>

<blockquote>
  <p>The decimal keyword indicates a 128-bit data type. Compared to
  floating-point types, the decimal type has more precision and a
  smaller range, which makes it <strong>appropriate for financial and monetary</strong>
  calculations.</p>
</blockquote>

<p>You can use a decimal as follows:</p>

<pre><code>decimal myMoney = 300.5m;
</code></pre>
","693376"
"The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication","188296","","<blockquote>
  <p>The communication object, System.ServiceModel.Channels.ServiceChannel, 
  cannot be used for communication because it is in the Faulted state. </p>
</blockquote>

<p>What is this error all about, and how would I go about solving it?</p>
","<p>You get this error because you let a .NET exception happen on your server side, and you didn't catch and handle it, and didn't convert it to a SOAP fault, either.</p>

<p>Now since the server side ""bombed"" out, the WCF runtime has ""faulted"" the channel - e.g. the communication link between the client and the server is unusable - after all, it looks like your server just blew up, so you cannot communicate with it any more.</p>

<p>So what you need to do is:</p>

<ul>
<li><p><strong>always</strong> catch and handle your server-side errors - <strong>do not</strong> let .NET exceptions travel from the server to the client - <strong>always</strong> wrap those into interoperable SOAP faults. Check out the WCF <a href=""http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx"" rel=""noreferrer"">IErrorHandler</a> interface and implement it on the server side</p></li>
<li><p>if you're about to send a second message onto your channel from the client, make sure the channel is not in the faulted state:</p>

<pre><code>if(client.InnerChannel.State != System.ServiceModel.CommunicationState.Faulted)
{
   // call service - everything's fine
}
else
{
   // channel faulted - re-create your client and then try again
}
</code></pre>

<p>If it is, all you can do is dispose of it and re-create the client side proxy again and then try again</p></li>
</ul>
","2763679"
"Getting Http Status code number (200, 301, 404, etc.) from HttpWebRequest and HttpWebResponse","188276","","<p>I am trying to get the HTTP status code number from the <code>HttpWebResponse</code> object returned from a <code>HttpWebRequest</code>.  I was hoping to get the actual numbers (200, 301,302, 404, etc.)  rather than the text description. (""Ok"", ""MovedPermanently"", etc.)  Is the number buried in a property somewhere in the response object?  Any ideas other than creating a big switch function?  Thanks.   </p>

<pre><code>HttpWebRequest webRequest = (HttpWebRequest)WebRequest
                                           .Create(""http://www.gooogle.com/"");
webRequest.AllowAutoRedirect = false;
HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();
//Returns ""MovedPermanently"", not 301 which is what I want.
Console.Write(response.StatusCode.ToString());
</code></pre>
","<pre><code>Console.Write((int)response.StatusCode);
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/system.net.httpstatuscode.aspx"" rel=""noreferrer"">HttpStatusCode</a> (the type of <code>response.StatusCode</code>) is an enumeration where the values of the members match the HTTP status codes, e.g.</p>

<pre><code>public enum HttpStatusCode
{
    ...
    Moved = 301,
    OK = 200,
    Redirect = 302,
    ...
}
</code></pre>
","1330877"
"C# Creating and using Functions","188255","","<p>I need help with C# programming; I am new to it and I come from C background.  I have a Console Application like this:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Add_Function
{
   class Program
   {
      static void Main(string[] args)
      {
         int a;
         int b;
         int c;

         Console.WriteLine(""Enter value of 'a':"");
         a = Convert.ToInt32(Console.ReadLine());

         Console.WriteLine(""Enter value of 'b':"");
         b = Convert.ToInt32(Console.ReadLine());

         //why can't I not use it this way?
         c = Add(a, b);
         Console.WriteLine(""a + b = {0}"", c);
      }//END   Main

      public int Add(int x, int y)
      { 
         int result = x + y;
         return result;
      }//END   Add
   }//END      Program
}//END         Add_Function
</code></pre>

<p>It gives me this error on the line that I call Add():</p>

<blockquote>
  <p>An object reference is required for the non-static field, method, or property 'Add_Function.Program.Add(int, int)'</p>
</blockquote>

<p>Can anyone please explain to me why I have this problem.  Is this because the architecture of C# is different than C, and the way I call it is wrong?  Thanks.</p>
","<p><em>Note: in C# the term ""function"" is often replaced by the term ""method"". For the sake of this question there is no difference, so I'll just use the term ""function"".</em></p>

<p>The other answers have already given you a quick way to <em>fix</em> your problem (just make <code>Add</code> a <code>static</code> function), but I'd like to explain why.</p>

<p>C# has a fundamentally different design paradigm than C. That paradigm is called <strong>object-oriented programming</strong> (OOP). Explaining all the differences between OOP and functional programming is beyond the scope of this question, but here's the short version as it applies to you.</p>

<p>Writing your program in C, you would have created a function that adds two numbers, and that function would exist independently and be callable from anywhere. In C# most functions don't exist independently; instead, they exist in the context of an object. In your example code, only an instance (an object) of the class <code>Program</code> knows how to perform <code>Add</code>. Said another way, you have to create an instance of <code>Program</code>, and then ask <code>Program</code> to perform an <code>Add</code> for you.</p>

<p>The solutions that people gave you, using the <code>static</code> keyword, route around that design. Using the <code>static</code> keyword is kind of like saying, ""Hey, this function I'm defining doesn't need any context/state, it can just be called."" Since your <code>Add</code> function is very simple, this makes sense. As you start diving deeper into OOP, you're going to find that your functions get more complicated and rely on knowing their state/context.</p>

<p>My advice: Pick up an OOP book and get ready to switch your brain from functional programming to OOP programming. You're in for a ride.    </p>
","10175709"
"Load a WPF BitmapImage from a System.Drawing.Bitmap","187988","","<p>I have an instance of a <code>System.Drawing.Bitmap</code> and would like to make it available to my WPF app in the form of a <code>System.Windows.Media.Imaging.BitmapImage</code>.</p>

<p>What would be the best approach for this?</p>
","<p>Thanks to Hallgrim, here is the code I ended up with:</p>

<pre><code>ScreenCapture = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(
   bmp.GetHbitmap(), 
   IntPtr.Zero, 
   System.Windows.Int32Rect.Empty, 
   BitmapSizeOptions.FromWidthAndHeight(width, height));
</code></pre>

<p>I also ended up binding to a BitmapSource instead of a BitmapImage as in my original question</p>
","96470"
"Open file dialog and select a file using WPF controls and C#","187279","","<p>I have a <code>TextBox</code> named <code>textbox1</code> and a <code>Button</code> named <code>button1</code>.
When I click on <code>button1</code> I want to browse my files to search only for image files (type jpg, png, bmp...).
And when I select an image file and click Ok in the file dialog I want the file directory to be written in the <code>textbox1.text</code> like this:</p>

<pre><code>textbox1.Text = ""C:\myfolder\myimage.jpg""
</code></pre>
","<p>Something like that should be what you need</p>

<pre><code>private void button1_Click(object sender, RoutedEventArgs e)
{
    // Create OpenFileDialog 
    Microsoft.Win32.OpenFileDialog dlg = new Microsoft.Win32.OpenFileDialog();



    // Set filter for file extension and default file extension 
    dlg.DefaultExt = "".png"";
    dlg.Filter = ""JPEG Files (*.jpeg)|*.jpeg|PNG Files (*.png)|*.png|JPG Files (*.jpg)|*.jpg|GIF Files (*.gif)|*.gif""; 


    // Display OpenFileDialog by calling ShowDialog method 
    Nullable&lt;bool&gt; result = dlg.ShowDialog();


    // Get the selected file name and display in a TextBox 
    if (result == true)
    {
        // Open document 
        string filename = dlg.FileName;
        textBox1.Text = filename;
    }
}
</code></pre>
","10315283"
"How to hide a column (GridView) but still access its value?","186825","","<p>I have a GridView with a <code>DataSource</code> (SQL Database). I want to hide a column, but still be able to access the value when I select the record. Can someone show me how to do this?</p>

<p>This is the column I want to hide and still want to access its value:</p>

<pre><code>&lt;asp:BoundField DataField=""Outlook_ID"" HeaderText=""OutlookID"" /&gt;
</code></pre>

<p>I tried everything to hide the column (property <code>Visible=""false""</code>), but I can't access its value.</p>
","<p>If I am not mistaken, <code>GridView</code> does not hold the values of <code>BoundColumns</code> that have the attribute <code>visible=""false""</code>. Two things you may do here, one (as explained in the answer from V4Vendetta) to use <code>Datakeys</code>. Or you can change your <code>BoundColumn</code> to a <code>TemplateField</code>. And in the <code>ItemTemplate</code>, add a control like <code>Label</code>, make its visibility false and give your value to that <code>Label</code>. </p>
","5376393"
"XML Serialize generic list of serializable objects","186777","","<p>Can I serialize a generic list of serializable objects without having to specify their type.</p>

<p>Something like the intention behind the broken code below:</p>

<pre><code>List&lt;ISerializable&gt; serializableList = new List&lt;ISerializable&gt;();

XmlSerializer xmlSerializer = new XmlSerializer(serializableList.GetType());

serializableList.Add((ISerializable)PersonList);

using (StreamWriter streamWriter = System.IO.File.CreateText(fileName))
{
    xmlSerializer.Serialize(streamWriter, serializableList);
}
</code></pre>

<p>Edit:</p>

<p>For those who wanted to know detail: when I try to run this code, it errors on the XMLSerializer[...] line with:</p>

<p>Cannot serialize interface System.Runtime.Serialization.ISerializable.</p>

<p>If I change to <code>List&lt;object&gt;</code> I get <code>""There was an error generating the XML document.""</code>. The InnerException detail is <code>""{""The type System.Collections.Generic.List1[[Project1.Person, ConsoleFramework, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] may not be used in this context.""}""</code></p>

<p>The person object is defined as follows:</p>

<pre><code>[XmlRoot(""Person"")]
public class Person
{
    string _firstName = String.Empty;
    string _lastName = String.Empty;

    private Person()
    {
    }

    public Person(string lastName, string firstName)
    {
        _lastName = lastName;
        _firstName = firstName;
    }

    [XmlAttribute(DataType = ""string"", AttributeName = ""LastName"")]
    public string LastName
    {
        get { return _lastName; }
        set { _lastName = value; }
    }

    [XmlAttribute(DataType = ""string"", AttributeName = ""FirstName"")]
    public string FirstName
    {
        get { return _firstName; }
        set { _firstName = value; }
    }
}
</code></pre>

<p>The PersonList is just a <code>List&lt;Person&gt;</code> .</p>

<p>This is just for testing though, so didn't feel the details were too important. The key is I have one or more different objects, all of which are serializable. I want to serialize them all to one file. I thought the easiest way to do that would be to put them in a generic list and serialize the list in one go. But this doesn't work.</p>

<p>I tried with <code>List&lt;IXmlSerializable&gt;</code> as well, but that fails with</p>

<p><code>System.Xml.Serialization.IXmlSerializable cannot be serialized because it does not have a parameterless constructor.</code></p>

<p>Sorry for the lack of detail, but I am a beginner at this and don't know what detail is required. It would be helpful if people asking for more detail tried to respond in a way that would leave me understanding what details are required, or a basic answer outlining possible directions.</p>

<p>Also <strong>thanks</strong> to the two answers I've got so far - I could have spent a lot more time reading without getting these ideas. It's amazing how helpful people are on this site.</p>
","<p>I have an solution for a generic List&lt;> with dynamic binded items.</p>

<p>class PersonalList it's the root element</p>

<pre><code>[XmlRoot(""PersonenListe"")]
[XmlInclude(typeof(Person))] // include type class Person
public class PersonalList
{
    [XmlArray(""PersonenArray"")]
    [XmlArrayItem(""PersonObjekt"")]
    public List&lt;Person&gt; Persons = new List&lt;Person&gt;();

    [XmlElement(""Listname"")]
    public string Listname { get; set; }

    // Konstruktoren 
    public PersonalList() { }

    public PersonalList(string name)
    {
        this.Listname = name;
    }

    public void AddPerson(Person person)
    {
        Persons.Add(person);
    }
}
</code></pre>

<p>class Person it's an single list element </p>

<pre><code>[XmlType(""Person"")] // define Type
[XmlInclude(typeof(SpecialPerson)), XmlInclude(typeof(SuperPerson))]  
        // include type class SpecialPerson and class SuperPerson
public class Person
{
    [XmlAttribute(""PersID"", DataType = ""string"")]
    public string ID { get; set; }

    [XmlElement(""Name"")]
    public string Name { get; set; }

    [XmlElement(""City"")]
    public string City { get; set; }

    [XmlElement(""Age"")]
    public int Age { get; set; }

    // Konstruktoren 
    public Person() { }

    public Person(string name, string city, int age, string id)
    {
        this.Name = name;
        this.City = city;
        this.Age = age;
        this.ID = id;
    }
}
</code></pre>

<p>class SpecialPerson inherits Person</p>

<pre><code>[XmlType(""SpecialPerson"")] // define Type
public class SpecialPerson : Person
{
    [XmlElement(""SpecialInterests"")]
    public string Interests { get; set; }

    public SpecialPerson() { }

    public SpecialPerson(string name, string city, int age, string id, string interests)
    {
        this.Name = name;
        this.City = city;
        this.Age = age;
        this.ID = id;
        this.Interests = interests;
    }
}
</code></pre>

<p>class SuperPerson inherits Person</p>

<pre><code>[XmlType(""SuperPerson"")] // define Type
public class SuperPerson : Person
{
    [XmlArray(""Skills"")]
    [XmlArrayItem(""Skill"")]
    public List&lt;String&gt; Skills { get; set; }

    [XmlElement(""Alias"")]
    public string Alias { get; set; }

    public SuperPerson() 
    {
        Skills = new List&lt;String&gt;();
    }

    public SuperPerson(string name, string city, int age, string id, string[] skills, string alias)
    {
        Skills = new List&lt;String&gt;();

        this.Name = name;
        this.City = city;
        this.Age = age;
        this.ID = id;
        foreach (string item in skills)
        {
            this.Skills.Add(item);   
        }
        this.Alias = alias;
    }
}
</code></pre>

<p>and the main test Source</p>

<pre><code>static void Main(string[] args)
{
    PersonalList personen = new PersonalList(); 
    personen.Listname = ""Friends"";

    // normal person
    Person normPerson = new Person();
    normPerson.ID = ""0"";
    normPerson.Name = ""Max Man"";
    normPerson.City = ""Capitol City"";
    normPerson.Age = 33;

    // special person
    SpecialPerson specPerson = new SpecialPerson();
    specPerson.ID = ""1"";
    specPerson.Name = ""Albert Einstein"";
    specPerson.City = ""Ulm"";
    specPerson.Age = 36;
    specPerson.Interests = ""Physics"";

    // super person
    SuperPerson supPerson = new SuperPerson();
    supPerson.ID = ""2"";
    supPerson.Name = ""Superman"";
    supPerson.Alias = ""Clark Kent"";
    supPerson.City = ""Metropolis"";
    supPerson.Age = int.MaxValue;
    supPerson.Skills.Add(""fly"");
    supPerson.Skills.Add(""strong"");

    // Add Persons
    personen.AddPerson(normPerson);
    personen.AddPerson(specPerson);
    personen.AddPerson(supPerson);

    // Serialize 
    Type[] personTypes = { typeof(Person), typeof(SpecialPerson), typeof(SuperPerson) };
    XmlSerializer serializer = new XmlSerializer(typeof(PersonalList), personTypes); 
    FileStream fs = new FileStream(""Personenliste.xml"", FileMode.Create); 
    serializer.Serialize(fs, personen); 
    fs.Close(); 
    personen = null;

    // Deserialize 
    fs = new FileStream(""Personenliste.xml"", FileMode.Open); 
    personen = (PersonalList)serializer.Deserialize(fs); 
    serializer.Serialize(Console.Out, personen);
    Console.ReadLine();
}
</code></pre>

<p>Important is the definition and includes of the diffrent types.</p>
","5117809"
"how to put focus on TextBox when the form load?","186734","","<p>I have in my C# program textBox</p>

<p>I need that when the program start, the focus will be on the textBox</p>

<p>I try this on Form_Load:</p>

<pre><code>MyTextBox.Focus();
</code></pre>

<p>but it wont work</p>
","<p>Set the<code>ActiveControl</code> property of the form and you should be fine.</p>

<pre><code>this.ActiveControl = yourtextboxname;
</code></pre>
","6597309"
"display messagebox in asp.net","186702","","<p>For displaying message box on sucessfull save of any item i wanted to show messagebox.</p>

<p>I googled it and tried different codes but none of them worked.</p>

<p><strong>Currently my code is:</strong></p>

<pre><code>try
{
    con.Open();
    string pass=""abc"";
    cmd = new SqlCommand(""insert into register values('"" + 
                                       txtName.Text + ""','"" + 
                                       txtEmail.Text + ""','"" + 
                                       txtPhoneNumber.Text + ""','"" + 
                                       ddlUserType.SelectedText + ""','"" + 
                                       pass + ""')"", con);

    cmd.ExecuteNonQuery();
    con.Close();
    Response.Write(""&lt;script LANGUAGE='JavaScript' &gt;alert('Login Successful')&lt;/script&gt;"");
}
catch (Exception ex)
{

}
finally
{
    con.Close();
}
</code></pre>

<p>Its not working. Kindly guid me with the messagebox code.</p>

<p><em>I am using Mozilla browser.</em></p>
","<p>@freelancer If you are using ScriptManager then try this code for message..</p>

<pre><code>string script = ""alert(\""Hello!\"");"";
ScriptManager.RegisterStartupScript(this, GetType(), 
                      ""ServerControlScript"", script, true);
</code></pre>
","15198207"
"Getting selected value of a combobox","186509","","<pre><code>public class ComboboxItem { 
            public string Text { get; set; } 
            public string Value { get; set; }
            public override string ToString() { return Text; } 
        }

private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            int selectedIndex = comboBox1.SelectedIndex;
            int selecteVal = (int)comboBox1.SelectedValue; 
            ComboboxItem selectedCar = (ComboboxItem)comboBox1.SelectedItem;
            MessageBox.Show(String.Format(""Index: [{0}] CarName={1}; Value={2}"", selectedIndex, selectedCar.Text, selecteVal));
        }
</code></pre>

<p>I'm adding them like:</p>

<pre><code>ComboboxItem item = new ComboboxItem();
                    item.Text = cd.Name;
                    item.Value = cd.ID;
                    this.comboBox1.Items.Add(item);
</code></pre>

<p>I keep getting a NullReferenceExeption and not sure why. the text seems to show up just fine.</p>
","<p>Try this:</p>

<pre><code>private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    ComboBox cmb = (ComboBox)sender;
    int selectedIndex = cmb.SelectedIndex;
    int selectedValue = (int)cmb.SelectedValue;

    ComboboxItem selectedCar = (ComboboxItem)cmb.SelectedItem;
    MessageBox.Show(String.Format(""Index: [{0}] CarName={1}; Value={2}"", selectedIndex, selectedCar.Text, selecteVal));        
}
</code></pre>
","6901118"
"Automatic vertical scroll bar in WPF TextBlock?","186436","","<p>I have a <code>TextBlock</code> in WPF. I write many lines to it, far exceeding its vertical height. I expected a vertical scroll bar to appear automatically when that happens, but it didn't. I tried to look for a scroll bar property in the Properties pane, but could not find one.</p>

<p>How can I make vertical scroll bar created automatically for my <code>TextBlock</code> once its contents exceed its height?</p>

<p>Clarification: I would rather do it from the designer and not by directly writing to the XAML.</p>
","<p>Wrap it in a scroll viewer:</p>

<pre><code>&lt;ScrollViewer&gt;
    &lt;TextBlock /&gt;
&lt;/ScrollViewer&gt;
</code></pre>

<p><strong>NOTE</strong> this answer applies to a <code>TextBlock</code> (a read-only text element) as asked for in the original question.</p>

<p>If you want to show scroll bars in a <code>TextBox</code> (an editable text element) then use the <code>ScrollViewer</code> attached properties:</p>

<pre><code>&lt;TextBox ScrollViewer.HorizontalScrollBarVisibility=""Disabled""
         ScrollViewer.VerticalScrollBarVisibility=""Auto"" /&gt;
</code></pre>

<p>Valid values for these two properties are <code>Disabled</code>, <code>Auto</code>, <code>Hidden</code> and <code>Visible</code>.</p>
","1192349"
"Unzip files programmatically in .net","185964","","<p>I am trying to programatically unzip a zipped file.</p>

<p>I have tried using the <code>System.IO.Compression.GZipStream</code> class in .NET, but when my app runs (actually a unit test) I get this exception: </p>

<blockquote>
  <p>System.IO.InvalidDataException: The magic number in GZip header is not correct. Make sure you are passing in a GZip stream..</p>
</blockquote>

<p>I now realize that a <code>.zip</code> file is not the same as a <code>.gz</code> file, and that <code>GZip</code> is not the same as <code>Zip</code>. </p>

<p>However, since I'm able to extract the file by manually double clicking the zipped file and then clicking the ""Extract all files""-button, I think there should be a way of doing that in code as well. </p>

<p>Therefore I've tried to use <code>Process.Start()</code> with the path to the zipped file as input. This causes my app to open a Window showing the contents in the zipped file. That's all fine, but the app will be installed on a server with none around to click the ""Extract all files""-button. </p>

<p>So, how do I get my app to extract the files in the zipped files?</p>

<p>Or is there another way to do it? I prefer doing it in code, without downloading any third party libraries or apps; the security department ain't too fancy about that...</p>
","<p>We have used <a href=""http://www.icsharpcode.net/OpenSource/SharpZipLib/"" rel=""noreferrer"">SharpZipLib</a> successfully on many projects. I know it's a third party tool, but source code is included and could provide some insight if you chose to reinvent the wheel here.</p>
","837035"
"Difference between ""\n"" and Environment.NewLine","185884","","<p>What is the difference between two, if any (with respect to .Net)?</p>
","<p>Depends on the platform. On Windows it is actually ""\r\n"".</p>

<p>From MSDN:</p>

<blockquote>
  <p>A string containing ""\r\n"" for
  non-Unix platforms, or a string
  containing ""\n"" for Unix platforms.</p>
</blockquote>
","1015771"
"Insert a new row into DataTable","185728","","<p>I have a datatable filled with staff data like..</p>

<pre><code>Staff 1 - Day 1 - Total
Staff 1 - Day 2 - Total
Staff 1 - Day 3 - Total
Staff 2 - Day 1 - Total
Staff 2 - Day 2 - Total
Staff 2 - Day 3 - Total
Staff 2 - Day 4 - Total
</code></pre>

<p>I want to modify so that the result would be sth like..</p>

<pre><code>Staff 1 - Day 1 - Total
Staff 1 - Day 2 - Total
Staff 1 - Day 3 - Total
Total   -       - Total Value
Staff 2 - Day 1 - Total
Staff 2 - Day 2 - Total
Staff 2 - Day 3 - Total
Staff 2 - Day 4 - Total
Total   -       - Total Value
</code></pre>

<p>to be concluded, I need to insert the total row at the end of each staff record.</p>

<p>So, my question is how to insert a row into a datatable? Tkz..</p>
","<pre><code>// get the data table
DataTable dt = ...;

// generate the data you want to insert
DataRow toInsert = dt.NewRow();

// insert in the desired place
dt.Rows.InsertAt(toInsert, index);
</code></pre>
","4731638"
"Linq select objects in list where exists IN (A,B,C)","185649","","<p>I have a list of <code>orders</code>.<br>
I want to select <code>orders</code> based on a set of order statuses.</p>

<p>So essentially <code>select orders where order.StatusCode in (""A"", ""B"", ""C"")</code></p>

<pre><code>// Filter the orders based on the order status
var filteredOrders = from order in orders.Order
                     where order.StatusCode.????????(""A"", ""B"", ""C"")
                     select order;
</code></pre>

<p>Many thanks.</p>
","<p>Your status-codes are also a collection, so use <a href=""http://msdn.microsoft.com/en-us/library/bb352880.aspx"" rel=""noreferrer""><code>Contains</code></a>:</p>

<pre><code>var allowedStatus = new[]{ ""A"", ""B"", ""C"" };
var filteredOrders = orders.Order.Where(o =&gt; allowedStatus.Contains(o.StatusCode));
</code></pre>

<p>or in query syntax:</p>

<pre><code>var filteredOrders = from order in orders.Order
                     where allowedStatus.Contains(order.StatusCode)
                     select order;
</code></pre>
","14257379"
"Set object property using reflection","185336","","<p>Is there a way in C# 3.5 where I can use reflection to set an object property?</p>

<p>Ex:</p>

<pre><code>MyObject obj = new MyObject();
obj.Name = ""Value"";
</code></pre>

<p>I want to set <code>obj.Name</code> with reflection. Something like:</p>

<pre><code>Reflection.SetProperty(obj, ""Name"") = ""Value"";
</code></pre>

<p>Is there a way of doing this?</p>
","<p>Yes, you can use <code>Type.InvokeMember()</code>:</p>

<pre><code>using System.Reflection;
MyObject obj = new MyObject();
obj.GetType().InvokeMember(""Name"",
    BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
    Type.DefaultBinder, obj, ""Value"");
</code></pre>

<p>This will throw an exception if <code>obj</code> doesn't have a property called <code>Name</code>, or it can't be set.</p>

<p>Another approach is to get the metadata for the property, and then set it. This will allow you to check for the existence of the property, and verify that it can be set:</p>

<pre><code>using System.Reflection;
MyObject obj = new MyObject();
PropertyInfo prop = obj.GetType().GetProperty(""Name"", BindingFlags.Public | BindingFlags.Instance);
if(null != prop &amp;&amp; prop.CanWrite)
{
    prop.SetValue(obj, ""Value"", null);
}
</code></pre>
","619778"
"Reflection - get attribute name and value on property","185328","","<p>I have a class, lets call it Book with a property called Name. With that property, I have an attribute associated with it.</p>

<pre><code>public class Book
{
    [Author(""AuthorName"")]
    public string Name
    {
        get; private set; 
    }
}
</code></pre>

<p>In my main method, I'm using reflection and wish to get key value pair of each attribute for each property. So in this example, I'd expect to see ""Author"" for attribute name and ""AuthorName"" for the attribute value.</p>

<p>Question: How do I get the attribute name and value on my properties using Reflection?</p>
","<p>Use <code>typeof(Book).GetProperties()</code> to get an array of <code>PropertyInfo</code> instances.  Then use <code>GetCustomAttribute()</code> on each <code>PropertyInfo</code> to see if any of them have the <code>Author</code> Attribute type.  If they do, you can get the name of the property from the property info and the attribute values from the attribute.</p>

<p>Something along these lines to scan a type for properties that have a specific attribute type and to return data in a dictionary (note that this can be made more dynamic by passing types into the routine):</p>

<pre><code>public static Dictionary&lt;string, string&gt; GetAuthors()
{
    Dictionary&lt;string, string&gt; _dict = new Dictionary&lt;string, string&gt;();

    PropertyInfo[] props = typeof(Book).GetProperties();
    foreach (PropertyInfo prop in props)
    {
        object[] attrs = prop.GetCustomAttributes(true);
        foreach (object attr in attrs)
        {
            AuthorAttribute authAttr = attr as AuthorAttribute;
            if (authAttr != null)
            {
                string propName = prop.Name;
                string auth = authAttr.Name;

                _dict.Add(propName, auth);
            }
        }
    }

    return _dict;
}
</code></pre>
","6637710"
"Convert XmlDocument to String","185270","","<p>Here is how I'm currently converting <strong>XMLDocument</strong> to <strong>String</strong></p>

<pre><code>StringWriter stringWriter = new StringWriter();
XmlTextWriter xmlTextWriter = new XmlTextWriter(stringWriter);

xmlDoc.WriteTo(xmlTextWriter);

return stringWriter.ToString();
</code></pre>

<p>The problem with this method is that if I have <strong>""</strong> ((quotes) which I have in attributes) it escapes them.</p>

<p>For Instance:</p>

<pre><code>&lt;Campaign name=""ABC""&gt;
&lt;/Campaign&gt;
</code></pre>

<p>Above is the expected XML. But it returns</p>

<pre><code>&lt;Campaign name=\""ABC\""&gt;
&lt;/Campaign&gt;
</code></pre>

<p>I can do <strong>String.Replace ""\""</strong> but is that method okay? Are there any side-effects? Will it work fine if the XML itself contains a <strong>""\""</strong></p>
","<p>There aren't any quotes. It's just VS debugger. Try printing to the console or saving to a file and you'll see. As a side note: always dispose disposable objects:</p>

<pre><code>using (var stringWriter = new StringWriter())
using (var xmlTextWriter = XmlWriter.Create(stringWriter))
{
    xmlDoc.WriteTo(xmlTextWriter);
    xmlTextWriter.Flush();
    return stringWriter.GetStringBuilder().ToString();
}
</code></pre>
","2407313"
"How do I get the list of keys in a dictionary?","185255","","<p>I never gotten any code I tried to work.</p>

<p>I want the keys and not the values (yet). Using another array proved to be too much work as I use remove also.</p>
","<pre><code>List&lt;string&gt; keyList = new List&lt;string&gt;(this.yourDictionary.Keys);
</code></pre>
","1276792"
"How to use LINQ to select object with minimum or maximum property value","184965","","<p>I have a Person object with a Nullable DateOfBirth property.  Is there a way to use LINQ to query a list of Person objects for the one with the earliest/smallest DateOfBirth value.</p>

<p>Here's what I started with:</p>

<pre><code>var firstBornDate = People.Min(p =&gt; p.DateOfBirth.GetValueOrDefault(DateTime.MaxValue));
</code></pre>

<p>Null DateOfBirth values are set to DateTime.MaxValue in order to rule them out of the Min consideration (assuming at least one has a specified DOB).</p>

<p>But all that does for me is to set firstBornDate to a DateTime value.  What I'd like to get is the Person object that matches that.  Do I need to write a second query like so:</p>

<pre><code>var firstBorn = People.Single(p=&gt; (p.DateOfBirth ?? DateTime.MaxValue) == firstBornDate);
</code></pre>

<p>Or is there a leaner way of doing it?</p>
","<pre><code>People.Aggregate((curMin, x) =&gt; (curMin == null || (x.DateOfBirth ?? DateTime.MaxValue) &lt;
    curMin.DateOfBirth ? x : curMin))
</code></pre>
","914155"
"Get Cell Value from a DataTable in C#","184869","","<p>Here is a <strong>DataTable dt</strong>, which has lots of data. </p>

<p>I want to get the specific <strong>Cell Value</strong> from the DataTable, say <strong>Cell[i,j]</strong>. Where, 
i -> Rows and j -> Columns. I will iterate i,j's value with two <code>forloops</code>.</p>

<p>But I can't figure out how I can call a cell by its index.</p>

<p>Here's the code: </p>

<pre><code>for (i = 0; i &lt;= dt.Rows.Count - 1; i++)
        {
            for (j = 0; j &lt;= dt.Columns.Count - 1; j++)
            {
                var cell = dt.Rows[i][j];
                xlWorkSheet.Cells[i + 1, j + 1] = cell;
            }
        }
</code></pre>
","<p>The <code>DataRow</code> has also an <a href=""http://msdn.microsoft.com/en-us/library/kwfe1t7z.aspx"" rel=""noreferrer"">indexer</a>:</p>

<pre><code>Object cellValue = dt.Rows[i][j];
</code></pre>

<p>But i would prefer the strongly typed <a href=""http://msdn.microsoft.com/en-us/library/bb360891.aspx"" rel=""noreferrer""><code>Field</code></a> extension method which also supports <a href=""http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.110%29.aspx"" rel=""noreferrer"">nullable types</a>:</p>

<pre><code>int number = dt.Rows[i].Field&lt;int&gt;(j);
</code></pre>

<p>or even more readable and less error-prone with the name of the column:</p>

<pre><code>double otherNumber = dt.Rows[i].Field&lt;double&gt;(""DoubleColumn"");
</code></pre>
","13816531"
"What is the difference between C# and .NET?","184803","","<p>May I know what is the difference between C# and .NET? When I think of C#, right away I would say it is a .NET language, but when I search for job posts, they require candidates to have C# and .NET experience. Can someone give me an explanation?</p>
","<p>In addition to what Andrew said, it is worth noting that:</p>

<ul>
<li>.NET isn't just a <strong>library</strong>, but also a <strong>runtime</strong> for executing applications.</li>
<li>The knowledge of C# implies some knowledge of .NET (because the C# object model corresponds to the .NET object model and you can do something interesting in C# just by using .NET libraries). The opposite isn't necessarily true as you can use other languages to write .NET applications.</li>
</ul>

<p>The distinction between a <em>language</em>, a <em>runtime</em>, and a <em>library</em> is more strict in .NET/C# than for example in C++, where the language specification also includes some basic library functions. The C# specification says only a very little about the environment (basically, that it should contain some types such as <code>int</code>, but that's more or less all).</p>
","2724907"
"LINQ with groupby and count","184595","","<p>This is pretty simple but I'm at a loss:
Given this type of data set:</p>

<pre><code>UserInfo(name, metric, day, other_metric)
</code></pre>

<p>and this sample data set:</p>

<pre><code>joe  1 01/01/2011 5
jane 0 01/02/2011 9
john 2 01/03/2011 0
jim  3 01/04/2011 1
jean 1 01/05/2011 3
jill 2 01/06/2011 5
jeb  0 01/07/2011 3
jenn 0 01/08/2011 7
</code></pre>

<p>I'd like to retrieve a table that lists metrics in order(0,1,2,3..) with the total number of times the count occurs. So from this set you'd end up with:</p>

<pre><code>0 3    
1 2    
2 2    
3 1
</code></pre>

<p>I'm grappling with the LINQ syntax but am stuck on where to put a groupby and count....
any help??</p>

<p>POST Edit: I was never able to get the posted answers to work as they always returned one record with the number of different counts. However I was able to put together a LINQ to SQL example that did work:</p>

<pre><code>        var pl = from r in info
                 orderby r.metric    
                 group r by r.metric into grp
                 select new { key = grp.Key, cnt = grp.Count()};
</code></pre>

<p>This result gave me an ordered set of records with 'metrics' and the number of users associated with each. I'm clearly new to LINQ in general and to my untrained eye this approach seems very similar to the pure LINQ approach yet gave me a different answer.</p>
","<p>After calling <code>GroupBy</code>, you get a series of groups <code>IEnumerable&lt;Grouping&gt;</code>, where each Grouping itself exposes the <code>Key</code> used to create the group and also is an <code>IEnumerable&lt;T&gt;</code> of whatever items are in your original data set. You just have to call <code>Count()</code> on that Grouping to get the subtotal.</p>

<pre><code>foreach(var line in data.GroupBy(info =&gt; info.metric)
                        .Select(group =&gt; new { 
                             Metric = group.Key, 
                             Count = group.Count() 
                        })
                        .OrderBy(x =&gt; x.Metric)
{
     Console.WriteLine(""{0} {1}"", line.Metric, line.Count);
}
</code></pre>

<p><hr /></p>

<blockquote>
  <p>This was a brilliantly quick reply but I'm having a bit of an issue with the first line, specifically ""data.groupby(info=>info.metric)""</p>
</blockquote>

<p>I'm assuming you already have a list/array of some <code>class</code> that looks like</p>

<pre><code>class UserInfo {
    string name;
    int metric;
    ..etc..
} 
...
List&lt;UserInfo&gt; data = ..... ;
</code></pre>

<p>When you do <code>data.GroupBy(x =&gt; x.metric)</code>, it means ""for each element <code>x</code> in the IEnumerable defined by <code>data</code>, calculate it's <code>.metric</code>, then group all the elements with the same metric into a <code>Grouping</code> and return an <code>IEnumerable</code> of all the resulting groups. Given your example data set of </p>

<pre><code>    &lt;DATA&gt;           | Grouping Key (x=&gt;x.metric) |
joe  1 01/01/2011 5  | 1
jane 0 01/02/2011 9  | 0
john 2 01/03/2011 0  | 2
jim  3 01/04/2011 1  | 3
jean 1 01/05/2011 3  | 1
jill 2 01/06/2011 5  | 2
jeb  0 01/07/2011 3  | 0
jenn 0 01/08/2011 7  | 0
</code></pre>

<p>it would result in the following result after the groupby:</p>

<pre><code>(Group 1): [joe  1 01/01/2011 5, jean 1 01/05/2011 3]
(Group 0): [jane 0 01/02/2011 9, jeb  0 01/07/2011 3, jenn 0 01/08/2011 7]
(Group 2): [john 2 01/03/2011 0, jill 2 01/06/2011 5]
(Group 3): [jim  3 01/04/2011 1]
</code></pre>
","7285770"
"Best implementation for Key Value Pair Data Structure?","184141","","<p>So I've been poking around with C# a bit lately, and all the Generic Collections have me a little confused. Say I wanted to represent a data structure where the head of a tree was a key value pair, and then there is one optional list of key value pairs below that (but no more levels than these). Would this be suitable?</p>

<pre><code>public class TokenTree
{
    public TokenTree()
    {
        /* I must admit to not fully understanding this,
         * I got it from msdn. As far as I can tell, IDictionary is an
         * interface, and Dictionary is the default implementation of
         * that interface, right?
         */
        SubPairs = new Dictionary&lt;string, string&gt;();
    }

    public string Key;
    public string Value;
    public IDictionary&lt;string, string&gt; SubPairs;
}
</code></pre>

<p>It's only really a simple shunt for passing around data.</p>
","<p>There is an actual Data Type called KeyValuePair, use like this</p>

<pre><code>KeyValuePair&lt;string, string&gt; myKeyValuePair = new KeyValuePair&lt;string,string&gt;(""defaultkey"", ""defaultvalue"");
</code></pre>
","8811"
"Java equivalent to #region in c#","183906","","<p>I want to use regions for code folding in <strong>Eclipse</strong>; how can that be done in Java?</p>

<p>An example usage in <a href=""https://msdn.microsoft.com/en-us/library/9a1ybwek.aspx"" rel=""noreferrer"">C#</a>:</p>

<pre><code>#region name
//code
#endregion
</code></pre>
","<p>There's no such <em>standard</em> equivalent. Some IDEs - Intellij, for instance, or Eclipse - can fold depending on the code types involved (constructors, imports etc.), but there's nothing quite like <code>#region</code>.</p>
","2344560"
"C# - Fill a combo box with a DataTable","183824","","<p>I'm used to work with Java where large amounts of examples are available. For various reasons I had to switch to C# and trying to do the following in SharpDevelop:</p>

<pre><code>// Form has a menu containing a combobox added via SharpDevelop's GUI

// --- Variables
languages = new string[2];
languages[0] = ""English"";
languages[1] = ""German"";
DataSet myDataSet = new DataSet();

// --- Preparation
DataTable lTable = new DataTable(""Lang"");
DataColumn lName = new DataColumn(""Language"", typeof(string));
lTable.Columns.Add( lName );
for( int i=0; i&lt;languages.Length; i++ ) {
    DataRow lLang = lTable.NewRow();
    lLang[""Language""] = languages[i];
    lTable.Rows.Add(lLang);
}
myDataSet.Tables.Add(lTable);

// --- Handling the combobox
mnuActionLanguage.ComboBox.DataSource = myDataSet.Tables[""Lang""].DefaultView;
mnuActionLanguage.ComboBox.DisplayMember = ""Language"";
</code></pre>

<p>One would assume to see some values in the dropdown, but it's empty. Please tell me what I'm doing wrong ;(</p>

<p><em>EDIT:
mnuActionLanguage.ComboBox.DataBind() is what I also found on the net, but it doesn't work in my case.</em></p>

<p><strong>SOLUTION</strong></p>

<pre><code>mnuActionLanguage.ComboBox.BindingContext = this.BindingContext;
</code></pre>

<p>at the end solved the problem!</p>
","<p>You need to set the binding context of the ToolStripComboBox.ComboBox.</p>

<p>Here is a slightly modified version of the code that I have just recreated using Visual Studio. The menu item combo box is called toolStripComboBox1 in my case. Note the last line of code to set the binding context.</p>

<p>I noticed that if the combo is in the visible are of the toolstrip, the binding works without this but not when it is in a drop-down. Do you get the same problem?</p>

<p>If you can't get this working, drop me a line via my contact page and I will send you the project. You won't be able to load it using SharpDevelop but will with C# Express.</p>

<pre><code>var languages = new string[2];
languages[0] = ""English"";
languages[1] = ""German"";

DataSet myDataSet = new DataSet();

// --- Preparation
DataTable lTable = new DataTable(""Lang"");
DataColumn lName = new DataColumn(""Language"", typeof(string));
lTable.Columns.Add(lName);

for (int i = 0; i &lt; languages.Length; i++)
{
    DataRow lLang = lTable.NewRow();
    lLang[""Language""] = languages[i];
    lTable.Rows.Add(lLang);
}
myDataSet.Tables.Add(lTable);

toolStripComboBox1.ComboBox.DataSource = myDataSet.Tables[""Lang""].DefaultView;
toolStripComboBox1.ComboBox.DisplayMember = ""Language"";

toolStripComboBox1.ComboBox.BindingContext = this.BindingContext;
</code></pre>
","256871"
"Converting string format to datetime in mm/dd/yyyy","183787","","<p>I have to convert string in mm/dd/yyyy format to datetime variable but it should remain in mm/dd/yyyy format.</p>

<pre><code>string strDate = DateTime.Now.ToString(""MM/dd/yyyy"");
</code></pre>

<p>Please help.</p>
","<p>You are looking for the <code>DateTime.Parse()</code> method (<a href=""http://msdn.microsoft.com/en-us/library/1k1skd40.aspx"" rel=""noreferrer"">MSDN Article</a>)</p>

<p>So you can do:</p>

<pre><code>var dateTime = DateTime.Parse(""01/01/2001"");
</code></pre>

<p>Which will give you a <code>DateTime</code> typed object.</p>

<p>If you need to specify which date format you want to use, you would use <code>DateTime.ParseExact</code> (<a href=""http://msdn.microsoft.com/en-us/library/332de853.aspx"" rel=""noreferrer"">MSDN Article</a>)</p>

<p>Which you would use in a situation like this (Where you are using a British style date format):</p>

<pre><code>string[] formats= { ""dd/MM/yyyy"" }
var dateTime = DateTime.ParseExact(""01/01/2001"", formats, new CultureInfo(""en-US""), DateTimeStyles.None);
</code></pre>
","10043208"
"C# declare empty string array","183740","","<p>I need to declare an empty string array and i'm using this code</p>

<pre><code>string[] arr = new String[0]();
</code></pre>

<p>but i get ""method name expected"" error.</p>

<p>What's wrong?</p>

<p>Thanks</p>
","<p>Try this</p>

<pre><code>string[] arr = new string[] {};
</code></pre>
","16834388"
"How to implement custom JsonConverter in JSON.NET to deserialize a List of base class objects?","183735","","<p>I am trying to extend the JSON.net example given here 
<a href=""http://james.newtonking.com/projects/json/help/CustomCreationConverter.html"" rel=""noreferrer"">http://james.newtonking.com/projects/json/help/CustomCreationConverter.html</a></p>

<p>I have another sub class deriving from base class/Interface</p>

<pre><code>public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

public class Employee : Person
{
    public string Department { get; set; }
    public string JobTitle { get; set; }
}

public class Artist : Person
{
    public string Skill { get; set; }
}

List&lt;Person&gt; people  = new List&lt;Person&gt;
{
    new Employee(),
    new Employee(),
    new Artist(),
};
</code></pre>

<p>How do I deserialize following Json back to List&lt; Person ></p>

<pre><code>[
  {
    ""Department"": ""Department1"",
    ""JobTitle"": ""JobTitle1"",
    ""FirstName"": ""FirstName1"",
    ""LastName"": ""LastName1""
  },
  {
    ""Department"": ""Department2"",
    ""JobTitle"": ""JobTitle2"",
    ""FirstName"": ""FirstName2"",
    ""LastName"": ""LastName2""
  },
  {
    ""Skill"": ""Painter"",
    ""FirstName"": ""FirstName3"",
    ""LastName"": ""LastName3""
  }
]
</code></pre>

<p>I don't want to use TypeNameHandling JsonSerializerSettings. I am specifically looking for custom JsonConverter implementation to handle this. The documentation and examples around this are pretty sparse on the net. I can't seem to get the the overridden ReadJson() method implementation in JsonConverter right.</p>
","<p>Using the standard <code>CustomCreationConverter</code>, I was struggling to work how to generate the correct type (<code>Person</code> or <code>Employee</code>), because in order to determine this you need to analyse the JSON and there is no built in way to do this using the <code>Create</code> method.</p>

<p>I found a discussion thread pertaining to type conversion and it turned out to provide the answer. Here is a link: <a href=""http://json.codeplex.com/discussions/56031"" rel=""noreferrer"">Type converting</a>.</p>

<p>What's required is to subclass <code>JsonConverter</code>, overriding the <code>ReadJson</code> method and creating a new abstract <code>Create</code> method which accepts a <code>JObject</code>.</p>

<blockquote>
  <p>The JObject class provides a means to load a JSON object and
  provides access to the data within this object.</p>
</blockquote>

<p>The overridden <code>ReadJson</code> method creates a <code>JObject</code> and invokes the <code>Create</code> method (implemented by our derived converter class), passing in the <code>JObject</code> instance.</p>

<p>This <code>JObject</code> instance can then be analysed to determine the correct type by checking existence of certain fields.</p>

<p><strong>Example</strong></p>

<pre><code>string json = ""[{
        \""Department\"": \""Department1\"",
        \""JobTitle\"": \""JobTitle1\"",
        \""FirstName\"": \""FirstName1\"",
        \""LastName\"": \""LastName1\""
    },{
        \""Department\"": \""Department2\"",
        \""JobTitle\"": \""JobTitle2\"",
        \""FirstName\"": \""FirstName2\"",
        \""LastName\"": \""LastName2\""
    },
        {\""Skill\"": \""Painter\"",
        \""FirstName\"": \""FirstName3\"",
        \""LastName\"": \""LastName3\""
    }]"";

List&lt;Person&gt; persons = 
    JsonConvert.DeserializeObject&lt;List&lt;Person&gt;&gt;(json, new PersonConverter());

...

public class PersonConverter : JsonCreationConverter&lt;Person&gt;
{
    protected override Person Create(Type objectType, JObject jObject)
    {
        if (FieldExists(""Skill"", jObject))
        {
            return new Artist();
        }
        else if (FieldExists(""Department"", jObject))
        {
            return new Employee();
        }
        else
        {
            return new Person();
        }
    }

    private bool FieldExists(string fieldName, JObject jObject)
    {
        return jObject[fieldName] != null;
    }
}

public abstract class JsonCreationConverter&lt;T&gt; : JsonConverter
{
    /// &lt;summary&gt;
    /// Create an instance of objectType, based properties in the JSON object
    /// &lt;/summary&gt;
    /// &lt;param name=""objectType""&gt;type of object expected&lt;/param&gt;
    /// &lt;param name=""jObject""&gt;
    /// contents of JSON object that will be deserialized
    /// &lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    protected abstract T Create(Type objectType, JObject jObject);

    public override bool CanConvert(Type objectType)
    {
        return typeof(T).IsAssignableFrom(objectType);
    }

    public override bool CanWrite
    {
        get { return false; }
    }

    public override object ReadJson(JsonReader reader, 
                                    Type objectType, 
                                     object existingValue, 
                                     JsonSerializer serializer)
    {
        // Load JObject from stream
        JObject jObject = JObject.Load(reader);

        // Create target object based on JObject
        T target = Create(objectType, jObject);

        // Populate the object properties
        serializer.Populate(jObject.CreateReader(), target);

        return target;
    }
}
</code></pre>
","8031283"
"How do I use reflection to call a generic method?","183684","","<p>What's the best way to call a generic method when the type parameter isn't known at compile time, but instead is obtained dynamically at runtime?</p>

<p>Consider the following sample code - inside the <code>Example()</code> method, what's the most concise way to invoke <code>GenericMethod&lt;T&gt;()</code> using the <code>Type</code> stored in the <code>myType</code> variable?</p>

<pre><code>public class Sample
{
    public void Example(string typeName)
    {
        Type myType = FindType(typeName);

        // What goes here to call GenericMethod&lt;T&gt;()?
        GenericMethod&lt;myType&gt;(); // This doesn't work

        // What changes to call StaticMethod&lt;T&gt;()?
        Sample.StaticMethod&lt;myType&gt;(); // This also doesn't work
    }

    public void GenericMethod&lt;T&gt;()
    {
        // ...
    }

    public static void StaticMethod&lt;T&gt;()
    {
        //...
    }
}
</code></pre>
","<p>You need to use reflection to get the method to start with, then ""construct"" it by supplying type arguments with <a href=""http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx"" rel=""noreferrer"">MakeGenericMethod</a>:</p>

<pre><code>MethodInfo method = typeof(Sample).GetMethod(""GenericMethod"");
MethodInfo generic = method.MakeGenericMethod(myType);
generic.Invoke(this, null);
</code></pre>

<p>For a static method, pass <code>null</code> as the first argument to <code>Invoke</code>. That's nothing to do with generic methods - it's just normal reflection.</p>

<p>As noted, a lot of this is simpler as of C# 4 using <code>dynamic</code> - if you can use type inference, of course. It doesn't help in cases where type inference isn't available, such as the exact example in the question.</p>
","232621"
"DateTimePicker: pick both date and time","183287","","<p>Is it possible to use DateTimePicker (Winforms) to pick both date and time (in the dropdown)? How do you change the custom display of the picked value? Also, is it possible to enable the user to type the date/time manually?</p>
","<p>Set the Format to Custom and then specify the format:</p>

<pre><code>dateTimePicker1.Format = DateTimePickerFormat.Custom;
dateTimePicker1.CustomFormat = ""MM/dd/yyyy hh:mm:ss"";  
</code></pre>

<p>or however you want to lay it out.  You could then type in directly the date/time.  If you use MMM, you'll need to use the numeric value for the month for entry, unless you write some code yourself for that (e.g., 5 results in May)</p>

<p>Don't know about the picker for date and time together.  Sounds like a custom control to me.</p>
","93614"
"How to maximize the browser window in Selenium WebDriver (Selenium 2) using C#?","183071","","<p>Is there any way to maximize the browser window using WebDriver (Selenium 2) with C#?</p>
","<p>There's an outstanding issue to add this functionality to WebDriver, which can be tracked here: <a href=""http://code.google.com/p/selenium/issues/detail?id=174"" rel=""nofollow noreferrer"">http://code.google.com/p/selenium/issues/detail?id=174</a></p>

<p>A workaround would be to use the <code>JavascriptExector</code> as follows:</p>

<pre><code>public void resizeTest() {
    driver.Navigate().GoToUrl(""http://www.example.com/"");
((IJavaScriptExecutor)driver).ExecuteScript(""window.resizeTo(1024, 768);"");
}
</code></pre>
","3193143"
"Why does one use dependency injection?","182893","","<p>I'm trying to understand <a href=""http://en.wikipedia.org/wiki/Dependency_injection"" rel=""noreferrer"">dependency injections</a> (DI), and once again I failed. It just seems silly. My code is never a mess; I hardly write virtual functions and interfaces (although I do once in a blue moon) and all my configuration is magically serialized into a class using json.net (sometimes using an XML serializer).</p>

<p>I don't quite understand what problem it solves. It looks like a way to say: ""hi. When you run into this function, return an object that is of this type and uses these parameters/data.""<br>
But... why would I ever use that? Note I have never needed to use <code>object</code> as well, but I understand what that is for.</p>

<p>What are some real situations in either building a website or desktop application where one would use DI? I can come up with cases easily for why someone may want to use interfaces/virtual functions in a game, but it's extremely rare (rare enough that I can't remember a single instance) to use that in non-game code.</p>
","<p>First, I want to explain an assumption that I make for this answer. It is not always true, but quite often:</p>

<blockquote>
  <p>Interfaces are adjectives; classes are nouns.</p>
</blockquote>

<p>(Actually, there are interfaces that are nouns as well, but I want to generalize here.)</p>

<p>So, e.g. an interface may be something such as <code>IDisposable</code>, <code>IEnumerable</code> or <code>IPrintable</code>. A class is an actual implementation of one or more of these interfaces: <code>List</code> or <code>Map</code> may both be implementations of <code>IEnumerable</code>.</p>

<p>To get the point: Often your classes depend on each other. E.g. you could have a <code>Database</code> class which accesses your database (hah, surprise! ;-)), but you also want this class to do logging about accessing the database. Suppose you have another class <code>Logger</code>, then <code>Database</code> has a dependency to <code>Logger</code>.</p>

<p>So far, so good.</p>

<p>You can model this dependency inside your <code>Database</code> class with the following line:</p>

<pre><code>var logger = new Logger();
</code></pre>

<p>and everything is fine. It is fine up to the day when you realize that you need a bunch of loggers: Sometimes you want to log to the console, sometimes to the file system, sometimes using TCP/IP and a remote logging server, and so on ...</p>

<p>And of course you do <em>NOT</em> want to change all your code (meanwhile you have gazillions of it) and replace all lines</p>

<pre><code>var logger = new Logger();
</code></pre>

<p>by:</p>

<pre><code>var logger = new TcpLogger();
</code></pre>

<p>First, this is no fun. Second, this is error-prone. Third, this is stupid, repetitive work for a trained monkey. So what do you do?</p>

<p>Obviously it's a quite good idea to introduce an interface <code>ICanLog</code> (or similar) that is implemented by all the various loggers. So step 1 in your code is that you do:</p>

<pre><code>ICanLog logger = new Logger();
</code></pre>

<p>Now the type inference doesn't change type any more, you always have one single interface to develop against. The next step is that you do not want to have <code>new Logger()</code> over and over again. So you put the reliability to create new instances to a single, central factory class, and you get code such as:</p>

<pre><code>ICanLog logger = LoggerFactory.Create();
</code></pre>

<p>The factory itself decides what kind of logger to create. Your code doesn't care any longer, and if you want to change the type of logger being used, you change it <em>once</em>: Inside the factory.</p>

<p>Now, of course, you can generalize this factory, and make it work for any type:</p>

<pre><code>ICanLog logger = TypeFactory.Create&lt;ICanLog&gt;();
</code></pre>

<p>Somewhere this TypeFactory needs configuration data which actual class to instantiate when a specific interface type is requested, so you need a mapping. Of course you can do this mapping inside your code, but then a type change means recompiling. But you could also put this mapping inside an XML file, e.g.. This allows you to change the actually used class even after compile time (!), that means dynamically, without recompiling!</p>

<p>To give you a useful example for this: Think of a software that does not log normally, but when your customer calls and asks for help because he has a problem, all you send to him is an updated XML config file, and now he has logging enabled, and your support can use the log files to help your customer.</p>

<p>And now, when you replace names a little bit, you end up with a simple implementation of a <em>Service Locator</em>, which is one of two patterns for <em>Inversion of Control</em> (since you invert control over who decides what exact class to instantiate).</p>

<p>All in all this reduces dependencies in your code, but now all your code has a dependency to the central, single service locator.</p>

<p><em>Dependency injection</em> is now the next step in this line: Just get rid of this single dependency to the service locator: Instead of various classes asking the service locator for an implementation for a specific interface, you - once again - revert control over who instantiates what.</p>

<p>With dependency injection, your <code>Database</code> class now has a constructor that requires a parameter of type <code>ICanLog</code>:</p>

<pre><code>public Database(ICanLog logger) { ... }
</code></pre>

<p>Now your database always has a logger to use, but it does not know any more where this logger comes from.</p>

<p>And this is where a DI framework comes into play: You configure your mappings once again, and then ask your DI framework to instantiate your application for you. As the <code>Application</code> class requires an <code>ICanPersistData</code> implementation, an instance of <code>Database</code> is injected - but for that it must first create an instance of the kind of logger which is configured for <code>ICanLog</code>. And so on ...</p>

<p>So, to cut a long story short: Dependency injection is one of two ways of how to remove dependencies in your code. It is very useful for configuration changes after compile-time, and it is a great thing for unit testing (as it makes it very easy to inject stubs and / or mocks).</p>

<p>In practice, there are things you can not do without a service locator (e.g., if you do not know in advance how many instances you do need of a specific interface: A DI framework always injects only one instance per parameter, but you can call a service locator inside a loop, of course), hence most often each DI framework also provides a service locator.</p>

<p>But basically, that's it.</p>

<p>Hope that helps.</p>

<p>PS: What I described here is a technique called <em>constructor injection</em>, there is also <em>property injection</em> where not constructor parameters, but properties are being used for defining and resolving dependencies. Think of property injection as an optional dependency, and of constructor injection as mandatory dependencies. But discussion on this is beyond the scope of this question.</p>
","14301496"
"Exception from HRESULT: 0x800A03EC Error","182420","","<p>I am getting ""HRESULT: 0x800A03EC"" error when running Excel add-in with following code:</p>

<pre><code>Excel.Range rng = ActiveSheet.Cells[x, y] as Excel.Range;                
string before = rng.Value2; 
string cleanV = System.Text.RegularExpressions.Regex.Replace(before, @""\s+"", """");
rng.set_Value(cleanV);
</code></pre>

<p>When error happens X and Y are set to 1, thus Excel range is not violated.
I searched extensively and tried a number of ways of setting the cell value (eg. Cells[x,y], range.set_Value()) but am at loss why this error happens and how to avoid it.</p>

<p>Any help is greatly appreciated.</p>

<p>Below are exception details:</p>

<hr>

<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code
  HResult=-2146827284
  Message=Exception from HRESULT: 0x800A03EC
  Source=""""
  ErrorCode=-2146827284
  StackTrace:
       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)
       at Microsoft.Office.Interop.Excel.Range.set_Value(Object RangeValueDataType, Object value)
       at ImportValidation.ThisAddIn.removeAnySpaces(Int32 x, Int32 y) in c:\Users\dshevelev\Documents\Visual Studio 2012\Projects\ImportValidation\ImportValidation\ThisAddIn.cs:line 354
       at ImportValidation.ThisAddIn.ReadHeaders(Hashtable columnAddress) in c:\Users\dshevelev\Documents\Visual Studio 2012\Projects\ImportValidation\ImportValidation\ThisAddIn.cs:line 123
       at ImportValidation.ThisAddIn.mapColumns() in c:\Users\dshevelev\Documents\Visual Studio 2012\Projects\ImportValidation\ImportValidation\ThisAddIn.cs:line 493
       at ImportValidation.Ribbon1.button6_Click(Object sender, RibbonControlEventArgs e) in c:\Users\dshevelev\Documents\Visual Studio 2012\Projects\ImportValidation\ImportValidation\Ribbon1.cs:line 55
       at Microsoft.Office.Tools.Ribbon.RibbonPropertyStorage.ControlActionRaise(IRibbonControl control)
       at Microsoft.Office.Tools.Ribbon.RibbonPropertyStorage.ButtonClickCallback(RibbonComponentImpl component, Object[] args)
       at Microsoft.Office.Tools.Ribbon.RibbonManagerImpl.Invoke(RibbonComponentCallback callback, Object[] args)
       at Microsoft.Office.Tools.Ribbon.RibbonMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
       at Microsoft.Office.Tools.Ribbon.RibbonManagerImpl.System.Reflection.IReflect.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParameters)
  InnerException: 
</code></pre>
","<p>Got same error in this line</p>

<pre><code> Object temp = range.Cells[i][0].Value;
</code></pre>

<p>Solved with non-zero based index</p>

<pre><code> Object temp = range.Cells[i][1].Value;
</code></pre>

<p>How is it possible that the guys who created this library thought it was a good idea to use non-zero based indexing?</p>
","14364664"
"What's a ""static method"" in C#?","182300","","<p>What does it mean when you add the static keyword to a method?</p>

<pre><code>public static void doSomething(){
   //Well, do something!
}
</code></pre>

<p>Can you add the <code>static</code> keyword to class? What would it mean then?</p>
","<p>A <code>static</code> function, unlike a regular (<em>instance</em>) function, is not associated with an instance of the class.</p>

<p>A <code>static</code> class is a class which can only contain <code>static</code> members, and therefore cannot be instantiated.</p>

<p>For example:</p>

<pre><code>class SomeClass {
    public int InstanceMethod() { return 1; }
    public static int StaticMethod() { return 42; }
}
</code></pre>

<p>In order to call <code>InstanceMethod</code>, you need an instance of the class:</p>

<pre><code>SomeClass instance = new SomeClass();
instance.InstanceMethod();   //Fine
instance.StaticMethod();     //Won't compile

SomeClass.InstanceMethod();  //Won't compile
SomeClass.StaticMethod();    //Fine
</code></pre>
","4124118"
"Merging dictionaries in C#","182212","","<p>What's the best way to merge 2 or more dictionaries (<code>Dictionary&lt;T1,T2&gt;</code>) in C#?
(3.0 features like LINQ are fine).</p>

<p>I'm thinking of a method signature along the lines of:</p>

<pre><code>public static Dictionary&lt;TKey,TValue&gt;
                 Merge&lt;TKey,TValue&gt;(Dictionary&lt;TKey,TValue&gt;[] dictionaries);
</code></pre>

<p>or</p>

<pre><code>public static Dictionary&lt;TKey,TValue&gt;
                 Merge&lt;TKey,TValue&gt;(IEnumerable&lt;Dictionary&lt;TKey,TValue&gt;&gt; dictionaries);
</code></pre>

<p><strong>EDIT:</strong> Got a cool solution from JaredPar and Jon Skeet, but I was thinking of something that handles duplicate keys. In case of collision, it doesn't matter which value is saved to the dict as long as it's consistent.</p>
","<p>This partly depends on what you want to happen if you run into duplicates. For instance, you could do:</p>

<pre><code>var result = dictionaries.SelectMany(dict =&gt; dict)
                         .ToDictionary(pair =&gt; pair.Key, pair =&gt; pair.Value);
</code></pre>

<p>That will blow up if you get any duplicate keys.</p>

<p>EDIT: If you use ToLookup then you'll get a lookup which can have multiple values per key. You <em>could</em> then convert that to a dictionary:</p>

<pre><code>var result = dictionaries.SelectMany(dict =&gt; dict)
                         .ToLookup(pair =&gt; pair.Key, pair =&gt; pair.Value)
                         .ToDictionary(group =&gt; group.Key, group =&gt; group.First());
</code></pre>

<p>It's a bit ugly - and inefficient - but it's the quickest way to do it in terms of code. (I haven't tested it, admittedly.)</p>

<p>You could write your own ToDictionary2 extension method of course (with a better name, but I don't have time to think of one now) - it's not terribly hard to do, just overwriting (or ignoring) duplicate keys. The important bit (to my mind) is using SelectMany, and realising that a dictionary supports iteration over its key/value pairs.</p>
","294145"
"How do you automatically resize columns in a DataGridView control AND allow the user to resize the columns on that same grid?","182141","","<p>I am populating a DataGridView control on a Windows Form (C# 2.0 not WPF).</p>

<p>My goal is to display a grid that neatly fills all available width with cells - i.e. no unused (dark grey) areas down the right and sizes each column appropriately according to the data it contains, <b>but</b> also allows the user to resize any of the columns to their liking.</p>

<p>I am attempting to achieve this by setting the AutoSizeMode of each column to be <strong>DataGridViewAutoSizeColumnMode.AllCells</strong> except for one of the columns which I set to <strong>DataGridViewAutoSizeColumnMode.Fill</strong> in order to ensure the entire area of the grid is neatly filled with data. (I don't mind that when the user attempt to resize this column it springs back to a size that ensures the horizontal space is always used.)</p>

<p>However, as I mentioned, once loaded I would like to allow the user to resize the columns to suit their own requirements - in setting these AutoSizeMode values for each column it appears the user is then unable to then resize those columns.</p>

<p>I've tried not setting the AutoSizeMode of all the columns which does allow resizing BUT doesn't set the initial size according to the data the cells contain. The same result occurs when changing the grid's AutoSizeMode back to ""Not Set"" after loading the data.</p>

<p>Is there a setting I'm missing here which allows automatic setting of default column widths AND user resizing or is there another technique I must use when populating the DataGridView control?</p>
","<p>This trick works for me:</p>

<pre><code>grd.DataSource = DT;

//set autosize mode
grd.Columns[0].AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;
grd.Columns[1].AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;
grd.Columns[2].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill;

//datagrid has calculated it's widths so we can store them
for (int i = 0; i &lt;= grd.Columns.Count - 1; i++) {
    //store autosized widths
    int colw = grd.Columns[i].Width;
    //remove autosizing
    grd.Columns[i].AutoSizeMode = DataGridViewAutoSizeColumnMode.None;
    //set width to calculated by autosize
    grd.Columns[i].Width = colw;
}
</code></pre>

<p>What happens here is that you set autosize to whathever mode you need and then column by column you store the width it got from autosize calculation, remove autosizing and set width to value you stored before.</p>
","1031871"
"WCF Service Client: The content type text/html; charset=utf-8 of the response message does not match the content type of the binding","182120","","<p>I've got a WCF Service running on my local IIS server. I've added it as a service reference to a C# Website Project and it adds fine and generates the proxy classes automatically.</p>

<p>However, when I try and call any of the service contracts, I get the following error:</p>

<blockquote>
  <p><strong>Description:</strong> An unhandled exception occurred during the
  execution of the current web  request.
  Please review the stack trace for more
  information about the error and where
  it originated in the code.</p>
  
  <p><strong>Exception Details:</strong> System.ServiceModel.ProtocolException:
  The content type text/html;
  charset=utf-8 of the response message
  does not match the content type of the
  binding (application/soap+xml;
  charset=utf-8). If using a custom
  encoder, be sure that the
  IsContentTypeSupported method is
  implemented properly. The first 1024
  bytes of the response were: '
       function
  bredir(d,u,r,v,c){var w,h,wd,hd,bi;var
  b=false;var p=false;var
  s=[[300,250,false],[250,250,false],[240,400,false],[336,280,false],[180,150,false],[468,60,false],[234,60,false],[88,31,false],[120,90,false],[120,60,false],[120,240,false],[125,125,false],[728,90,false],[160,600,false],[120,600,false],[300,600,false],[300,125,false],[530,300,false],[190,200,false],[470,250,false],[720,300,true],[500,350,true],[550,480,true]];if(typeof(window.innerHeight)=='number'){h=window.innerHeight;w=window.innerWidth;}else
  if(typeof(document.body.offsetHeight)=='number'){h=document.body.offsetHeight;w=document.body.offsetWidth;}for(var
  i=0;i  
</blockquote>

<p>I also have a console application which also communicates with the WCF Service and the console app is able to call methods fine without getting this error.</p>

<p>Below are excerpts from my config files.</p>

<p>WCF Service Web.Config:</p>

<pre><code>&lt;system.serviceModel&gt;
   &lt;services&gt;
      &lt;service name=""ScraperService"" behaviorConfiguration=""ScraperServiceBehavior""&gt;
         &lt;endpoint address=""""
                   binding=""wsHttpBinding"" 
                   bindingConfiguration=""WSHttpBinding_IScraperService""
                   contract=""IScraperService"" /&gt;
         &lt;endpoint address=""mex"" 
                   binding=""mexHttpBinding"" 
                   contract=""IMetadataExchange"" /&gt;
         &lt;host&gt;
            &lt;baseAddresses&gt;
                &lt;add baseAddress=""http://example.com"" /&gt;
            &lt;/baseAddresses&gt;
         &lt;/host&gt;
      &lt;/service&gt;
   &lt;/services&gt;
   &lt;bindings&gt;
       &lt;wsHttpBinding&gt;
           &lt;binding name=""WSHttpBinding_IScraperService""
                    bypassProxyOnLocal=""false"" transactionFlow=""false""
                    hostNameComparisonMode=""StrongWildcard""
                    maxBufferPoolSize=""2000000"" maxReceivedMessageSize=""2000000""
                    messageEncoding=""Text"" textEncoding=""utf-8""
                    useDefaultWebProxy=""true"" allowCookies=""false""&gt;
               &lt;readerQuotas 
                     maxDepth=""2000000"" maxStringContentLength=""2000000"" 
                     maxArrayLength=""2000000"" maxBytesPerRead=""2000000""
                     maxNameTableCharCount=""2000000"" /&gt;
               &lt;reliableSession 
                     enabled=""false"" ordered=""true"" inactivityTimeout=""00:10:00"" /&gt;
               &lt;security mode=""Message""&gt;
                   &lt;message clientCredentialType=""Windows""
                            negotiateServiceCredential=""true""
                            algorithmSuite=""Default""
                            establishSecurityContext=""true"" /&gt;
               &lt;/security&gt;
            &lt;/binding&gt;
          &lt;/wsHttpBinding&gt;
      &lt;/bindings&gt;
      &lt;behaviors&gt;
          &lt;serviceBehaviors&gt;
              &lt;behavior name=""ScraperServiceBehavior""&gt;
                  &lt;serviceMetadata httpGetEnabled=""true"" /&gt;
                  &lt;serviceDebug includeExceptionDetailInFaults=""true"" /&gt;
              &lt;/behavior&gt;
          &lt;/serviceBehaviors&gt;
     &lt;/behaviors&gt;
&lt;/system.serviceModel&gt;
</code></pre>

<p>Website Project Service Client <code>Web.Config</code>:</p>

<pre><code>&lt;system.serviceModel&gt;
   &lt;bindings&gt;
      &lt;wsHttpBinding&gt;
          &lt;binding name=""WSHttpBinding_IScraperService"" 
              closeTimeout=""00:01:00"" openTimeout=""00:01:00"" 
              receiveTimeout=""00:10:00"" sendTimeout=""00:01:00""
              bypassProxyOnLocal=""false"" transactionFlow=""false"" 
              hostNameComparisonMode=""StrongWildcard""
              maxBufferPoolSize=""524288"" maxReceivedMessageSize=""65536"" 
              messageEncoding=""Text"" textEncoding=""utf-8""
              useDefaultWebProxy=""true"" allowCookies=""false""&gt;
              &lt;readerQuotas 
                  maxDepth=""32"" maxStringContentLength=""8192"" 
                  maxArrayLength=""16384"" maxBytesPerRead=""4096"" 
                  maxNameTableCharCount=""16384"" /&gt;
              &lt;reliableSession enabled=""false""
                  ordered=""true"" inactivityTimeout=""00:10:00"" /&gt;
              &lt;security mode=""Message""&gt;
                  &lt;transport clientCredentialType=""Windows"" 
                       proxyCredentialType=""None"" realm="""" /&gt;
                  &lt;message clientCredentialType=""Windows"" 
                       negotiateServiceCredential=""true""
                       algorithmSuite=""Default"" /&gt;
              &lt;/security&gt;
          &lt;/binding&gt;
       &lt;/wsHttpBinding&gt;
    &lt;/bindings&gt;
&lt;client&gt;
        &lt;endpoint name=""WSHttpBinding_IScraperService""
            address=""http://example.com/ScraperService.svc""
            binding=""wsHttpBinding"" 
            bindingConfiguration=""WSHttpBinding_IScraperService""
            contract=""ScraperService.IScraperService"" &gt;
           &lt;identity&gt;
               &lt;servicePrincipalName value=""host/FreshNET-II"" /&gt;
           &lt;/identity&gt;
        &lt;/endpoint&gt;
     &lt;/client&gt;
&lt;/system.serviceModel&gt;
</code></pre>

<p>This is my first attempt at creating a WCF so it's all very new. Any help is much appreciated.</p>

<p>Thanks.</p>
","<p>Try browsing to <a href=""http://localhost/ScraperService.svc"" rel=""noreferrer"">http://localhost/ScraperService.svc</a> in the web browser on the server hosting the service, using the same Windows credentials that the client normally runs under.</p>

<p>I imagine that IIS is displaying an html error message of some description instead of returning xml as expected. </p>

<p>This also can occur when you have an http proxy server that performs internet filtering. My experience with ContentKeeper is that it intercepts any http/https traffic and blocks it as ""Unmanaged Content"" - all we get back is an html error message. To avoid this, you can add proxy server exception rules to Internet Explorer so that the proxy doesn't intercept traffic to your site:</p>

<p>Control Panel > Internet Options > Connections > LAN Settings > Advanced > Proxy Settings</p>

<p><img src=""https://i.stack.imgur.com/xNY40.png"" alt=""enter image description here""></p>
","5245627"
"how to check if object already exists in a list","182119","","<p>I have a list</p>

<pre><code>  List&lt;MyObject&gt; myList
</code></pre>

<p>and i am adding items to a list and i want to check if that object is already in the list.  </p>

<p>so before i do this:</p>

<pre><code> myList.Add(nextObject);
</code></pre>

<p>i want to see if nextObject is already in the list. </p>

<p>the object ""MyObject"" has a number of properties but comparison is based on matching on two properties.</p>

<p>what is the best way to do a check before i add a new ""MyObject"" to thsi list of ""MyObject""s</p>

<p>the only solution i thought up was to change from a list to a dictionary and them make the key a concatenated string of the properties (this seems a little unelegant)</p>

<p>any other cleaner solutions using list or LINQ or something else?</p>
","<p>It depends on the needs of the specific situation. For example, the dictionary approach would be quite good assuming:</p>

<ol>
<li>The list is relatively stable (not a lot of inserts/deletions, which dictionaries are not optimized for)</li>
<li>The list is quite large (otherwise the overhead of the dictionary is pointless).</li>
</ol>

<p>If the above are not true for your situation, just use <strong><a href=""http://msdn.microsoft.com/en-us/library/bb534972.aspx"" rel=""noreferrer""><code>Any()</code></a>:</strong></p>

<pre><code>Item wonderIfItsPresent = ...
bool containsItem = myList.Any(item =&gt; item.UniqueProperty == wonderIfItsPresent.UniqueProperty);'
</code></pre>

<p>This will enumerate through the list until it finds a match, or until it reaches the end.</p>
","3435099"
"Int to Char in C#","181724","","<p>What is the best way to convert an Int value to the corresponding Char in Utf16, given that the Int is in the range of valid values?</p>
","<pre><code>(char)myint;
</code></pre>

<p>for example:</p>

<pre><code>Console.WriteLine(""(char)122 is {0}"", (char)122);
</code></pre>

<p>yields:</p>

<blockquote>
  <p>(char)122 is z</p>
</blockquote>
","289815"
"Entity Framework The underlying provider failed on Open","181694","","<p>Below is my connection string:</p>

<blockquote>
  <p>connectionString=""metadata=res://*/EDMX.Test.csdl|res://*/EDMX.Test.ssdl|res://*/EDMX.Test.msl;provider=System.Data.SqlClient;provider
  connection string=&quot;Data Source=home_computer;Initial
  Catalog=db_Test;Persist Security Info=True;User
  ID=testUser;Password=$1234;MultipleActiveResultSets=True&quot;""</p>
</blockquote>

<p>Here is the code where the program stuck:</p>

<pre><code>EDMX.TestingEntity context = new EDMX.TestingEntity();

var query = from t in context.User
            where t.UserName == _userName
            select t;
</code></pre>

<p>After running the above code, I check the variable query and found an exception </p>

<blockquote>
  <p>The underlying provider failed on Open.</p>
</blockquote>

<p>I've checked:</p>

<ol>
<li>Connection between server and computer is normal   </li>
<li>I can login to the database with username testuser and with password $1234   </li>
<li>I have checked the security settings in database (SQL Server) that permission has been granted to testUser</li>
</ol>

<p>Why does this exception happen? I'm using .net 4.5</p>

<hr>

<p>Added:</p>

<p>I tried again, look at the inner exception and it was:
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)</p>

<p>I know it might be a network problem but I've turned off the firewall of server and also my computer and tried again but still not success..</p>

<hr>

<p>Just now Copied the connectionstring to a program to test this connection and it was functioning well..</p>

<hr>

<p>I just rollback all changes and test again and it worked</p>
","<p>Seems like a connection issue. You can use the Data link properties to find if the connection is fine. Do the following:</p>

<ol>
<li>Create a blank notepad and rename it to ""X.UDL""</li>
<li>Double click to open it</li>
<li>Under connections tab choose the server name/enter the name
use the correct credentials and DB</li>
<li>Click OK to save it. </li>
</ol>

<p>Now open the file in Notepad and compare the connection string properties.</p>
","18271966"
"How to convert a column number (eg. 127) into an excel column (eg. AA)","181553","","<p>How do you convert a numerical number to an Excel column name in C# without using automation getting the value directly from Excel.</p>

<p>Excel 2007 has a possible range of 1 to 16384, which is the number of columns that it supports. The resulting values should be in the form of excel column names, e.g. A, AA, AAA etc.</p>
","<p>Here's how I do it:</p>

<pre><code>private string GetExcelColumnName(int columnNumber)
{
    int dividend = columnNumber;
    string columnName = String.Empty;
    int modulo;

    while (dividend &gt; 0)
    {
        modulo = (dividend - 1) % 26;
        columnName = Convert.ToChar(65 + modulo).ToString() + columnName;
        dividend = (int)((dividend - modulo) / 26);
    } 

    return columnName;
}
</code></pre>
","182924"
"Redirecting to another page in ASP.NET MVC using JavaScript/jQuery","181504","","<p>I want to redirect from one page to another page in ASP.NET MVC 3.0 using JavaScript/jQuery/Ajax. On button click event I have written JavaScript code like below.</p>

<pre><code>function foo(id)
{
    $.post('/Branch/Details/' + id);
}
</code></pre>

<p>My controller code is like this:</p>

<pre><code>public ViewResult Details(Guid id)
{
     Branch branch = db.Branches.Single(b =&gt; b.Id == id);
     return View(branch);
}
</code></pre>

<p>When I click on a button it is calling the Details action inside  BranchController, but it doesn't return to the Details view.</p>

<p>I didn't get any error or exception. It's showing status 200 OK in <a href=""http://en.wikipedia.org/wiki/Firebug_%28software%29"">Firebug</a>. What is wrong in my code and how can I redirect to the Details view page?</p>
","<p>You are not subscribing to any success callback in your $.post AJAX call.  Meaning that the request is executed, but you do nothing with the results. If you want to do something useful with the results, try:</p>

<pre><code>$.post('/Branch/Details/' + id, function(result) {
    // Do something with the result like for example inject it into
    // some placeholder and update the DOM.
    // This obviously assumes that your controller action returns
    // a partial view otherwise you will break your markup
});
</code></pre>

<p>On the other hand if you want to redirect, you absolutely do not need AJAX. You use AJAX only when you want to stay on the same page and update only a portion of it. </p>

<p>So if you only wanted to redirect the browser:</p>

<pre><code>function foo(id) {
    window.location.href = '/Branch/Details/' + id;
}
</code></pre>

<p>As a side note: 
You should never be hardcoding urls like this. You should always be using url helpers when dealing with urls in an ASP.NET MVC application. So:</p>

<pre><code>function foo(id) {
    var url = '@Url.Action(""Details"", ""Branch"", new { id = ""__id__"" })';
    window.location.href = url.replace('__id__', id);
}
</code></pre>
","8148657"
"How to use System.Net.HttpClient to post a complex type?","181362","","<p>I have a custom complex type that I want to work with using Web API.</p>

<pre><code>public class Widget
{
    public int ID { get; set; }
    public string Name { get; set; }
    public decimal Price { get; set; }
}
</code></pre>

<p>And here is my web API controller method. I want to post this object like so:</p>

<pre><code>public class TestController : ApiController
{
    // POST /api/test
    public HttpResponseMessage&lt;Widget&gt; Post(Widget widget)
    {
        widget.ID = 1; // hardcoded for now. TODO: Save to db and return newly created ID

        var response = new HttpResponseMessage&lt;Widget&gt;(widget, HttpStatusCode.Created);
        response.Headers.Location = new Uri(Request.RequestUri, ""/api/test/"" + widget.ID.ToString());
        return response;
    }
}
</code></pre>

<p>And now I'd like to use System.Net.HttpClient to make the call to the method. However, I'm unsure of what type of object to pass into the PostAsync method, and how to construct it. Here is some sample client code. </p>

<pre><code>var client = new HttpClient();
HttpContent content = new StringContent(""???""); // how do I construct the Widget to post?
client.PostAsync(""http://localhost:44268/api/test"", content).ContinueWith(
    (postTask) =&gt;
    {
        postTask.Result.EnsureSuccessStatusCode();
    });
</code></pre>

<p>How do I create the HttpContent object in a way that web API will understand it?</p>
","<p>The generic <code>HttpRequestMessage&lt;T&gt;</code> has been <strong>removed</strong>. This :</p>

<pre><code>new HttpRequestMessage&lt;Widget&gt;(widget)
</code></pre>

<p>will <strong>no longer work</strong>.</p>

<p>Instead, <a href=""http://aspnetwebstack.codeplex.com/discussions/350492"" rel=""nofollow noreferrer"">from this post</a>, the ASP.NET team has included some <a href=""http://msdn.microsoft.com/en-us/library/hh944339%28v=vs.108%29.aspx"" rel=""nofollow noreferrer"">new calls</a> to support this functionality:</p>

<pre><code>HttpClient.PostAsJsonAsync&lt;T&gt;(T value) sends “application/json”
HttpClient.PostAsXmlAsync&lt;T&gt;(T value) sends “application/xml”
</code></pre>

<p>So, the new code (<a href=""https://stackoverflow.com/a/10305214/39758"">from dunston</a>) becomes:</p>

<pre><code>Widget widget = new Widget()
widget.Name = ""test""
widget.Price = 1;

HttpClient client = new HttpClient();
client.BaseAddress = new Uri(""http://localhost:44268"");
client.PostAsJsonAsync(""api/test"", widget)
    .ContinueWith((postTask) =&gt; postTask.Result.EnsureSuccessStatusCode() );
</code></pre>
","14714560"
"C# MessageBox dialog result","180994","","<p>I want to make a MessageBox confirmation. Here is the message box:</p>

<pre><code>MessageBox.Show(""Do you want to save changes?"", ""Confirmation"", messageBoxButtons.YesNoCancel);
</code></pre>

<p>And I want to make something like this (in pseudocode):</p>

<pre><code>if (MessageBox.Result == DialogResult.Yes)
    ;
else if (MessageBox.Result == DialogResult.No)
    ;
else
    ;
</code></pre>

<p>How can I do that in C#?</p>
","<pre><code>DialogResult result = MessageBox.Show(""Do you want to save changes?"", ""Confirmation"", MessageBoxButtons.YesNoCancel);
if(result == DialogResult.Yes)
{ 
    //...
}
else if (result == DialogResult.No)
{ 
    //...
}
else
{
    //...
} 
</code></pre>
","10777143"
"Do you have to put Task.Run in a method to make it async?","180486","","<p>I'm trying to understand async await in the simplest form.  I want to create a very simple method that adds two numbers for the sake of this example, granted, it's no processing time at all, it's just a matter of formulating an example here.</p>

<p>Example 1:</p>

<pre><code>private async Task DoWork1Async()
{
    int result = 1 + 2;
}
</code></pre>

<p>Example 2:</p>

<pre><code>private async Task DoWork2Async()
{
    Task.Run( () =&gt;
    {
        int result = 1 + 2;
    });
}
</code></pre>

<p>If I await <code>DoWork1Async()</code> will the code run synchronously or asynchronously?</p>

<p>Do I need to wrap the sync code with <code>Task.Run</code> to make the method awaitable AND asynchronous so as not to block the UI thread?</p>

<p>I'm trying to figure out if my method is a <code>Task</code> or returns <code>Task&lt;T&gt;</code> do I need to wrap the code with <code>Task.Run</code> to make it asynchronous.</p>

<p>Stupid question I'm sure but I see examples on the net where people are awaiting code that has nothing async within and not wrapped in a <code>Task.Run</code> or <code>StartNew</code>.</p>
","<p>First, let's clear up some terminology: ""asynchronous"" (<code>async</code>) means that it may yield control back to the calling thread before it starts. In an <code>async</code> method, those ""yield"" points are <code>await</code> expressions.</p>

<p>This is very different than the term ""asynchronous"", as (mis)used by the MSDN documentation for years to mean ""executes on a background thread"".</p>

<p>To futher confuse the issue, <code>async</code> is very different than ""awaitable""; there are some <code>async</code> methods whose return types are not awaitable, and many methods returning awaitable types that are not <code>async</code>.</p>

<p>Enough about what they <em>aren't</em>; here's what they <em>are</em>:</p>

<ul>
<li>The <code>async</code> keyword allows an asynchronous method (that is, it allows <code>await</code> expressions). <code>async</code> methods may return <code>Task</code>, <code>Task&lt;T&gt;</code>, or (if you must) <code>void</code>.</li>
<li>Any type that follows a certain pattern can be awaitable. The most common awaitable types are <code>Task</code> and <code>Task&lt;T&gt;</code>.</li>
</ul>

<p>So, if we reformulate your question to ""how can I run an operation <em>on a background thread</em> in a way that it's awaitable"", the answer is to use <code>Task.Run</code>:</p>

<pre><code>private Task&lt;int&gt; DoWorkAsync() // No async because the method does not need await
{
  return Task.Run(() =&gt;
  {
    return 1 + 2;
  });
}
</code></pre>

<p>(But this pattern is a poor approach; see below).</p>

<p>But if your question is ""how do I create an <code>async</code> method that can yield back to its caller instead of blocking"", the answer is to declare the method <code>async</code> and use <code>await</code> for its ""yielding"" points:</p>

<pre><code>private async Task&lt;int&gt; GetWebPageHtmlSizeAsync()
{
  var client = new HttpClient();
  var html = await client.GetAsync(""http://www.example.com/"");
  return html.Length;
}
</code></pre>

<p>So, the basic pattern of things is to have <code>async</code> code depend on ""awaitables"" in its <code>await</code> expressions. These ""awaitables"" can be other <code>async</code> methods or just regular methods returning awaitables. Regular methods returning <code>Task</code>/<code>Task&lt;T&gt;</code> <em>can</em> use <code>Task.Run</code> to execute code on a background thread, or (more commonly) they can use <code>TaskCompletionSource&lt;T&gt;</code> or one of its shortcuts (<code>TaskFactory.FromAsync</code>, <code>Task.FromResult</code>, etc). I <strong>don't</strong> recommend wrapping an entire method in <code>Task.Run</code>; synchronous methods should have synchronous signatures, and it should be left up to the consumer whether it should be wrapped in a <code>Task.Run</code>:</p>

<pre><code>private int DoWork()
{
  return 1 + 2;
}

private void MoreSynchronousProcessing()
{
  // Execute it directly (synchronously), since we are also a synchronous method.
  var result = DoWork();
  ...
}

private async Task DoVariousThingsFromTheUIThreadAsync()
{
  // I have a bunch of async work to do, and I am executed on the UI thread.
  var result = await Task.Run(() =&gt; DoWork());
  ...
}
</code></pre>

<p>I have an <a href=""http://blog.stephencleary.com/2012/02/async-and-await.html"" rel=""noreferrer""><code>async</code>/<code>await</code> intro</a> on my blog; at the end are some good followup resources. The MSDN docs for <code>async</code> are unusually good, too.</p>
","17119610"
"Export DataTable to Excel File","180441","","<p>I have a DataTable with 30+ columns and 6500+ rows.I need to dump the whole DataTable values into an Excel file.Can anyone please help with the C# code.I need each column value to be in a cell.To be precise,I need the exact looking copy of DataTable in an Excel File.Please help.</p>

<p>Thanks,
Vix</p>
","<p>use this code...</p>

<pre><code>    dt = city.GetAllCity();//your datatable
    string attachment = ""attachment; filename=city.xls"";
    Response.ClearContent();
    Response.AddHeader(""content-disposition"", attachment);
    Response.ContentType = ""application/vnd.ms-excel"";
    string tab = """";
    foreach (DataColumn dc in dt.Columns)
    {
        Response.Write(tab + dc.ColumnName);
        tab = ""\t"";
    }
    Response.Write(""\n"");
    int i;
    foreach (DataRow dr in dt.Rows)
    {
        tab = """";
        for (i = 0; i &lt; dt.Columns.Count; i++)
        {
            Response.Write(tab + dr[i].ToString());
            tab = ""\t"";
        }
        Response.Write(""\n"");
    }
    Response.End();
</code></pre>
","1746924"
"EntityType has no key defined error","180248","","<p><strong>Controller:</strong></p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using MvcApplication1.Models;
using System.ComponentModel.DataAnnotations.Schema;

namespace MvcApplication1.Controllers
{
    public class studentsController : Controller
    {
        //
        // GET: /students/

        public ActionResult details()
        {
            int id = 16;
            studentContext std = new studentContext();
           student first = std.details.Single(m =&gt; m.RollNo == id);
            return View(first);
        }

    }
}
</code></pre>

<p><strong>DbContext Model:</strong></p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.Entity;

namespace MvcApplication1.Models
{
    public class studentContext : DbContext
    {
        public DbSet&lt;student&gt; details { get; set; }
    }
}
</code></pre>

<p><strong>Model:</strong></p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations.Schema;

namespace MvcApplication1.Models
{
    [Table(""studentdetails"")]
    public class student
    {
        public int RollNo;
        public string Name;
        public string Stream;
        public string Div;
    }
}
</code></pre>

<p><strong>Database table:</strong></p>

<pre><code>CREATE TABLE [dbo].[studentdetails](
    [RollNo] [int] NULL,
    [Name] [nvarchar](50) NULL,
    [Stream] [nvarchar](50) NULL,
    [Div] [nvarchar](50) NULL
)  
</code></pre>

<p><strong>In global.asax.cs</strong></p>

<pre><code>Database.SetInitializer&lt;MvcApplication1.Models.studentContext&gt;(null);
</code></pre>

<p>The above code lists all the classes I am working on. Upon running my application am receiving the error:</p>

<blockquote>
  <p>""One or more validation errors were detected during model generation"" along with ""Entity type has no key defined"".</p>
</blockquote>
","<p>The Model class should be changed to :</p>

<pre><code>using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations.Schema;
using System.ComponentModel.DataAnnotations;

namespace MvcApplication1.Models
{
    [Table(""studentdetails"")]
    public class student
    {
        [Key]
        public int RollNo { get; set; }

        public string Name { get; set; }

        public string Stream { get; set; }

        public string Div { get; set; }
    }
}
</code></pre>
","20314485"
"Fastest way to remove first char in a string","180035","","<p>Say we have the following string </p>

<pre><code>string data= ""/temp string"";
</code></pre>

<p>If we want to remove the first character <code>/</code> we can do by alot of ways such as :</p>

<pre><code>data.Remove(0,1);
data.TrimStart('/');
data.Substring(1);
</code></pre>

<p>But .. really I don't know which one have the best algorithm and doing that faster .. <br/>
<strong>Is there a one that is the best or all are the same ?</strong>  </p>
","<p>The second option really isn't the same as the others - if the string is ""///foo"" it will become ""foo"" instead of ""//foo"".</p>

<p>The first option needs a bit more work to understand than the third - I would view the <code>Substring</code> option as the most common and readable.</p>

<p>(Obviously each of them as an individual statement won't do anything useful - you'll need to assign the result to a variable, possibly <code>data</code> itself.)</p>

<p>I wouldn't take performance into consideration here unless it was actually becoming a problem for you - in which case the only way you'd know would be to have test cases, and then it's easy to just run those test cases for each option and compare the results. I'd expect <code>Substring</code> to probably be the fastest here, simply because <code>Substring</code> always ends up creating a string from a single chunk of the original input, whereas <code>Remove</code> has to at least <em>potentially</em> glue together a start chunk and an end chunk.</p>
","3222139"
"Parse string to DateTime in C#","179931","","<p>I have <strong>date and time</strong> in a string formatted like that one:</p>

<pre><code>""2011-03-21 13:26"" //year-month-day hour:minute
</code></pre>

<p>How can I parse it to <code>System.DateTime</code>?</p>

<p>I want to use functions like <code>DateTime.Parse()</code> or <code>DateTime.ParseExact()</code> if possible, to be able to specify the format of the date manually.</p>
","<p><code>DateTime.Parse()</code> will try figure out the format of the given date, and it usually does a good job. If you can guarantee dates will always be in a given format then you can use <code>ParseExact()</code>:</p>

<pre><code>string s = ""2011-03-21 13:26"";

DateTime dt = 
    DateTime.ParseExact(s, ""yyyy-MM-dd HH:mm"", CultureInfo.InvariantCulture);
</code></pre>

<p>(But note that it is usually safer to use one of the TryParse methods in case a date is not in the expected format)</p>

<p>Make sure to check  <a href=""https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx"" rel=""noreferrer"">Custom Date and Time Format Strings</a> when constructing format string, especially pay attention to number of letters and case (i.e. ""MM"" and ""mm"" mean very different things).</p>

<p>Another useful resource for C# format strings is <a href=""http://blog.stevex.net/string-formatting-in-csharp/"" rel=""noreferrer"">String Formatting in C#</a></p>
","5366311"
"Converting string to title case","179713","","<p>I have a string which contains a mixture of upper and lower case characters, for example ""a Simple string"" . What I want to do is to convert first character of each word ( I can assume that words are separated by spaces) into upper case. So I want the result as ""A Simple String"". Is there any easy way to do this? I don't want to split the string and do the conversion (that will be my last resort). Also, it is guaranteed that the strings are in English.</p>
","<p>MSDN : <a href=""http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx"" rel=""noreferrer"">TextInfo.ToTitleCase</a>  </p>

<p>Make sure that you include: <code>using System.Globalization</code></p>

<pre><code>string title = ""war and peace"";

TextInfo textInfo = new CultureInfo(""en-US"", false).TextInfo;

title = textInfo.ToTitleCase(title); 
Console.WriteLine(title) ; //War And Peace

//When text is ALL UPPERCASE...
title = ""WAR AND PEACE"" ;

title = textInfo.ToTitleCase(title); 
Console.WriteLine(title) ; //WAR AND PEACE

//You need to call ToLower to make it work
title = textInfo.ToTitleCase(title.ToLower()); 
Console.WriteLine(title) ; //War And Peace
</code></pre>
","1206029"
"How to create and use resources in .NET","179674","","<p>How do I create a resource that I can reference and use in various parts of my program easily?</p>

<p>My specific problem is that I have a NotifyIcon that I want to change the icon of depending on the state of the program. A common problem, but one I've been struggling with for a long time. </p>
","<p>Well, after searching around and cobbling together various points from around StackOverflow (gee, I love this place already), most of the problems were already past this stage. I did manage to work out an answer to my problem though.</p>

<p><strong>How to create a resource.</strong></p>

<p>In my case, I want to create an icon. It's a similar process, no matter what sort of data you want to add as a resource though.</p>

<ul>
<li>Right click the project you want to add a resource to. Do this in the Solution Explorer. Select the ""Properties"" option from the list.</li>
<li>Click the ""Resources"" tab.</li>
<li>The first button along the top of the bar will let you select the type of resource you want to add. It should start on string. We want to add an icon, so click on it and select ""Icons"" from the list of options.</li>
<li>Next, move to the second button, ""Add Resource"". You can either add a new resource, or if you already have an icon already made, you can add that too. Follow the prompts for whichever option you choose.</li>
<li>At this point, you can double click the newly added resource to edit it. Note, resources also show up in the Solution Explorer, and double clicking there is just as effective</li>
</ul>

<p><strong>How to use a resource.</strong></p>

<p>Great, so we have our new resource and we're itching to have those lovely changing icons... How do we do that? Well, lucky us, C# makes this exceedingly easy.</p>

<p>There is a static class called <code>Properties.Resources</code> that gives you access to all your resources, so my code ended up being as simple as:</p>

<pre><code>paused = !paused;
if (paused)
    notifyIcon.Icon = Properties.Resources.RedIcon;
else
    notifyIcon.Icon = Properties.Resources.GreenIcon;
</code></pre>

<p>Done! Finis! Everything is simple when you know how, no?</p>
","90699"
"How do I show a ""Loading . . . please wait"" message in Winforms for a long loading form?","179501","","<p>I have a form that is very slow because there are many controls placed on the form.  </p>

<p>As a result the form takes a long time to loaded. </p>

<p>How do I load the form first, then display it and while loading delay show another form which that have message like ""Loading... please wait.?""</p>
","<p>Using a separate thread to display a simple please wait message is overkill especially if you don't have much experience with threading.</p>

<p>A much simpler approach is to create a ""Please wait"" form and display it as a mode-less window just before the slow loading form.  Once the main form has finished loading, hide the please wait form.</p>

<p>In this way you are using just the one main UI thread to firstly display the please wait form and then load your main form.  </p>

<p>The only limitation to this approach is that your please wait form cannot be animated (such as a animated GIF) because the thread is busy loading your main form.</p>

<pre><code>PleaseWaitForm pleaseWait=new PleaseWaitForm ();

// Display form modelessly
pleaseWait.Show();

//  ALlow main UI thread to properly display please wait form.
Application.DoEvents();

// Show or load the main form.
mainForm.ShowDialog();
</code></pre>
","1918955"
"Process.start: how to get the output?","179088","","<p>I would like to run an external command line program from my Mono/.NET app. 
For example, I would like to run <strong>mencoder</strong>. Is it possible:</p>

<ol>
<li>To get the command line shell output, and write it on my text box?</li>
<li>To get the numerical value to show a progress bar with time elapsed?</li>
</ol>
","<p>When you create your <code>Process</code> object set <code>StartInfo</code> appropriately:</p>

<pre><code>var proc = new Process {
    StartInfo = new ProcessStartInfo {
        FileName = ""program.exe"",
        Arguments = ""command line arguments to your executable"",
        UseShellExecute = false,
        RedirectStandardOutput = true,
        CreateNoWindow = true
    }
};
</code></pre>

<p>then start the process and read from it:</p>

<pre><code>proc.Start();
while (!proc.StandardOutput.EndOfStream) {
    string line = proc.StandardOutput.ReadLine();
    // do something with line
}
</code></pre>

<p>You can use <code>int.Parse()</code> or <code>int.TryParse()</code> to convert the strings to numeric values. You may have to do some string manipulation first if there are invalid numeric characters in the strings you read.</p>
","4291965"
"Best way to specify whitespace in a String.Split operation","178705","","<p>I am splitting a string based on whitespace as follows:</p>

<pre><code>string myStr = ""The quick brown fox jumps over the lazy dog"";

char[] whitespace = new char[] { ' ', '\t' };
string[] ssizes = myStr.Split(whitespace);
</code></pre>

<p>It's irksome to define the char[] array everywhere in my code I want to do this. Is there more efficent way that doesn't require the creation of the character array (which is prone to error if copied in different places)?</p>
","<p>If you just call:</p>

<pre><code>string[] ssize = myStr.Split(null);
</code></pre>

<p>or:</p>

<pre><code>string[] ssize = myStr.Split(new char[0]);
</code></pre>

<p>then white-space is assumed to be the splitting character. From the <a href=""http://msdn.microsoft.com/en-us/library/b873y76a.aspx"" rel=""noreferrer""><code>string.Split(char[])</code> method's documentation page</a>.</p>

<blockquote>
  <p><em>If the separator parameter is <code>null</code> or contains no characters, white-space characters are assumed to be the delimiters. White-space characters are defined by the Unicode standard and return <code>true</code> if they are passed to the <a href=""http://msdn.microsoft.com/en-us/library/system.char.iswhitespace.aspx"" rel=""noreferrer""><code>Char.IsWhiteSpace</code></a> method.</em></p>
</blockquote>

<p>Always, always, <strong>always</strong> read the documentation!</p>
","6111355"
"""The given path's format is not supported.""","178470","","<p>I gave following line of code on web service:</p>

<pre><code>string str_uploadpath = Server.MapPath(""/UploadBucket/Raw/"");
FileStream objfilestream = new FileStream(str_uploadpath +
                fileName, FileMode.Create, FileAccess.ReadWrite);
</code></pre>

<p>Can some one help me resolve issue with this error message from line 2 of the code.</p>

<blockquote>
  <p>The given path's format is not supported.</p>
</blockquote>

<p>Permission on the folder set to full access to everyone and it is actual path to the folder.
break point gave me value of <code>str_uploadpath</code> as <code>C:\\webprojects\\webservices\\UploadBucket\\Raw\\</code>.</p>

<p>What is wrong with this string I can not see.</p>
","<p>Rather than using <code>str_uploadpath + fileName</code>, try using <a href=""http://msdn.microsoft.com/en-us/library/fyy7a5kt.aspx""><code>System.IO.Path.Combine</code></a> instead:</p>

<pre><code>Path.Combine(str_uploadpath, fileName);
</code></pre>

<p>which returns a string.</p>
","7348799"
"How to convert image in byte array","178198","","<p>Can anybody suggest how can I can convert an image into a byte array..and vice versa. If anybody has some code samples help me out. I'm developing a WPF application and enable to find stream reader.</p>
","<p>Sample code to change an image into a byte array</p>

<pre><code>public byte[] ImageToByteArray(System.Drawing.Image imageIn)
{
   using (var ms = new MemoryStream())
   {
      imageIn.Save(ms,System.Drawing.Imaging.ImageFormat.Gif);
      return  ms.ToArray();
   }
}
</code></pre>

<p><a href=""http://www.codeproject.com/KB/recipes/ImageConverter.aspx"" rel=""noreferrer"">C# Image to Byte Array and Byte Array to Image Converter Class</a></p>
","3801289"
"How to provide user name and password when connecting to a network share","178075","","<p>When connecting to a network share for which the current user (in my case, a network enabled service user) has no rights, name and password have to be provided.</p>

<p>I know how to do this with Win32 functions (the <code>WNet*</code> family from <code>mpr.dll</code>), but would like to do it with .Net (2.0) functionality.</p>

<p>What options are available?</p>

<p><strong>Maybe some more information helps:</strong></p>

<ul>
<li>The use case is a windows service, not an Asp.Net application.</li>
<li>The service is running under an account which has no rights on the share.</li>
<li>The user account needed for the share is not known on the client side.</li>
<li>Client and server are not members of the same domain.</li>
</ul>
","<p>You can either change the thread identity, or P/Invoke WNetAddConnection2. I prefer the latter, as I sometimes need to maintain multiple credentials for different locations. I wrap it into an IDisposable and call WNetCancelConnection2 to remove the creds afterwards (avoiding the multiple usernames error):</p>

<pre><code>using (new NetworkConnection(@""\\server\read"", readCredentials))
using (new NetworkConnection(@""\\server2\write"", writeCredentials)) {
   File.Copy(@""\\server\read\file"", @""\\server2\write\file"");
}
</code></pre>
","295703"
"String vs. StringBuilder","177996","","<p>I understand the difference between <code>String</code> and <code>StringBuilder</code> (<code>StringBuilder</code> being mutable) but is there a large performance difference between the two? </p>

<p>The program I’m working on has a lot of case driven string appends (500+). Is using <code>StringBuilder</code> a better choice?</p>
","<p>Yes, the performance difference is significant.  See the KB article ""<a href=""http://support.microsoft.com/kb/306822"" rel=""noreferrer"">How to improve string concatenation performance in Visual C#</a>"".</p>

<p>I have always tried to code for clarity first, and then optimize for performance later.  That's much easier than doing it the other way around! However, having seen the enormous performance difference in my applications between the two, I now think about it a little more carefully.  </p>

<p>Luckily, it's relatively straightforward to run performance analysis on your code to see where you're spending the time, and then to modify it to use <code>StringBuilder</code> where needed.</p>
","73929"
"Very simple C# CSV reader","177973","","<p>I'd like to create an array from a CSV file.</p>

<p>This is about as simple as you can imagine, the CSV file will only ever have one line and these values:</p>

<pre><code>Device, SignalStrength, Location, Time, Age.
</code></pre>

<p>I'd like to put these values into one dimensional array.</p>

<p>I've tried some examples but they've all been more complicated than required.</p>
","<p>If there is only ever one line then do something like this:</p>

<pre><code>using System;
using System.IO;

class Program
{
    static void Main()
    {
        String[] values = File.ReadAllText(@""d:\test.csv"").Split(',');
    }
}
</code></pre>
","1375422"
"'System.OutOfMemoryException' was thrown when there is still plenty of memory free","177687","","<p>This is my code:</p>

<pre><code>int size = 100000000;
double sizeInMegabytes = (size * 8.0) / 1024.0 / 1024.0; //762 mb
double[] randomNumbers = new double[size];
</code></pre>

<p>Exception:
Exception of type 'System.OutOfMemoryException' was thrown.</p>

<p><strong>I have 4GB memory on this machine 2.5GB is free</strong> when I start this running, there is clearly enough space on the PC to handle the 762mb of 100000000 random numbers. I need to store as many random numbers as possible given available memory. When I go to production there will be 12GB on the box and I want to make use of it.</p>

<p><strong>Does the CLR constrain me to a default max memory to start with? and how do I request more?</strong></p>

<p><strong>Update</strong></p>

<p>I thought breaking this into smaller chunks and incrementally adding to my memory requirements would help if the issue is due to <strong>memory fragmentation</strong>, but it doesn't <strong>I can't get past a total ArrayList size of 256mb regardless of what I do tweaking blockSize</strong>.</p>

<pre><code>private static IRandomGenerator rnd = new MersenneTwister();
private static IDistribution dist = new DiscreteNormalDistribution(1048576);
private static List&lt;double&gt; ndRandomNumbers = new List&lt;double&gt;();

private static void AddNDRandomNumbers(int numberOfRandomNumbers) {
    for (int i = 0; i &lt; numberOfRandomNumbers; i++) {
      ndRandomNumbers.Add(dist.ICDF(rnd.nextUniform()));                
  }
}
</code></pre>

<p>From my main method:</p>

<pre><code>int blockSize = 1000000;

while (true) {
  try
  {
    AddNDRandomNumbers(blockSize);                    
  }
  catch (System.OutOfMemoryException ex)
  {
    break;
  }
}            
double arrayTotalSizeInMegabytes = (ndRandomNumbers.Count * 8.0) / 1024.0 / 1024.0;
</code></pre>
","<p>You may want to read this: ""<a href=""http://blogs.msdn.com/ericlippert/archive/2009/06/08/out-of-memory-does-not-refer-to-physical-memory.aspx"" rel=""noreferrer"">“Out Of Memory” Does Not Refer to Physical Memory</a>"" by Eric Lippert.</p>

<p>In short, and very simplified, ""Out of memory"" does not really mean that the amount of available memory is too small. The most common reason is that within the current address space, there is no contiguous portion of memory that is large enough to serve the wanted allocation. If you have 100 blocks, each 4 MB large, that is not going to help you when you need one 5 MB block.</p>

<p><strong>Key Points:</strong> </p>

<ul>
<li>the data storage that we call “process memory” is in my opinion best visualized as a <strong>massive file on disk</strong>.</li>
<li>RAM can be seen as merely a performance optimization</li>
<li>Total amount of virtual memory your program consumes is really not hugely relevant to its performance</li>
<li>""running out of RAM"" seldom results in an “out of memory” error. Instead of an error, it results in bad performance because the full cost of the fact that storage is actually on disk suddenly becomes relevant.</li>
</ul>
","1153743"
"HTTP 404 Page Not Found in Web Api hosted in IIS 7.5","177141","","<p>I have a Web Api application. It works perfectly well when I tested it using the VS 2010 debugging dev server. But I now deployed it to IIS 7.5 and I am getting a HTTP 404 error when trying to access the application.</p>

<p>Here is my web.config</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name=""DefaultConnection"" connectionString=""Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-FlowGearProxy-20123141219;Integrated Security=True"" providerName=""System.Data.SqlClient"" /&gt;
  &lt;/connectionStrings&gt;
  &lt;appSettings&gt;
    &lt;add key=""webpages:Version"" value=""2.0.0.0"" /&gt;
    &lt;add key=""webpages:Enabled"" value=""true"" /&gt;
    &lt;add key=""PreserveLoginUrl"" value=""true"" /&gt;
    &lt;add key=""ClientValidationEnabled"" value=""true"" /&gt;
    &lt;add key=""UnobtrusiveJavaScriptEnabled"" value=""true"" /&gt;
  &lt;/appSettings&gt;
  &lt;system.web&gt;
    &lt;compilation debug=""true"" targetFramework=""4.0"" /&gt;
    &lt;authentication mode=""Forms""&gt;
      &lt;forms loginUrl=""~/Account/Login"" timeout=""2880"" /&gt;
    &lt;/authentication&gt;
    &lt;pages&gt;
      &lt;namespaces&gt;
        &lt;add namespace=""System.Web.Helpers"" /&gt;
        &lt;add namespace=""System.Web.Mvc"" /&gt;
        &lt;add namespace=""System.Web.Mvc.Ajax"" /&gt;
        &lt;add namespace=""System.Web.Mvc.Html"" /&gt;
        &lt;add namespace=""System.Web.Routing"" /&gt;
        &lt;add namespace=""System.Web.WebPages"" /&gt;
      &lt;/namespaces&gt;
    &lt;/pages&gt;
  &lt;/system.web&gt;
  &lt;system.webServer&gt;
    &lt;validation validateIntegratedModeConfiguration=""false"" /&gt;
    &lt;modules runAllManagedModulesForAllRequests=""true"" /&gt;
  &lt;/system.webServer&gt;
&lt;/configuration&gt;
</code></pre>
","<p>I was struggling with this as well.  Fortunately, Steve Michelotti documented a solution that worked for me <a href=""http://geekswithblogs.net/michelotti/archive/2011/05/28/resolve-404-in-iis-express-for-put-and-delete-verbs.aspx"" rel=""noreferrer"">here</a>.</p>

<p>At the end of the day, I enabled all verbs (verb=""*"") to the ExtensionlessUrlHandler-Integrated-4.0 handler in my web config.</p>

<pre><code>&lt;system.webServer&gt;
    &lt;validation validateIntegratedModeConfiguration=""false"" /&gt;
    &lt;modules runAllManagedModulesForAllRequests=""true"" /&gt;
        &lt;handlers&gt;
            &lt;remove name=""ExtensionlessUrlHandler-Integrated-4.0"" /&gt;
            &lt;add name=""ExtensionlessUrlHandler-Integrated-4.0"" path=""*."" verb=""*"" type=""System.Web.Handlers.TransferRequestHandler"" resourceType=""Unspecified"" requireAccess=""Script"" preCondition=""integratedMode,runtimeVersionv4.0"" /&gt;
        &lt;/handlers&gt;
&lt;/system.webServer&gt;
</code></pre>

<p>Others have pointed out that having WebDAV enabled causes issues.  Fortunately, I did not run into that issue as well.</p>
","10221536"
"Get properties and values from unknown object","177139","","<p>From the world of PHP I have decided to give C# a go. I've had a search but can't seem to find the answer of how to do the equivalent to this.</p>

<pre><code>$object = new Object();

$vars = get_class_vars(get_class($object));

foreach($vars as $var)
{
    doSomething($object-&gt;$var);
}
</code></pre>

<p>I basically have a List of an object. The object could be one of three different types and will have a set of public properties. I want to be able to get a list of the properties for the object, loop over them and then write them out to a file.
I'm thinking this has something to do with c# reflection but it's all new to me.</p>

<p>Any help would be greatly appreciated.</p>
","<p>This should do it:</p>

<pre><code>Type myType = myObject.GetType();
IList&lt;PropertyInfo&gt; props = new List&lt;PropertyInfo&gt;(myType.GetProperties());

foreach (PropertyInfo prop in props)
{
    object propValue = prop.GetValue(myObject, null);

    // Do something with propValue
}
</code></pre>
","4144817"
"Convert Pixels to Points","177055","","<p>I have a need to convert Pixels to Points in C#. I've seen some complicated explanations about the topic, but can't seem to locate a simple formula. Let's assume a standard 96dpi, how do I calulate this conversion?</p>
","<p>There are <a href=""http://en.wikipedia.org/wiki/Point_%28typography%29"" rel=""noreferrer"">72 points per inch</a>; if it is sufficient to assume 96 pixels per inch, the formula is rather simple:</p>

<p>points = pixels * 72 / 96</p>

<p>There is a way to get the configured pixels per inch of your display in Windows using <a href=""https://msdn.microsoft.com/en-us/library/dd144877(v=vs.85).aspx"" rel=""noreferrer""><code>GetDeviceCaps</code></a>.  Microsoft has a guide called <a href=""http://msdn.microsoft.com/en-us/library/ms838191.aspx"" rel=""noreferrer"">""Developing DPI-Aware Applications""</a>, look for the section ""Creating DPI-Aware Fonts"".</p>

<p>The W3C has defined the pixel measurement <code>px</code> as exactly <a href=""https://www.w3.org/TR/css3-values/#absolute-lengths"" rel=""noreferrer"">1/96th of 1in</a> regardless of the actual resolution of your display, so the above formula should be good for all web work.</p>
","139712"
"C# error: ""An object reference is required for the non-static field, method, or property""","177008","","<p>I have two classes, one for defining the algorithm parameters and another to implement the algorithm:</p>

<p><strong>Class 1 (algorithm parameters):</strong></p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace VM_Placement
{
    public static class AlgorithmParameters
    {
        public static int pop_size = 100;
        public static double crossover_rate = 0.7;
        public static double mutation_rate = 0.001;

        public static int chromo_length = 300;
        public static int gene_length = 4;
        public static int max_allowable_generations = 400;

        static Random rand = new Random();
        public static double random_num = rand.NextDouble();
    }
}
</code></pre>

<p><strong>Class 2 (implement algorithm):</strong></p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace VM_Placement
{
    public class Program
    {
        public struct chromo_typ
        {
            public string   bits;
            public float    fitness;

            //public chromo_typ(){
            // bits = """";
            // fitness = 0.0f;
            //}
            chromo_typ(string bts, float ftns)
            {
                bits = bts;
                fitness = ftns;
            }
        };

        public static int GetRandomSeed()
        {
            byte[] bytes = new byte[4];
            System.Security.Cryptography.RNGCryptoServiceProvider rng =
              new System.Security.Cryptography.RNGCryptoServiceProvider();
            rng.GetBytes(bytes);
            return BitConverter.ToInt32(bytes, 0);
        }

        public string GetRandomBits()
        {
            string bits="""";

            for (int i = 0; i &lt; VM_Placement.AlgorithmParameters.chromo_length; i++)
            {
                if (VM_Placement.AlgorithmParameters.random_num &gt; 0.5f)
                    bits += ""1"";
                else
                    bits += ""0"";
            }
            return bits;
        }

        public static void Main(string[] args)
        {
            Random rnd = new Random(GetRandomSeed());

            while (true)
            {
                chromo_typ[] Population = new chromo_typ[VM_Placement.AlgorithmParameters.pop_size];
                double Target;

                Console.WriteLine(""\n Input a target number"");
                Target = Convert.ToDouble(Console.ReadLine());

                for (int i = 0; i &lt; VM_Placement.AlgorithmParameters.pop_size; i++)
                {
                    Population[i].bits = GetRandomBits();
                    Population[i].fitness = 0.0f;
                }
            }
        }
    }
}
</code></pre>

<p>I am getting an error on <code>Population[i].bits = GetRandomBits();</code> in <code>Main()</code>.</p>

<p>Error is:</p>

<blockquote>
  <p>An object reference is required for the non-static field, method, or property 'VM_Placement.Program.GetRandomBits()'</p>
</blockquote>

<p>Am I missing anything?</p>
","<p>The <code>Main</code> method is Static. You can not invoke a non-static method from a static method.</p>

<pre><code>GetRandomBits()
</code></pre>

<p>is not a static method. Either you have to create an instance of <code>Program</code></p>

<pre><code>Program p = new Program();
p.GetRandomBits();
</code></pre>

<p>or make</p>

<p><code>GetRandomBits()</code> static.</p>
","10264343"
"How to solve COM Exception Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))?","176829","","<p>When I try to create a instance of a COM class it throws an exception as </p>

<p><strong>Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))</strong></p>

<p>Please suggest how could i solve it?</p>
","<p>It looks like whichever program or process you're trying to initialize either isn't installed on your machine, has a damaged installation or needs to be registered.</p>

<p>Either install it, repair it (via Add/Remove Programs) or register it (via Regsvr32.exe).</p>

<p>You haven't provided enough information for us to help you any more than this.</p>
","1496238"
"How to define an enum with string value?","176637","","<p>I am trying to define an <code>Enum</code> and add valid common separators which used in CSV or similar files. Then I am going to bind it to a <code>ComboBox</code> as a data source so whenever I add or remove from the Enum definition, I would not need to change anything in the combo box.</p>

<p>The problem is how can I define enum with string representation, something like:</p>

<p><code>public enum SeparatorChars{Comma = "","", Tab = ""\t"", Space = "" ""}</code></p>
","<p>You can't - enum values have to be integral values. You can either use attributes to associate a string value with each enum value, or in this case if every separator is a single character you could just use the <code>char</code> value:</p>

<pre><code>enum Separator
{
    Comma = ',',
    Tab = '\t',
    Space = ' '
}
</code></pre>

<p>(EDIT: Just to clarify, you can't make <code>char</code> the underlying type of the enum, but you can use <code>char</code> constants to assign the integral value corresponding to each enum value. The underlying type of the above enum is <code>int</code>.)</p>

<p>Then an extension method if you need one:</p>

<pre><code>public string ToSeparatorString(this Separator separator)
{
    // TODO: validation
    return ((char) separator).ToString();
}
</code></pre>
","8588430"
"LINQ - Left Join, Group By, and Count","176596","","<p>Let's say I have this SQL:</p>

<pre><code>SELECT p.ParentId, COUNT(c.ChildId)
FROM ParentTable p
  LEFT OUTER JOIN ChildTable c ON p.ParentId = c.ChildParentId
GROUP BY p.ParentId
</code></pre>

<p>How can I translate this into LINQ to SQL? I got stuck at the COUNT(c.ChildId), the generated SQL always seems to output COUNT(*). Here's what I got so far:</p>

<pre><code>from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into j1
from j2 in j1.DefaultIfEmpty()
group j2 by p.ParentId into grouped
select new { ParentId = grouped.Key, Count = grouped.Count() }
</code></pre>

<p>Thank you!</p>
","<pre><code>from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into j1
from j2 in j1.DefaultIfEmpty()
group j2 by p.ParentId into grouped
select new { ParentId = grouped.Key, Count = grouped.Count(t=&gt;t.ChildId != null) }
</code></pre>
","695510"
"Entity Framework Join 3 Tables","176407","","<p>I'm trying to join three tables but I can't understand the method...</p>

<p>I completed join 2 tables</p>

<pre><code>        var entryPoint = dbContext.tbl_EntryPoint
            .Join(dbContext.tbl_Entry,
                c =&gt; c.EID,
                cm =&gt; cm.EID,
                (c, cm) =&gt; new
                {
                    UID = cm.OwnerUID,
                    TID = cm.TID,
                    EID = c.EID,
                }).
            Where(a =&gt; a.UID == user.UID).Take(10);
</code></pre>

<p><img src=""https://i.stack.imgur.com/N8DZE.png"" alt=""tables""></p>

<p>I would like to include <strong>tbl_Title</strong> table with <strong>TID</strong> PK and get <strong>Title</strong> field.</p>

<p>Thanks a lot</p>
","<p>I think it will be easier using syntax-based query:</p>

<pre><code>var entryPoint = (from ep in dbContext.tbl_EntryPoint
                 join e in dbContext.tbl_Entry on ep.EID equals e.EID
                 join t in dbContext.tbl_Title on e.TID equals t.TID
                 where e.OwnerID == user.UID
                 select new {
                     UID = e.OwnerID,
                     TID = e.TID,
                     Title = t.Title,
                     EID = e.EID
                 }).Take(10);
</code></pre>

<p>And you should probably add <code>orderby</code> clause, to make sure <code>Top(10)</code> returns correct top ten items.</p>
","21051754"
"How can I get the baseurl of site?","176363","","<p>I want to write a little helper method which returns the base URL of the site. This is what I came up with:</p>

<pre><code>public static string GetSiteUrl()
{
    string url = string.Empty;
    HttpRequest request = HttpContext.Current.Request;

    if (request.IsSecureConnection)
        url = ""https://"";
    else
        url = ""http://"";

    url += request[""HTTP_HOST""] + ""/"";

    return url;
}
</code></pre>

<p>Is there any mistake in this, that you can think of? Can anyone improve upon this?</p>
","<p>Try this:</p>

<pre><code>string baseUrl = Request.Url.Scheme + ""://"" + Request.Url.Authority + 
    Request.ApplicationPath.TrimEnd('/') + ""/"";
</code></pre>
","7413510"
"How to convert DataSet to DataTable","176320","","<p>I am retrieving data from a SQL table so I can display the result on the page as a HTML table. Later I need to be able to save that table as a CSV file. </p>

<p>So far I have figured out how to retrieve the data and fill them in a dataset for display purpose (which is working perfectly)...</p>

<pre><code>        string selectQuery = ""SELECT Name, ProductNumber, ListPrice FROM Poduction.Product"";

        // Establish the connection to the SQL database 
        SqlConnection conn = ConnectionManager.GetConnection();
        conn.Open();

        // Connect to the SQL database using the above query to get all the data from table.
        SqlDataAdapter myCommand = new SqlDataAdapter(selectQuery, conn);

        // Create and fill a DataSet.
        DataSet ds = new DataSet();
        myCommand.Fill(ds);
</code></pre>

<p>and how to save them in a CSV file with the help of following code from: <a href=""http://www.evontech.com/login/topic/1983.html"" rel=""nofollow noreferrer"">http://www.evontech.com/login/topic/1983.html</a></p>

<pre><code>    private void exportDataTableToCsv(DataTable formattedDataTable, string filename)
    {
       DataTable toExcel = formattedDataTable.Copy();
       HttpContext context = HttpContext.Current;
       context.Response.Clear();

       foreach (DataColumn column in toExcel.Columns)
       {
          context.Response.Write(column.ColumnName + "","");
       }

       context.Response.Write(Environment.NewLine);
       foreach (DataRow row in toExcel.Rows)
       {
          for (int i = 0; i &lt; toExcel.Columns.Count; i++)
          {
             context.Response.Write(row.ToString().Replace("","", string.Empty) + "","");
          }

          context.Response.Write(Environment.NewLine);
       }

       context.Response.ContentType = ""text/csv"";
       context.Response.AppendHeader(""Content-Disposition"", ""attachment; filename="" + filename + "".csv"");
       context.Response.End();
    }
</code></pre>

<p>Now my problem is how do I convert this <code>DataSet</code> to <code>DataTable</code>? I have tried the way described here with <strong>NO</strong> luck: <a href=""http://www.ezineasp.net/post/ASP-Net-C-sharp-Convert-DataSet-to-DataTable.aspx"" rel=""nofollow noreferrer"">http://www.ezineasp.net/post/ASP-Net-C-sharp-Convert-DataSet-to-DataTable.aspx</a></p>

<p>Can anyone help me?</p>
","<p>A <code>DataSet</code> already <em>contains</em> <code>DataTables</code>. You can just use:</p>

<pre><code>DataTable firstTable = dataSet.Tables[0];
</code></pre>

<p>or by name:</p>

<pre><code>DataTable customerTable = dataSet.Tables[""Customer""];
</code></pre>

<p>Note that you should have <code>using</code> statements for your SQL code, to ensure the connection is disposed properly:</p>

<pre><code>using (SqlConnection conn = ...)
{
    // Code here...
}
</code></pre>
","8983284"
"Write bytes to file","176116","","<p>I have a hexadecimal string (e.g <code>0CFE9E69271557822FE715A8B3E564BE</code>) and I want to write it to a file as bytes. For example,</p>

<pre><code>Offset      0  1  2  3  4  5  6  7   8  9 10 11 12 13 14 15
00000000   0C FE 9E 69 27 15 57 82  2F E7 15 A8 B3 E5 64 BE   .þži'.W‚/ç.¨³åd¾
</code></pre>

<p>How can I accomplish this using .NET and C#?</p>
","<p>If I understand you correctly, this should do the trick. You'll need add <code>using System.IO</code> at the top of your file if you don't already have it.</p>

<pre><code>public bool ByteArrayToFile(string fileName, byte[] byteArray)
{
    try
    {
        using (var fs = new FileStream(fileName, FileMode.Create, FileAccess.Write))
        {
            fs.Write(byteArray, 0, byteArray.Length);
            return true;
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine(""Exception caught in process: {0}"", ex);
        return false;
    }
}
</code></pre>
","6397249"
"How to shut down the computer from C#","175926","","<p>What's the best way to shut down the computer from a C# program?</p>

<p>I've found a few methods that work - I'll post them below - but none of them are very elegant. I'm looking for something that's simpler and natively .net.</p>
","<p>Taken from: <a href=""http://www.geekpedia.com/code36_Shut-down-system-using-Csharp.html"" rel=""noreferrer"">a Geekpedia post</a></p>

<p>This method uses <a href=""http://en.wikipedia.org/wiki/Windows_Management_Instrumentation"" rel=""noreferrer"">WMI</a> to shutdown windows.</p>

<p>You'll need to add a reference to System.Management to your project to use this.</p>

<pre><code>using System.Management;

void Shutdown()
{
    ManagementBaseObject mboShutdown = null;
    ManagementClass mcWin32 = new ManagementClass(""Win32_OperatingSystem"");
    mcWin32.Get();

    // You can't shutdown without security privileges
    mcWin32.Scope.Options.EnablePrivileges = true;
    ManagementBaseObject mboShutdownParams =
             mcWin32.GetMethodParameters(""Win32Shutdown"");

     // Flag 1 means we want to shut down the system. Use ""2"" to reboot.
    mboShutdownParams[""Flags""] = ""1"";
    mboShutdownParams[""Reserved""] = ""0"";
    foreach (ManagementObject manObj in mcWin32.GetInstances())
    {
        mboShutdown = manObj.InvokeMethod(""Win32Shutdown"", 
                                       mboShutdownParams, null);
    }
}
</code></pre>
","102583"
"Indentation shortcuts in Visual Studio","175911","","<p>I'm new to Visual Studio 2010 and C#. How can I indent the selected text to left/right by using shortcuts?</p>

<p><img src=""https://i.stack.imgur.com/DVw7b.png"" alt=""enter image description here""></p>

<p>In the Delphi IDE the equivalents are <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd> and <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>U</kbd></p>
","<p><kbd>Tab</kbd> and <kbd>Shift</kbd>+<kbd>Tab</kbd> will do that.</p>

<p>Another cool trick is holding down <kbd>ALT</kbd> when you select text, it will allow you to make a square selection.  Starting with VS2010, you can start typing and it will replace the contents of your square selection with what you type.  Absolutely awesome for changing a bunch of lines at once.</p>
","9012079"
"Validating an XML against referenced XSD in C#","175896","","<p>I have an XML file with a specified schema location such as this:</p>

<pre><code>xsi:schemaLocation=""someurl ..\localSchemaPath.xsd""
</code></pre>

<p>I want to validate in C#.  Visual Studio, when I open the file, validates it against the schema and lists errors perfectly.  Somehow, though, I can't seem to validate it automatically in C# without specifying the schema to validate against like so:</p>

<pre><code>XmlDocument asset = new XmlDocument();

XmlTextReader schemaReader = new XmlTextReader(""relativeSchemaPath"");
XmlSchema schema = XmlSchema.Read(schemaReader, SchemaValidationHandler);

asset.Schemas.Add(schema);

asset.Load(filename);
asset.Validate(DocumentValidationHandler);
</code></pre>

<p>Shouldn't I be able to validate with the schema specified in the XML file automatically ?  What am I missing ?</p>
","<p>You need to create an XmlReaderSettings instance and pass that to your XmlReader when you create it. Then you can subscribe to the <code>ValidationEventHandler</code> in the settings to receive validation errors. Your code will end up looking like this:</p>

<pre><code>using System.Xml;
using System.Xml.Schema;
using System.IO;

public class ValidXSD
{
    public static void Main()
    {

        // Set the validation settings.
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessInlineSchema;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessSchemaLocation;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
        settings.ValidationEventHandler += new ValidationEventHandler(ValidationCallBack);

        // Create the XmlReader object.
        XmlReader reader = XmlReader.Create(""inlineSchema.xml"", settings);

        // Parse the file. 
        while (reader.Read()) ;

    }
    // Display any warnings or errors.
    private static void ValidationCallBack(object sender, ValidationEventArgs args)
    {
        if (args.Severity == XmlSeverityType.Warning)
            Console.WriteLine(""\tWarning: Matching schema not found.  No validation occurred."" + args.Message);
        else
            Console.WriteLine(""\tValidation error: "" + args.Message);

    }
}
</code></pre>
","752774"
"DataGridView.Clear()","175699","","<p>Here comes the trouble.
I want to delete all rows from datagridview.
This how i add rows:</p>

<pre><code>private void ReadCompleteCallback(object clientHandle, Opc.Da.ItemValueResult[]     results)
{
    foreach (Opc.Da.ItemValueResult readResult in results)
    {
        dataGridView1.Invoke(new MethodInvoker(() =&gt; dataGridView1.Rows.Add(readResult.ItemName, readResult.Quality, readResult.Timestamp,readResult.Value)));        
    }
}                              
</code></pre>

<p>And its how i clear gridview:</p>

<pre><code>private void treeView1_SelectionsChanged(object sender, EventArgs e)
{
    dataGridView1.Rows.Clear();
    items = new Opc.Da.Item[treeView1.SelectedNodes.Count]; 
    foreach (TreeNode x in treeView1.SelectedNodes) {
        items[treeView1.SelectedNodes.IndexOf(x)] = new Opc.Da.Item();
        items[treeView1.SelectedNodes.IndexOf(x)].ItemName = x.Text; 
    }

    group.AddItems(items);
    group.Read(group.Items, 123, new Opc.Da.ReadCompleteEventHandler(ReadCompleteCallback), out req);
}
</code></pre>

<p>in debug i see that dataGridVIew1.Rows.Count=0, but on form, grid doesnt become clear. what a point?
on each selection in tree, i want to see new rows in table.</p>
","<p>I'm betting you just need to refresh the datagrid. Try this:</p>

<pre><code>dataGridView1.Rows.Clear();
dataGridView1.Refresh();
</code></pre>

<p>If this works... you might want to rethink this part of your application.</p>
","3745070"
"Getting all types that implement an interface","175575","","<p>Using reflection, how can I get all types that implement an interface with C# 3.0/.NET 3.5 with the least code, and minimizing iterations?</p>

<p>This is what I want to re-write:</p>

<pre><code>foreach (Type t in this.GetType().Assembly.GetTypes())
    if (t is IMyInterface)
        ; //do stuff
</code></pre>
","<p>Mine would be this in c# 3.0 :)</p>

<pre><code>var type = typeof(IMyInterface);
var types = AppDomain.CurrentDomain.GetAssemblies()
    .SelectMany(s =&gt; s.GetTypes())
    .Where(p =&gt; type.IsAssignableFrom(p));
</code></pre>

<p>Basically, the least amount of iterations will always be:</p>

<pre><code>loop assemblies  
 loop types  
  see if implemented.
</code></pre>
","26750"
"How to get character for a given ascii value","175340","","<p>How can I get the ascii character of a given ascii code.</p>

<p>e.g. I'm looking for a method that given the code 65 would return ""A"".</p>

<p>Thanks</p>
","<p>Do you mean ""A"" (a <code>string</code>) or 'A' (a <code>char</code>)?</p>

<pre><code>int unicode = 65;
char character = (char) unicode;
string text = character.ToString();
</code></pre>

<p>Note that I've referred to Unicode rather than ASCII as that's C#'s native character encoding; essentially each <code>char</code> is a UTF-16 code point.</p>
","4648787"
"Parse JSON in C#","175259","","<p>I'm trying to parse some JSON data from the Google AJAX Search API. I have <a href=""http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=cheese&amp;rsz=large"" rel=""noreferrer"">this URL</a> and I'd like to break it down so that the results are displayed. I've currently written this code, but I'm pretty lost in regards of what to do next, although there are a number of examples out there with simplified JSON strings.</p>

<p>Being new to C# and .NET in general I've struggled to get a genuine text output for my ASP.NET page so I've been recommended to give JSON.NET a try. Could anyone point me in the right direction to just simply writing some code that'll take in JSON from the Google AJAX Search API and print it out to the screen?</p>

<hr>

<p><strong>EDIT:</strong> ALL FIXED! All results are working fine. Thank you again Dreas Grech!</p>

<pre><code>using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.ServiceModel.Web;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;
using System.IO;
using System.Text;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        GoogleSearchResults g1 = new GoogleSearchResults();
        const string json = @""{""""responseData"""": {""""results"""":[{""""GsearchResultClass"""":""""GwebSearch"""",""""unescapedUrl"""":""""http://www.cheese.com/"""",""""url"""":""""http://www.cheese.com/"""",""""visibleUrl"""":""""www.cheese.com"""",""""cacheUrl"""":""""http://www.google.com/search?q\u003dcache:bkg1gwNt8u4J:www.cheese.com"""",""""title"""":""""\u003cb\u003eCHEESE\u003c/b\u003e.COM - All about \u003cb\u003echeese\u003c/b\u003e!."""",""""titleNoFormatting"""":""""CHEESE.COM - All about cheese!."""",""""content"""":""""\u003cb\u003eCheese\u003c/b\u003e - everything you want to know about it. Search \u003cb\u003echeese\u003c/b\u003e by name, by types   of milk, by textures and by countries.""""},{""""GsearchResultClass"""":""""GwebSearch"""",""""unescapedUrl"""":""""http://en.wikipedia.org/wiki/Cheese"""",""""url"""":""""http://en.wikipedia.org/wiki/Cheese"""",""""visibleUrl"""":""""en.wikipedia.org"""",""""cacheUrl"""":""""http://www.google.com/search?q\u003dcache:n9icdgMlCXIJ:en.wikipedia.org"""",""""title"""":""""\u003cb\u003eCheese\u003c/b\u003e - Wikipedia, the free encyclopedia"""",""""titleNoFormatting"""":""""Cheese - Wikipedia, the free encyclopedia"""",""""content"""":""""\u003cb\u003eCheese\u003c/b\u003e is a food consisting of proteins and fat from milk, usually the milk of   cows, buffalo, goats, or sheep. It is produced by coagulation of the milk \u003cb\u003e...\u003c/b\u003e""""},{""""GsearchResultClass"""":""""GwebSearch"""",""""unescapedUrl"""":""""http://www.ilovecheese.com/"""",""""url"""":""""http://www.ilovecheese.com/"""",""""visibleUrl"""":""""www.ilovecheese.com"""",""""cacheUrl"""":""""http://www.google.com/search?q\u003dcache:GBhRR8ytMhQJ:www.ilovecheese.com"""",""""title"""":""""I Love \u003cb\u003eCheese\u003c/b\u003e!, Homepage"""",""""titleNoFormatting"""":""""I Love Cheese!, Homepage"""",""""content"""":""""The American Dairy Association\u0026#39;s official site includes recipes and information   on nutrition and storage of \u003cb\u003echeese\u003c/b\u003e.""""},{""""GsearchResultClass"""":""""GwebSearch"""",""""unescapedUrl"""":""""http://www.gnome.org/projects/cheese/"""",""""url"""":""""http://www.gnome.org/projects/cheese/"""",""""visibleUrl"""":""""www.gnome.org"""",""""cacheUrl"""":""""http://www.google.com/search?q\u003dcache:jvfWnVcSFeQJ:www.gnome.org"""",""""title"""":""""\u003cb\u003eCheese\u003c/b\u003e"""",""""titleNoFormatting"""":""""Cheese"""",""""content"""":""""\u003cb\u003eCheese\u003c/b\u003e uses your webcam to take photos and videos, applies fancy special effects   and lets you share the fun with others. It was written as part of Google\u0026#39;s \u003cb\u003e...\u003c/b\u003e""""}],""""cursor"""":{""""pages"""":[{""""start"""":""""0"""",""""label"""":1},{""""start"""":""""4"""",""""label"""":2},{""""start"""":""""8"""",""""label"""":3},{""""start"""":""""12"""",""""label"""":4},{""""start"""":""""16"""",""""label"""":5},{""""start"""":""""20"""",""""label"""":6},{""""start"""":""""24"""",""""label"""":7},{""""start"""":""""28"""",""""label"""":8}],""""estimatedResultCount"""":""""14400000"""",""""currentPageIndex"""":0,""""moreResultsUrl"""":""""http://www.google.com/search?oe\u003dutf8\u0026ie\u003dutf8\u0026source\u003duds\u0026start\u003d0\u0026hl\u003den-GB\u0026q\u003dcheese""""}}, """"responseDetails"""": null, """"responseStatus"""": 200}"";
        g1 = JSONHelper.Deserialise&lt;GoogleSearchResults&gt;(json);
        Response.Write(g1.content);
    }
}

public class JSONHelper
{
    public static T Deserialise&lt;T&gt;(string json)
    {
        T obj = Activator.CreateInstance&lt;T&gt;();
        MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(json));
        DataContractJsonSerializer serialiser = new DataContractJsonSerializer(obj.GetType());
        ms.Close();
        return obj;
    }
}
/// Deserialise from JSON
[Serializable]
public class GoogleSearchResults
{
    public GoogleSearchResults() { }
    public GoogleSearchResults(string _unescapedUrl, string _url, string _visibleUrl, string _cacheUrl, string _title, string _titleNoFormatting, string _content)
    {
        this.unescapedUrl = _unescapedUrl;
        this.url = _url;
        this.visibleUrl = _visibleUrl;
        this.cacheUrl = _cacheUrl;
        this.title = _title;
        this.titleNoFormatting = _titleNoFormatting;
        this.content = _content;
    }

    string _unescapedUrl;
    string _url;
    string _visibleUrl;
    string _cacheUrl;
    string _title;
    string _titleNoFormatting;
    string _content;

    [DataMember]
    public string unescapedUrl
    {
        get { return _unescapedUrl; }
        set { _unescapedUrl = value; }
    }

    [DataMember]
    public string url
    {
        get { return _url; }
        set { _url = value; }
    }

    [DataMember]
    public string visibleUrl
    {
        get { return _visibleUrl; }
        set { _visibleUrl = value; }
    }
    [DataMember]
    public string cacheUrl
    {
        get { return _cacheUrl; }
        set { _cacheUrl = value; }
    }

    [DataMember]
    public string title
    {
        get { return _title; }
        set { _title = value; }
    }

    [DataMember]
    public string titleNoFormatting
    {
        get { return _titleNoFormatting; }
        set { _titleNoFormatting = value; }
    }

    [DataMember]
    public string content
    {
        get { return _content; }
        set { _content = value; }
    }
}
</code></pre>

<p>The code currently compiles and runs perfectly, but isn't returning any results. Could someone help me with returning what I require, the results ready to print out to the screen?</p>

<p><strong>Edit:</strong></p>

<p>Json.NET works using the same JSON and classes as the example above.</p>

<pre><code>GoogleSearchResults g1 = JsonConvert.DeserializeObject&lt;GoogleSearchResults&gt;(json);
</code></pre>

<p>Link: <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm"" rel=""noreferrer"">Serializing and Deserializing JSON with Json.NET</a></p>

<h2>Related</h2>

<p><a href=""https://stackoverflow.com/questions/802766/c-parsing-json-formatted-data-into-nested-hashtables"">C# - parsing json formatted data into nested hashtables</a><br>
<a href=""https://stackoverflow.com/questions/854028/parse-json-array"">Parse JSON array</a></p>
","<p><strong>[Update]</strong><br/>
I've just realized why you weren't receiving results back... you have a missing line in your <code>Deserialize</code> method.  You were forgetting to assign the results to your <code>obj</code> :</p>

<pre><code>public static T Deserialize&lt;T&gt;(string json)
{
    using (MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(json)))
    {
        DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(T));
        return (T)serializer.ReadObject(ms);
    } 
}
</code></pre>

<p>Also, just for reference, here is the <code>Serialize</code> method : </p>

<pre><code>public static string Serialize&lt;T&gt;(T obj)
{
    DataContractJsonSerializer serializer = new DataContractJsonSerializer(obj.GetType());
    using (MemoryStream ms = new MemoryStream())
    {
        serializer.WriteObject(ms, obj);
        return Encoding.Default.GetString(ms.ToArray());
    }
}
</code></pre>

<hr>

<p><strong>Edit</strong></p>

<p>If you want to use Json.NET here are the equivalent Serialize/Deserialize methods to the code above..</p>

<p>Deserialize:</p>

<pre><code>JsonConvert.DeserializeObject&lt;T&gt;(string json);
</code></pre>

<p>Serialize:</p>

<pre><code>JsonConvert.SerializeObject(object o);
</code></pre>

<p>This are already part of Json.NET so you can just call them on the JsonConvert class.</p>

<p><strong>Link: <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm"" rel=""noreferrer"">Serializing and Deserializing JSON with Json.NET</a></strong></p>

<hr>

<p><br/>Now, the reason you're getting a StackOverflow is because of your <code>Properties</code>.</p>

<p>Take for example this one : </p>

<pre><code>[DataMember]
public string unescapedUrl
{
    get { return unescapedUrl; } // &lt;= this line is causing a Stack Overflow
    set { this.unescapedUrl = value; }
}
</code></pre>

<p>Notice that in the <code>getter</code>, you are returning the actual property (ie the property's getter is calling itself over and over again), and thus you are creating an infinite recursion.</p>

<hr>

<p>Properties (in 2.0) should be defined like such : </p>

<pre><code>string _unescapedUrl; // &lt;= private field

[DataMember]
public string unescapedUrl
{
    get { return _unescapedUrl; } 
    set { _unescapedUrl = value; }
}
</code></pre>

<p>You have a private field and then you return the value of that field in the getter, and set the value of that field in the setter.</p>

<hr>

<p>Btw, if you're using the 3.5 Framework, you can just do this and avoid the backing fields, and let the compiler take care of that : </p>

<pre><code>public string unescapedUrl { get; set;}
</code></pre>
","1218902"
"Windows Forms ProgressBar: Easiest way to start/stop marquee?","175192","","<p>I am using C# and Windows Forms. I have a normal progress bar working fine in the program, but now I have another operation where the duration cannot be easily calculated. I would like to display a progress bar but don't know the best way to start/stop the scrolling marquee. I was hoping for something as simple as setting the marquee speed and then having a start() and stop() but it doesn't appear to be that simple. Do I have to run an empty loop in the background? How do I best do this? Thanks</p>
","<p>Use a progress bar with the style set to <code>Marquee</code>. This represents an indeterminate progress bar.</p>

<pre><code>myProgressBar.Style = ProgressBarStyle.Marquee;
</code></pre>

<p>You can also use the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.progressbar.marqueeanimationspeed.aspx"" rel=""noreferrer""><code>MarqueeAnimationSpeed</code></a> property to set how long it will take the little block of color to animate across your progress bar.</p>
","312999"
"What 'additional configuration' is necessary to reference a .NET 2.0 mixed mode assembly in a .NET 4.0 project?","175009","","<p>I have a project in which I'd like to use some of the .NET 4.0 features but a core requirement is that I can use the System.Data.SQLite framework which is compiled against 2.X. I see mention of this being possible such as <a href=""https://stackoverflow.com/questions/1609894/how-to-reference-net-4-0-assembly-within-net-3-5-projects"">the accepted answer here</a> but I don't see how to actually achieve this.</p>

<p>When I just try and run my 4.0 project while referencing the 2.X assembly I get:</p>

<blockquote>
  <p><em>Mixed mode assembly is built against version 'v2.0.50727' of the runtime 
  and cannot be loaded in the 4.0 runtime without additional 
  configuration information.</em></p>
</blockquote>

<p>What ""additional configuration"" is necessary?</p>
","<p>In order to use a CLR 2.0 <em>mixed mode assembly</em>, you need to modify your App.Config file to include:</p>

<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;<br/>&lt;configuration&gt;<br/>  &lt;startup <b>useLegacyV2RuntimeActivationPolicy=&quot;true&quot;</b>&gt;<br/>    &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.0&quot;/&gt;<br/>  &lt;/startup&gt;<br/>&lt;/configuration&gt;</code></pre>

<p>The key is the <code>useLegacyV2RuntimeActivationPolicy</code> flag.  This causes the CLR to use the latest version (4.0) to load your mixed mode assembly.  Without this, it will not work.</p>

<p>Note that this only matters for mixed mode (C++/CLI) assemblies.  You can load all managed CLR 2 assemblies without specifying this in <code>app.config</code>.</p>
","2455686"
"Best practices for catching and re-throwing .NET exceptions","174650","","<p>What are the best practices to consider when catching exceptions and re-throwing them? I want to make sure that the <code>Exception</code> object's <code>InnerException</code> and stack trace are preserved. Is there a difference between the following code blocks in the way they handle this?</p>

<pre><code>try
{
    //some code
}
catch (Exception ex)
{
    throw ex;
}
</code></pre>

<p>Vs:</p>

<pre><code>try
{
    //some code
}
catch
{
    throw;
}
</code></pre>
","<p>The way to preserve the stack trace is through the use of the <code>throw;</code> This is valid as well</p>

<pre><code>try {
  // something that bombs here
} catch (Exception ex)
{
    throw;
}
</code></pre>

<p><code>throw ex;</code> is basically like throwing an exception from that point, so the stack trace would only go to where you are issuing the <code>throw ex;</code> statement.</p>

<p><a href=""https://stackoverflow.com/questions/22623/net-throwing-exceptions-best-practices#22649"">Mike</a> is also correct, assuming the exception allows you to pass an exception (which is recommended).</p>

<p><a href=""http://openmymind.net"" rel=""noreferrer"">Karl Seguin</a> has a <a href=""http://codebetter.com/blogs/karlseguin/archive/2008/05/29/foundations-of-programming-pt-8-back-to-basics-exceptions.aspx"" rel=""noreferrer"">great write up on exception handling</a> in his <a href=""http://openmymind.net/FoundationsOfProgramming.pdf"" rel=""noreferrer"">foundations of programming e-book</a> as well, which is a great read.</p>

<p>Edit: Working link to <a href=""http://openmymind.net/FoundationsOfProgramming.pdf"" rel=""noreferrer"">Foundations of Programming</a> pdf. Just search the text for ""exception"".</p>
","22628"
"Using Server.MapPath in external C# Classes in ASP.NET","174197","","<p>I'm trying to get the absolute path of certain files in a C# class.  <code>Server.MapPath</code> works great of course for ASPX and their code-behind pages, but that doesn't exist in another class file.  I tried <code>HostingEnvironment.MapPath()</code>, but that complains that the relative virtual path isn't allowed.  Any thoughts?</p>

<p><code>System.Web</code> is already imported.</p>
","<p>The <code>ServerUtility</code> class is available as an instance in your <code>HttpContext</code>.  If you're in an environment where you know it'll be executed inside the ASP.Net pipeline, you can use</p>

<pre><code>HttpContext.Current.Server.MapPath()
</code></pre>

<p>You'll have to import <code>System.Web</code> though.</p>
","1190210"
"What are .NET Assemblies?","174043","","<p>What are .NET Assemblies? I browsed over the net and I am not able to understand the definition.</p>
","<p>In more simple terms: A chunk of (precompiled) code that can be executed by the .NET runtime environment. A .NET program consists of one or more assemblies. </p>
","2972763"
"Filtering collections in C#","173774","","<p>I am looking for a very fast way to filter down a collection in C#.  I am currently using generic List&lt;object&gt; collections, but am open to using other structures if they perform better.</p>

<p>Currently, I am just creating a new List&lt;object&gt; and looping thru the original list.  If the filtering criteria matches, I put a copy into the new list.</p>

<p>Is there a better way to do this?  Is there a way to filter in place so there is no temporary list required?</p>
","<p>If you're using C# 3.0 you can use linq, way better and way more elegant:</p>

<pre><code>List&lt;int&gt; myList = GetListOfIntsFromSomewhere();

// This will filter out the list of ints that are &gt; than 7, Where returns an
// IEnumerable&lt;T&gt; so a call to ToList is required to convert back to a List&lt;T&gt;.
List&lt;int&gt; filteredList = myList.Where( x =&gt; x &gt; 7).ToList();
</code></pre>
","26203"
"Regex to remove all special characters from string?","173698","","<p>I'm completely incapable of regular expressions, and so I need some help with a problem that I think would best be solved by using regular expressions.</p>

<p>I have list of strings in C#:</p>

<pre><code>List&lt;string&gt; lstNames = new List&lt;string&gt;();
lstNames.add(""TRA-94:23"");
lstNames.add(""TRA-42:101"");
lstNames.add(""TRA-109:AD"");

foreach (string n in lstNames) {
  // logic goes here that somehow uses regex to remove all special characters
  string regExp = ""NO_IDEA"";
  string tmp = Regex.Replace(n, regExp, """");
}
</code></pre>

<p>I need to be able to loop over the list and return each item without any special characters. For example, item one would be ""TRA9423"", item two would be ""TRA42101"" and item three would be TRA109AD. </p>

<p>Is there a regular expression that can accomplish this for me?</p>

<p>Also, the list contains more than 4000 items, so I need the search and replace to be efficient and quick if possible.</p>

<p>EDIT:
I should have specified that any character beside a-z, A-Z and 0-9 is special in my circumstance.</p>
","<p>It really depends on your definition of special characters. I find that a whitelist rather than a blacklist is the best approach in most situations:</p>

<pre><code>tmp = Regex.Replace(n, ""[^0-9a-zA-Z]+"", """");
</code></pre>

<p>You should be careful with your current approach because the following two items will be converted to the same string and will therefore be indistinguishable:</p>

<pre><code>""TRA-12:123""
""TRA-121:23""
</code></pre>
","3303435"
"How do you get the current project directory from C# code when creating a custom MSBuild task?","173520","","<p>Instead of running an external program with its path hardcoded, I would like to get the current Project Dir. I'm calling an external program using a process in the custom task.</p>

<p>How would I do that? AppDomain.CurrentDomain.BaseDirectory just gives me the location of VS 2008.</p>
","<p>You can try one of this two methods.</p>

<pre><code>string startupPath = System.IO.Directory.GetCurrentDirectory();

string startupPath = Environment.CurrentDirectory;
</code></pre>

<p>Tell me, which one seems to you better</p>
","816589"
"Convert object to JSON string in C#","173496","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/6201529/turn-c-sharp-object-into-a-json-string-in-net-4"">Turn C# object into a JSON string in .NET 4</a>  </p>
</blockquote>



<p>In the Java, I have a code to convert java object to JSON string. How to do the similar in the C# ? which JSON library I should use ?</p>

<p>Thanks.</p>

<p>JAVA code</p>

<pre><code>import net.sf.json.JSONArray;
import net.sf.json.JSONObject;

public class ReturnData {
    int total;

    List&lt;ExceptionReport&gt; exceptionReportList;  

    public String getJSon(){
        JSONObject json = new JSONObject(); 

        json.put(""totalCount"", total);

        JSONArray jsonArray = new JSONArray();
        for(ExceptionReport report : exceptionReportList){
            JSONObject jsonTmp = new JSONObject();
            jsonTmp.put(""reportId"", report.getReportId());      
            jsonTmp.put(""message"", report.getMessage());            
            jsonArray.add(jsonTmp);         
        }

        json.put(""reports"", jsonArray);
        return json.toString();
    }
    ...
}
</code></pre>
","<p>I have used <a href=""http://json.codeplex.com/"">Newtonsoft JSON.NET</a> (<a href=""http://james.newtonking.com/projects/json/help/"">Documentation</a>) It allows you to create a class / object, populate the fields, and serialize as JSON.  </p>

<pre><code>public class ReturnData 
{
    public int totalCount { get; set; }
    public List&lt;ExceptionReport&gt; reports { get; set; }  
}

public class ExceptionReport
{
    public int reportId { get; set; }
    public string message { get; set; }  
}


string json = JsonConvert.SerializeObject(myReturnData);
</code></pre>
","11345478"
"Import and Export Excel - What is the best library?","173485","","<p>In one of our ASP.NET applications in C#, we take a certain data collection (SubSonic collection) and export it to Excel. We also want to import Excel files in a specific format. I'm looking for a library I can use for this purpose. </p>

<p>Requirements:</p>

<ul>
<li>Excel 2007 files (Does Excel 2003 support over 64k rows? I need more than that.)</li>
<li>Does not require Excel on the server </li>
<li>Takes a typed collection and, if it can, tries to put numeric fields as numeric in Excel. </li>
<li>Works well with large files (100k to 10M) - fast enough.</li>
<li>Doesn't crash when exporting GUIDs!</li>
<li>Does not cost a crapload of money (no enterprise library like aspose). Free is always great, but can be a commercial library.</li>
</ul>

<p>What library do you recommend? Have you used it for large quantities of data? Are there other solutions? </p>

<p>Right now, I am using a simple tool that generates HTML that is loaded by Excel later on, but I am losing some capabilities, plus Excel complains when we load it. I don't need to generate charts or anything like that, just export raw data. </p>

<p>I am thinking of flat CSV files, but Excel is a customer requirement. I can work with CSV directly, if I had a tool to convert to and from Excel. Given Excel 2007 is an xml-based (and zipped) file format, I am guessing this kind of library should be easy to find. However, what matters most to me are your comments and opinions. </p>

<hr>

<p>EDIT: Ironically, in my opinion and following the answer with the most votes, the best Excel import&amp;export library is no export at all. This is not the case for all scenarios, but it is for mine. XLS files support only 64k rows. XLSX supports up to 1M. The free libraries that I've tried feature bad performance (one second to load one row when you have 200k rows). I haven't tried the paid ones, as I feel they are overpriced for the value they deliver when all you need is a fast XLSX&lt;->CSV conversion routine. </p>
","<p>I'm going to throw my hand in for flat csv files, if only because you've got the greatest control over the code. Just make sure that you read in the rows and process them one at a time (reading the document to the end and splitting will eat up all of your memory - same with writing, stream it out).</p>

<p>Yes, the user will have to save-as CSV in excel before you can process it, but perhaps this limitation can be overcome by training and providing clear instructions on the page?</p>

<p>Finally, when you export to the customer, if you set the mime type to text/csv, Excel is usually mapped to that type so it appears to the user to be 'an Excel file'.</p>
","445107"
"How to calculate the sum of the datatable column in asp.net?","173212","","<p>I have a DataTable which has 5 columns:</p>

<ul>
<li>ID</li>
<li>Name</li>
<li>Account Number</li>
<li>Branch </li>
<li>Amount</li>
</ul>

<p>The DataTable contains 5 rows.</p>

<p>How can I show the sum of the Amount Column in a Label Control as ""Total Amount""?</p>
","<p>To calculate the sum of a column in a DataTable use the <a href=""http://msdn.microsoft.com/en-us/library/system.data.datatable.compute.aspx"">DataTable.Compute</a> method.</p>

<p>Example of usage from the linked MSDN article:</p>

<pre><code>DataTable table;
table = dataSet.Tables[""YourTableName""];

// Declare an object variable.
object sumObject;
sumObject = table.Compute(""Sum(Amount)"", """");
</code></pre>

<p>Display the result in your Total Amount Label like so:</p>

<pre><code>lblTotalAmount.Text = sumObject.ToString();
</code></pre>
","5893054"
"How to send HTML-formatted email?","173070","","<p>I could be able to let the web application sends automatic emails using Windows Task Scheduler. Now I want to send HTML-Formatted email using the following method that I wrote for sending emails.</p>

<p>My code-behind:</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
    {
        SmtpClient sc = new SmtpClient(""mail address"");
        MailMessage msg = null;

        try
        {
            msg = new MailMessage(""xxxx@gmail.com"",
                ""yyyy@gmail.com"", ""Message from PSSP System"",
                ""This email sent by the PSSP system"");

             sc.Send(msg);
        }

        catch (Exception ex)
        {
            throw ex;
        }

        finally
        {
            if (msg != null)
            {
                msg.Dispose();
            }
        }
    }
</code></pre>

<p>How to do that? I just want to put some bold text with one link and maybe one image in the email.</p>
","<p>Setting <code>isBodyHtml</code> to <code>true</code> allows you to use HTML tags in the message body:</p>

<pre><code>msg = new MailMessage(""xxxx@gmail.com"",
                ""yyyy@gmail.com"", ""Message from PSSP System"",
                ""This email sent by the PSSP system&lt;br /&gt;"" +
                ""&lt;b&gt;this is bold text!&lt;/b&gt;"");

msg.IsBodyHtml = true;
</code></pre>
","8628697"
"Can I automatically increment the file build version when using Visual Studio?","172956","","<p>I was just wondering how I could <em>automatically</em> increment the build (and version?) of my files using Visual Studio (2005). </p>

<p>If I look up the properties of say <code>C:\Windows\notepad.exe</code>, the Version tab gives ""File version: 5.1.2600.2180"". I would like to get these cool numbers in the version of my dll's too, not version 1.0.0.0, which let's face it is a bit dull.</p>

<p>I tried a few things, but it doesn't seem to be out-of-box functionality, or maybe I'm just looking in the wrong place (as usual).</p>

<p>I work with mainly web projects....</p>

<p>I looked at both:</p>

<ol>
<li><a href=""http://www.codeproject.com/KB/dotnet/Auto_Increment_Version.aspx"" rel=""noreferrer"">http://www.codeproject.com/KB/dotnet/Auto_Increment_Version.aspx</a></li>
<li><a href=""http://www.codeproject.com/KB/dotnet/build_versioning.aspx"" rel=""noreferrer"">http://www.codeproject.com/KB/dotnet/build_versioning.aspx</a></li>
</ol>

<p>and I couldn't believe it so much effort to do something is standard practice.</p>

<p>EDIT:
<strong>It does not work in VS2005 as far I can tell (<a href=""http://www.codeproject.com/KB/dotnet/AutoIncrementVersion.aspx"" rel=""noreferrer"">http://www.codeproject.com/KB/dotnet/AutoIncrementVersion.aspx</a>)</strong></p>
","<p>In visual Studio 2008, the following works.</p>

<p>Find the AssemblyInfo.cs file and find these 2 lines:</p>

<pre><code>[assembly: AssemblyVersion(""1.0.0.0"")]
[assembly: AssemblyFileVersion(""1.0.0.0"")]
</code></pre>

<p>You could try changing this to:</p>

<pre><code>[assembly: AssemblyVersion(""1.0.*"")]
[assembly: AssemblyFileVersion(""1.0.*"")]
</code></pre>

<p>But this won't give you the desired result, you will end up with a Product Version of <strong>1.0.*</strong> and a File Version of <strong>1.0.0.0</strong>. Not what you want!</p>

<p>However, if you remove the second of these lines and just have:</p>

<pre><code>[assembly: AssemblyVersion(""1.0.*"")]
</code></pre>

<p>Then the compiler will set the File Version to be equal to the Product Version and you will get your desired result of an automatically increment product and file version which are in sync. E.g. <strong>1.0.3266.92689</strong></p>
","356694"
"Better way to check if a Path is a File or a Directory?","172916","","<p>I am processing a <code>TreeView</code> of directories and files. A user can select either a file or a directory and then do something with it. This requires me to have a method which performs different actions based on the user's selection.</p>

<p>At the moment I am doing something like this to determine whether the path is a file or a directory:</p>

<pre><code>bool bIsFile = false;
bool bIsDirectory = false;

try
{
    string[] subfolders = Directory.GetDirectories(strFilePath);

    bIsDirectory = true;
    bIsFile = false;
}
catch(System.IO.IOException)
{
    bIsFolder = false;
    bIsFile = true;
}
</code></pre>

<p>I cannot help to feel that there is a better way to do this! I was hoping to find a standard .NET method to handle this, but I haven't been able to do so. Does such a method exist, and if not, what is the most straightforward means to determine whether a path is a file or directory?</p>
","<p>From <a href=""http://bytes.com/topic/c-sharp/answers/248663-how-tell-if-path-file-directory"" rel=""noreferrer"">How to tell if path is file or directory</a>: </p>

<pre><code>// get the file attributes for file or directory
FileAttributes attr = File.GetAttributes(@""c:\Temp"");

//detect whether its a directory or file
if ((attr &amp; FileAttributes.Directory) == FileAttributes.Directory)
    MessageBox.Show(""Its a directory"");
else
    MessageBox.Show(""Its a file"");
</code></pre>

<h2>Update for .NET 4.0+</h2>

<p>Per the comments below, if you are on .NET 4.0 or later (and maximum performance is not critical) you can write the code in a cleaner way:</p>

<pre><code>// get the file attributes for file or directory
FileAttributes attr = File.GetAttributes(@""c:\Temp"");

if (attr.HasFlag(FileAttributes.Directory))
    MessageBox.Show(""Its a directory"");
else
    MessageBox.Show(""Its a file"");
</code></pre>
","1395226"
"LINQ: ""contains"" and a Lambda query","172768","","<p>I have a <code>List&lt;BuildingStatus&gt;</code> called <code>buildingStatus</code>. I'd like to check whether it contains a status whose char code (returned by <code>GetCharCode()</code>) equals some variable, <code>v.Status</code>.</p>

<p>Is there some way of doing this, along the lines of the (non-compiling) code below?</p>

<pre><code>buildingStatus.Contains(item =&gt; item.GetCharValue() == v.Status)
</code></pre>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/bb534972.aspx"" rel=""nofollow noreferrer""><strong><code>Any()</code></strong></a> instead of <code>Contains()</code>:</p>

<pre><code>buildingStatus.Any(item =&gt; item.GetCharValue() == v.Status)
</code></pre>
","1566464"
"C# Change A Button's Background Color","172761","","<p>Using C# and Visual Studio 2010, how can I change the background color of a button once another button is pressed? Am I not including a System.? wrong?</p>

<p>What I have at the moment is:</p>

<blockquote>
  <p>ButtonToday.Background = Color.Red;</p>
</blockquote>

<p>And it's not working.</p>
","<p>WinForm:</p>

<pre><code>private void button1_Click(object sender, EventArgs e)
{
   button2.BackColor = Color.Red;
}
</code></pre>

<p>WPF:</p>

<pre><code>private void button1_Click(object sender, RoutedEventArgs e)
{
   button2.Background = Brushes.Blue;
}
</code></pre>
","4991112"
"Multi-select dropdown list in ASP.NET","172710","","<p>Do any good multi-select dropdownlist with checkboxes (webcontrol) exist for asp.net?</p>

<p>Thanks a lot</p>
","<p>You could use the <code><a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx"" rel=""noreferrer"">System.Web.UI.WebControls.CheckBoxList</a></code> control or use the <code><a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listbox.aspx"" rel=""noreferrer"">System.Web.UI.WebControls.ListBox</a></code> control with the <code>SelectionMode</code> property set to <code>Multiple</code>.</p>
","774639"
"C# Linq Where Date Between 2 Dates","172660","","<p>I'm trying to get my linq statement to get me all records between two dates, and I'm not quite sure what I need to change to get it to work: <code>(a.Start &gt;= startDate &amp;&amp; endDate)</code></p>

<pre><code>var appointmentNoShow =
    from a in appointments
    from p in properties
    from c in clients
    where a.Id == p.OID &amp;&amp; (a.Start.Date &gt;= startDate.Date &amp;&amp; endDate)
</code></pre>
","<p>Just change it to</p>

<pre><code>var appointmentNoShow = from a in appointments
                        from p in properties
                        from c in clients
                        where a.Id == p.OID &amp;&amp; 
                       (a.Start.Date &gt;= startDate.Date &amp;&amp; a.Start.Date &lt;= endDate)
</code></pre>
","2237452"
"LINQ Aggregate algorithm explained","172338","","<p>This might sound lame, but  I have not been able to find a really good explanation of <code>Aggregate</code>.</p>

<p>Good means short, descriptive, comprehensive with a small and clear example.</p>
","<p>The easiest-to-understand definition of <code>Aggregate</code> is that it performs an operation on each element of the list taking into account the operations that have gone before. That is to say it performs the action on the first and second element and carries the result forward. Then it operates on the previous result and the third element and carries forward. etc.</p>

<p><strong>Example 1. Summing numbers</strong></p>

<pre><code>var nums = new[]{1,2,3,4};
var sum = nums.Aggregate( (a,b) =&gt; a + b);
Console.WriteLine(sum); // output: 10 (1+2+3+4)
</code></pre>

<p>This adds <code>1</code> and <code>2</code> to make <code>3</code>. Then adds <code>3</code> (result of previous) and <code>3</code> (next element in sequence) to make <code>6</code>. Then adds <code>6</code> and <code>4</code> to make <code>10</code>.</p>

<p><strong>Example 2. create a csv from an array of strings</strong></p>

<pre><code>var chars = new []{""a"",""b"",""c"", ""d""};
var csv = chars.Aggregate( (a,b) =&gt; a + ',' + b);
Console.WriteLine(csv); // Output a,b,c,d
</code></pre>

<p>This works in much the same way. Concatenate <code>a</code> a comma and <code>b</code> to make <code>a,b</code>. Then concatenates <code>a,b</code>  with a comma and <code>c</code> to make <code>a,b,c</code>. and so on.</p>

<p><strong>Example 3. Multiplying numbers using a seed</strong></p>

<p>For completeness, there is an <a href=""http://msdn.microsoft.com/en-us/library/bb549218.aspx"" rel=""noreferrer"">overload</a> of <code>Aggregate</code> which takes a seed value. </p>

<pre><code>var multipliers = new []{10,20,30,40};
var multiplied = multipliers.Aggregate(5, (a,b) =&gt; a * b);
Console.WriteLine(multiplied); //Output 1200000 ((((5*10)*20)*30)*40)
</code></pre>

<p>Much like the above examples, this starts with a value of <code>5</code> and multiplies it by the first element of the sequence <code>10</code> giving a result of <code>50</code>. This result is carried forward and multiplied by the next number in the sequence <code>20</code> to give a result of <code>1000</code>. This continues through the remaining 2 element of the sequence.</p>

<p>Live examples: <a href=""http://rextester.com/ZXZ64749"" rel=""noreferrer"">http://rextester.com/ZXZ64749</a><br>
Docs: <a href=""http://msdn.microsoft.com/en-us/library/bb548651.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/bb548651.aspx</a></p>

<hr>

<p><strong>Addendum</strong></p>

<p>Example 2, above, uses string concatenation to create a list of values separated by a comma. This is a simplistic way to explain the use of <code>Aggregate</code> which was the intention of this answer. However, if using this technique to actually create a large amount of comma separated data, it would be more appropriate to use a <code>StringBuilder</code>, and this is entirely compatible with <code>Aggregate</code> using the seeded overload to initiate the <code>StringBuilder</code>.</p>

<pre><code>var chars = new []{""a"",""b"",""c"", ""d""};
var csv = chars.Aggregate(new StringBuilder(), (a,b) =&gt; {
    if(a.Length&gt;0)
        a.Append("","");
    a.Append(b);
    return a;
});
Console.WriteLine(csv);
</code></pre>

<p>Updated example: <a href=""http://rextester.com/YZCVXV6464"" rel=""noreferrer"">http://rextester.com/YZCVXV6464</a></p>
","7105616"
"minimize app to system tray","172071","","<p>I have a Windows forms app powered by C# and Visual Studio 2010.</p>

<p>How can I minimize my app to system tray (not taskbar), then bring it back when doubled click in the system tray? any idea? also, how can I make some menu in the icon in system tray and when I right click it, it shows a menu like Login, Disconnect, Connect, something like that.
Also, are there any methods to show like a baloon popping up from the system tray?</p>

<p>PS: I already added a notifyIcon, but I do not know how to use it.</p>
","<ul>
<li><a href=""http://alperguc.blogspot.com/2008/11/c-system-tray-minimize-to-tray-with.html"" rel=""noreferrer"">C# System Tray Minimize To Tray With NotifyIcon</a></li>
<li><a href=""http://www.codeproject.com/KB/dialog/Minimize_To_Tray.aspx"" rel=""noreferrer"">Minimize window to system tray</a></li>
</ul>

<blockquote>
  <p>Handle the form’s Resize event. In this handler, you override the
  basic functionality of the Resize event to make the form minimize to
  the system tray and not to the taskbar. This can be done by doing the
  following in your form’s Resize event handler: Check whether the
  form’s WindowState property is set to FormWindowState.Minimized. If
  yes, hide your form, enable the NotifyIcon object, and show the
  balloon tip that shows some information. Once the WindowState becomes
  FormWindowState.Normal, disable the NotifyIcon object by setting its
  Visible property to false. Now, you want the window to reappear when
  you double click on the NotifyIcon object in the taskbar. For this,
  handle the NotifyIcon’s MouseDoubleClick event. Here, you show the
  form using the Show() method.</p>
</blockquote>

<pre><code>private void frmMain_Resize(object sender, EventArgs e)
{
    if (FormWindowState.Minimized == this.WindowState)
    {
       mynotifyicon.Visible = true;
       mynotifyicon.ShowBalloonTip(500);
       this.Hide();
    }

    else if (FormWindowState.Normal == this.WindowState)
    {
       mynotifyicon.Visible = false;
    }
}
</code></pre>
","7625426"
"How to set a dropdownlist item as selected in ASP.NET?","172042","","<p>I want to set selecteditem for asp. net dropdownlist control programmatically.</p>

<p>So I want to pass a value to the dropdownlist control to set the selected item where is the value of the item equal to the passed value.</p>
","<pre><code>dropdownlist.ClearSelection(); //making sure the previous selection has been cleared
dropdownlist.Items.FindByValue(value).Selected = true;
</code></pre>
","10975034"
"How can I declare a two dimensional string array?","171920","","<pre><code>string[][] Tablero = new string[3][3];
</code></pre>

<p>I need to have a 3x3 array arrangement to save information to. How do I declare this in C#?</p>
","<pre><code>string[,] Tablero = new string[3,3];
</code></pre>

<p>You can also instantiate it in the same line with array initializer syntax as follows:</p>

<pre><code>string[,] Tablero = new string[3, 3] {{""a"",""b"",""c""},
                                      {""d"",""e"",""f""}, 
                                      {""g"",""h"",""i""} };
</code></pre>
","3814164"
"How to add New Column with Value to the Existing DataTable?","171637","","<p>I have One DataTable with 5 Columns and 10 Rows.
     Now I want to add one New Column to the DataTable and I want to assign DropDownList value to the New Column.
     So the DropDownList value should be added 10 times to the New Column.
     How to do this?
Note: Without using FOR LOOP.</p>

<p>For Example: My Existing DataTable is like this.</p>

<pre><code>   ID             Value
  -----          -------
    1              100
    2              150
</code></pre>

<p>Now I want to add one New Column ""CourseID"" to this DataTable.
I have One DropDownList. Its selected value is 1.
So My Existing Table should be like below:</p>

<pre><code>    ID              Value         CourseID
   -----            ------       ----------
    1                100             1
    2                150             1
</code></pre>

<p>How to do this?</p>
","<p>Without For loop:</p>

<pre><code>Dim newColumn As New Data.DataColumn(""Foo"", GetType(System.String))     
newColumn.DefaultValue = ""Your DropDownList value"" 
table.Columns.Add(newColumn) 
</code></pre>

<p>This is untested. I used an online C# <a href=""http://www.developerfusion.com/tools/convert/vb-to-csharp/"">conversion tool</a>:</p>

<pre><code>System.Data.DataColumn newColumn = new System.Data.DataColumn(""Foo"", typeof(System.String));
newColumn.DefaultValue = ""Your DropDownList value"";
table.Columns.Add(newColumn);
</code></pre>
","6427038"
"How do I do logging in C#?","171485","","<p>I would like to implement logging in my application, but would rather not use any outside frameworks like log4net.</p>

<p>So I would like to do something like DOS's <a href=""https://ss64.com/nt/echo.html"" rel=""nofollow noreferrer"">echo</a> to a file. What is the most effective way to do it?</p>

<p>Is there a way to log unhandled exceptions logged without using an outside framework?</p>
","<pre><code>public void Logger(String lines)
{

 // Write the string to a file.append mode is enabled so that the log
 // lines get appended to  test.txt than wiping content and writing the log

  System.IO.StreamWriter file = new System.IO.StreamWriter(""c:\\test.txt"",true);
  file.WriteLine(lines);

  file.Close();

}
</code></pre>

<p>For more information <a href=""http://msdn.microsoft.com/en-us/library/aa287548%28v=vs.71%29.aspx"">MSDN</a>:</p>
","5057598"
"ASP.NET GridView RowIndex As CommandArgument","171473","","<p>How can you access and display the row index of a gridview item as the command argument in a  buttonfield column button?</p>

<pre><code>&lt;gridview&gt;
&lt;Columns&gt;
   &lt;asp:ButtonField  ButtonType=""Button"" 
        CommandName=""Edit"" Text=""Edit"" Visible=""True"" 
        CommandArgument="" ? ? ? "" /&gt;
.....
</code></pre>
","<p>Here is a very simple way:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;asp:ButtonField ButtonType=""Button"" CommandName=""Edit"" Text=""Edit"" Visible=""True"" 
                 CommandArgument='&lt;%# Container.DataItemIndex %&gt;' /&gt;
</code></pre>
","398358"
"How to get current user, and how to use User class in MVC5?","171134","","<ul>
<li>How can I get the id of the currently logged in user in <strong>MVC 5</strong>? I tried the StackOverflow suggestions, but they seem to be not for MVC 5. </li>
<li>Also, what is the MVC 5 best practice of assigning stuff to the users? (e.g. a <code>User</code> should have <code>Items</code>. Should I store the User's <code>Id</code> in <code>Item</code>? Can I extend the <code>User</code> class with an <code>List&lt;Item&gt;</code> navigation property?</li>
</ul>

<p>I'm using ""Individual User Accounts"" from the MVC template.</p>

<p>Tried these:</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/1045197/how-do-i-get-the-current-user-in-an-mvc-application"">How do I get the current user in an MVC Application?</a></li>
<li><a href=""https://stackoverflow.com/questions/263486/how-to-get-current-user-in-asp-net-mvc"">How to get the current user in ASP.NET MVC</a></li>
<li><a href=""https://stackoverflow.com/questions/13994967/get-logged-in-users-id"">Get logged in user&#39;s id</a> - this throws the following:</li>
</ul>

<blockquote>
  <p>'Membership.GetUser()' is null.</p>
</blockquote>
","<p>If you're coding in an ASP.NET MVC Controller, use</p>

<pre><code>using Microsoft.AspNet.Identity;

...

User.Identity.GetUserId();
</code></pre>

<p>Worth mentioning that <code>User.Identity.IsAuthenticated</code> and <code>User.Identity.Name</code> will work without adding the above mentioned <code>using</code> statement. But <code>GetUserId()</code> won't be present without it. </p>

<p>If you're in a class other than a Controller, use</p>

<pre><code>HttpContext.Current.User.Identity.GetUserId();
</code></pre>

<p>In the default template of MVC 5, user ID is a GUID stored as a string.</p>

<p>No best practice yet, but found some valuable info on extending the user profile:</p>

<ul>
<li>Overview of <code>Identity</code>: <a href=""http://blogs.msdn.com/b/webdev/archive/2013/06/27/introducing-asp-net-identity-membership-system-for-asp-net-applications.aspx"" rel=""noreferrer"">http://blogs.msdn.com/b/webdev/archive/2013/06/27/introducing-asp-net-identity-membership-system-for-asp-net-applications.aspx</a></li>
<li>Example solution regarding how to extend the user profile by adding an extra property: <a href=""https://github.com/rustd/AspnetIdentitySample"" rel=""noreferrer"">https://github.com/rustd/AspnetIdentitySample</a></li>
</ul>
","18451374"
"How to Find And Replace Text In A File With C#","170920","","<p>My code so far</p>

<pre><code>StreamReader reading = File.OpenText(""test.txt"");
string str;
while ((str = reading.ReadLine())!=null)
{
      if (str.Contains(""some text""))
      {
          StreamWriter write = new StreamWriter(""test.txt"");
      }
}
</code></pre>

<p>I know how to find the text, but I have no idea on how to replace the text in the file with my own.</p>
","<p>Read all file content. Make a replacement with <code>String.Replace</code>. Write content back to file.</p>

<pre><code>string text = File.ReadAllText(""test.txt"");
text = text.Replace(""some text"", ""new value"");
File.WriteAllText(""test.txt"", text);
</code></pre>
","13509665"
"Invalid column name sql error","170559","","<p>I am trying to enter data into my database, but it is giving me the following error:</p>

<blockquote>
  <p>Invalid column name</p>
</blockquote>

<p>Here's my code </p>

<pre><code>string connectionString = ""Persist Security Info=False;User ID=sa;Password=123;Initial Catalog=AddressBook;Server=Bilal-PC"";

using (SqlConnection connection = new SqlConnection(connectionString))
{
  SqlCommand cmd = new SqlCommand();

  cmd.CommandText = ""INSERT INTO Data (Name,PhoneNo,Address) VALUES ("" + txtName.Text + "","" + txtPhone.Text + "","" + txtAddress.Text + "");"";
  cmd.CommandType = CommandType.Text;
  cmd.Connection = connection;

  connection.Open();
  cmd.ExecuteNonQuery();
}
</code></pre>
","<p>Always try to use parametrized sql query to keep safe from malicious occurrence, so you could rearrange you code as below:</p>

<p>Also make sure that your table has column name matches to <code>Name</code>, <code>PhoneNo</code> ,<code>Address</code>.</p>

<pre><code>using (SqlConnection connection = new SqlConnection(connectionString))
{
    SqlCommand cmd = new SqlCommand(""INSERT INTO Data (Name, PhoneNo, Address) VALUES (@Name, @PhoneNo, @Address)"");
    cmd.CommandType = CommandType.Text;
    cmd.Connection = connection;
    cmd.Parameters.AddWithValue(""@Name"", txtName.Text);
    cmd.Parameters.AddWithValue(""@PhoneNo"", txtPhone.Text);
    cmd.Parameters.AddWithValue(""@Address"", txtAddress.Text);
    connection.Open();
    cmd.ExecuteNonQuery();
}
</code></pre>
","8390345"
"Shortcut to create properties in Visual Studio?","170376","","<p>I have seen some people creating properties in C# really fast, but how did they do it?</p>

<p>What shortcuts are available in Visual Studio (currently using Visual&nbsp;Studio&nbsp;2010) to create properties?</p>

<p>I am using C#.</p>

<p>For example,</p>

<pre><code>public string myString {get;set;}
</code></pre>
","<p>You could type ""prop"" and then press tab twice. That will generate the following.</p>

<pre><code>public TYPE Type { get; set; }
</code></pre>

<p>Then you change ""TYPE"" and ""Type"":</p>

<pre><code>public string myString {get; set;}
</code></pre>

<p>You can also get the full property typing ""propfull"" and then tab twice. That would generate the field and the full property.</p>

<pre><code>private int myVar;

public int MyProperty
{
    get { return myVar;}
    set { myVar = value;}
}
</code></pre>
","3871280"
"Windows Forms: How to hide Close (x) button?","170313","","<p>I have a modal dialog, and need to hide the Close (X) button, but I cannot use 
<code>ControlBox = false</code>, because I need to keep the Minimize and Maximize buttons.</p>

<p>I need to hide just Close button, is there any way to do that?</p>

<p>Thanks a lot!</p>

<p>Update: I had permission to disable it, which is simpler :) Thanks all!</p>
","<p>You can't hide it, but you can disable it by overriding the CreateParams property of the form.</p>

<pre><code>private const int CP_NOCLOSE_BUTTON = 0x200;
protected override CreateParams CreateParams
{
    get
    {
       CreateParams myCp = base.CreateParams;
       myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON ;
       return myCp;
    }
}
</code></pre>

<p>Source: <a href=""http://www.codeproject.com/KB/cs/DisableClose.aspx"" rel=""noreferrer"">http://www.codeproject.com/KB/cs/DisableClose.aspx</a></p>
","7301828"
"jQuery UI Dialog with ASP.NET button postback","170264","","<p>I have a jQuery UI Dialog working great on my ASP.NET page:</p>

<pre><code>jQuery(function() {
    jQuery(""#dialog"").dialog({
        draggable: true,
        resizable: true,
        show: 'Transfer',
        hide: 'Transfer',
        width: 320,
        autoOpen: false,
        minHeight: 10,
        minwidth: 10
    });
});

jQuery(document).ready(function() {
    jQuery(""#button_id"").click(function(e) {
        jQuery('#dialog').dialog('option', 'position', [e.pageX + 10, e.pageY + 10]);
        jQuery('#dialog').dialog('open');
    });
});
</code></pre>

<p>My div:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;div id=""dialog"" style=""text-align: left;display: none;""&gt;
    &lt;asp:Button ID=""btnButton"" runat=""server"" Text=""Button"" onclick=""btnButton_Click"" /&gt;
&lt;/div&gt;
</code></pre>

<p>But the btnButton_Click is never called... How can I solve that?</p>

<p>More information: I added this code to move div to form:</p>

<pre><code>jQuery(""#dialog"").parent().appendTo(jQuery(""form:first""));
</code></pre>

<p>But still without success...</p>
","<p>You are close to the solution, just getting the wrong object. It should be like this:</p>

<pre><code>jQuery(function() {
    var dlg = jQuery(""#dialog"").dialog({
                         draggable: true,
                         resizable: true,
                         show: 'Transfer',
                         hide: 'Transfer',
                         width: 320,
                         autoOpen: false,
                         minHeight: 10,
                         minwidth: 10
                     });
    dlg.parent().appendTo(jQuery(""form:first""));
});
</code></pre>
","768163"
"How to programmatically set cell value in DataGridView?","170247","","<p>I have a DataGridView. Some of the cells receive their data from a serial port: I want to shove the data into the cell, and have it update the underlying bound object.</p>

<p>I'm trying something like this:</p>

<pre><code>SetValueFromSerial (decimal newValue)
{
    dataGridView.CurrentCell.Value = newValue;
}
</code></pre>

<p>using a string doesn't help:</p>

<pre><code>    dataGridView.CurrentCell.Value = newValue.ToString ();
</code></pre>

<p>In both cases, I don't see anything in the grid, and the underlying value is unchanged.</p>

<p>I did Google and search here, but I didn't find anything. (I may have missed something, perhaps something obvious, but I'm not <em>utterly</em> lazy.)</p>
","<p>If the <code>DataGridView</code> is databound, you shouldn't directly modify the content of the cell. Instead, you should modify the databound object. You can access that object through the <code>DataBoundItem</code> of the <code>DataGridViewRow</code> :</p>

<pre><code>MyObject obj = (MyObject)dataGridView.CurrentRow.DataBoundItem;
obj.MyProperty = newValue;
</code></pre>

<p>Note that the bound object should implement <code>INotifyPropertyChanged</code> so that the change is reflected in the <code>DataGridView</code></p>
","1516269"
"C - determine if a number is prime","170037","","<p>I am trying to come up with a method that takes an integer and returns a boolean to say if the number is prime or not and I don't know much C; would anyone care to give me some pointers?</p>

<p>Basically, I would do this in C# like this:</p>

<pre><code>static bool IsPrime(int number)
{
    for (int i = 2; i &lt; number; i++)
    {
        if (number % i == 0 &amp;&amp; i != number)
            return false;
    }
    return true;
}
</code></pre>
","<p>OK, so forget about C.  Suppose I give you a number and ask you to determine if it's prime.  How do you do it?  Write down the steps clearly, <em>then</em> worry about translating them into code.</p>

<p>Once you have the algorithm determined, it will be much easier for you to figure out how to write a program, and for others to help you with it.</p>

<p><strong>edit:</strong> Here's the C# code you posted:</p>

<pre><code>static bool IsPrime(int number) {
    for (int i = 2; i &lt; number; i++) {
        if (number % i == 0 &amp;&amp; i != number) return false;
    }
    return true;
}
</code></pre>

<p>This is <em>very nearly</em> valid C as is; there's no <code>bool</code> type in C, and no <code>true</code> or <code>false</code>, so you need to modify it a little bit (edit: Kristopher Johnson correctly points out that C99 added the stdbool.h header).  Since some people don't have access to a C99 environment (but you should use one!), let's make that very minor change:</p>

<pre><code>int IsPrime(int number) {
    int i;
    for (i=2; i&lt;number; i++) {
        if (number % i == 0 &amp;&amp; i != number) return 0;
    }
    return 1;
}
</code></pre>

<p>This is a perfectly valid C program that does what you want.  We can improve it a little bit without too much effort.  First, note that <code>i</code> is always less than <code>number</code>, so the check that <code>i != number</code> always succeeds; we can get rid of it.</p>

<p>Also, you don't actually need to try divisors all the way up to <code>number - 1</code>; you can stop checking when you reach sqrt(number).  Since <code>sqrt</code> is a floating-point operation and that brings a whole pile of subtleties, we won't actually compute <code>sqrt(number)</code>.  Instead, we can just check that <code>i*i &lt;= number</code>:</p>

<pre><code>int IsPrime(int number) {
    int i;
    for (i=2; i*i&lt;=number; i++) {
        if (number % i == 0) return 0;
    }
    return 1;
}
</code></pre>

<p>One last thing, though; there was a small bug in your original algorithm!  If <code>number</code> is negative, or zero, or one, this function will claim that the number is prime.  You likely want to handle that properly, and you may want to make <code>number</code> be unsigned, since you're more likely to care about positive values only:</p>

<pre><code>int IsPrime(unsigned int number) {
    if (number &lt;= 1) return 0; // zero and one are not prime
    unsigned int i;
    for (i=2; i*i&lt;=number; i++) {
        if (number % i == 0) return 0;
    }
    return 1;
}
</code></pre>

<p>This definitely isn't the fastest way to check if a number is prime, but it works, and it's pretty straightforward.  We barely had to modify your code at all!</p>
","1538653"
"Could not load file or assembly 'Microsoft.ReportViewer.Common, Version=11.0.0.0","169880","","<p>I recently upgraded my n-tier solution from <strong>.NET 3.5 vs 2008 to 4.5 visual studio 2012</strong>. Every thing went fine apart from crystal reports and I had to install new runtime crystal reports for visual studio 2012 from the following link <a href=""http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_13_0_5.exe"" rel=""noreferrer"">http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_13_0_5.exe</a>.
After installing the above package I had to resolve some deprecated function and properties of 
CrystalViewer and after that reports rendering properly in development environment <strong>(Windows 7 64 bit, SQL Server 2005, Visual Studio 2012)</strong>. When I deployed the package in test environment windows server 2008 R2
the Application failed to load by throwing error 
Could not load file or assembly <strong>Microsoft.ReportViewer.WebForms, Version=11</strong></p>

<p>I managed to resolve ReportViewer.WebForms error by copying the DLL 
from <strong>C:\Program Files (x86)\Microsoft Visual Studio 11.0\ReportViewer</strong> to bin folder of solution and set property <strong>copylocal = true</strong> and deployed the package. After that I received the error <strong>Could not load file or assembly 'Microsoft.ReportViewer.Common, Version=11.0.0.0</strong> . I tried to search that DLL on my machine but couldn't. when project is running in visual studio, In <strong>Debug-> Windows->Module</strong>  the file is not listed however in global assembly cache that file is installed but I don't know how its installed to global cache and from where .  I found one solution that I had to install <strong>ReportViewer.msi</strong> from microsoft package but if i install this package it asks me to install SQL Server 2012 which I dont wan't. Could any one help me to resolve this issue. Thanks</p>
","<p>You can install the Microsoft Report Viewer 2012 Runtime and change your references so they point to the ones installed by the runtime.</p>

<p><a href=""http://www.microsoft.com/en-gb/download/details.aspx?id=35747"" rel=""noreferrer"">http://www.microsoft.com/en-gb/download/details.aspx?id=35747</a></p>

<p>I have installed the runtime without it asking for SQL Server 2012. Before installing try uninstalling any previous versions of report viewer.</p>
","22253867"
"Datagridview full row selection but get single cell value","169832","","<p>I have a datagridview that is a full row select.
How would I grab the data from only a certain cell no matter what cell in the row was clicked on since it highlights the entire row.</p>
","<p>You can do like this...... </p>

<pre><code>     private void datagridview1_SelectionChanged(object sender, EventArgs e)
     {
         if (datagridview1.SelectedCells.Count &gt; 0)
         {
             int selectedrowindex = datagridview1.SelectedCells[0].RowIndex;

             DataGridViewRow selectedRow = datagridview1.Rows[selectedrowindex];  

              string a = Convert.ToString(selectedRow.Cells[""you have to mention you cell  corresponding column name""].Value);           


         }
     }
</code></pre>
","7659577"
"Best way to implement keyboard shortcuts in a Windows Forms application?","169748","","<p>I'm looking for a best way to implement common Windows keyboard shortcuts (for example <kbd>Ctrl</kbd>+<kbd>F</kbd>, <kbd>Ctrl</kbd>+<kbd>N</kbd>) in my <a href=""http://en.wikipedia.org/wiki/Windows_Forms"" rel=""noreferrer"">Windows Forms</a> application in C#.</p>

<p>The application has a main form which hosts many child forms (one at a time). When a user hits <kbd>Ctrl</kbd>+<kbd>F</kbd>, I'd like to show a custom search form. The search form would depend on the current open child form in the application.</p>

<p>I was thinking of using something like this in the <em>ChildForm_KeyDown</em> event:</p>

<pre><code>   if (e.KeyCode == Keys.F &amp;&amp; Control.ModifierKeys == Keys.Control)
        // Show search form
</code></pre>

<p>But this doesn't work. The event doesn't even fire when you press a key. What is the solution?</p>
","<p>You probably forgot to set the form's <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx"" rel=""noreferrer"">KeyPreview</a> property to True. Overriding the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.control.processcmdkey.aspx"" rel=""noreferrer"">ProcessCmdKey()</a> method is the generic solution:</p>

<pre><code>protected override bool ProcessCmdKey(ref Message msg, Keys keyData) {
  if (keyData == (Keys.Control | Keys.F)) {
    MessageBox.Show(""What the Ctrl+F?"");
    return true;
  }
  return base.ProcessCmdKey(ref msg, keyData);
}
</code></pre>
","400325"
"How to get a Char from an ASCII Character Code in c#","169380","","<p>Im trying to parse a file in c# that has field (string) arrays separated by ascii character codes 0, 1 and 2 (in Visual Basic 6 you can generate these by using Chr(0) or Chr(1) etc.)</p>

<p>I know that for character code 0 in c# you can do the following:</p>

<pre><code>char separator = '\0';
</code></pre>

<p>But this doesnt work for character codes 1 and 2?</p>
","<p>Two options:</p>

<pre><code>char c1 = '\u0001';
char c1 = (char) 1;
</code></pre>
","3414929"
"How to reference Microsoft.Office.Interop.Excel dll?","169302","","<p>I had developed a system that deals with excel sheets in 2006 using MS VS 2005. Now, I can not  use the same reference with MS VS 2012.</p>

<pre><code>var app = new Microsoft.Office.Interop.Excel.Application();
Workbooks wbs = app.Workbooks;
</code></pre>
","<p>In your project, right-click on ""References"" and select ""Add Reference"".</p>

<p><strong>VS 2012 / 2013:</strong></p>

<p>Select ""Extensions"" on the left and look for <code>Microsoft.Office.Interop.Excel</code>.</p>

<p>Note that you can just type ""excel"" into the search box in the upper-right corner.</p>

<p><img src=""https://i.stack.imgur.com/J9l9j.png"" alt=""VS2012/2013 References"" title=""VS 2012 / 2013""></p>

<p><strong>VS 2008 / 2010:</strong></p>

<p>Look under the .NET tab.</p>

<p><img src=""https://i.stack.imgur.com/L1FKU.png"" alt=""VS 2010 References"" title=""VS 2008 / 2010""></p>
","15285939"
"WCF vs ASP.NET Web API","169236","","<p>I've spent a few months trying to grasp the concepts behind WCF and recently I've developed my first WCF service application.<br>
I've struggled quite a bit to understand all the settings in the config file.<br>
I am not convinced about the environment but it seems that you can do amazing stuff with it.<br>
The other day I've found out that Microsoft has come out with a new thing called <strong>ASP.NET Web API</strong>.<br>
For what I can read it's a <strong>RESTful framework</strong>, very easy to use and implement.<br>
Now, I am trying to figure out what are the main differences between the 2 frameworks and if I should try and convert my <em>old</em> WCF service application with the new API.</p>

<p>Could someone, please, help me to understand the differences and usage of each?</p>
","<p>The new <a href=""http://www.asp.net/web-api"">ASP.NET Web API</a> is a continuation of the previous <a href=""http://wcf.codeplex.com/"">WCF Web API</a> project (although some of the <a href=""http://wcf.codeplex.com/wikipage?title=How%20to%20Migrate%20from%20WCF%20Web%20API%20to%20ASP.NET%20Web%20API"">concepts have changed</a>).</p>

<p>WCF was originally created to enable SOAP-based services. For simpler RESTful or RPCish services (think clients like jQuery) ASP.NET Web API should be good choice.</p>
","9352630"
"Using .NET, how can you find the mime type of a file based on the file signature not the extension","169235","","<p>I am looking for a simple way to get a mime type where the file extension is incorrect or not given, something similar to <a href=""https://stackoverflow.com/questions/51438/getting-a-files-mime-type-in-java"">this question</a> only in .Net.</p>
","<p>In Urlmon.dll, there's a function called <code>FindMimeFromData</code>.</p>

<p>From the documentation </p>

<blockquote>
  <p>MIME type detection, or ""data sniffing,"" refers to the process of determining an appropriate MIME type from binary data. The final result depends on a combination of server-supplied MIME type headers, file extension, and/or the data itself. Usually, only the first 256 bytes of data are significant. </p>
</blockquote>

<p>So, read the first (up to) 256 bytes from the file and pass it to <code>FindMimeFromData</code>.</p>
","58570"
"Add new column and data to datatable that already contains data - c#","169101","","<p>How do I add a new <code>DataColumn</code> to a <code>DataTable</code> object that already contains data?</p>

<p>PseudoCode</p>

<pre><code>//call SQL helper class to get initial data 
DataTable dt = sql.ExecuteDataTable(""sp_MyProc"");

dt.Columns.Add(""NewColumn"", type(System.Int32));

foreach(DataRow row in dr.Rows)
{
    //need to set value to NewColumn column
}
</code></pre>
","<p>Just keep going with your code - you're on the right track:</p>

<pre><code>//call SQL helper class to get initial data 
DataTable dt = sql.ExecuteDataTable(""sp_MyProc"");

dt.Columns.Add(""NewColumn"", typeof(System.Int32));

foreach(DataRow row in dt.Rows)
{
    //need to set value to NewColumn column
    row[""NewColumn""] = 0;   // or set it to some other value
}

// possibly save your Dataset here, after setting all the new values
</code></pre>
","2313125"
"How do I convert Int/Decimal to float in C#?","169040","","<p>How does one convert from an int or a decimal to a float in C#?</p>

<p>I need to use a float for a third-party control, but I don't use them in my code, and I'm not sure how to end up with a float.</p>
","<p>You can just do a cast</p>

<pre><code>int val1 = 1;
float val2 = (float)val1;
</code></pre>

<p>or</p>

<pre><code>decimal val3 = 3;
float val4 = (float)val3;
</code></pre>
","1042104"
"How to inherit constructors?","168972","","<p><strong><em>Imagine</em></strong> a base class with many constructors and a virtual method</p>

<pre><code>public class Foo
{
   ...
   public Foo() {...}
   public Foo(int i) {...}
   ...
   public virtual void SomethingElse() {...}
   ...
}
</code></pre>

<p>and now i want to create a descendant class that overrides the virtual method:</p>

<pre><code>public class Bar : Foo 
{
   public override void SomethingElse() {...}
}
</code></pre>

<p>And another descendant that does some more stuff:</p>

<pre><code>public class Bah : Bar
{
   public void DoMoreStuff() {...}
}
</code></pre>

<p>Do i really have to copy all constructors from Foo into Bar and Bah? And then if i change a constructor signature in Foo, do i have to update it in Bar and Bah?</p>

<p>Is there no way to inherit constructors? Is there no way to encourage code reuse?</p>
","<p>Yes, you will have to implement the constructors that make sense for each derivation and then use the <code>base</code> keyword to direct that constructor to the appropriate base class or the <code>this</code> keyword to direct a constructor to another constructor in the same class.</p>

<p>If the compiler made assumptions about inheriting constructors, we wouldn't be able to properly determine how our objects were instantiated. In the most part, you should consider why you have so many constructors and consider reducing them to only one or two in the base class. The derived classes can then mask out some of them using constant values like <code>null</code> and only expose the necessary ones through their constructors.</p>

<h1>Update</h1>

<p>In C#4 you could specify default parameter values and use named parameters to make a single constructor support multiple argument configurations rather than having one constructor per configuration.</p>
","223068"
"Differences in string compare methods in C#","168928","","<p>Comparing string in C# is pretty simple.  In fact there are several ways to do it.  I have listed some in the block below.  What I am curious about are the differences between them and when one should be used over the others?  Should one be avoided at all costs?  Are there more I haven't listed?  </p>

<pre><code>string testString = ""Test"";
string anotherString = ""Another"";

if (testString.CompareTo(anotherString) == 0) {}
if (testString.Equals(anotherString)) {}
if (testString == anotherString) {}
</code></pre>

<p>(Note: I am looking for equality in this example, not less than or greater than but feel free to comment on that as well)</p>
","<p>Here are the rules for how these functions work:</p>

<p><strong>stringValue.CompareTo(otherStringValue):</strong></p>

<ol>
<li>null comes before a string</li>
<li>it uses CultureInfo.CurrentCulture.CompareInfo.Compare, which means it will use a culture-dependant comparison. This might mean that ß will compare equal to SS in Germany, or similar</li>
</ol>

<p><strong>stringValue.Equals(otherStringValue):</strong></p>

<ol>
<li>null is not considered equal to anything</li>
<li>unless you specify a StringComparison option, it will use what looks like a direct ordinal equality check, ie. ß is not the same as SS, in any language or culture</li>
</ol>

<p><strong>stringValue == otherStringValue:</strong></p>

<ol>
<li>Is not the same as stringValue.Equals().</li>
<li>The == operator calls the static Equals(string a, string b) method (which in turn goes to an internal EqualsHelper to do the comparison.</li>
<li>Calling .Equals() on a null string gets null reference exception, while on == does not. </li>
</ol>

<p><strong>Object.ReferenceEquals(stringValue, otherStringValue):</strong></p>

<p>Just checks that references are the same, ie. it isn't just two strings with the same contents, you're comparing a string object with itself.</p>

<hr>

<p>Note that with the options above that use method calls, there are overloads with more options to specify how to compare.</p>

<p>My advice if you just want to check for equality is to make up your mind wether you want to use a culture-dependant comparison or not, and then use .CompareTo or .Equals, depending on the choice.</p>
","44373"
"Problem with converting int to string in Linq to entities","168881","","<pre><code>var items = from c in contacts
            select new ListItem
            {
                Value = c.ContactId, //Cannot implicitly convert type 'int' (ContactId) to 'string' (Value).
                Text = c.Name
            };
var items = from c in contacts
            select new ListItem
            {
                Value = c.ContactId.ToString(), //Throws exception: ToString is not supported in linq to entities.
                Text = c.Name
            };
</code></pre>

<p>Is there anyway I can achieve this?
Note, that in VB.NET there is no problem use the first snippet it works just great, VB is flexible, im unable to get used to C#'s strictness!!!</p>
","<p>With EF v4 you can use <a href=""http://msdn.microsoft.com/en-us/library/dd466166.aspx"" rel=""noreferrer""><code>SqlFunctions.StringConvert</code></a>.  There is no overload for int so you need to cast to a double or a decimal.  Your code ends up looking like this:</p>

<pre><code>var items = from c in contacts
            select new ListItem
            {
                Value = SqlFunctions.StringConvert((double)c.ContactId).Trim(),
                Text = c.Name
            };
</code></pre>
","3292773"
"How to get last inserted id?","168879","","<p>I have this code:</p>

<pre><code>string insertSql = 
    ""INSERT INTO aspnet_GameProfiles(UserId,GameId) VALUES(@UserId, @GameId)"";

using (SqlConnection myConnection = new SqlConnection(myConnectionString))
{
   myConnection.Open();

   SqlCommand myCommand = new SqlCommand(insertSql, myConnection);

   myCommand.Parameters.AddWithValue(""@UserId"", newUserId);
   myCommand.Parameters.AddWithValue(""@GameId"", newGameId);

   myCommand.ExecuteNonQuery();

   myConnection.Close();
}
</code></pre>

<p>When I insert into this table, I have an auto_increment int primary key column called <code>GamesProfileId</code>, how can i get the last inserted one after this so I can use that id to insert into another table?</p>
","<p>For SQL Server 2005+, if there is no insert trigger, then change the insert statement (all one line, split for clarity here) to this </p>

<pre><code>INSERT INTO aspnet_GameProfiles(UserId,GameId)
OUTPUT INSERTED.ID
VALUES(@UserId, @GameId)
</code></pre>

<p>For SQL Server 2000, or if there is an insert trigger:</p>

<pre><code>INSERT INTO aspnet_GameProfiles(UserId,GameId) 
VALUES(@UserId, @GameId);
SELECT SCOPE_IDENTITY()
</code></pre>

<p>And then</p>

<pre><code> Int32 newId = (Int32) myCommand.ExecuteScalar();
</code></pre>
","5228819"
"Compare two List<T> objects for equality, ignoring order","168700","","<p>Yet another list-comparing question.</p>

<pre><code>List&lt;MyType&gt; list1;
List&lt;MyType&gt; list2;
</code></pre>

<p>I need to check that they both have the same elements, regardless of their position within the list. Each <strong>MyType</strong> object may appear multiple times on a list. Is there a built-in function that checks this? What if I guarantee that each element appears only once in a list?</p>

<p><strong>EDIT:</strong> Guys thanks for the answers but I forgot to add something, the number of occurrences of each element should be the same on both lists.</p>
","<p>If you want them to be really equal (i.e. the same items and the same number of each item), I think that the simplest solution is to sort before comparing:</p>

<pre><code>Enumerable.SequenceEqual(list1.OrderBy(t =&gt; t), list2.OrderBy(t =&gt; t))
</code></pre>

<h3>Edit:</h3>

<p>Here is a solution that performs a bit better (about ten times faster), and only requires <code>IEquatable</code>, not <code>IComparable</code>:</p>

<pre><code>public static bool ScrambledEquals&lt;T&gt;(IEnumerable&lt;T&gt; list1, IEnumerable&lt;T&gt; list2) {
  var cnt = new Dictionary&lt;T, int&gt;();
  foreach (T s in list1) {
    if (cnt.ContainsKey(s)) {
      cnt[s]++;
    } else {
      cnt.Add(s, 1);
    }
  }
  foreach (T s in list2) {
    if (cnt.ContainsKey(s)) {
      cnt[s]--;
    } else {
      return false;
    }
  }
  return cnt.Values.All(c =&gt; c == 0);
}
</code></pre>

<h3>Edit 2:</h3>

<p>To handle any data type as key (for example nullable types as Frank Tzanabetis pointed out), you can make a version that takes a <a href=""http://msdn.microsoft.com/en-us/library/ms132151.aspx"" rel=""noreferrer"">comparer</a> for the dictionary:</p>

<pre><code>public static bool ScrambledEquals&lt;T&gt;(IEnumerable&lt;T&gt; list1, IEnumerable&lt;T&gt; list2, IEqualityComparer&lt;T&gt; comparer) {
  var cnt = new Dictionary&lt;T, int&gt;(comparer);
  ...
</code></pre>
","3670089"
"Returning http status code from Web Api controller","168672","","<p>I'm trying to return a status code of 304 not modified for a GET method in a web api controller.</p>

<p>The only way I succeeded was something like this:</p>

<pre><code>public class TryController : ApiController
{
    public User GetUser(int userId, DateTime lastModifiedAtClient)
    {
        var user = new DataEntities().Users.First(p =&gt; p.Id == userId);
        if (user.LastModified &lt;= lastModifiedAtClient)
        {
             throw new HttpResponseException(HttpStatusCode.NotModified);
        }
        return user;
    }
}
</code></pre>

<p>The problem here is that it's not an exception, It's just not modified so the client cache is OK.
I also want the return type to be a User (as all the web api examples shows with GET) not return HttpResponseMessage or something like this.</p>
","<p>I did not know the answer so asked the ASP.NET team <a href=""http://aspnetwebstack.codeplex.com/discussions/356306"" rel=""noreferrer"">here</a>.</p>

<p>So the trick is to change the signature to <code>HttpResponseMessage</code> and use <code>Request.CreateResponse</code>.</p>

<pre><code>[ResponseType(typeof(User))]
public HttpResponseMessage GetUser(HttpRequestMessage request, int userId, DateTime lastModifiedAtClient)
{
    var user = new DataEntities().Users.First(p =&gt; p.Id == userId);
    if (user.LastModified &lt;= lastModifiedAtClient)
    {
         return new HttpResponseMessage(HttpStatusCode.NotModified);
    }
    return request.CreateResponse(HttpStatusCode.OK, user);
}
</code></pre>
","10658604"
"Creating Scheduled Tasks","168624","","<p>I am currently working on a C# WPF project. I need to allow the user to create and add a scheduled task to the Windows Task Scheduler. </p>

<p>How could I go about doing this and what using directives and references do I need as I am not finding much when searching the Internet. </p>
","<p>You can use <a href=""http://taskscheduler.codeplex.com/"" rel=""noreferrer"">Task Scheduler Managed Wrapper</a>:</p>

<pre><code>using System;
using Microsoft.Win32.TaskScheduler;

class Program
{
   static void Main(string[] args)
   {
      // Get the service on the local machine
      using (TaskService ts = new TaskService())
      {
         // Create a new task definition and assign properties
         TaskDefinition td = ts.NewTask();
         td.RegistrationInfo.Description = ""Does something"";

         // Create a trigger that will fire the task at this time every other day
         td.Triggers.Add(new DailyTrigger { DaysInterval = 2 });

         // Create an action that will launch Notepad whenever the trigger fires
         td.Actions.Add(new ExecAction(""notepad.exe"", ""c:\\test.log"", null));

         // Register the task in the root folder
         ts.RootFolder.RegisterTaskDefinition(@""Test"", td);

         // Remove the task we just created
         ts.RootFolder.DeleteTask(""Test"");
      }
   }
}
</code></pre>

<p>Alternatively you can use <a href=""http://msdn.microsoft.com/en-us/library/aa384006%28v=vs.85%29.aspx"" rel=""noreferrer"">native</a> API or go for <a href=""http://www.quartz-scheduler.net/"" rel=""noreferrer"">Quartz.NET</a>. See <a href=""https://stackoverflow.com/q/5115105/625332"">this</a> for details.</p>
","7394955"
"Access random item in list","168515","","<p>I have an ArrayList, and I need to be able to click a button and then randomly pick out a string from that list and display it in a messagebox.</p>

<p>How would I go about doing this?</p>
","<ol>
<li><p>Create an instance of <code>Random</code> class somewhere. Note that it's pretty important not to create a new instance each time you need a random number. You should reuse the old instance to achieve uniformity in the generated numbers. You can have a <code>static</code> field somewhere (be careful about thread safety issues):</p>

<pre><code>static Random rnd = new Random();
</code></pre></li>
<li><p>Ask the <code>Random</code> instance to give you a random number with the maximum of the number of items in the <code>ArrayList</code>:</p>

<pre><code>int r = rnd.Next(list.Count);
</code></pre></li>
<li><p>Display the string:</p>

<pre><code>MessageBox.Show((string)list[r]);
</code></pre></li>
</ol>
","2019432"
"How do I access named capturing groups in a .NET Regex?","168370","","<p>I'm having a hard time finding a good resource that explains how to use Named Capturing Groups in C#.  This is the code that I have so far:</p>

<pre><code>string page = Encoding.ASCII.GetString(bytePage);
Regex qariRegex = new Regex(""&lt;td&gt;&lt;a href=\""(?&lt;link&gt;.*?)\""&gt;(?&lt;name&gt;.*?)&lt;/a&gt;&lt;/td&gt;"");
MatchCollection mc = qariRegex.Matches(page);
CaptureCollection cc = mc[0].Captures;
MessageBox.Show(cc[0].ToString());
</code></pre>

<p>However this always just shows the full line:</p>

<pre><code>&lt;td&gt;&lt;a href=""/path/to/file""&gt;Name of File&lt;/a&gt;&lt;/td&gt; 
</code></pre>

<p>I have experimented with several other ""methods"" that I've found on various websites but I keep getting the same result.</p>

<p>How can I access the named capturing groups that are specified in my regex?</p>
","<p>Use the group collection of the Match object, indexing it with the capturing group name, e.g. </p>

<pre><code>foreach (Match m in mc){
    MessageBox.Show(m.Groups[""link""].Value);
}
</code></pre>
","906514"
"How can I get the active screen dimensions?","168256","","<p>What I am looking for is the equivalent of <code>System.Windows.SystemParameters.WorkArea</code> for the monitor that the window is currently on.</p>

<p><strong>Clarification:</strong>  The window in question is <code>WPF</code>, not <code>WinForm</code>.</p>
","<p><code>Screen.FromControl</code>, <code>Screen.FromPoint</code> and <code>Screen.FromRectangle</code> should help you with this. For example in WinForms it would be:</p>

<pre><code>class MyForm : Form
{
  public Rectangle GetScreen()
  {
    return Screen.FromControl(this).Bounds;
  }
}
</code></pre>

<p>I don't know of an equivalent call for WPF. Therefore, you need to do something like this extension method.</p>

<pre><code>static class ExtensionsForWPF
{
  public static System.Windows.Forms.Screen GetScreen(this Window window)
  {
    return System.Windows.Forms.Screen.FromHandle(new WindowInteropHelper(window).Handle);
  }
}
</code></pre>
","254241"
"What is [Serializable] and when should I use it?","168174","","<p>I found out that some classes use the <code>[Serializable]</code> attribute.</p>

<ul>
<li>What is it?   </li>
<li>When should I use it?   </li>
<li>What kinds of benefits will I get?  </li>
</ul>
","<h3>What is it?</h3>

<p>When you create an object in a .Net framework application, you don't need to think about how the data is stored in memory. Because the .Net Framework takes care of that for you. However, if you want to store the contents of an object to a file, send an object to another process or transmit it across the network, you do have to think about how the object is represented because you will need to convert to a different format. This conversion is called SERIALIZATION.</p>

<h3>Uses for Serialization</h3>

<p>Serialization allows the developer to save the state of an object and recreate it as needed, providing storage of objects as well as data exchange. Through serialization, a developer can perform actions like sending the object to a remote application by means of a Web Service, passing an object from one domain to another, passing an object through a firewall as an XML string, or maintaining security or user-specific information across applications. </p>

<p>Apply <a href=""http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx"" rel=""noreferrer""><code>SerializableAttribute</code></a> to a type to indicate that instances of this type can be serialized. Apply the <a href=""http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx"" rel=""noreferrer""><code>SerializableAttribute</code></a> even if the class also implements the <a href=""http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx"" rel=""noreferrer""><code>ISerializable</code></a> interface to control the serialization process.</p>

<p>All the public and private fields in a type that are marked by the <a href=""http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx"" rel=""noreferrer""><code>SerializableAttribute</code></a> are serialized by default, unless the type implements the <a href=""http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx"" rel=""noreferrer""><code>ISerializable</code></a> interface to override the serialization process. The default serialization process excludes fields that are marked with <a href=""http://msdn.microsoft.com/en-us/library/system.nonserializedattribute.aspx"" rel=""noreferrer""><code>NonSerializedAttribute</code></a>. If a field of a serializable type contains a pointer, a handle, or some other data structure that is specific to a particular environment, and cannot be meaningfully reconstituted in a different environment, then you might want to apply <a href=""http://msdn.microsoft.com/en-us/library/system.nonserializedattribute.aspx"" rel=""noreferrer""><code>NonSerializedAttribute</code></a> to that field.</p>

<p>See <a href=""http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx"" rel=""noreferrer"">MSDN</a> for more details.</p>
","5877839"
"C# Error ""The type initializer for ... threw an exception","168066","","<p>This error occurs only in some computers. By reading the stack information, there is some problem when I call to this static method (""FormatQuery"") in a static class:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Data;
using System.Diagnostics;
using System.IO;
using System.Text;
using System.Windows.Forms;
using DevExpress.XtraEditors;
using FlexCel.Report;
using FlexCel.XlsAdapter;
using ComboBox=System.Windows.Forms.ComboBox;

namespace XSoftArt.A
{
    static class RHelper
    {
        private static string FormatQuery(string FieldName, int Count,
            CheckedListBox chekedListBox)
        {
            string ID = string.Empty;
            int n = Count;

            foreach (DataRowView item in chekedListBox.CheckedItems)
            {
                ID = ID + item["""" + FieldName + """"];
                if (n &gt; 1)
                {
                    ID = ID + "" , "";
                    n--;
                }
            }
            return ID;
        }

        public static string FormatQuery(CheckedListBox chekedListBox)
        {
            return FormatQuery(chekedListBox.ValueMember,
                chekedListBox.CheckedItems.Count, chekedListBox);
        }
    }
</code></pre>

<p>So, what's the problem? How do I solve it? Is there something wrong with the project configuration or debbuging mode or what?</p>

<p>Error information:</p>

<pre><code>   at XSoftArt.EVS.ReportHelper.FormatQuery(CheckedListBox chekedListBox)
   at XSoftArt.EVS.NewEmailSelectClient.LoadList_v2(String search, TextBox txtbox)
   at XSoftArt.EVS.NewEmailSelectClient.LoadContacts()
   at XSoftArt.EVS.NewEmailSelectClient.button7_Click(Object sender, EventArgs e)
   at System.Windows.Forms.Control.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message&amp; m)
   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)
   at System.Windows.Forms.Button.WndProc(Message&amp; m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
</code></pre>
","<p>I tried your code:</p>

<pre><code>CheckedListBox cb = new CheckedListBox();
for (var i = 1; i &lt; 11; i++)
  cb.Items.Add(""Item "" + i, i % 3 == 0);

string fmt = RHelper.FormatQuery(cb);
Console.WriteLine(fmt);
Console.ReadLine();
</code></pre>

<p>It threw an exception at this line:</p>

<pre><code>foreach (DataRowView item in chekedListBox.CheckedItems)

// Unable to cast object of type 'System.String' to type 'System.Data.DataRowView'.
</code></pre>

<p>Maybe you are also facing the same kind of problem. Instead of casting to <strong>DataRowView</strong>, try making the following changes:</p>

<pre><code>foreach (var item in chekedListBox.CheckedItems)
{
    ID = ID + item.ToString(); // item["""" + FieldName + """"];
</code></pre>

<p>Because items in CheckedListBox are of <em>object</em> type.</p>
","1226258"
"C# LINQ select from list","168066","","<p>i have a list of event Ids returned from an xml document as shown below</p>

<pre><code>public IEnumerable&lt;EventFeed&gt; GetEventIdsByEventDate(DateTime eventDate)
    {

        return (from feed in xmlDoc.Descendants(""Show"")
                from ev in feed.Elements(""Event"")
                where Convert.ToDateTime(ev.Attribute(""Date"").Value).ToShortDateString() == eventDate.ToShortDateString()
                select new EventFeed()
                {
                    EventShowCode = feed.Attribute(""Code"").Value
                }).ToList();  
    }
</code></pre>

<p>i now need to query my database to match events that equal the eventIds returned from the above method. so i would have something like:</p>

<p>select * from eventsdb where eventId in GetEventIdsByEventDate()</p>

<p>how can i do this using LINQ</p>

<hr>

<p>i cant seem to get any of the answers working.</p>

<p>this is the method that looks up the eventIds from an XML feed</p>

<pre><code>public IList&lt;EventsDetails&gt; GetEventIds(DateTime eventDate)
    {

        var eventids = (from feed in xmlDoc.Descendants(""Show"")
                        from ev in feed.Elements(""Event"")
                        where Convert.ToDateTime(ev.Attribute(""Date"").Value).ToShortDateString() == eventDate.ToShortDateString()
                        select new EventsDetails()
                        {
                            EventId = feed.Attribute(""Code"").Value
                        }).ToList();

        return eventids;
    }
</code></pre>

<p>this is the method that looks up the events in my database</p>

<pre><code>public IEnumerable&lt;EventFeed&gt; GetAllEventsFromDatabase()
    {
        var allEvents = from eventsList in GetEventsList()
                        select new EventFeed()
                        {
                            EventName = eventsList.Title,
                            EventSummary = eventsList.Introduction,
                            EventShowCode = eventsList.EventId,
                            EventImageSmall = eventsList.EventImageThumbUrl,
                            EventUrl = eventsList.Url,
                            EventSortBy = eventsList.SortOrder
                        };

        return allEvents.OrderBy(x =&gt; x.EventSortBy);
    }
</code></pre>

<p>and this is the method to look up any matching eventIds in the XML that exist in my database</p>

<pre><code>public IEnumerable&lt;EventFeed&gt; FilteredEvents(DateTime eventDate)
    {

        return GetAllEventsFromDatabase().Where(p =&gt; GetEventIds(eventDate).Contains&lt;EventsDetails&gt;(p.EventShowCode)); 
    }
</code></pre>

<p>the project fails to build with the following error:</p>

<p>Error   9   Argument '2': cannot convert from 'string' to 'Events.EventsDetails'    </p>
","<pre><code>        var eventids = GetEventIdsByEventDate(DateTime.Now);
        var result = eventsdb.Where(e =&gt; eventids.Contains(e));
</code></pre>

<p>If you are returnning <code>List&lt;EventFeed&gt;</code> inside the method, you should change the method return type from <code>IEnumerable&lt;EventFeed&gt;</code> to <code>List&lt;EventFeed&gt;</code>. </p>
","3117092"
"C# getting file names without extensions","167799","","<p>When getting file names in a certain folder:</p>

<pre><code>DirectoryInfo di = new DirectoryInfo(currentDirName);
FileInfo[] smFiles = di.GetFiles(""*.txt"");
    foreach (FileInfo fi in smFiles)
    {
        builder.Append(fi.Name);
        builder.Append("", "");
        ...
    }
</code></pre>

<p>by <code>fi.Name</code> we get a file name with its extension: <code>file1.txt</code>, <code>file2.txt</code>, <code>file3.txt</code></p>

<p>How better to get file names without file extensions <code>file1</code>, <code>file2</code>, <code>file3</code>?</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx"" rel=""noreferrer""><code>Path.GetFileNameWithoutExtension</code></a>:</p>

<pre><code>foreach (FileInfo fi in smFiles)
{
    builder.Append(Path.GetFileNameWithoutExtension(fi.Name));
    builder.Append("", "");
}
</code></pre>

<p>Although I am surprised there isn't a way to get this directly from the <code>FileInfo</code> (or at least I can't see it).</p>
","4805012"
"Storing data into list with class","167437","","<p>I have the following class:</p>

<pre><code>public class EmailData
{
    public string FirstName{ set; get; }
    public string LastName { set; get; }
    public string Location{ set; get; }
}
</code></pre>

<p>I then did the following but was not working properly:</p>

<pre><code>List&lt;EmailData&gt; lstemail = new List&lt;EmailData&gt;(); 
lstemail.Add(""JOhn"",""Smith"",""Los Angeles"");
</code></pre>

<p>I get a message that says no overload for method takes 3 arguments.</p>
","<p>If you want to instantiate and add in the same line, you'd have to do something like this:</p>

<pre><code>lstemail.Add(new EmailData { FirstName = ""JOhn"", LastName = ""Smith"", Location = ""Los Angeles"" });
</code></pre>

<p>or just instantiate the object prior, and add it directly in:</p>

<pre><code>EmailData data = new EmailData();
data.FirstName = ""JOhn"";
data.LastName = ""Smith"";
data.Location = ""Los Angeles""

lstemail.Add(data);
</code></pre>
","8391928"
"Unrecognized escape sequence for path string containing backslashes","167345","","<p>The following code generates a compiler error about an ""unrecognized escape sequence"" for each backslash:</p>

<pre><code>string foo = ""D:\Projects\Some\Kind\Of\Pathproblem\wuhoo.xml"";
</code></pre>

<p>I guess I need to escape backslash? How do I do that?</p>
","<p>You can either use a double backslash each time </p>

<pre><code>string foo = ""D:\\Projects\\Some\\Kind\\Of\\Pathproblem\\wuhoo.xml"";
</code></pre>

<p>or use the @ symbol</p>

<pre><code>string foo = @""D:\Projects\Some\Kind\Of\Pathproblem\wuhoo.xml"";
</code></pre>
","1302872"
"How can you strip non-ASCII characters from a string? (in C#)","167298","","<p>How can you strip non-ASCII characters from a string? (in C#)</p>
","<pre><code>string s = ""søme string"";
s = Regex.Replace(s, @""[^\u0000-\u007F]+"", string.Empty);
</code></pre>
","123340"
"Reading data from XML","167185","","<p>I'm planning to use XML for database purpose. Only thing I was able to do is read whole XML file. I want to be able to read only some data and I don't know how to do that.</p>

<p>Here is a simple XML</p>

<pre><code>&lt;Books&gt;
 &lt;Book&gt;
  &lt;Title&gt;Animals&lt;/Title&gt;
  &lt;Author&gt;J. Anderson&lt;/Author&gt;
 &lt;/Book&gt;
 &lt;Book&gt;
  &lt;Title&gt;Car&lt;/Title&gt;
  &lt;Author&gt;L. Sawer&lt;/Author&gt;
 &lt;/Book&gt;
&lt;/Books&gt; 
</code></pre>

<p>I'm interested in app where output is gonna be</p>

<pre><code>Books:
Animals
Cars

Authors:
J. Anderson
L. Sawer
</code></pre>

<p>I'm just want to learn how read specific data from XML not whole file. </p>

<p>[SOLVED]
I have used Linq to XML</p>
","<p>I don't think you can ""legally"" load only part of an XML file, since then it would be malformed (there would be a missing closing element somewhere).</p>

<p>Using LINQ-to-XML, you can do <code>var doc = XDocument.Load(""yourfilepath"")</code>. From there its just a matter of querying the data you want, say like this:</p>

<pre><code>var authors = doc.Root.Elements().Select( x =&gt; x.Element(""Author"") );
</code></pre>

<p>HTH.</p>

<p><strong>EDIT:</strong></p>

<p>Okay, just to make this a better sample, try this (with @JWL_'s suggested improvement):</p>

<pre><code>using System;
using System.Xml.Linq;

namespace ConsoleApplication1 {
    class Program {
        static void Main( string[] args )  {
            XDocument doc = XDocument.Load( ""XMLFile1.xml"" );
            var authors = doc.Descendants( ""Author"" );
            foreach ( var author in authors ) {
                Console.WriteLine( author.Value );
            }
            Console.ReadLine();
        }
    }
}
</code></pre>

<p>You will need to adjust the path in <code>XDocument.Load()</code> to point to your XML file, but the rest should work. Ask questions about which parts you don't understand.</p>
","7119947"
"How to return a value from a Form in C#?","167098","","<p>I have a main form (let's call it frmHireQuote) that is a child of a main MDI form (frmMainMDI), that shows another form (frmImportContact) via ShowDialog() when a button is clicked.</p>

<p>When the user clicks the 'OK' on frmImportContact, I want to pass a few string variables back to some text boxes on frmHireQuote.</p>

<p>Note that there could be multiple instances of frmHireQuote, it's obviously important that I get back to the instance that called this instance of frmImportContact.</p>

<p>What's the best method of doing this?</p>
","<p>Create some public Properties on your <strong>sub-form</strong> like so </p>

<pre><code>public string ReturnValue1 {get;set;} 
public string ReturnValue2 {get;set;}
</code></pre>

<p>then set this inside your <strong>sub-form</strong> ok button click handler</p>

<pre><code>private void btnOk_Click(object sender,EventArgs e)
{
    this.ReturnValue1 = ""Something"";
    this.ReturnValue2 = DateTime.Now.ToString(); //example
    this.DialogResult = DialogResult.OK;
    this.Close();
}
</code></pre>

<p>Then in your <strong>frmHireQuote form</strong>, when you open the sub-form</p>

<pre><code>using (var form = new frmImportContact())
{
    var result = form.ShowDialog();
    if (result == DialogResult.OK)
    {
        string val = form.ReturnValue1;            //values preserved after close
        string dateString = form.ReturnValue2;
        //Do something here with these values

        //for example
        this.txtSomething.Text = val;
    }
}
</code></pre>

<p>Additionaly if you wish to cancel out of the <strong>sub-form</strong> you can just add a button to the form and set its <a href=""http://msdn.microsoft.com/en-GB/library/system.windows.forms.button.dialogresult.aspx"" rel=""noreferrer"">DialogResult</a> to <code>Cancel</code> and you can also set the <a href=""http://msdn.microsoft.com/en-GB/library/system.windows.forms.form.cancelbutton%28v=vs.80%29.aspx"" rel=""noreferrer"">CancelButton</a> property of the form to said button - this will enable the escape key to cancel out of the form.</p>
","5233526"
"How to fix Error: ""Could not find schema information for the attribute/element"" by creating schema","166981","","<p>I have a windows forms application written in VS2010 with C# and get the following errors in the <code>app.config</code> file:</p>

<pre class=""lang-none prettyprint-override""><code>Message 4   Could not find schema information for the attribute 'name'
Message 8   Could not find schema information for the attribute 'name'
Message 12  Could not find schema information for the attribute 'name'
Message 5   Could not find schema information for the attribute 'serializeAs'
Message 15  Could not find schema information for the element 'CCP_Utility.Settings1'
Message 2   Could not find schema information for the element 'CCP_Utility.Properties.Settings'
Message 3   Could not find schema information for the element 'setting'
Message 1   Could not find schema information for the element 'userSettings'
Message 6   Could not find schema information for the element 'value'
</code></pre>

<p>What do I have to change in the code to fix this issue? Where can I edit what's in <code>CCP_Utility.Settings1</code> and <code>CCP_Utility.Properties.Settings</code> ?</p>

<p>Here's the <code>app.config</code> code: </p>

<pre class=""lang-xml prettyprint-override""><code>&lt;configuration&gt;
&lt;configSections&gt;
    &lt;sectionGroup name=""userSettings"" type=""System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" &gt;
        &lt;section name=""CCP_Utility.Properties.Settings"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /&gt;
        &lt;section name=""CCP_Utility.Settings1"" type=""System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"" allowExeDefinition=""MachineToLocalUser"" requirePermission=""false"" /&gt;
    &lt;/sectionGroup&gt;
  &lt;/configSections&gt;
&lt;userSettings&gt;
  &lt;CCP_Utility.Properties.Settings&gt;
    &lt;setting name=""SourceDir"" serializeAs=""String""&gt;
      &lt;value /&gt;
    &lt;/setting&gt;
    &lt;setting name=""TargetDir"" serializeAs=""String""&gt;
      &lt;value /&gt;
    &lt;/setting&gt;
    &lt;setting name=""CorpID"" serializeAs=""String""&gt;
      &lt;value /&gt;
    &lt;/setting&gt;
  &lt;/CCP_Utility.Properties.Settings&gt;
    &lt;CCP_Utility.Settings1&gt;
        &lt;setting name=""sourceDir"" serializeAs=""String""&gt;
            &lt;value /&gt;
        &lt;/setting&gt;
        &lt;setting name=""targetDir"" serializeAs=""String""&gt;
            &lt;value /&gt;
        &lt;/setting&gt;
    &lt;/CCP_Utility.Settings1&gt;

   &lt;/userSettings&gt;
&lt;/configuration&gt;
</code></pre>
","<p><strong>UPDATE Sept 2015</strong><br />
This answer continues to get upvotes, so I'm going to leave it here since it seems to be helpful to some people, but please check out the other answers from <a href=""https://stackoverflow.com/a/14965640/1016343"">@reexmonkey</a> and <a href=""https://stackoverflow.com/a/7517532/1016343"">@Pressacco</a> first. They may provide better results.</p>

<p><strong>ORIGINAL ANSWER</strong><br />
Give this a shot:</p>

<ol>
<li>In Visual Studio, open your app.config or web.config file.  </li>
<li>Go to the ""XML"" menu and select ""Create Schema"". This action should create a new file called ""app.xsd"" or ""web.xsd"".</li>
<li>Save that file to your disk.</li>
<li>Go back to your app.config or web.config and in the <strong>edit window</strong>, right click and select properties. From there, make sure the xsd you just generated is referenced in the Schemas property. If it's not there then add it. </li>
</ol>

<p>That should cause those messages to disappear.</p>

<p>I saved my web.xsd in the root of my web folder (which might not be the best place for it, but just for demonstration purposes) and my Schemas property looks like this:</p>

<blockquote>
  <p>""C:\Program Files (x86)\Microsoft
  Visual Studio
  10.0\xml\Schemas\DotNetConfig.xsd"" ""Web.xsd""</p>
</blockquote>
","5312985"
"Passing data between different controller action methods","166964","","<p>I'm using <code>ASP.NET MVC 4</code>. I am trying to pass data from one controller to another controller.  I'm not getting this right.  I'm not sure if this is possible?</p>

<p>Here is my source action method where I want to pass the data from:</p>

<pre><code>public class ServerController : Controller
{
     [HttpPost]
     public ActionResult ApplicationPoolsUpdate(ServiceViewModel viewModel)
     {
          XDocument updatedResultsDocument = myService.UpdateApplicationPools();

          // Redirect to ApplicationPool controller and pass
          // updatedResultsDocument to be used in UpdateConfirmation action method
     }
}
</code></pre>

<p>I need to pass it to this action method in this controller:</p>

<pre><code>public class ApplicationPoolController : Controller
{
     public ActionResult UpdateConfirmation(XDocument xDocument)
     {
          // Will add implementation code

          return View();
     }
}
</code></pre>

<p>I have tried the following in the <code>ApplicationPoolsUpdate</code> action method but it doesn't work:</p>

<pre><code>return RedirectToAction(""UpdateConfirmation"", ""ApplicationPool"", new { xDocument = updatedResultsDocument });

return RedirectToAction(""UpdateConfirmation"", new { controller = ""ApplicationPool"", xDocument = updatedResultsDocument });
</code></pre>

<p>How would I achieve this?</p>
","<p><strong>HTTP and redirects</strong></p>

<p>Let's first recap how ASP.NET MVC works:</p>

<ol>
<li>When an HTTP request comes in, it is matched against a set of routes. If a route matches the request, the controller action corresponding to the route will be invoked.</li>
<li>Before invoking the action method, ASP.NET MVC performs model binding. Model binding is the process of mapping the content of the HTTP request, which is basically just text, to the strongly typed arguments of your action method</li>
</ol>

<p>Let's also remind ourselves what a redirect is:</p>

<p>An HTTP redirect is a response that the webserver can send to the client, telling the client to look for the requested content under a different URL. The new URL is contained in a <code>Location</code> header that the webserver returns to the client. In ASP.NET MVC, you do an HTTP redirect by returning a <code>RedirectResult</code> from an action. </p>

<p><strong>Passing data</strong></p>

<p>If you were just passing simple values like strings and/or integers, you could pass them as query parameters in the URL in the <code>Location</code> header. This is what would happen if you used something like</p>

<pre><code>return RedirectToAction(""ActionName"", ""Controller"", new { arg = updatedResultsDocument });
</code></pre>

<p>as others have suggested</p>

<p>The reason that this will not work is that the <code>XDocument</code> is a potentially very complex object. There is no straightforward way for the ASP.NET MVC framework to serialize the document into something that will fit in a URL and then model bind from the URL value back to your <code>XDocument</code> action parameter.</p>

<p>In general, passing the document to the client in order for the client to pass it back to the server on the next request, is a very brittle procedure: it would require all sorts of serialisation and deserialisation and all sorts of things could go wrong. If the document is large, it might also be a substantial waste of bandwidth and might severely impact the performance of your application.</p>

<p>Instead, what you want to do is keep the document around on the server and pass an identifier back to the client. The client then passes the identifier along with the next request and the server retrieves the document using this identifier. </p>

<p><strong>Storing data for retrieval on the next request</strong></p>

<p>So, the question now becomes, where does the server store the document in the meantime? Well, that is for you to decide and the best choice will depend upon your particular scenario. If this document needs to be available in the long run, you may want to store it on disk or in a database. If it contains only transient information, keeping it in the webserver's memory, in the ASP.NET cache or the <code>Session</code> (or <code>TempData</code>, which is more or less the same as the <code>Session</code> in the end) may be the right solution. Either way, you store the document under a key that will allow you to retrieve the document later:</p>

<pre><code>int documentId = _myDocumentRepository.Save(updatedResultsDocument);
</code></pre>

<p>and then you return that key to the client:</p>

<pre><code>return RedirectToAction(""UpdateConfirmation"", ""ApplicationPoolController "", new { id = documentId });
</code></pre>

<p>When you want to retrieve the document, you simply fetch it based on the key:</p>

<pre><code> public ActionResult UpdateConfirmation(int id)
 {
      XDocument doc = _myDocumentRepository.GetById(id);

      ConfirmationModel model = new ConfirmationModel(doc);

      return View(model);
 }
</code></pre>
","25201658"
"How to open a web page from my application?","166877","","<p>I want to make my WPF application open the default browser and go to a certain web page.  How do I do that?</p>
","<pre><code>System.Diagnostics.Process.Start(""http://www.webpage.com"");
</code></pre>

<p>One of many ways.</p>
","502204"
"converting a base 64 string to an image and saving it","166861","","<p>Here is my code:</p>

<pre><code>protected void SaveMyImage_Click(object sender, EventArgs e)
        {
            string imageUrl = Hidden1.Value;
            string saveLocation = Server.MapPath(""~/PictureUploads/whatever2.png"") ; 


            HttpWebRequest imageRequest = (HttpWebRequest)WebRequest.Create(imageUrl);
            WebResponse imageResponse = imageRequest.GetResponse();

            Stream responseStream = imageResponse.GetResponseStream();

            using (BinaryReader br = new BinaryReader(responseStream))
            {
                imageBytes = br.ReadBytes(500000);
                br.Close();
            }
            responseStream.Close();
            imageResponse.Close();

            FileStream fs = new FileStream(saveLocation, FileMode.Create);
            BinaryWriter bw = new BinaryWriter(fs);
            try
            {
                bw.Write(imageBytes);
            }
            finally
            {
                fs.Close();
                bw.Close();
            }
        }
}
</code></pre>

<p>The top imageUrl declartion is taking in a Base64 image string, and I want to convert it into an image.  I think my set of code only works for images like ""www.mysite.com/test.jpg"" not for a Base64 string.  Anybody have some suggestions?  Thanks!</p>
","<p>Here is an example, you can modify the method to accept a string parameter.  Then just save the image object with .Save().</p>

<pre><code>public Image LoadImage()
{
    //data:image/gif;base64,
    //this image is a single pixel (black)
    byte[] bytes = Convert.FromBase64String(""R0lGODlhAQABAIAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICTAEAOw=="");

    Image image;
    using (MemoryStream ms = new MemoryStream(bytes))
    {
        image = Image.FromStream(ms);
    }

    return image;
}
</code></pre>
","5400225"
"How to call another controller Action From a controller in Mvc","166861","","<p>I need to call a controller B action FileUploadMsgView  from Controller A and need to pass a parameter for it.</p>

<pre><code> Code---its not going to the controller B's FileUploadMsgView().
    In ControllerA
  private void Test()
    {

        try
        {//some codes here
            ViewBag.FileUploadMsg = ""File uploaded successfully."";
            ViewBag.FileUploadFlag = ""2"";

            RedirectToAction(""B"", ""FileUploadMsgView"", new { FileUploadMsg = ""File   uploaded successfully"" });
        }

     In ControllerB receiving part
  public ActionResult FileUploadMsgView(string FileUploadMsg)
    {
         return View();
    }
</code></pre>
","<p>Controllers are just classes - new one up and call the action method just like you would any other class member:</p>

<p><code>var result = new ControllerB().FileUploadMsgView(""some string"");</code></p>
","16870465"
"How do I convert a dictionary to a JSON String in C#?","166822","","<p>I want to convert my <code>Dictionary&lt;int,List&lt;int&gt;&gt;</code> to JSON string. Does anyone know how to achieve this in C#?</p>
","<p>Serializing data structures <strong>containing only numeric or boolean values</strong> is fairly straightforward. If you don't have much to serialize, you can write a method for your specific type.</p>

<p>For a <code>Dictionary&lt;int, List&lt;int&gt;&gt;</code> as you have specified, you can use Linq:</p>

<pre><code>string MyDictionaryToJson(Dictionary&lt;int, List&lt;int&gt;&gt; dict)
{
    var entries = dict.Select(d =&gt;
        string.Format(""\""{0}\"": [{1}]"", d.Key, string.Join("","", d.Value)));
    return ""{"" + string.Join("","", entries) + ""}"";
}
</code></pre>

<p><em>But, if you are serializing several different classes, or more complex data structures, <strong>or especially if your data contains string values</em></strong>, you would be better off using a reputable JSON library that already knows how to handle things like escape characters and line breaks.  <a href=""http://www.newtonsoft.com/json"" rel=""noreferrer"">Json.NET</a> is a popular option.</p>
","5597628"
"What is the purpose of a question mark after a type (for example: int? myVariable)?","166623","","<p>Typically the main use of the question mark is for the conditional, <code>x ? ""yes"" : ""no""</code>.</p>

<p>But I have seen another use for it but can't find an explanation of this use of the <code>?</code> operator, for example.</p>

<pre><code>public int? myProperty
{
   get;
   set;
}
</code></pre>
","<p>It means that the value type in question is a <a href=""https://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.140).aspx"" rel=""noreferrer"">nullable type</a></p>

<blockquote>
  <p>Nullable types are instances of the System.Nullable struct. A
  nullable type can represent the correct range of values for its
  underlying value type, plus an additional null value. For example, a
  Nullable, pronounced ""Nullable of Int32,"" can be assigned any
  value from -2147483648 to 2147483647, or it can be assigned the null
  value. A Nullable can be assigned the values true, false, or
  null. The ability to assign null to numeric and Boolean types is
  especially useful when you are dealing with databases and other data
  types that contain elements that may not be assigned a value. For
  example, a Boolean field in a database can store the values true or
  false, or it may be undefined.</p>

<pre><code>class NullableExample
{
  static void Main()
  {
      int? num = null;

      // Is the HasValue property true?
      if (num.HasValue)
      {
          System.Console.WriteLine(""num = "" + num.Value);
      }
      else
      {
          System.Console.WriteLine(""num = Null"");
      }

      // y is set to zero
      int y = num.GetValueOrDefault();

      // num.Value throws an InvalidOperationException if num.HasValue is false
      try
      {
          y = num.Value;
      }
      catch (System.InvalidOperationException e)
      {
          System.Console.WriteLine(e.Message);
      }
  }
}
</code></pre>
</blockquote>
","2690890"
"Namespace for [DataContract]","166621","","<p>I can't find the namespace to use for <code>[DataContract]</code> and <code>[DataMember]</code> elements. According to what I've found, it seems that adding the following should be enough, but in my case it is not.</p>

<pre><code>using System;
using System.Runtime.Serialization;
</code></pre>

<p>Here is a snippet of my code:</p>

<pre><code>using System;
using System.Runtime.Serialization;

namespace MyNamespace {

    [DataContract]
    public class Tuple&lt;T1, T2&gt; {
            // A custom implementation of a Tuple
            //...
            //...
        }
}
</code></pre>

<p>And the error I get:</p>

<blockquote>
  <p>The type or namespace name 'DataContract' could not be found (are you missing a using directive or an assembly reference?)</p>
</blockquote>

<p>Am I not using the right namespaces?</p>
","<p><code>DataContractAttribute</code> Class is in the <code>System.Runtime.Serialization</code> namespace.</p>

<p>But you should add reference to <code>System.Runtime.Serialization.dll</code></p>

<p>And assembly isn't referenced by default, so you have to go to References -> Add Reference in Solution Explorer and add an assembly reference</p>
","7401828"
"How do I get the last day of a month?","166549","","<p>How can I find the last day of the month in C#?</p>

<p>For example, if I have the date 03/08/1980, how do I get the last day of month 8 (in this case 31)?</p>
","<p>The last day of the month you get like this, which returns 31:</p>

<pre><code>DateTime.DaysInMonth(1980, 08);
</code></pre>
","2493068"
"Generating HTML email body in C#","166548","","<p>Is there a better way to generate HTML email in C# (for sending via System.Net.Mail), than using a Stringbuilder to do the following:</p>

<pre><code>string userName = ""John Doe"";
StringBuilder mailBody = new StringBuilder();
mailBody.AppendFormat(""&lt;h1&gt;Heading Here&lt;/h1&gt;"");
mailBody.AppendFormat(""Dear {0},"" userName);
mailBody.AppendFormat(""&lt;br /&gt;"");
mailBody.AppendFormat(""&lt;p&gt;First part of the email body goes here&lt;/p&gt;"");
</code></pre>

<p>and so on, and so forth?</p>
","<p>You can use the <a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.maildefinition.aspx"" rel=""noreferrer"">MailDefinition class</a>.</p>

<p>This is how you use it:</p>

<pre><code>MailDefinition md = new MailDefinition();
md.From = ""test@domain.com"";
md.IsBodyHtml = true;
md.Subject = ""Test of MailDefinition"";

ListDictionary replacements = new ListDictionary();
replacements.Add(""{name}"", ""Martin"");
replacements.Add(""{country}"", ""Denmark"");

string body = ""&lt;div&gt;Hello {name} You're from {country}.&lt;/div&gt;"";

MailMessage msg = md.CreateMailMessage(""you@anywhere.com"", replacements, body, new System.Web.UI.Control());
</code></pre>

<p>Also, I've written a blog post on how to <a href=""http://martinnormark.com/generate-html-e-mail-body-in-c-using-templates"" rel=""noreferrer"">generate HTML e-mail body in C# using templates using the MailDefinition class</a>.</p>
","886750"
"WCF, Service attribute value in the ServiceHost directive could not be found","166505","","<p>I'm trying to host my service with IIS 6 but I keep get this exception.</p>

<pre><code>    Server Error in '/WebServices' Application.
--------------------------------------------------------------------------------

The type 'QS.DialogManager.Communication.IISHost.RecipientService', provided as the Service attribute value in the ServiceHost directive could not be found. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.InvalidOperationException: The type 'QS.DialogManager.Communication.IISHost.RecipientService', provided as the Service attribute value in the ServiceHost directive could not be found.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 


[InvalidOperationException: The type 'QS.DialogManager.Communication.IISHost.RecipientService', provided as the Service attribute value in the ServiceHost directive could not be found.]
   System.ServiceModel.Activation.ServiceHostFactory.CreateServiceHost(String constructorString, Uri[] baseAddresses) +6714599
   System.ServiceModel.HostingManager.CreateService(String normalizedVirtualPath) +604
   System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +46
   System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +654

[ServiceActivationException: The service '/WebServices/dm/RecipientService.svc' cannot be activated due to an exception during compilation.  The exception message is: The type 'QS.DialogManager.Communication.IISHost.RecipientService', provided as the Service attribute value in the ServiceHost directive could not be found..]
   System.ServiceModel.AsyncResult.End(IAsyncResult result) +15626880
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +15546921
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) +265
   System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +227
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +171




--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.3082; ASP.NET Version:2.0.50727.3082 
</code></pre>

<p>I have absolutely no clue except that it seems like it can't find my assemblies. The code should be correctly compiled with public classes.</p>

<p>Here is my .svc file:</p>

<pre><code>&lt;%@ ServiceHost Language=""C#"" Debug=""true"" Service=""QS.DialogManager.Communication.IISHost.RecipientService"" CodeBehind=""RecipientService.svc.cs"" %&gt;
</code></pre>

<p>I have tried to create a very very simple service that contains just nothin too see if this would work but still the same old error shows up.</p>

<pre><code>The type 'IISHost.Service1', provided as the Service attribute value in the ServiceHost directive could not be found. 
</code></pre>
","<p><strong>Option One</strong>:</p>

<p>This message is often due to an IIS 7 config problem.  If you are used to creating a virtual directory pointing to the folder where your service resides, that no longer works. Now, you need to use the ""Create Application..."" option instead.</p>

<p><strong>Other Options</strong>:</p>

<ul>
<li><a href=""http://www.thejoyofcode.com/WCF_The_type_provided_as_the_Service_attribute_could_not_be_found.aspx"" rel=""noreferrer"">WCF: The type provided as the Service attribute could not be found</a>  </li>
<li><a href=""http://dennyonline.wordpress.com/2008/02/26/the-type-service-provided-as-the-service-attribute-value-in-the-servicehost-directive-could-not-be-found/"" rel=""noreferrer"">The type , provided as the Service attribute value in the ServiceHost directive could not be found.</a></li>
</ul>
","720829"
"Convert array of strings to List<string>","166284","","<p>I've seen examples of this done using <code>.ToList()</code> on array types, this seems to be available only <a href=""http://msdn.microsoft.com/en-us/library/bb342261.aspx"" rel=""noreferrer"">in .Net 3.5+</a>. I'm working with .NET Framework 2.0 on an ASP.NET project that can't be upgraded at this time, so I was wondering: is there another solution? One that is more elegant than looping through the array and adding each element to this List (which is no problem; I'm just wondering if there is a better solution for learning purposes)?</p>

<pre class=""lang-csharp prettyprint-override""><code>string[] arr = { ""Alpha"", ""Beta"", ""Gamma"" };

List&lt;string&gt; openItems = new List&lt;string&gt;();

foreach (string arrItem in arr)
{
    openItems.Add(arrItem);
}
</code></pre>

<p>If I have to do it this way, is there a way to deallocate the lingering array from memory after I copy it into my list?</p>
","<p>Just use <a href=""https://msdn.microsoft.com/en-us/library/fkbw11z0(v=vs.110).aspx"">this constructor</a> of <code>List&lt;T&gt;</code>. It accepts any <code>IEnumerable&lt;T&gt;</code> as an argument.</p>

<pre class=""lang-csharp prettyprint-override""><code>string[] arr = ...
List&lt;string&gt; list = new List&lt;string&gt;(arr);
</code></pre>
","10129453"
"Why Doesn't C# Allow Static Methods to Implement an Interface?","166180","","<p>Why was C# designed this way?</p>

<p>As I understand it, an interface only describes behaviour, and serves the purpose of describing a contractual obligation for classes implementing the interface that certain behaviour is implemented.</p>

<p>If classes wish to implement that behavour in a shared method, why shouldn't they?</p>

<p>Here is an example of what I have in mind:</p>

<pre><code>// These items will be displayed in a list on the screen.
public interface IListItem {
  string ScreenName();
  ...
}

public class Animal: IListItem {
    // All animals will be called ""Animal"".
    public static string ScreenName() {
        return ""Animal"";
    }
....
}

public class Person: IListItem {

    private string name;

    // All persons will be called by their individual names.
    public string ScreenName() {
        return name;
    }

    ....

 }
</code></pre>
","<p>Assuming you are asking why you can't do this:</p>

<pre><code>public interface IFoo {
    void Bar();
}

public class Foo: IFoo {
    public static void Bar() {}
}
</code></pre>

<p>This doesn't make sense to me, semantically.  Methods specified on an interface should be there to specify the contract for interacting with an object.  Static methods do not allow you to interact with an object - if you find yourself in the position where your implementation could be made static, you may need to ask yourself if that method really belongs in the interface.
<hr/>
To implement your example, I would give Animal a const property, which would still allow it to be accessed from a static context, and return that value in the implementation.</p>

<pre><code>public class Animal: IListItem {
    /* Can be tough to come up with a different, yet meaningful name!
     * A different casing convention, like Java has, would help here.
     */
    public const string AnimalScreenName = ""Animal"";
    public string ScreenName(){ return AnimalScreenName; }
}
</code></pre>

<p>For a more complicated situation, you could always declare another static method and delegate to that.  In trying come up with an example, I couldn't think of any reason you would do something non-trivial in both a static and instance context, so I'll spare you a FooBar blob, and take it as an indication that it might not be a good idea.</p>
","259079"
"Retrieving Property name from lambda expression","166139","","<p>Is there a better way to get the Property name when passed in via a lambda expression?
Here is what i currently have.</p>

<p>eg. </p>

<pre><code>GetSortingInfo&lt;User&gt;(u =&gt; u.UserId);
</code></pre>

<p>It worked by casting it as a memberexpression only when the property was  a string. because not all properties are strings i had to use object but then it would return a unaryexpression for those.</p>

<pre><code>public static RouteValueDictionary GetInfo&lt;T&gt;(this HtmlHelper html, 
    Expression&lt;Func&lt;T, object&gt;&gt; action) where T : class
{
    var expression = GetMemberInfo(action);
    string name = expression.Member.Name;

    return GetInfo(html, name);
}

private static MemberExpression GetMemberInfo(Expression method)
{
    LambdaExpression lambda = method as LambdaExpression;
    if (lambda == null)
        throw new ArgumentNullException(""method"");

    MemberExpression memberExpr = null;

    if (lambda.Body.NodeType == ExpressionType.Convert)
    {
        memberExpr = 
            ((UnaryExpression)lambda.Body).Operand as MemberExpression;
    }
    else if (lambda.Body.NodeType == ExpressionType.MemberAccess)
    {
        memberExpr = lambda.Body as MemberExpression;
    }

    if (memberExpr == null)
        throw new ArgumentException(""method"");

    return memberExpr;
}
</code></pre>
","<p>I found another way you can do it was to have the source and property strongly typed and explicitly infer the input for the lambda. Not sure if that is correct terminology but here is the result.</p>

<pre><code>public static RouteValueDictionary GetInfo&lt;T,P&gt;(this HtmlHelper html, Expression&lt;Func&lt;T, P&gt;&gt; action) where T : class
{
    var expression = (MemberExpression)action.Body;
    string name = expression.Member.Name;

    return GetInfo(html, name);
}
</code></pre>

<p>And then call it like so.</p>

<pre><code>GetInfo((User u) =&gt; u.UserId);
</code></pre>

<p>and voila it works.<br>
Thanks all.</p>
","672330"
"ASP.NET MVC passing an ID in an ActionLink to the controller","166120","","<p>I can't see to retrieve an ID I'm sending in a html.ActionLink in my controller, here is what I'm trying to do</p>

<pre><code>&lt;li&gt;
    &lt;%= Html.ActionLink(""Modify Villa"", ""Modify"", ""Villa"", new { @id = ""1"" })%&gt;&lt;/li&gt;


    public ActionResult Modify(string ID)
    {

        ViewData[""Title""] =ID;
        return View();
    }
</code></pre>

<p>That's what a tutorial I followed recommended, but it's not working, it's also putting ?Length=5 at the end of the URL!</p>

<p>Thanks in advance!</p>

<p>edit: here is the route I'm using, it's default </p>

<pre><code>        routes.MapRoute(
            ""Default"",                                              // Route name
            ""{controller}/{action}/{id}"",                           // URL with parameters
            new { controller = ""Home"", action = ""Index"", id = """" }  // Parameter defaults
        );
</code></pre>

<p>it appears someone has downvoted the two suggestions below but not posted their solution!</p>
","<p>Doesn't look like you are using the correct overload of ActionLink.  Try this:-</p>

<pre><code>&lt;%=Html.ActionLink(""Modify Villa"", ""Modify"", new {id = ""1""})%&gt;
</code></pre>

<p>This assumes your view is under the /Views/Villa folder. If not then I suspect you need:-</p>

<pre><code>&lt;%=Html.ActionLink(""Modify Villa"", ""Modify"", ""Villa"", new {id = ""1""}, null)%&gt;
</code></pre>
","316996"
"Cannot open database ""test"" requested by the login. The login failed. Login failed for user 'xyz\ASPNET'","166084","","<p>I have created a web service which is saving some data into to db. But I am getting this error:</p>

<blockquote>
  <p>Cannot open database ""test"" requested by the login. The login failed. Login failed for user 'xyz\ASPNET'.</p>
</blockquote>

<p>My connection string is  </p>

<pre><code>Data Source=.\SQLExpress;Initial Catalog=IFItest;Integrated Security=True
</code></pre>
","<p>Well, the error is pretty clear, no? You are trying to connect to your SQL Server with user ""xyz/ASPNET"" - that's the account your ASP.NET app is running under.</p>

<p>This account is not allowed to connect to SQL Server - either create a login on SQL Server for that account, or then specify another valid SQL Server account in your connection string.</p>

<p>Can you show us your connection string (by updating your original question)?</p>

<p>UPDATE: Ok, you're using integrated Windows authentication --> you need to create a SQL Server login for ""xyz\ASPNET"" on your SQL Server - or change your connection string to something like:</p>

<pre><code>connectionString=""Server=.\SQLExpress;Database=IFItest;User ID=xyz;pwd=top$secret""
</code></pre>

<p>If you have a user ""xyz"" with a password of ""top$secret"" in your database.</p>
","2575927"
"The calling thread cannot access this object because a different thread owns it","166063","","<p>My code is as below    </p>

<pre><code>public CountryStandards()
{
    InitializeComponent();
    try
    {
        FillPageControls();
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message, ""Country Standards"", MessageBoxButton.OK, MessageBoxImage.Error);
    }
}

/// &lt;summary&gt;
/// Fills the page controls.
/// &lt;/summary&gt;
private void FillPageControls()
{
    popUpProgressBar.IsOpen = true;
    lblProgress.Content = ""Loading. Please wait..."";
    progress.IsIndeterminate = true;
    worker = new BackgroundWorker();
    worker.DoWork += new System.ComponentModel.DoWorkEventHandler(worker_DoWork);
    worker.ProgressChanged += new System.ComponentModel.ProgressChangedEventHandler(worker_ProgressChanged);
    worker.WorkerReportsProgress = true;
    worker.WorkerSupportsCancellation = true;
    worker.RunWorkerCompleted += new System.ComponentModel.RunWorkerCompletedEventHandler(worker_RunWorkerCompleted);
    worker.RunWorkerAsync();                    
}

private void worker_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
{
    GetGridData(null, 0); // filling grid
}

private void worker_ProgressChanged(object sender, System.ComponentModel.ProgressChangedEventArgs e)
{
    progress.Value = e.ProgressPercentage;
}

private void worker_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
{
    worker = null;
    popUpProgressBar.IsOpen = false;
    //filling Region dropdown
    Standards.UDMCountryStandards objUDMCountryStandards = new Standards.UDMCountryStandards();
    objUDMCountryStandards.Operation = ""SELECT_REGION"";
    DataSet dsRegionStandards = objStandardsBusinessLayer.GetCountryStandards(objUDMCountryStandards);
    if (!StandardsDefault.IsNullOrEmptyDataTable(dsRegionStandards, 0))
        StandardsDefault.FillComboBox(cmbRegion, dsRegionStandards.Tables[0], ""Region"", ""RegionId"");

    //filling Currency dropdown
    objUDMCountryStandards = new Standards.UDMCountryStandards();
    objUDMCountryStandards.Operation = ""SELECT_CURRENCY"";
    DataSet dsCurrencyStandards = objStandardsBusinessLayer.GetCountryStandards(objUDMCountryStandards);
    if (!StandardsDefault.IsNullOrEmptyDataTable(dsCurrencyStandards, 0))
        StandardsDefault.FillComboBox(cmbCurrency, dsCurrencyStandards.Tables[0], ""CurrencyName"", ""CurrencyId"");

    if (Users.UserRole != ""Admin"")
        btnSave.IsEnabled = false;

}

/// &lt;summary&gt;
/// Gets the grid data.
/// &lt;/summary&gt;
/// &lt;param name=""sender""&gt;The sender.&lt;/param&gt;
/// &lt;param name=""pageIndex""&gt;Index of the page.( used in case of paging)   &lt;/pamam&gt;
private void GetGridData(object sender, int pageIndex)
{
    Standards.UDMCountryStandards objUDMCountryStandards = new Standards.UDMCountryStandards();
    objUDMCountryStandards.Operation = ""SELECT"";
    objUDMCountryStandards.Country = txtSearchCountry.Text.Trim() != string.Empty ? txtSearchCountry.Text : null;
    DataSet dsCountryStandards = objStandardsBusinessLayer.GetCountryStandards(objUDMCountryStandards);
    if (!StandardsDefault.IsNullOrEmptyDataTable(dsCountryStandards, 0) &amp;&amp; (chkbxMarketsSearch.IsChecked == true || chkbxBudgetsSearch.IsChecked == true || chkbxProgramsSearch.IsChecked == true))
    {
        DataTable objDataTable = StandardsDefault.FilterDatatableForModules(dsCountryStandards.Tables[0], ""Country"", chkbxMarketsSearch, chkbxBudgetsSearch, chkbxProgramsSearch);
        dgCountryList.ItemsSource = objDataTable.DefaultView;
    }
    else
    {
        MessageBox.Show(""No Records Found"", ""Country Standards"", MessageBoxButton.OK, MessageBoxImage.Information);
        btnClear_Click(null, null);
    }
}
</code></pre>

<p>The step <code>objUDMCountryStandards.Country = txtSearchCountry.Text.Trim() != string.Empty ? txtSearchCountry.Text : null;</code> in get grid data throws exception </p>

<blockquote>
  <p>The calling thread cannot access this object because a different
  thread owns it.</p>
</blockquote>

<p>What's wrong here?</p>
","<p>This is a common problem with people getting started. Whenever you update your UI elements from a thread other than the main thread, you need to use:</p>

<pre><code>this.Dispatcher.Invoke(() =&gt;
{
    ...// your code here.
});
</code></pre>

<p>You can also use <a href=""http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.checkaccess(v=vs.110).aspx"" rel=""noreferrer""><code>control.Dispatcher.CheckAccess()</code></a> to check whether the current thread owns the control. If it does own it, your code looks as normal. Otherwise, use above pattern.</p>
","9732853"
"Check if a folder exist in a directory and create them using C#","166024","","<p>How can I check if directory <code>C:/</code> contains a folder named <code>MP_Upload</code>, and if it does not exist, create the folder automatically?</p>

<p>I am using Visual&nbsp;Studio&nbsp;2005 C#.</p>
","<p>This should help:</p>

<pre><code>using System.IO;
...

string path = @""C:\MP_Upload"";
if(!Directory.Exists(path))
{
    Directory.CreateDirectory(path);
}
</code></pre>
","9092187"
"How can I check if a string contains a character in C#?","165919","","<p>Is there a function I can apply to a string that will return true of false if a string contains a character. </p>

<p>I have strings with one or more character options such as:</p>

<pre><code>var abc = ""s"";
var def = ""aB"";
var ghi = ""Sj"";
</code></pre>

<p>What I would like to do for example is have a function that would return true or false if the above contained a lower or upper case ""s"".</p>

<pre><code>if (def.Somefunction(""s"") == true) { }
</code></pre>

<p>Also in C# do I need to check if something is true like this or could I just remove the ""== true"" ?</p>
","<p>You can use the extension method <a href=""https://msdn.microsoft.com/en-us/library/bb352880(v=vs.100).aspx"" rel=""noreferrer""><code>.Contains()</code></a> from the namespace System.Linq:</p>

<pre><code>if (abc.ToLower().Contains('s')) { }
</code></pre>

<p>And no, to check if a boolean expression is true, you don't need <code>== true</code></p>

<p>Since the <code>Contains</code> method is an extension method, my solution appeared to be confusing to some. Here are two versions that doesn't require you to add <code>using System.Linq;</code>:</p>

<pre><code>if (abc.ToLower().IndexOf('s') != -1) { }

// or:

if (abc.IndexOf(""s"", StringComparison.CurrentCultureIgnoreCase) != -1) { }
</code></pre>

<p><strong>Update</strong></p>

<p>If you want to, you can write your own extensions method for easier reuse:</p>

<pre><code>public static class MyStringExtensions
{
    public static bool ContainsAnyCaseInvariant(this string haystack, char needle)
    {
        return haystack.IndexOf(needle, StringComparison.InvariantCultureIgnoreCase) != -1;
    }

    public static bool ContainsAnyCase(this string haystack, char needle)
    {
        return haystack.IndexOf(needle, StringComparison.CurrentCultureIgnoreCase) != -1;
    }
}
</code></pre>

<p>Then you can call it like this:</p>

<pre><code>if (def.ContainsAnyCaseInvariant('s')) { }
// or
if (def.ContainsAnyCase('s')) { }
</code></pre>

<p>In most cases when dealing with user data, you actually want to use <code>CurrentCultureIgnoreCase</code> <em>(or the <code>ContainsAnyCase</code> extension method)</em>, because that way you let the system handle upper/lowercase issues, which depend on the language. When dealing with computational issues, like names of HTML tags and so on, you want to use the invariant culture.</p>

<p>For example: In Turkish, the uppercase letter <code>I</code> in lowercase is <code>ı</code> <em>(without a dot)</em>, and not <code>i</code> <em>(with a dot)</em>.</p>
","8879798"
"Get Substring - everything before certain char","165856","","<p>I'm trying to figure out the best way to get everything before the - character in a string.  Some example strings are below.  The length of the string before - varies and can be any length</p>

<pre><code>223232-1.jpg
443-2.jpg
34443553-5.jpg
</code></pre>

<p>so I need the value that's from the start index of 0 to right before -. So the substrings would turn out to be 223232, 443, and 34443553</p>
","<p><a href=""https://dotnetfiddle.net/vYUrh9"" rel=""noreferrer"">.Net Fiddle example</a></p>

<pre><code>class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(""223232-1.jpg"".GetUntilOrEmpty());
        Console.WriteLine(""443-2.jpg"".GetUntilOrEmpty());
        Console.WriteLine(""34443553-5.jpg"".GetUntilOrEmpty());

        Console.ReadKey();
    }
}

static class Helper
{
    public static string GetUntilOrEmpty(this string text, string stopAt = ""-"")
    {
        if (!String.IsNullOrWhiteSpace(text))
        {
            int charLocation = text.IndexOf(stopAt, StringComparison.Ordinal);

            if (charLocation &gt; 0)
            {
                return text.Substring(0, charLocation);
            }
        }

        return String.Empty;
    }
}
</code></pre>
","1857525"
"How to get the substring in C#?","165727","","<p>I can get the first three characters with the function below.  </p>

<p>However, how can I get the output of the last five characters (<strong>Three</strong>) with <code>Substring()</code> function. Or other string function will be used?</p>

<p>Thank you.</p>

<pre><code>static void Main()
{
    string input = ""OneTwoThree"";

    // Get first three characters
    string sub = input.Substring(0, 3);
    Console.WriteLine(""Substring: {0}"", sub); // Output One. 
}
</code></pre>
","<p>If your input string could be less than five characters long then you should be aware that <a href=""http://msdn.microsoft.com/en-us/library/hxthx5h6.aspx"" rel=""noreferrer""><code>string.Substring</code></a> will throw an <code>ArgumentOutOfRangeException</code> if the <code>startIndex</code> argument is negative.</p>

<p>To solve this potential problem you can use the following code:</p>

<pre><code>string sub = input.Substring(Math.Max(0, input.Length - 5));
</code></pre>

<p>Or more explicitly:</p>

<pre><code>public static string Right(string input, int length)
{
    if (length &gt;= input.Length)
    {
        return input;
    }
    else
    {
        return input.Substring(input.Length - length);
    }
}
</code></pre>
","2902453"
"Array slices in C#","165675","","<p>How do you do it? Given a byte array:</p>

<pre><code>byte[] foo = new byte[4096];
</code></pre>

<p>How would I get the first x bytes of the array as a separate array? (Specifically, I need it as an <code>IEnumerable&lt;byte&gt;</code>)</p>

<p>This is for working with <code>Socket</code>s. I figure the easiest way would be array slicing, similar to Perls syntax:</p>

<pre><code>@bar = @foo[0..40];
</code></pre>

<p>Which would return the first 41 elements into the <code>@bar</code> array. Is there something in C# that I'm just missing, or is there some other thing I should be doing?</p>

<p>LINQ is an option for me (.NET 3.5), if that helps any.</p>
","<p>Arrays are enumerable, so your <code>foo</code> already is an <code>IEnumerable&lt;byte&gt;</code> itself.
Simply use LINQ sequence methods like <a href=""https://msdn.microsoft.com/en-us/library/bb503062(v=vs.110).aspx"" rel=""noreferrer""><code>Take()</code></a> to get what you want out of it (don't forget to include the <code>Linq</code> namespace with  <code>using System.Linq;</code>):</p>

<pre><code>byte[] foo = new byte[4096];

var bar = foo.Take(41);
</code></pre>

<p>If you really need an array from any <code>IEnumerable&lt;byte&gt;</code> value, you could use the <code>ToArray()</code> method for that. That does not seem to be the case here.</p>
","406502"
"How to detect Windows 64-bit platform with .NET?","165631","","<p>In a <a href=""http://en.wikipedia.org/wiki/.NET_Framework"" rel=""noreferrer"">.NET</a> 2.0 C# application I use the following code to detect the operating system platform:</p>

<pre><code>string os_platform = System.Environment.OSVersion.Platform.ToString();
</code></pre>

<p>This returns ""Win32NT"". The problem is that it returns ""Win32NT"" even when running on Windows Vista 64-bit.</p>

<p>Is there any other method to know the correct platform (32&nbsp;or 64&nbsp;bit)?</p>

<p>Note that it should also detect 64&nbsp;bit when run as a 32&nbsp;bit application on Windows 64&nbsp;bit.</p>
","<p>IntPtr.Size won't return the correct value if running in 32-bit .NET Framework 2.0 on 64-bit Windows (it would return 32-bit).</p>

<p>As Microsoft's Raymond Chen describes, you have to first check if running in a 64-bit process (I think in .NET you can do so by checking IntPtr.Size), and if you are running in a 32-bit process, you still have to call the Win API function IsWow64Process. If this returns true, you are running in a 32-bit process on 64-bit Windows.</p>

<p>Microsoft's Raymond Chen:
<a href=""http://blogs.msdn.com/oldnewthing/archive/2005/02/01/364563.aspx"" rel=""noreferrer"">How to detect programmatically whether you are running on 64-bit Windows</a></p>

<p>My solution:</p>

<pre><code>static bool is64BitProcess = (IntPtr.Size == 8);
static bool is64BitOperatingSystem = is64BitProcess || InternalCheckIsWow64();

[DllImport(""kernel32.dll"", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool IsWow64Process(
    [In] IntPtr hProcess,
    [Out] out bool wow64Process
);

public static bool InternalCheckIsWow64()
{
    if ((Environment.OSVersion.Version.Major == 5 &amp;&amp; Environment.OSVersion.Version.Minor &gt;= 1) ||
        Environment.OSVersion.Version.Major &gt;= 6)
    {
        using (Process p = Process.GetCurrentProcess())
        {
            bool retVal;
            if (!IsWow64Process(p.Handle, out retVal))
            {
                return false;
            }
            return retVal;
        }
    }
    else
    {
        return false;
    }
}
</code></pre>
","336729"
"Connecting to Oracle Database through C#?","165625","","<p>I need to connect to a Oracle DB (external) through Visual Studio 2010. But I dont want to install Oracle on my machine. 
In my project I referenced: <strong>System.Data.OracleClient</strong>. But its not fulfilling the need. 
I have an <strong>""Oracle SQL Developer IDE""</strong> in which I run SQL queries against oracle db. </p>

<p>I have this code so far:</p>

<pre><code> private static string GetConnectionString()
    {
        String connString = ""host= serverName;database=myDatabase;uid=userName;pwd=passWord"";
        return connString;
    }

 private static void ConnectingToOracle()
    {
        string connectionString = GetConnectionString();
        using (OracleConnection connection = new OracleConnection())
        {
            connection.ConnectionString = connectionString;
            connection.Open();
            Console.WriteLine(""State: {0}"", connection.State);
            Console.WriteLine(""ConnectionString: {0}"",
                              connection.ConnectionString);

            OracleCommand command = connection.CreateCommand();
            string sql = ""SELECT * FROM myTableName"";
            command.CommandText = sql;

            OracleDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                string myField = (string)reader[""MYFIELD""];
                Console.WriteLine(myField);
            }
        }
    }
</code></pre>

<p>So far I read these blogs: </p>

<p><a href=""http://st-curriculum.oracle.com/tutorial/DBXETutorial/index.htm"">http://st-curriculum.oracle.com/tutorial/DBXETutorial/index.htm</a></p>

<p><a href=""http://blogs.msdn.com/b/kaevans/archive/2009/07/18/connecting-to-oracle-from-visual-studio.aspx"">http://blogs.msdn.com/b/kaevans/archive/2009/07/18/connecting-to-oracle-from-visual-studio.aspx</a></p>

<p>So far I have not downloaded anything from Oracle. What steps should I take to make this happen? </p>
","<p>First off you need to download and install ODP from this site
<a href=""http://www.oracle.com/technetwork/topics/dotnet/index-085163.html"" rel=""noreferrer"">http://www.oracle.com/technetwork/topics/dotnet/index-085163.html</a></p>

<p>After installation add a reference of the assembly <strong>Oracle.DataAccess.dll</strong>.</p>

<p>Your are good to go after this.</p>

<pre><code>using System; 
using Oracle.DataAccess.Client; 

class OraTest
{ 
    OracleConnection con; 
    void Connect() 
    { 
        con = new OracleConnection(); 
        con.ConnectionString = ""User Id=&lt;username&gt;;Password=&lt;password&gt;;Data Source=&lt;datasource&gt;""; 
        con.Open(); 
        Console.WriteLine(""Connected to Oracle"" + con.ServerVersion); 
    }

    void Close() 
    {
        con.Close(); 
        con.Dispose(); 
    } 

    static void Main() 
    { 
        OraTest ot= new OraTest(); 
        ot.Connect(); 
        ot.Close(); 
    } 
}
</code></pre>
","12568350"
"Linq Syntax - Selecting multiple columns","165603","","<p>This is my Linq Syntax which I am using to my entity model</p>

<pre><code>IQueryable&lt;string&gt; objEmployee = null;

objEmployee = from res in _db.EMPLOYEEs
              where (res.EMAIL == givenInfo || res.USER_NAME == givenInfo)
              select res.EMAIL;
</code></pre>

<p>How can I select multiple columns? Like I want to select res.ID aswell. And how can I receive those? IQueryable will not work I think.
And this is called Linq to SQL - right ?</p>
","<p>As the other answers have indicated, you need to use an anonymous type.</p>

<p>As far as syntax is concerned, I personally far prefer method chaining. The method chaining equivalent would be:-</p>

<pre><code>var employee = _db.EMPLOYEEs
    .Where(x =&gt; x.EMAIL == givenInfo || x.USER_NAME == givenInfo)
    .Select(x =&gt; new { x.EMAIL, x.ID });
</code></pre>

<p>AFAIK, the declarative LINQ syntax is converted to a method call chain similar to this when it is compiled.</p>

<p><strong>UPDATE</strong></p>

<p>If you want the entire object, then you just have to omit the call to <code>Select()</code>, i.e.</p>

<pre><code>var employee = _db.EMPLOYEEs
    .Where(x =&gt; x.EMAIL == givenInfo || x.USER_NAME == givenInfo);
</code></pre>
","6772333"
"How to split() a delimited string to a List<String>","165585","","<p>I had this code:</p>

<pre><code>    String[] lineElements;       
    . . .
    try
    {
        using (StreamReader sr = new StreamReader(""TestFile.txt""))
        {
            String line;
            while ((line = sr.ReadLine()) != null)
            {
                lineElements = line.Split(',');
                . . .
</code></pre>

<p>but then thought I should maybe go with a List instead. But this code:</p>

<pre><code>    List&lt;String&gt; listStrLineElements;
    . . .
    try
    {
        using (StreamReader sr = new StreamReader(""TestFile.txt""))
        {
            String line;
            while ((line = sr.ReadLine()) != null)
            {
                listStrLineElements = line.Split(',');
. . .
</code></pre>

<p>...gives me, ""<em>Cannot implicitly convert type 'string[]' to 'System.Collections.Generic.List'</em>""</p>
","<p><code>string.Split()</code> returns an array - you can convert it to a list using <code>ToList()</code>:</p>

<pre><code>listStrLineElements = line.Split(',').ToList();
</code></pre>

<p>You need to import System.Linq to access the .ToList() function.</p>
","9263724"
"Getting specified Node values from XML document","165505","","<p>I have a problem going through an XML document (with C#) and get all the necessary values. I successfully go through all specified XmlNodeLists in the XML document, successfully get all XmlNode values inside, but I have to get some values outside of this XmlNodeList.</p>

<p>For example:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8"" ?&gt;
&lt;Element xsi:schemaLocation=""http://localhost/AML/CaseInvestigationMangement/Moduli/XmlImportControls/xsdBorrow.xsd xsd2009027_kor21.xsd"" Kod=""370"" xmlns=""http://localhost/AML/CaseInvestigationMangement/Moduli/XmlImportControls/xsdBorrow.xsd"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""&gt;
/2001/XMLSchema-instance""&gt;
    &lt;ANode&gt;
        &lt;BNode&gt;
            &lt;CNode&gt;
                &lt;Example&gt;
                    &lt;Name&gt;John&lt;/Name&gt;
                    &lt;NO&gt;001&lt;/NO&gt;
                &lt;/Example&gt;
            &lt;/CNode&gt;
        &lt;/BNode&gt;
        &lt;ID&gt;1234&lt;/ID&gt;
        &lt;Date&gt;2011-10-01&lt;/Date&gt;
    &lt;/ANode&gt;
    &lt;ANode&gt;
        &lt;BNode&gt;
            &lt;CNode&gt;
                &lt;Example&gt;
                    &lt;Name&gt;Mike&lt;/Name&gt;
                    &lt;NO&gt;002&lt;/NO&gt;
                &lt;/Example&gt;
            &lt;/CNode&gt;
        &lt;/BNode&gt;
        &lt;ID&gt;5678&lt;/ID&gt;
        &lt;Date&gt;2011-03-31&lt;/Date&gt;
    &lt;/ANode&gt;
&lt;/Element&gt;
</code></pre>

<p>This is the code that gets values for nodes Name and NO in every found ANode in the XML document:</p>

<pre><code>XmlDocument xml = new XmlDocument();
xml.LoadXml(myXmlString); //myXmlString is the xml file in string //copying xml to string: string myXmlString = xmldoc.OuterXml.ToString();
XmlNodeList xnList = xml.SelectNodes(""/Element[@*]/ANode/BNode/CNode"");
foreach (XmlNode xn in xnList)
{
  XmlNode example = xn.SelectSingleNode(""Example"");
    if (example != null)
    {
        string na = example[""Name""].InnerText;
        string no = example[""NO""].InnerText;
    }
}
</code></pre>

<p>Now I have a problem getting values for ID and Date.</p>
","<p>Just like you do for getting something from the <code>CNode</code> you also need to do for the <code>ANode</code></p>

<pre><code>XmlNodeList xnList = xml.SelectNodes(""/Element[@*]"");
foreach (XmlNode xn in xnList)
{
  XmlNode anode = xn.SelectSingleNode(""ANode"");
    if (anode!= null)
    {
        string id = anode[""ID""].InnerText;
        string date = anode[""Date""].InnerText;
        XmlNodeList CNodes = xn.SelectNodes(""ANode/BNode/CNode"");
        foreach (XmlNode node in CNodes)
        {
         XmlNode example = node.SelectSingleNode(""Example"");
         if (example != null)
         {
            string na = example[""Name""].InnerText;
            string no = example[""NO""].InnerText;
         }
        }
    }
}
</code></pre>
","6442247"
"ConfigurationManager.AppSettings - How to modify and save?","165503","","<p>It might sound too trival to ask and I do the same thing as suggested in articles, yet it doesn't work as expected. Hope someone can point me to the right direction.</p>

<p>I would like to save the usersettings per AppSettings.</p>

<p>Once the Winform is closed I trigger this:</p>

<pre><code>conf.Configuration config = 
           ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);

if (ConfigurationManager.AppSettings[""IntegrateWithPerforce""] != null)
    ConfigurationManager.AppSettings[""IntegrateWithPerforce""] = 
                                           e.Payload.IntegrateCheckBox.ToString();
else
    config.AppSettings.Settings.Add(""IntegrateWithPerforce"", 
                                          e.Payload.IntegrateCheckBox.ToString());

config.Save(ConfigurationSaveMode.Modified);
</code></pre>

<p>So the first time when the entry doesnt exist yet, it would simply create it, otherwise it would modify the existing entry.  However this doesn't save.</p>

<p>1) What am I doing wrong?</p>

<p>2) Where am I expecting the usersettings for App settings to be saved again? Is it in the Debug folder or in C:\Documents and Settings\USERNAME\Local Settings\Application Data folder?</p>
","<p>Perhaps you should look at adding a Settings File. (e.g. App.Settings)
Creating this file will allow you to do the following:</p>

<pre><code>string mysetting = App.Default.MySetting;
App.Default.MySetting = ""my new setting"";
</code></pre>

<p>This means you can edit and then change items, where the items are strongly typed, and best of all... you don't have to touch any xml before you deploy! </p>

<p>The result is a Application or User contextual setting.</p>

<p>Have a look in the ""add new item"" menu for the setting file.</p>
","5274968"
"How do you upload a file to a document library in sharepoint?","165473","","<p>How do you programmatically upload a file to a document library in sharepoint?</p>

<p>I am currently making a Windows application using C# that will add documents to a document library list.</p>
","<p>You can upload documents to SharePoint libraries using the Object Model or <a href=""http://msdn.microsoft.com/en-us/library/lists.lists.aspx"" rel=""noreferrer"">SharePoint Webservices</a>.</p>

<p>Upload using Object Model:</p>

<pre><code>String fileToUpload = @""C:\YourFile.txt"";
String sharePointSite = ""http://yoursite.com/sites/Research/"";
String documentLibraryName = ""Shared Documents"";

using (SPSite oSite = new SPSite(sharePointSite))
{
    using (SPWeb oWeb = oSite.OpenWeb())
    {
        if (!System.IO.File.Exists(fileToUpload))
            throw new FileNotFoundException(""File not found."", fileToUpload);                    

        SPFolder myLibrary = oWeb.Folders[documentLibraryName];

        // Prepare to upload
        Boolean replaceExistingFiles = true;
        String fileName = System.IO.Path.GetFileName(fileToUpload);
        FileStream fileStream = File.OpenRead(fileToUpload);

        // Upload document
        SPFile spfile = myLibrary.Files.Add(fileName, fileStream, replaceExistingFiles);

        // Commit 
        myLibrary.Update();
    }
}
</code></pre>
","468685"
"Newtonsoft JSON Deserialize","165455","","<p>My JSON is as follows:</p>

<pre><code>{""t"":""1339886"",""a"":true,""data"":[],""Type"":[['Ants','Biz','Tro']]}
</code></pre>

<p>I found the Newtonsoft JSON.NET deserialize library for C#. I tried to use it as follow:</p>

<pre><code>object JsonDe = JsonConvert.DeserializeObject(Json); 
</code></pre>

<p>How can I access to the <code>JsonDe</code> object to get all the ""Type"" Data? I tried it with a loop but it is not working because the object does not have an enumerator.</p>
","<p>You can implement a class that holds the fields you have in your JSON</p>

<pre><code>class MyData
{
    public string t;
    public bool a;
    public object[] data;
    public string[][] type;
}
</code></pre>

<p>and then use the generic version of DeserializeObject:</p>

<pre><code>MyData tmp = JsonConvert.DeserializeObject&lt;MyData&gt;(json);
foreach (string typeStr in tmp.type[0])
{
    // Do something with typeStr
}
</code></pre>

<p>Documentation: <a href=""http://www.newtonsoft.com/json/help/html/SerializingJSON.htm"" rel=""noreferrer""><strong>Serializing and Deserializing JSON</strong></a></p>
","17038878"
"How to declare an array of objects in C#","165125","","<p>I have a very beginning C# question. Suppose I have a class called <code>GameObject</code>, and I want to create an array of <code>GameObject</code> entities. I could think of writing code like:</p>

<pre><code>GameObject[] houses = new GameObject[200];
</code></pre>

<p>The compiler complains (assuming because of invalid syntax). Since this is XNA development, I load my texture in the <code>LoadContent()</code> method as follows:</p>

<pre><code> houses[0].Model = Content.Load&lt;Model&gt;(""Models\\Building_01 Windowed"");
</code></pre>

<p>where <code>houses[0]</code> should be a <code>GameObject</code> and can be loaded like this, but the compiler throws this error:</p>

<blockquote>
  <p>""Use the ""new"" keyword to create an object instance""</p>
  
  <p>""Check to determine if the object is null before calling the method""</p>
</blockquote>

<p>There must be something wrong with my initialization.</p>
","<p>The issue here is that you've initialized your <em>array</em>, but not its <em>elements</em>; they are all null. So if you try to reference <code>houses[0]</code>, it will be <code>null</code>.</p>

<p>Here's a great little helper method you could write for yourself:</p>

<pre><code>T[] InitializeArray&lt;T&gt;(int length) where T : new()
{
    T[] array = new T[length];
    for (int i = 0; i &lt; length; ++i)
    {
        array[i] = new T();
    }

    return array;
}
</code></pre>

<p>Then you could initialize your <code>houses</code> array as:</p>

<pre><code>GameObject[] houses = InitializeArray&lt;GameObject&gt;(200);
</code></pre>
","3301750"
"How to change the color of progressbar in C# .NET 3.5?","165120","","<p>I'd like to do two things on my progress bar.</p>

<ol>
<li>Change the green colour to red.</li>
<li>Remove the blocks and make it in one color.</li>
</ol>

<p>Any information about those two things I wonder how to accomplish will be greatfuly appreaciated!</p>

<p>Thanks.</p>
","<p>Since the previous answers don't appear to work in with Visual Styles. You'll probably need to create your own class or extend the progress bar:</p>

<pre><code>public class NewProgressBar : ProgressBar
{
    public NewProgressBar()
    {
        this.SetStyle(ControlStyles.UserPaint, true);
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        Rectangle rec = e.ClipRectangle;

        rec.Width = (int)(rec.Width * ((double)Value / Maximum)) - 4;
        if(ProgressBarRenderer.IsSupported)
           ProgressBarRenderer.DrawHorizontalBar(e.Graphics, e.ClipRectangle);
        rec.Height = rec.Height - 4;
        e.Graphics.FillRectangle(Brushes.Red, 2, 2, rec.Width, rec.Height);
    }
}
</code></pre>

<p>EDIT:  Updated code to make the progress bar use the visual style for the background</p>
","778866"
"How to remove all white spaces from the start or end of a string?","165086","","<p>How to remove all white spaces from the right and left end of a string, like so:</p>

<p><code>""hello""</code> return <code>""hello""</code><br>
<code>""hello   ""</code> return <code>""hello""</code><br>
<code>"" hello   ""</code> return <code>""hello""</code><br>
<code>"" hello world   ""</code> return <code>""hello world""</code></p>
","<p><a href=""https://msdn.microsoft.com/en-us/library/t97s7bs3.aspx"" rel=""noreferrer""><code>String.Trim()</code></a> will trim all <a href=""https://msdn.microsoft.com/en-us/library/t809ektx%28v=vs.110%29.aspx"" rel=""noreferrer"">white-spaces</a> from start <em>and</em> end of a string:</p>

<pre><code>""   A String   "".Trim() -&gt; ""A String""
</code></pre>

<p><code>String.TrimStart()</code> will trim all white-spaces from the start of a string:</p>

<pre><code>""   A String   "".TrimStart() -&gt; ""A String   ""
</code></pre>

<p><code>String.TrimEnd()</code> will trim all white-spaces from the end of a string:</p>

<pre><code>""   A String   "".TrimEnd() -&gt; ""   A String""
</code></pre>
","3381992"
"Read a XML (from a string) and get some fields - Problems reading XML","165040","","<p>I have this XML (stored in a C# string called <code>myXML</code>)</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-16""?&gt;
&lt;myDataz xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema""&gt;
  &lt;listS&gt;
    &lt;sog&gt;
      &lt;field1&gt;123&lt;/field1&gt;
      &lt;field2&gt;a&lt;/field2&gt;
      &lt;field3&gt;b&lt;/field3&gt;
    &lt;/sog&gt;
    &lt;sog&gt;
      &lt;field1&gt;456&lt;/field1&gt;
      &lt;field2&gt;c&lt;/field2&gt;
      &lt;field3&gt;d&lt;/field3&gt;
    &lt;/sog&gt;
  &lt;/listS&gt;
&lt;/myDataz&gt;
</code></pre>

<p>and I'd like to browse all <code>&lt;sog&gt;</code> elements. For each of them, I'd like to print the child <code>&lt;field1&gt;</code>.</p>

<p>So this is my code :</p>

<pre><code>XmlDocument xmlDoc = new XmlDocument();
string myXML = ""&lt;?xml version=\""1.0\"" encoding=\""utf-16\""?&gt;&lt;myDataz xmlns:xsi=\""http://www.w3.org/2001/XMLSchema-instance\"" xmlns:xsd=\""http://www.w3.org/2001/XMLSchema\""&gt;&lt;listS&gt;&lt;sog&gt;&lt;field1&gt;123&lt;/field1&gt;&lt;field2&gt;a&lt;/field2&gt;&lt;field3&gt;b&lt;/field3&gt;&lt;/sog&gt;&lt;sog&gt;&lt;field1&gt;456&lt;/field1&gt;&lt;field2&gt;c&lt;/field2&gt;&lt;field3&gt;d&lt;/field3&gt;&lt;/sog&gt;&lt;/listS&gt;&lt;/myDataz&gt;""
xmlDoc.Load(myXML);
XmlNodeList parentNode = xmlDoc.GetElementsByTagName(""listS"");
foreach (XmlNode childrenNode in parentNode)
{
    HttpContext.Current.Response.Write(childrenNode.SelectSingleNode(""//field1"").Value);
}
</code></pre>

<p>but seems I can't read a string as XML? I get <code>System.ArgumentException</code></p>
","<p>You should use LoadXml method, not Load:</p>

<pre><code>xmlDoc.LoadXml(myXML); 
</code></pre>

<p>Load method is trying to load xml from a file and LoadXml from a string. You could also use XPath:</p>

<pre><code>XmlDocument xmlDoc = new XmlDocument();
xmlDoc.LoadXml(xml);

string xpath = ""myDataz/listS/sog"";
var nodes = xmlDoc.SelectNodes(xpath);

foreach (XmlNode childrenNode in nodes)
{
    HttpContext.Current.Response.Write(childrenNode.SelectSingleNode(""//field1"").Value);
} 
</code></pre>
","8401375"
"Linq: GroupBy, Sum and Count","164895","","<p>I have a collection of products</p>

<pre><code>public class Product {

   public Product() { }

   public string ProductCode {get; set;}
   public decimal Price {get; set; }
   public string Name {get; set;}
}
</code></pre>

<p>Now I want to group the collection based on the product code and return an object containing the name, the number or products for each code and the total price for each product.</p>

<pre><code>public class ResultLine{

   public ResultLine() { }

   public string ProductName {get; set;}
   public string Price {get; set; }
   public string Quantity {get; set;}
}
</code></pre>

<p>So I use a GroupBy to group by ProductCode, then I calculate the sum and also count the number of records for each product code. </p>

<p>This is what I have so far: </p>

<pre><code>List&lt;Product&gt; Lines = LoadProducts();    
List&lt;ResultLine&gt; result = Lines
                .GroupBy(l =&gt; l.ProductCode)
                .SelectMany(cl =&gt; cl.Select(
                    csLine =&gt; new ResultLine
                    {
                        ProductName =csLine.Name,
                        Quantity = cl.Count().ToString(),
                        Price = cl.Sum(c =&gt; c.Price).ToString(),
                    })).ToList&lt;ResultLine&gt;();
</code></pre>

<p><strong>For some reason, the sum is done correctly but the count is always 1.</strong></p>

<p>Sampe data:</p>

<pre><code>List&lt;CartLine&gt; Lines = new List&lt;CartLine&gt;();
            Lines.Add(new CartLine() { ProductCode = ""p1"", Price = 6.5M, Name = ""Product1"" });
            Lines.Add(new CartLine() { ProductCode = ""p1"", Price = 6.5M, Name = ""Product1"" });
            Lines.Add(new CartLine() { ProductCode = ""p2"", Price = 12M, Name = ""Product2"" });
</code></pre>

<p>Result with sample data:</p>

<pre><code>Product1: count 1   - Price:13 (2x6.5)
Product2: count 1   - Price:12 (1x12)
</code></pre>

<p>Product 1 should have count = 2!</p>

<p>I tried to simulate this in a simple console application but there i got the following result:</p>

<pre><code>Product1: count 2   - Price:13 (2x6.5)
Product1: count 2   - Price:13 (2x6.5)
Product2: count 1   - Price:12 (1x12)
</code></pre>

<p>Product1: should only be listed once...
The code for the above can be found on pastebin: <a href=""http://pastebin.com/cNHTBSie"">http://pastebin.com/cNHTBSie</a></p>
","<p>I don't understand where the first ""result with sample data"" is coming from, but the problem in the console app is that you're using <code>SelectMany</code> to look at <em>each item in each group</em>.</p>

<p>I think you just want:</p>

<pre><code>List&lt;ResultLine&gt; result = Lines
    .GroupBy(l =&gt; l.ProductCode)
    .Select(cl =&gt; new ResultLine
            {
                ProductName = cl.First().Name,
                Quantity = cl.Count().ToString(),
                Price = cl.Sum(c =&gt; c.Price).ToString(),
            }).ToList();
</code></pre>

<p>The use of <code>First()</code> here to get the product name assumes that every product with the same product code has the same product name. As noted in comments, you could group by product name as well as product code, which will give the same results if the name is always the same for any given code, but apparently generates better SQL in EF.</p>

<p>I'd also suggest that you should change the <code>Quantity</code> and <code>Price</code> properties to be <code>int</code> and <code>decimal</code> types respectively - why use a string property for data which is clearly not textual?</p>
","16522841"
"LINQ: Select an object and change some properties without creating a new object","164756","","<p>Using LINQ, if I wanted to perform some query and return the object from the query, but change only some of the properties in that object, how would I do this without creating a new object and manually set every property?  Is this possible?</p>

<p>Example:</p>

<pre><code>var list = from something in someList
           select x // but change one property
</code></pre>
","<p>I'm not sure what the query syntax is.  But here is the expanded LINQ expression example.</p>

<pre><code>var query = someList.Select(x =&gt; { x.SomeProp = ""foo""; return x; })
</code></pre>

<p>What this does is use an anonymous method vs and expression.  This allows you to use several statements in one lambda.  So you can combine the two operations of setting the property and returning the object into this somewhat succinct method.</p>
","807816"
"How can I export a GridView.DataSource to a datatable or dataset?","164747","","<p>How can I export <code>GridView.DataSource</code> to datatable or dataset?</p>
","<p>You should convert first <code>DataSource</code> in <code>BindingSource</code>, look example</p>

<pre><code>BindingSource bs = (BindingSource)dgrid.DataSource; // Se convierte el DataSource 
DataTable tCxC = (DataTable) bs.DataSource;
</code></pre>

<p>With the data of <code>tCxC</code> you can do anything.</p>
","4445932"
"How to get correct timestamp in C#","164621","","<p>I would like to get valid timestamp in my application so I wrote:</p>

<pre><code>  public static String GetTimestamp(DateTime value) {
            return value.ToString(""yyyyMMddHHmmssffff"");
        }
  ...later on in the code
  String timeStamp = GetTimestamp(new DateTime());
  Console.WriteLine(timeStamp);
</code></pre>

<p>output:</p>

<pre><code>000101010000000000
</code></pre>

<p>I wanted something like:</p>

<pre><code>20140112180244
</code></pre>

<p>What have I done wrong? </p>
","<p>Your mistake is using <code>new DateTime()</code>, which returns January 1, 0001 at 00:00:00.000 instead of current date and time. The correct syntax to get current date and time is <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.now%28v=vs.110%29.aspx"" rel=""noreferrer"">DateTime.Now</a>, so change this:</p>

<pre><code>String timeStamp = GetTimestamp(new DateTime());
</code></pre>

<p>to this:</p>

<pre><code>String timeStamp = GetTimestamp(DateTime.Now);
</code></pre>
","21219819"
"Should I use int or Int32","164551","","<p>In C#, <code>int</code> and <code>Int32</code> are the same thing, but I've read a number of times that <code>int</code> is preferred over <code>Int32</code> with no reason given. Is there a reason, and should I care?</p>
","<p><a href=""https://www.ecma-international.org/publications/standards/Ecma-334.htm"" rel=""noreferrer"">ECMA-334</a>:2006 <em>C# Language Specification</em> (p18):</p>

<blockquote>
  <p>Each of the predefined types is shorthand for a system-provided type. For example, the keyword <code>int</code> refers to the struct <code>System.Int32</code>. As a matter of style, use of the keyword is favoured over use of the complete system type name.</p>
</blockquote>
","62738"
"How to subtract a day from a DateTime?","164491","","<p>What is wrong here:</p>

<pre><code>DateTime dateForButton =  DateTime.Now;  
dateForButton = dateForButton.AddDays(-1);  // ERROR: un-representable DateTime
</code></pre>

<p>The full error message is:</p>

<blockquote>
  <p><em>The added or subtracted value results in an un-representable DateTime.</em><br/>
  <em>Parameter name: value</em></p>
</blockquote>
","<p>That error usually occurs when you try to subtract an interval from <code>DateTime.MinValue</code> or you want to add something to <code>DateTime.MaxValue</code> (or you try to instantiate a date outside this min-max interval). Are you sure you're not assigning <code>MinValue</code> somewhere?</p>
","11152137"
"How to create readonly textbox in ASP.NET MVC3 Razor","164205","","<p>How to create a readonly textbox in ASP.NET MVC3, With Razor view engine ? Is there an HTMLHelper method available to do that ?</p>

<p><strong>Something like this ?</strong></p>

<p><code>@Html.ReadOnlyTextBoxFor(m =&gt; m.userCode)</code></p>
","<pre><code>@Html.TextBoxFor(m =&gt; m.userCode, new { @readonly=""readonly"" })
</code></pre>

<p>You are welcome to make an HTML Helper for this, but this is simply just an HTML attribute like any other.  Would you make an HTML Helper for a text box that has other attributes?</p>
","8761683"
"?: ?? Operators Instead Of IF|ELSE","164141","","<pre><code>public string Source
{
    get
    {
        /*
        if ( Source == null ){
            return string . Empty;
        } else {
            return Source;
        }
        */
        return Source ?? string.Empty;
    }
    set
    {
        /*
        if ( Source == null ) {
            Source = string . Empty;
        } else {
            if ( Source == value ) {
                Source = Source;
            } else {
                Source = value;
            }
        }
        */
        Source == value ? Source : value ?? string.Empty;
        RaisePropertyChanged ( ""Source"" );
    }
}
</code></pre>

<p>Can I use <code>?:</code> <code>??</code> operators <strong>EXACTLY</strong> as If/Else?</p>

<hr>

<p><strong>My Question :</strong><br>
How to write the following with ?: ?? operators  </p>

<p><strong>[ 1 ]</strong></p>

<pre><code>if ( Source == null ){
    // Return Nothing
} else {
    return Source;
}
</code></pre>

<p><strong>[ 2 ]</strong></p>

<pre><code>if ( Source == value ){
    // Do Nothing
} else {
    Source = value;
    RaisePropertyChanged ( ""Source"" );
} 
</code></pre>

<p><strong>Briefly</strong> : How to do nothing, return nothing and do multiple instructions with <code>?:</code> <code>??</code> operator?</p>
","<p>For [1], you can't: these operators are made to return a value, not perform operations.</p>

<p>The expression</p>

<pre><code>a ? b : c
</code></pre>

<p>evaluates to <code>b</code> if <code>a</code> is true and evaluates to <code>c</code> if <code>a</code> is false.</p>

<p>The expression</p>

<pre><code>b ?? c
</code></pre>

<p>evaluates to <code>b</code> if <code>b</code> is not null and evaluates to <code>c</code> if <code>b</code> is null.</p>

<p>If you write</p>

<pre><code>return a ? b : c;
</code></pre>

<p>or</p>

<pre><code>return b ?? c;
</code></pre>

<p>they will <em>always</em> return something.</p>

<p>For [2], you can write a function that returns the right value that performs your ""multiple operations"", but that's probably worse than just using <code>if/else</code>.</p>
","6208182"
"How to ignore a property in class if null, using json.net","164118","","<p>I am using <a href=""http://www.newtonsoft.com/json"" rel=""noreferrer"">Json.NET</a> to serialize a class to JSON.</p>

<p>I have the class like this:</p>

<pre><code>class Test1
{
    [JsonProperty(""id"")]
    public string ID { get; set; }
    [JsonProperty(""label"")]
    public string Label { get; set; }
    [JsonProperty(""url"")]
    public string URL { get; set; }
    [JsonProperty(""item"")]
    public List&lt;Test2&gt; Test2List { get; set; }
}
</code></pre>

<p>I want to add a <code>JsonIgnore()</code> attribute to <code>Test2List</code> property only when <code>Test2List</code> is <code>null</code>. If it is not null then I want to include it in my json.</p>
","<p>As per James Newton King: If you create the serializer yourself rather than using JavaScriptConvert there is a <a href=""http://james.newtonking.com/json/help/index.html?topic=html/T_Newtonsoft_Json_NullValueHandling.htm"" rel=""noreferrer""><code>NullValueHandling</code> property</a> which you can set to ignore.</p>

<p>Here's a sample:</p>

<pre><code>JsonSerializer _jsonWriter = new JsonSerializer {
                                 NullValueHandling = NullValueHandling.Ignore
                             };
</code></pre>

<hr>

<p>Alternatively, as suggested by @amit</p>

<pre><code>JsonConvert.SerializeObject(myObject, 
                            Newtonsoft.Json.Formatting.None, 
                            new JsonSerializerSettings { 
                                NullValueHandling = NullValueHandling.Ignore
                            });
</code></pre>
","6507965"
"Duplicate keys in .NET dictionaries?","163948","","<p>Are there any dictionary classes in the .NET base class library which allow duplicate keys to be used?  The only solution I've found is to create, for example, a class like:</p>

<pre><code>Dictionary&lt;string, List&lt;object&gt;&gt;
</code></pre>

<p>But this is quite irritating to actually use.  In Java, I believe a MultiMap accomplishes this, but cannot find an analog in .NET.</p>
","<p>If you're using .NET 3.5, use the <a href=""http://msdn.microsoft.com/en-us/library/bb460184.aspx"" rel=""noreferrer""><code>Lookup</code></a> class.</p>

<p>EDIT: You generally create a <code>Lookup</code> using <a href=""http://msdn.microsoft.com/en-us/library/system.linq.enumerable.tolookup.aspx"" rel=""noreferrer""><code>Enumerable.ToLookup</code></a>. This does assume that you don't need to change it afterwards - but I typically find that's good enough.</p>

<p>If that <em>doesn't</em> work for you, I don't think there's anything in the framework which will help - and using the dictionary is as good as it gets :(</p>
","146227"
"How do you do Impersonation in .NET?","163874","","<p>Is there a simple out of the box way to impersonate a user in .NET?</p>

<p>So far I've been using <a href=""http://www.codeproject.com/KB/cs/zetaimpersonator.aspx"" rel=""noreferrer"">this class from code project</a> for all my impersonation requirements.</p>

<p>Is there a better way to do it by using .NET Framework?</p>

<p>I have a user credential set, (username, password, domain name) which represents the identity I need to impersonate.</p>
","<p>Here is some good overview of .NET impersonation concepts.</p>

<ul>
<li><a href=""http://michiel.vanotegem.nl/2006/07/07/WindowsImpersonationContextMadeEasy.aspx"" rel=""noreferrer"">Michiel van Otegem: WindowsImpersonationContext made easy</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx"" rel=""noreferrer"">WindowsIdentity.Impersonate Method (check out the code samples)</a></li>
</ul>

<p>Basically you will be leveraging these classes that are out of the box in the .NET framework:</p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx"" rel=""noreferrer"">WindowsImpersonationContext</a> </li>
<li><a href=""http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx"" rel=""noreferrer"">WindowsIdentity</a></li>
</ul>

<p>The code can often get lengthy though and that is why you see many examples like the one you reference that try to simplify the process.</p>
","125356"
"How to populate/instantiate a C# array with a single value?","163850","","<p>I know that instantiated arrays of value types in C# are automatically populated with the <a href=""http://msdn.microsoft.com/en-us/library/83fhsxwc(loband).aspx"" rel=""noreferrer"">default value of the type</a> (e.g. false for bool, 0 for int, etc.).</p>

<p>Is there a way to auto-populate an array with a seed value that's not the default? Either on creation or a built-in method afterwards (like Java's <a href=""https://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#fill-int:A-int-"" rel=""noreferrer"">Arrays.fill()</a>)? Say I wanted an boolean array that was true by default, instead of false.  Is there a built-in way to do this, or do you just have to iterate through the array with a for loop?</p>

<pre><code> // Example pseudo-code:
 bool[] abValues = new[1000000];
 Array.Populate(abValues, true);

 // Currently how I'm handling this:
 bool[] abValues = new[1000000];
 for (int i = 0; i &lt; 1000000; i++)
 {
     abValues[i] = true;
 }
</code></pre>

<p>Having to iterate through the array and ""reset"" each value to true seems ineffecient.  Is there anyway around this?  Maybe by flipping all values?</p>

<p>After typing this question out and thinking about it, I'm guessing that the default values are simply a result of how C# handles the memory allocation of these objects behind the scenes, so I imagine it's probably not possible to do this.  But I'd still like to know for sure!</p>
","<p>Don't know of a framework method but you could write a quick helper to do it for you.</p>

<pre><code>public static void Populate&lt;T&gt;(this T[] arr, T value ) {
  for ( int i = 0; i &lt; arr.Length;i++ ) {
    arr[i] = value;
  }
}
</code></pre>
","1014015"
"How to check if a number is a power of 2","163755","","<p>Today I needed a simple algorithm for checking if a number is a power of 2.</p>

<p>The algorithm needs to be:</p>

<ol>
<li>Simple</li>
<li>Correct for any <code>ulong</code> value.</li>
</ol>

<p>I came up with this simple algorithm:</p>

<pre><code>private bool IsPowerOfTwo(ulong number)
{
    if (number == 0)
        return false;

    for (ulong power = 1; power &gt; 0; power = power &lt;&lt; 1)
    {
        // This for loop used shifting for powers of 2, meaning
        // that the value will become 0 after the last shift
        // (from binary 1000...0000 to 0000...0000) then, the 'for'
        // loop will break out.

        if (power == number)
            return true;
        if (power &gt; number)
            return false;
    }
    return false;
}
</code></pre>

<p>But then I thought, how about checking if <code>log<sub>2</sub> x</code> is an exactly round number? But when I checked for 2^63+1, <code>Math.Log</code> returned exactly 63 because of rounding. So I checked if 2 to the power 63 is equal to the original number - and it is, because the calculation is done in <code>double</code>s and not in exact numbers:</p>

<pre><code>private bool IsPowerOfTwo_2(ulong number)
{
    double log = Math.Log(number, 2);
    double pow = Math.Pow(2, Math.Round(log));
    return pow == number;
}
</code></pre>

<p>This returned <code>true</code> for the given wrong value: <code>9223372036854775809</code>.</p>

<p>Is there a better algorithm?</p>
","<p>There's a simple trick for this problem:</p>

<pre><code>bool IsPowerOfTwo(ulong x)
{
    return (x &amp; (x - 1)) == 0;
}
</code></pre>

<p>Note, this function will report <code>true</code> for <code>0</code>, which is not a power of <code>2</code>. If you want to exclude that, here's how:</p>

<pre><code>bool IsPowerOfTwo(ulong x)
{
    return (x != 0) &amp;&amp; ((x &amp; (x - 1)) == 0);
}
</code></pre>

<h3>Explanation</h3>

<p>First and foremost the bitwise binary &amp; operator from MSDN definition:</p>

<blockquote>
  <p>Binary &amp; operators are predefined for the integral types and bool. For
  integral types, &amp; computes the logical bitwise AND of its operands.
  For bool operands, &amp; computes the logical AND of its operands; that
  is, the result is true if and only if both its operands are true.</p>
</blockquote>

<p>Now let's take a look at how this all plays out:</p>

<p>The function returns boolean (true / false) and accepts one incoming parameter of type unsigned long (x, in this case).  Let us for the sake of simplicity assume that someone has passed the value 4 and called the function like so:</p>

<pre><code>bool b = IsPowerOfTwo(4)
</code></pre>

<p>Now we replace each occurrence of x with 4:</p>

<pre><code>return (4 != 0) &amp;&amp; ((4 &amp; (4-1)) == 0);
</code></pre>

<p>Well we already know that 4 != 0 evals to true, so far so good.  But what about:</p>

<pre><code>((4 &amp; (4-1)) == 0)
</code></pre>

<p>This translates to this of course:</p>

<pre><code>((4 &amp; 3) == 0)
</code></pre>

<p>But what exactly is <code>4&amp;3</code>?</p>

<p>The binary representation of 4 is 100 and the binary representation of 3 is 011 (remember the &amp; takes the binary representation of these numbers.  So we have:</p>

<pre><code>100 = 4
011 = 3
</code></pre>

<p>Imagine these values being stacked up much like elementary addition. The <code>&amp;</code> operator says that if both values are equal to 1 then the result is 1, otherwise it is 0. So <code>1 &amp; 1 = 1</code>, <code>1 &amp; 0 = 0</code>, <code>0 &amp; 0 = 0</code>, and <code>0 &amp; 1 = 0</code>. So we do the math:</p>

<pre><code>100
011
----
000
</code></pre>

<p>The result is simply 0. So we go back and look at what our return statement now translates to:</p>

<pre><code>return (4 != 0) &amp;&amp; ((4 &amp; 3) == 0);
</code></pre>

<p>Which translates now to:</p>

<pre><code>return true &amp;&amp; (0 == 0);
</code></pre>



<pre><code>return true &amp;&amp; true;
</code></pre>

<p>We all know that <code>true &amp;&amp; true</code> is simply <code>true</code>, and this shows that for our example, 4 is a power of 2.</p>
","600306"
"What does {0} mean when found in a string in C#?","163745","","<p>In a dictionary like this:</p>

<pre><code>Dictionary&lt;string, string&gt; openWith = new Dictionary&lt;string, string&gt;();

openWith.Add(""txt"", ""notepad.exe"");
openWith.Add(""bmp"", ""paint.exe"");
openWith.Add(""dib"", ""paint.exe"");
openWith.Add(""rtf"", ""wordpad.exe"");

Console.WriteLine(""For key = \""rtf\"", value = {0}."", openWith[""rtf""]);
</code></pre>

<p>The output is:</p>

<blockquote>
  <p>For Key = ""rtf"" value = wordpad.exe</p>
</blockquote>

<p>What does the <code>{0}</code> mean?</p>
","<p>You are printing a formatted string.  The {0} means to insert the first parameter following the format string; in this case the value associated with the key ""rtf"".</p>

<p>For String.Format, which is similar, if you had something like</p>

<pre><code>//            Format string                    {0}           {1}
String.Format(""This {0}.  The value is {1}."",  ""is a test"",  42 ) 
</code></pre>

<p>you'd create a string ""This <strong>is a test</strong>.  The value is <strong>42</strong>"".</p>

<p>You can also use expressions, and print values out multiple times:</p>

<pre><code>//            Format string              {0} {1}  {2}
String.Format(""Fib: {0}, {0}, {1}, {2}"", 1,  1+1, 1+2) 
</code></pre>

<p>yielding ""Fib: <strong>1</strong>, <strong>1</strong>, <strong>2</strong>, <strong>3</strong>""</p>

<p>See more at <a href=""http://msdn.microsoft.com/en-us/library/txafckwd.aspx"" rel=""noreferrer"">http://msdn.microsoft.com/en-us/library/txafckwd.aspx</a>, which talks about composite formatting.</p>
","530540"
"Change WPF controls from a non-main thread using Dispatcher.Invoke","163679","","<p>I have recently started programming in WPF and bumped into the following problem. I don't understand how to use the <code>Dispatcher.Invoke()</code> method. I have experience in threading and I have made a few simple Windows Forms programs where I just used the</p>

<pre><code>Control.CheckForIllegalCrossThreadCalls = false;
</code></pre>

<p>Yes I know that is pretty lame but these were simple monitoring applications.</p>

<p>The fact is now I am making a WPF application which retrieves data in the background, I start off a new thread to make the call to retrieve the data (from a webserver), now I want to display it on my WPF form. The thing is, I cannot set any control from this thread. Not even a label or anything. How can this be resolved?</p>

<p><b>Answer comments:</b><br>
@Jalfp:<br>
 <em>So I use this Dispatcher method in the 'new tread' when I get the data? Or should I make a background worker retrieve the data, put it into a field and start a new thread that waits till this field is filled and call the dispatcher to show the retrieved data into the controls?</em></p>
","<p>The first thing is to understand that, the Dispatcher is not designed to run long blocking operation (such as retrieving data from a WebServer...). You can use the Dispatcher when you want to run an operation that will be executed on the UI thread (such as updating the value of a progress bar).</p>

<p>What you can do is to retrieve your data in a background worker and use the ReportProgress method to propagate changes in the UI thread.</p>

<p>If you really need to use the Dispatcher directly, it's pretty simple:</p>

<pre><code>Application.Current.Dispatcher.BeginInvoke(
  DispatcherPriority.Background,
  new Action(() =&gt; this.progressBar.Value = 50));
</code></pre>
","1644254"
"When should I use a List vs a LinkedList","163570","","<p>When is it better to use a <code>List(Of T)</code> vs a <code>LinkedList(Of T)</code>?</p>
","<h2>Edit</h2>

<blockquote>
  <p>Please read the comments to this answer. People claim I did not do
  proper tests. I agree this should not be an accepted answer. As I was
  learning I did some tests and felt like sharing them.</p>
</blockquote>

<h2>Original answer...</h2>

<p>I found interesting results:</p>

<pre><code>// Temporary class to show the example
class Temp
{
    public decimal A, B, C, D;

    public Temp(decimal a, decimal b, decimal c, decimal d)
    {
        A = a;            B = b;            C = c;            D = d;
    }
}
</code></pre>

<h2>Linked list (3.9 seconds)</h2>

<pre><code>        LinkedList&lt;Temp&gt; list = new LinkedList&lt;Temp&gt;();

        for (var i = 0; i &lt; 12345678; i++)
        {
            var a = new Temp(i, i, i, i);
            list.AddLast(a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A;
</code></pre>

<h2>List  (2.4 seconds)</h2>

<pre><code>        List&lt;Temp&gt; list = new List&lt;Temp&gt;(); // 2.4 seconds

        for (var i = 0; i &lt; 12345678; i++)
        {
            var a = new Temp(i, i, i, i);
            list.Add(a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A;
</code></pre>

<p><strong>Even if you only access data essentially it is much slower!!</strong> I say never use a linkedList.</p>

<hr>

<hr>

<hr>

<p><strong>Here is another comparison performing a lot of inserts (we plan on inserting an item at the middle of the list)</strong></p>

<h2>Linked List  (51 seconds)</h2>

<pre><code>        LinkedList&lt;Temp&gt; list = new LinkedList&lt;Temp&gt;();

        for (var i = 0; i &lt; 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.AddLast(a);
            var curNode = list.First;

            for (var k = 0; k &lt; i/2; k++) // In order to insert a node at the middle of the list we need to find it
                curNode = curNode.Next;

            list.AddAfter(curNode, a); // Insert it after
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A;
</code></pre>

<h2>List  (7.26 seconds)</h2>

<pre><code>        List&lt;Temp&gt; list = new List&lt;Temp&gt;();

        for (var i = 0; i &lt; 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.Insert(i / 2, a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A;
</code></pre>

<h2>Linked List having reference of location where to insert (.04 seconds)</h2>

<pre><code>        list.AddLast(new Temp(1,1,1,1));
        var referenceNode = list.First;

        for (var i = 0; i &lt; 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.AddLast(a);
            list.AddBefore(referenceNode, a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A;
</code></pre>

<p>So only if you plan on inserting several items and you <strong>also</strong> somewhere have the reference of where you plan to insert the item then use a linked list. Just because you have to insert a lot of items it does not make it faster because searching the location where you will like to insert it takes time.</p>
","12466884"
"Reading CSV files using C#","163282","","<p>I'm writing a simple import application and need to read a CSV file, show result in a <code>DataGrid</code> and show corrupted lines of the CSV file in another grid. For example, show the lines that are shorter than 5 values in another grid. I'm trying to do that like this:</p>

<pre><code>StreamReader sr = new StreamReader(FilePath);
importingData = new Account();
string line;
string[] row = new string [5];
while ((line = sr.ReadLine()) != null)
{
    row = line.Split(',');

    importingData.Add(new Transaction
    {
        Date = DateTime.Parse(row[0]),
        Reference = row[1],
        Description = row[2],
        Amount = decimal.Parse(row[3]),
        Category = (Category)Enum.Parse(typeof(Category), row[4])
    });
}
</code></pre>

<p>but it's very difficult to operate on arrays in this case. Is there any better way to split the values?</p>
","<p>Don't reinvent the wheel. Take advantage of what's already in .NET BCL. </p>

<ul>
<li>add a reference to the <code>Microsoft.VisualBasic</code> (yes, it says VisualBasic but it works in C# just as well - remember that at the end it is all just IL)</li>
<li>use the <code>Microsoft.VisualBasic.FileIO.TextFieldParser</code> class to parse CSV file</li>
</ul>

<p>Here is the sample code:</p>

<pre><code>using (TextFieldParser parser = new TextFieldParser(@""c:\temp\test.csv""))
{
    parser.TextFieldType = FieldType.Delimited;
    parser.SetDelimiters("","");
    while (!parser.EndOfData) 
    {
        //Processing row
        string[] fields = parser.ReadFields();
        foreach (string field in fields) 
        {
            //TODO: Process field
        }
    }
}
</code></pre>

<p>It works great for me in my C# projects. </p>

<p>Here are some more links/informations:</p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/cakac7e6.aspx"" rel=""noreferrer"">MSDN: Read From Comma-Delimited Text Files in Visual Basic</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx"" rel=""noreferrer"">MSDN: TextFieldParser Class</a></li>
</ul>
","3508572"
"Difference between Dictionary and Hashtable","163245","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/301371/why-dictionary-is-preferred-over-hashtable-in-c"">Why Dictionary is preferred over hashtable in C#?</a>  </p>
</blockquote>



<p>What is the difference between Dictionary and Hashtable. How to decide which one to use?</p>
","<p>Simply, <code>Dictionary&lt;TKey,TValue&gt;</code> is a generic type, allowing:</p>

<ul>
<li>static typing (and compile-time verification)</li>
<li>use without boxing</li>
</ul>

<p>If you are .NET 2.0 or above, you should <em>prefer</em> <code>Dictionary&lt;TKey,TValue&gt;</code> (and the other generic collections)</p>

<p>A subtle but important difference is that <code>Hashtable</code> supports multiple reader threads with a single writer thread, while <code>Dictionary</code> offers no thread safety. If you need thread safety with a generic dictionary, you must implement your own synchronization or (in .NET 4.0) use <code>ConcurrentDictionary&lt;TKey, TValue&gt;</code>.</p>
","876659"
"Make an Installation program for C# applications and include .NET Framework installer into the setup","163221","","<p>I've finished my C# application, but I have a little problem:</p>

<p>When I try to run my application in another PC, I need always to Install .NET Framework 4.0.</p>

<p>Is there something to do to make it work without installing the framework from internet?</p>

<p>I tried before <a href=""http://www.jrsoftware.org/isinfo.php"">InnoSetup</a> for a VB6 application, but I'm not sure if it's going to work for .NET 4.0!</p>

<p>Any ideas?</p>
","<p>Use Visual Studio Setup project. Setup project can automatically include .NET framework setup in your installation package:</p>

<p>Here is my step-by-step for windows forms application:</p>

<ol>
<li><p>Create setup project. You can use Setup Wizard.</p>

<p><img src=""https://i.stack.imgur.com/3paMR.png"" alt=""enter image description here""></p></li>
<li><p>Select project type.</p>

<p><img src=""https://i.stack.imgur.com/i6it2.png"" alt=""enter image description here""></p></li>
<li><p>Select output.</p>

<p><img src=""https://i.stack.imgur.com/5RDGP.png"" alt=""enter image description here""></p></li>
<li><p>Hit Finish.</p></li>
<li><p>Open setup project properties.</p>

<p><img src=""https://i.stack.imgur.com/VtesJ.png"" alt=""enter image description here""></p></li>
<li><p>Chose to include .NET framework.</p>

<p><img src=""https://i.stack.imgur.com/zKVrY.png"" alt=""enter image description here""></p></li>
<li><p>Build setup project</p></li>
<li><p>Check output</p>

<p><img src=""https://i.stack.imgur.com/4YbgN.png"" alt=""enter image description here""></p></li>
</ol>

<hr>

<p><strong>Note:</strong> The Visual Studio Installer projects are no longer pre-packed with Visual Studio.  However, in Visual Studio 2013 you can download them by using <code>Tools &gt; Extensions and Updates &gt; Online (search) &gt; Visual Studio Installer Projects</code></p>
","6090929"
"Quickest way to compare two List<>","163186","","<p>What is the quickest (and least resource intensive) to compare two massive (>50.000 items) and as a result have two lists like the ones below:</p>

<ol>
<li>items that show up in the first list but not in the second</li>
<li>items that show up in the second list but not in the first</li>
</ol>

<p>Currently I'm working with the List or IReadOnlyCollection and solve this issue in a linq query:</p>

<pre><code>var list1 = list.Where(i =&gt; !list2.Contains(i)).ToList();
var list2 = list2.Where(i =&gt; !list.Contains(i)).ToList();
</code></pre>

<p>But this doesn't perform as good as i would like.
Any idea of making this quicker and less resource intensive as i need to process a lot of lists?</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/bb300779.aspx"" rel=""noreferrer""><code>Except</code></a>:</p>

<pre><code>var firstNotSecond = list1.Except(list2).ToList();
var secondNotFirst = list2.Except(list1).ToList();
</code></pre>

<p>I suspect there are approaches which would actually be marginally faster than this, but even this will be <em>vastly</em> faster than your O(N * M) approach.</p>

<p>If you want to combine these, you could create a method with the above and then a return statement:</p>

<pre><code>return !firstNotSecond.Any() &amp;&amp; !secondNotFirst.Any();
</code></pre>
","12795900"
"How to hide a div from code (c#)","162858","","<p>I have a div element on my page that I wish to show/hide based on a session value in my code-behind. How can I do this?</p>
","<p>Give the div <code>""runat=""server""</code> and an <code>id</code> and you can reference it in your <code>code behind</code>.</p>

<pre><code>&lt;div runat=""server"" id=""theDiv""&gt;
</code></pre>

<p>In code behind:</p>

<pre><code>{
    theDiv.Visible = false;
}
</code></pre>
","5297189"
"What is the purpose of the vshost.exe file?","162790","","<p>When I create and compile a ""hello world"" application in C#, I get three files in the Debug folder apart from the main exe (e.g. HelloWorld.exe)</p>

<ol>
<li>HelloWorld.vshost.exe</li>
<li>HelloWorld.pdb</li>
<li>HelloWorld.vshost.exe.manifest</li>
</ol>

<p>What purpose do these files serve?</p>
","<p>The vshost.exe feature was introduced with VS2005 (to answer your comment).</p>

<p>The purpose of it is mostly to make debugging launch quicker - basically there's already a process with the framework running, just ready to load your application as soon as you want it to.</p>

<p>See <a href=""http://msdn.microsoft.com/en-us/library/ms242202.aspx"" rel=""noreferrer"">this MSDN article</a> and <a href=""http://blogs.msdn.com/dtemp/archive/2004/08/17/215764.aspx"" rel=""noreferrer"">this blog post</a> for more information.</p>
","774219"
"C# Passing Function as Argument","162737","","<p>I've written a function in C# that does a numerical differentiation. It looks like this:</p>

<pre><code>public double Diff(double x)
{
    double h = 0.0000001;

    return (Function(x + h) - Function(x)) / h;
}
</code></pre>

<p>I would like to be able to pass in any function, as in:</p>

<pre><code>public double Diff(double x, function f)
{
    double h = 0.0000001;

    return (f(x + h) - f(x)) / h;
}
</code></pre>

<p>I think this is possible with delegates (maybe?) but I'm not sure how to use them.</p>

<p>Any help would be greatly appreciated.</p>
","<p>Using the Func as mentioned above works but there are also delegates that do the same task and also define intent within the naming:</p>

<pre><code>public delegate double MyFunction(double x);

public double Diff(double x, MyFunction f)
{
    double h = 0.0000001;

    return (f(x + h) - f(x)) / h;
}

public double MyFunctionMethod(double x)
{
    // Can add more complicated logic here
    return x + 10;
}

public void Client()
{
    double result = Diff(1.234, x =&gt; x * 456.1234);
    double secondResult = Diff(2.345, MyFunctionMethod);
}
</code></pre>
","3622263"
"Change GridView row color based on condition","162680","","<p>I want to change a particular row color of gridview based on some condition, I am using ASP.NET with c#. Thank you.</p>
","<pre><code>protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    e.Row.Attributes.Add(""style"", ""cursor:help;"");
    if (e.Row.RowType == DataControlRowType.DataRow &amp;&amp; e.Row.RowState == DataControlRowState.Alternate)
    { 
        if (e.Row.RowType == DataControlRowType.DataRow)
        {                
            e.Row.Attributes.Add(""onmouseover"", ""this.style.backgroundColor='orange'"");
            e.Row.Attributes.Add(""onmouseout"", ""this.style.backgroundColor='#E56E94'"");
            e.Row.BackColor = Color.FromName(""#E56E94"");                
        }           
    }
    else
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            e.Row.Attributes.Add(""onmouseover"", ""this.style.backgroundColor='orange'"");
            e.Row.Attributes.Add(""onmouseout"", ""this.style.backgroundColor='gray'"");
            e.Row.BackColor = Color.FromName(""gray"");                
        }

        //e.Row.Cells[0].BackColor = Color.FromName(""gray"");
        //e.Row.Cells[1].BackColor = Color.FromName(""gray"");
        //e.Row.Cells[2].BackColor = Color.FromName(""gray"");
        //e.Row.Cells[3].BackColor = Color.FromName(""gray"");
        //e.Row.Cells[4].BackColor = Color.FromName(""gray"");
        //e.Row.BorderWidth = 2;
        //e.Row.BorderColor = Color.FromName(""#43C6DB"");
    }
}
</code></pre>
","5124981"
"Calling @Html.Partial to display a partial view belonging to a different controller","162581","","<p>I am developing an ASP.NET MVC 3 application, whose content pages have a common pattern of layout elements. However, because the login page does not follow this layout, I cannot place this layout in <code>\Views\Shared\_Layout.cshtml</code>.</p>

<p>So I would like to add another shared layout, say, <code>\Views\Shared\_Content.cshtml</code>, and call it from the content views... but unfortunately those views belong to different controllers.</p>

<p>Is there any way to invoke <code>@Html.Partial</code> for a view belonging to a different controller?</p>
","<p>That's no problem.</p>

<pre><code>@Html.Partial(""../Controller/View"", model)
</code></pre>

<p>or </p>

<pre><code>@Html.Partial(""~/Views/Controller/View.cshtml"", model)
</code></pre>

<p>Should do the trick.</p>

<p>If you want to pass through the (other) controller, you can use:</p>

<pre><code>@Html.Action(""action"", ""controller"", parameters)
</code></pre>

<p>or any of the other overloads</p>
","6061017"
".NET HashTable Vs Dictionary - Can the Dictionary be as fast?","162547","","<p>I am trying to figure out when and why to use a Dictionary or a HashTable.  I have done a bit of a search on here and have found people talking about the generic advantages of the Dictionary which I totally agree with, which leads the boxing and unboxing advantage for a slight performance gain.</p>

<p>But I have also read the Dictionary will not always return the objects in the order they are inserted, thing it is sorted.  Where as a HashTable will.  As I understand it this leads to the HashTable being far faster for some situations.</p>

<p>My question is really, what might those situations be?  Am I just wrong in my assumptions above?  What situations might you use to choose one above the other, (yes the last one is a bit ambiguous).</p>
","<p><code>System.Collections.Generic.Dictionary&lt;TKey, TValue&gt;</code> and <code>System.Collections.Hashtable</code> classes both maintain a hash table data structure internally. <strong>None of them guarantee preserving the order of items.</strong> </p>

<p>Leaving boxing/unboxing issues aside, most of the time, they should have very similar performance. </p>

<p>The primary structural difference between them is that <code>Dictionary</code> relies on <em>chaining</em> (maintaining a list of items for each hash table bucket) to resolve collisions whereas <code>Hashtable</code> uses <em>rehashing</em> for collision resolution (when a collision occurs, tries another hash function to map the key to a bucket).</p>

<p>There is little benefit to use <code>Hashtable</code> class if you are targeting for .NET Framework 2.0+. It's effectively rendered obsolete by <code>Dictionary&lt;TKey, TValue&gt;</code>.</p>
","1089142"
"How I can filter a Datatable?","162530","","<p>I use a DataTable with Information about Users and I want search a user or a list of users in this DataTable. I try it butit don't work :( </p>

<p>Here is my c# code:</p>

<pre><code> public DataTable GetEntriesBySearch(string username,string location,DataTable table)
        {
            list = null;
            list = table;

            string expression;
            string sortOrder;

            expression = ""Nachname = 'test'"";
            sortOrder = ""nachname DESC"";

            DataRow[] rows =  list.Select(expression, sortOrder);

            list = null; // for testing
            list = new DataTable(); // for testing

            foreach (DataRow row in rows)
            {
                list.ImportRow(row);
            }

            return list; 
        }
</code></pre>
","<p>You can use DataView.<br></p>

<pre><code>DataView dv = new DataView(yourDatatable);
dv.RowFilter = ""query""; // query example = ""id = 10""
</code></pre>

<p><br>
<a href=""http://www.csharp-examples.net/dataview-rowfilter/"">http://www.csharp-examples.net/dataview-rowfilter/</a></p>
","13012669"
"Develop Android app using C#","162450","","<p>Is it possible to write an android app using C#? Is there an API or something? Is it free for personal and commercial development?</p>

<p>What do I need to install to have android project template in my Visual Studio?</p>
","<p>You could use <code>Mono for Android</code>:</p>

<p><a href=""http://xamarin.com/monoforandroid"" rel=""noreferrer"">http://xamarin.com/monoforandroid</a></p>

<p>An alternative is <code>dot42</code>:</p>

<p><a href=""http://www.dot42.com/"" rel=""noreferrer"">http://www.dot42.com/</a></p>

<p>dot42 provides a free community licence as well as a professional licence for $399.</p>
","10962119"
"Sequence contains no elements?","162369","","<p>I'm currently using a single query in two places to get a row from a database.</p>

<pre><code>BlogPost post = (from p in dc.BlogPosts
                 where p.BlogPostID == ID
                 select p).Single();
</code></pre>

<p>The query is fine when retrieving the row to put data in to the text boxes, but it returns an error ""Sequence contains no elements"" when used to retrieve the row in order to edit it and put it back in to the database. I can't understand why it might find an appropriate row in one instance but not another.</p>

<p>(Using ASP.NET MVC and LINQ)</p>
","<p>Put a breakpoint on that line, or a Debug.Print before it, in both cases and see what ID contains.</p>
","1324220"
"How to use a WSDL","162260","","<p>I need to consume a Web Service. They sent me the WSDL file. 
What should I do to add it to my website and start using it as the proxy.
( If I put it on a Virtual Directory it can be discovered, but does it grant me the connection with the real web service?)</p>
","<p>I would fire up Visual Studio 2008, create a web project (or console app - doesn't matter), and then right-click on the project and pick ""Add Service Reference"" from the context menu.</p>

<p>Enter the file path and name into the box and import the WSDL - this will generate a simple, very basic WCF client for you to use. You should find a ""YourservicenameClient"" class in the generated code which should have methods for each of the defined methods on the WSDL contract.</p>

<p>Instantiate the client and call the methods you want to call - that's all there is!</p>

<pre><code>YourServiceClient client = new YourServiceClient();
client.SayHello(""World!"");
</code></pre>

<p>If you need to specify the remote URL (not using the one created by default), you can easily do this in the constructor of the proxy client:</p>

<pre><code>YourServiceClient client = new YourServiceClient(""configName"", ""remoteURL"");
</code></pre>

<p>where <code>configName</code> is the name of the endpoint to use (you will use all the settings except the URL), and the <code>remoteURL</code> is a string representing the URL to connect to (instead of the one contained in the config).</p>
","1302559"
"List<T> or IList<T>","162209","","<p>Can anyone explain to me why I would want to use IList over List in C#?</p>

<p><em>Related question: <a href=""https://stackoverflow.com/questions/387937"">Why is it considered bad to expose <code>List&lt;T&gt;</code></a></em></p>
","<p>If you are exposing your class through a library that others will use, you generally want to expose it via interfaces rather than concrete implementations.  This will help if you decide to change the implementation of your class later to use a different concrete class.  In that case the users of your library won't need to update their code since the interface doesn't change.</p>

<p>If you are just using it internally, you may not care so much, and using <code>List&lt;T&gt;</code> may be ok.</p>
","400144"
"Two Decimal places using c#","161980","","<pre><code>decimal Debitvalue = 1156.547m;

decimal DEBITAMT = Convert.ToDecimal(string.Format(""{0:0.00}"", Debitvalue));
</code></pre>

<p>I have to get only two decimal places but by using this code I am getting 1156.547.
Let me know which format I have to use to display two decimal places.</p>
","<p>If you want to round the decimal, look at <code>Math.Round()</code></p>
","10749522"
"Programmatically add new column to DataGridView","161889","","<p>I have a DataGridView bound to a DataTable. The DataTable is populated from a database query. The table contains a column named BestBefore. BestBefore is a date formatted as a string (SQLite doesn't have date types). </p>

<p>I would like to programmatically add a new column to the DataGridView called Status. If BestBefore is less than the current date, Status value should be set to OK, otherwise Status value should be set to NOT OK.</p>

<p>I'm very new to Winforms, so some example code would be greatly appreciated.</p>

<p><strong>UPDATE:</strong></p>

<p>I think DataColumn.Expression is okay for doing simple calculations such multiplying a column's integer value by another value, but what about doing what I need to do? That is, calculate the difference between now and the date (string formatted) in the BestBefore column to determine what value to give the new status column. Example code would be appreciated. </p>
","<p>Add new column to <code>DataTable</code> and use column <code>Expression</code> property to set your Status expression.</p>

<p>Here you can find good example: <a href=""http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx"" rel=""noreferrer""><code>DataColumn.Expression</code> Property</a></p>

<p><a href=""http://davidhayden.com/blog/dave/archive/2006/07/09/datacolumnexpressions.aspx"" rel=""noreferrer"">DataTable and DataColumn Expressions in ADO.NET - Calculated Columns</a></p>

<p><strong>UPDATE</strong></p>

<p>Code sample:</p>

<pre><code>DataTable dt = new DataTable();
dt.Columns.Add(new DataColumn(""colBestBefore"", typeof(DateTime)));
dt.Columns.Add(new DataColumn(""colStatus"", typeof(string)));

dt.Columns[""colStatus""].Expression = String.Format(""IIF(colBestBefore &lt; #{0}#, 'Ok','Not ok')"", DateTime.Now.ToString(""yyyy-MM-dd HH:mm:ss""));

dt.Rows.Add(DateTime.Now.AddDays(-1));
dt.Rows.Add(DateTime.Now.AddDays(1));
dt.Rows.Add(DateTime.Now.AddDays(2));
dt.Rows.Add(DateTime.Now.AddDays(-2));

demoGridView.DataSource = dt;
</code></pre>

<p><strong>UPDATE #2</strong></p>

<pre><code>dt.Columns[""colStatus""].Expression = String.Format(""IIF(CONVERT(colBestBefore, 'System.DateTime') &lt; #{0}#, 'Ok','Not ok')"", DateTime.Now.ToString(""yyyy-MM-dd HH:mm:ss""));
</code></pre>
","5524098"
"How can I convert comma separated string into a List<int>","161868","","<pre><code>string tags = ""9,3,12,43,2""

List&lt;int&gt; TagIds = tags.Split(',');
</code></pre>

<p>This doesnt work cause the split method returns a string[]</p>

<p>Please help.</p>
","<p>Here is one way of doing it:</p>

<pre><code>List&lt;int&gt; TagIds = tags.Split(',').Select(int.Parse).ToList();
</code></pre>
","9301290"
"System.MissingMethodException: Method not found?","161576","","<p>What once was working in my asp.net webforms app now throws this error:</p>

<blockquote>
  <p>System.MissingMethodException: Method not found</p>
</blockquote>

<p>The <code>DoThis</code> method is on the same class and it should work.</p>

<p>I have a generic handler as such:</p>

<pre><code>public class MyHandler: IHttpHandler
{
    public void Processrequest(HttpContext context)
    {
      // throws error now System.MissingMethodException: Method not found?
      this.DoThis(); 
    }

    public void DoThis()
    {
    //
    }
}
</code></pre>
","<p>This is a problem which can occur when there is an old version of a DLL still lingering somewhere around. Make sure that the latest assemblies are deployed and no duplicated older assemblies are hiding in certain folders. Your best bet would be to delete every built item  and rebuild/redeploy the entire solution.</p>
","8059594"
"Verifying that a string contains only letters in C#","161501","","<p>I have an input string and I want to verify that it contains:</p>

<ul>
<li>Only letters or</li>
<li>Only letters and numbers or</li>
<li>Only letters, numbers or underscore </li>
</ul>

<p>To clarify, I have 3 different cases in the code, each calling for different validation. What's the simplest way to achieve this in C#?</p>
","<p>Only letters: </p>

<pre><code>Regex.IsMatch(input, @""^[a-zA-Z]+$"");
</code></pre>

<p>Only letters and numbers: </p>

<pre><code>Regex.IsMatch(input, @""^[a-zA-Z0-9]+$"");
</code></pre>

<p>Only letters, numbers and underscore: </p>

<pre><code>Regex.IsMatch(input, @""^[a-zA-Z0-9_]+$"");
</code></pre>
","1181426"
"Enum ""Inheritance""","161392","","<p>I have an enum in a low level namespace. I'd like to provide a class or enum in a mid level namespace that ""inherits"" the low level enum.</p>

<pre><code>namespace low
{
   public enum base
   {
      x, y, z
   }
}

namespace mid
{
   public enum consume : low.base
   {
   }
}
</code></pre>

<p>I'm hoping that this is possible, or perhaps some kind of class that can take the place of the enum consume which will provide a layer of abstraction for the enum, but still let an instance of that class access the enum.</p>

<p>Thoughts?</p>

<p>EDIT:
One of the reasons I haven't just switched this to consts in classes is that the low level enum is needed by a service that I must consume. I have been given the WSDLs and the XSDs, which define the structure as an enum. The service cannot be changed.</p>
","<p>This is not possible.  Enums cannot inherit from other enums. In fact all enums must actually inherit from <code>System.Enum</code>.  C# allows syntax to change the underlying representation of the enum values which looks like inheritance, but in actuality they still inherit from System.enum.</p>

<p>See section 8.5.2 of the <a href=""http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf"" rel=""noreferrer"">CLI spec</a> for the full details.  Relevant information from the spec</p>

<ul>
<li>All enums must derive from <code>System.Enum</code></li>
<li>Because of the above, all enums are value types and hence sealed</li>
</ul>
","757762"
"Open existing file, append a single line","161047","","<p>I want to open a text file, append a single line to it, then close it.</p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/ms143356.aspx"" rel=""noreferrer""><code>File.AppendAllText</code></a> for that:</p>

<pre><code>File.AppendAllText(@""c:\path\file.txt"", ""text content"" + Environment.NewLine);
</code></pre>
","2837043"
"How to avoid a System.Runtime.InteropServices.COMException?","160981","","<p>In my Microsoft Surface project, I always get a lot of the following exceptions:</p>

<pre><code>'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089\mscorlib.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Windows.Forms\2.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System\2.0.0.0__b77a5c561934e089\System.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Drawing\2.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Users\Roflcoptr\Documents\Visual Studio 2008\Projects\MuReSe\MuReSe\bin\Debug\MuReSe.vshost.exe'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Core\3.5.0.0__b77a5c561934e089\System.Core.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Xml.Linq\3.5.0.0__b77a5c561934e089\System.Xml.Linq.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Data.DataSetExtensions\3.5.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_32\System.Data\2.0.0.0__b77a5c561934e089\System.Data.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Xml\2.0.0.0__b77a5c561934e089\System.Xml.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\WindowsBase\3.0.0.0__31bf3856ad364e35\WindowsBase.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_32\PresentationCore\3.0.0.0__31bf3856ad364e35\PresentationCore.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\PresentationFramework\3.0.0.0__31bf3856ad364e35\PresentationFramework.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface.Presentation\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.Presentation.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface.Presentation.Generic\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.Presentation.Generic.dll'
The thread 'vshost.NotifyLoad' (0x1504) has exited with code 0 (0x0).
The thread 'vshost.LoadReference' (0x131c) has exited with code 0 (0x0).
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Users\Roflcoptr\Documents\Visual Studio 2008\Projects\MuReSe\MuReSe\bin\Debug\MuReSe.exe', Symbols loaded.
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Configuration\2.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll'
Step into: Stepping over method without symbols 'MuReSe.App.App'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface.Shell.ShellApi\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.Shell.ShellApi.dll'
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface.Common\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.Common.dll'
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Shell.ShellApi.dll
A first chance exception of type 'Microsoft.Surface.Common.ProcessCommunicationException' occurred in Microsoft.Surface.Shell.ShellApi.dll
A first chance exception of type 'System.Threading.WaitHandleCannotBeOpenedException' occurred in mscorlib.dll
'MuReSe.vshost.exe' (Managed (v2.0.50727)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.Surface.Core\1.0.0.0__31bf3856ad364e35\Microsoft.Surface.Core.dll'
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.IO.FileNotFoundException' occurred in mscorlib.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
A first chance exception of type 'System.Runtime.InteropServices.COMException' occurred in Microsoft.Surface.Core.dll
</code></pre>

<p>The last Exception is thrown all the time until I stop the program. I already commented out all of my code, and I ran the application with nothing other than the already built in code, but the same happens.</p>

<p>How can I correct that? I only found this reference:</p>

<p><a href=""http://www.mobydisk.com/softdev/techinfo/dotnetexceptions.html"" rel=""nofollow noreferrer"">http://www.mobydisk.com/softdev/techinfo/dotnetexceptions.html</a></p>

<p>There it says:</p>

<blockquote>
  <p>The exception that is thrown when an
  unrecognized HRESULT is returned from
  a COM method call.</p>
</blockquote>

<p>But I don't know what this means....</p>

<p>====EDIT====</p>

<p>I followed the suggestion in the answer below to debug the exception. This is the detailed report:</p>

<pre><code>System.Runtime.InteropServices.COMException occurred
  Message=Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))
  Source=Microsoft.Surface.Shell.ShellApi
  ErrorCode=-2147221164
  StackTrace:
       at Microsoft.Surface.Shell.NativeMethods.CoCreateInstance(Guid rclsid, Object pUnkOuter, CLSCTX dwClsContext, Guid riid)
  InnerException: 
</code></pre>

<p>And the debuger stopped at the constructor call:</p>

<pre><code> public MainWindow()
        {
            InitializeComponent();

            // Add handlers for Application activation events
            AddActivationHandlers();

           // AssemblyParser parser = new AssemblyParser();
            //parser.parse();

           // DirSearch(@""C:\Users\Roflcoptr\Documents\Visual Studio 2008\Projects\TestClass.dll\"");
        }
</code></pre>

<p>I stopped right at the start of the constructor:</p>

<pre><code>public MainWindow()
</code></pre>
","<p>Your code (or some code called by you) is making a call to a COM method which is returning an unknown value. If you can find that then you're half way there.</p>

<p>You could try breaking when the exception is thrown. Go to <strong>Debug > Exceptions...</strong> and use the <strong>Find...</strong> option to locate <code>System.Runtime.InteropServices.COMException</code>. Tick the option to break when it's thrown and then debug your application.</p>

<p>Hopefully it will break somewhere meaningful and you'll be able to trace back and find the source of the error.</p>
","4281451"
"The entity cannot be constructed in a LINQ to Entities query","160926","","<p>There is an entity type called product that is generated by entity framework.
I have writen this query</p>

<pre><code>public IQueryable&lt;Product&gt; GetProducts(int categoryID)
{
    return from p in db.Products
           where p.CategoryID== categoryID
           select new Product { Name = p.Name};
}
</code></pre>

<p>The code below throws the following error : </p>

<blockquote>
  <p>""The entity or complex type Shop.Product cannot be constructed in a
  LINQ to Entities query""</p>
</blockquote>

<pre><code>var products = productRepository.GetProducts(1).Tolist();
</code></pre>

<p>But when I use <code>select p</code> instead of <code>select new Product { Name = p.Name};</code> it works correctly.</p>

<p>How can I preform a custom select section?</p>
","<p>You cannot (and should not be able to) project onto a mapped entity. You can, however, project onto an annonymous type or onto a <a href=""http://msdn.microsoft.com/en-us/magazine/ee236638.aspx#id0080022"" rel=""noreferrer"">DTO</a>:</p>

<pre><code>public class ProductDTO
{
    public string Name { get; set; }
    // Other field you may need from the Product entity
}
</code></pre>

<p>And your method will return a List of DTO's.</p>

<pre><code>public List&lt;ProductDTO&gt; GetProducts(int categoryID)
{
    return (from p in db.Products
            where p.CategoryID == categoryID
            select new ProductDTO { Name = p.Name }).ToList();
}
</code></pre>
","5325861"
"In C#, how to check if a TCP port is available?","160908","","<p>In C# to use a TcpClient or generally to connect to a socket how can I first check if a certain port is free on my machine?</p>

<p><em>more info:</em>
This is the code I use:</p>

<pre><code>TcpClient c;
//I want to check here if port is free.
c = new TcpClient(ip, port);
</code></pre>
","<p>Since you're using a <code>TcpClient</code>, that means you're checking open TCP ports. There are lots of good objects available in the <a href=""http://msdn.microsoft.com/en-us/library/system.net.networkinformation.aspx"" rel=""noreferrer"">System.Net.NetworkInformation</a> namespace.</p>

<p>Use the <code>IPGlobalProperties</code> object to get to an array of <code>TcpConnectionInformation</code> objects, which you can then interrogate about endpoint IP and port.</p>

<hr>

<pre><code> int port = 456; //&lt;--- This is your value
 bool isAvailable = true;

 // Evaluate current system tcp connections. This is the same information provided
 // by the netstat command line application, just in .Net strongly-typed object
 // form.  We will look through the list, and if our port we would like to use
 // in our TcpClient is occupied, we will set isAvailable to false.
 IPGlobalProperties ipGlobalProperties = IPGlobalProperties.GetIPGlobalProperties();
 TcpConnectionInformation[] tcpConnInfoArray = ipGlobalProperties.GetActiveTcpConnections();

 foreach (TcpConnectionInformation tcpi in tcpConnInfoArray)
 {
   if (tcpi.LocalEndPoint.Port==port)
   {
     isAvailable = false;
     break;
   }
 }

 // At this point, if isAvailable is true, we can proceed accordingly.
</code></pre>
","570461"
"How to insert a data table into SQL Server database table?","160484","","<p>I have imported data from some Excel file and I have saved it into a <code>datatable</code>. Now I'd like to save this information in my <code>SQL Server</code> database.</p>

<p>I saw a lot of information on the web but I cannot understand it:</p>

<ol>
<li>Someone said insert line by line another suggested bulk update... etc: what it better?</li>
<li>Should I use <code>OLE</code> or <code>SQL Server</code> objects (like <code>dataAdapter</code> or <code>connection</code>)?</li>
</ol>

<p>My need is to read the employee weekly hours report, from his Excel file and save it to a database table where all the reports are saved (updating the db with new records every week).</p>

<p>The Excel file contains reports only for the current week.</p>
","<p>Create a <code>User-Defined TableType</code> in your database:</p>

<pre><code>CREATE TYPE [dbo].[MyTableType] AS TABLE(
    [Id] int NOT NULL,
    [Name] [nvarchar](128) NULL
)
</code></pre>

<p>and define a parameter in your <code>Stored Procedure</code>:</p>

<pre><code>CREATE PROCEDURE [dbo].[InsertTable]
    @myTableType MyTableType readonly
AS
BEGIN
    insert into [dbo].Records select * from @myTableType 
END
</code></pre>

<p>and send your <code>DataTable</code> directly to sql server:</p>

<pre><code>using (var command = new SqlCommand(""InsertTable"") {CommandType = CommandType.StoredProcedure})
{
    var dt = new DataTable(); //create your own data table
    command.Parameters.Add(new SqlParameter(""@myTableType"", dt));
    SqlHelper.Exec(command);
}
</code></pre>

<p>To edit the values inside stored-procedure, you can declare a local variable with the same type and insert input table into it:</p>

<pre><code>DECLARE @modifiableTableType MyTableType 
INSERT INTO @modifiableTableType SELECT * FROM @myTableType
</code></pre>

<p>Then, you can edit <code>@modifiableTableType</code>:</p>

<pre><code>UPDATE @modifiableTableType SET [Name] = 'new value'
</code></pre>
","9075853"
"Passing A List Of Objects Into An MVC Controller Method Using jQuery Ajax","160374","","<p>I'm trying to pass an array of objects into an MVC controller method using
jQuery's ajax() function. When I get into the PassThing() C# controller method,
the argument ""things"" is null. I've tried this using a type of List for
the argument, but that doesn't work either. What am I doing wrong?</p>

<pre><code>&lt;script type=""text/javascript""&gt;
    $(document).ready(function () {
        var things = [
            { id: 1, color: 'yellow' },
            { id: 2, color: 'blue' },
            { id: 3, color: 'red' }
        ];

        $.ajax({
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            type: 'POST',
            url: '/Xhr/ThingController/PassThing',
            data: JSON.stringify(things)
        });
    });
&lt;/script&gt;

public class ThingController : Controller
{
    public void PassThing(Thing[] things)
    {
        // do stuff with things here...
    }

    public class Thing
    {
        public int id { get; set; }
        public string color { get; set; }
    }
}
</code></pre>
","<p>Using NickW's suggestion, I was able to get this working using <code>things = JSON.stringify({ 'things': things });</code> Here is the complete code.</p>

<pre><code>$(document).ready(function () {
    var things = [
        { id: 1, color: 'yellow' },
        { id: 2, color: 'blue' },
        { id: 3, color: 'red' }
    ];      

    things = JSON.stringify({ 'things': things });

    $.ajax({
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        type: 'POST',
        url: '/Home/PassThings',
        data: things,
        success: function () {          
            $('#result').html('""PassThings()"" successfully called.');
        },
        failure: function (response) {          
            $('#result').html(response);
        }
    }); 
});


public void PassThings(List&lt;Thing&gt; things)
{
    var t = things;
}

public class Thing
{
    public int Id { get; set; }
    public string Color { get; set; }
}
</code></pre>

<p>There are two things I learned from this:
1) The contentType and dataType settings are absolutely necessary in the ajax() function. It won't work if they are missing. I found this out after much trial and error. 2) To pass in an array of objects to an MVC controller method, simply use the JSON.stringify({ 'things': things }) format.</p>

<p>I hope this helps someone else!</p>
","13255459"
"Display only date and no time","160327","","<p>In MVC razor, I am putting current date in the database like this..</p>

<pre><code>model.Returndate = DateTime.Now.Date.ToShortDateString();
</code></pre>

<p>Since the database field is a datetime datatype and I am converting the current date to string format, this is not working.. how can I do this? I am doing the string format because I want the date in mm/dd/yyyy format and not in mm/dd/yyyy hh:mm:ss time format..</p>

<p>EDIT:</p>

<p>In the controller I have </p>

<pre><code>var model = new ViewModel();
model.ReturnDate = DateTime.Now;            
return PartialView(""PartialView"", model);  
</code></pre>

<p>In the partialview, I have </p>

<pre><code>@Html.EditorFor(model =&gt; model.Returndate)
</code></pre>

<p>This is where its displaying the date as Date and Time together... I want just the date to be displayed. Not the time. I hope this edit explains better.</p>
","<p>If the column type is DateTime in SQL then it will store a time where you pass one or not.</p>

<p>It'd be better to save the date properly:</p>

<pre><code>model.ReturnDate = DateTime.Now;
</code></pre>

<p>and then format it when you need to display it:</p>

<pre><code>@Html.Label(Model.ReturnDate.ToShortDateString())
</code></pre>

<p>Or if you're using EditorFor:</p>

<pre><code>@Html.EditorFor(model =&gt; model.ReturnDate.ToShortDateString())
</code></pre>

<p>or</p>

<pre><code>@Html.EditorFor(model =&gt; model.ReturnDate.ToString(""MM/dd/yyyy""))
</code></pre>

<p>To add a property to your model add this code:</p>

<pre><code>public string ReturnDateForDisplay
{
    get
    {
       return this.ReturnDate.ToString(""d"");
    }
}
</code></pre>

<p>Then in your PartialView:</p>

<pre><code>@Html.EditorFor(model =&gt; model.ReturnDateForDisplay)
</code></pre>

<p>EDIT:</p>

<p>Hi guys, just want to clarify for this answer that by my saying 'If you're using EditorFor', that means you need to have an EditorFor template for the type of value you're trying to represent.</p>

<p>Editor templates are a cool way of managing repetitive controls in MVC:</p>

<p><a href=""http://coding-in.net/asp-net-mvc-3-how-to-use-editortemplates/"" rel=""noreferrer"">http://coding-in.net/asp-net-mvc-3-how-to-use-editortemplates/</a></p>

<p>You can use them for naive types like String as I've done above; but they're especially great for letting you template a set of input fields for a more complicated data type.</p>
","7124488"
"IF Statement multiple conditions, same statement","160292","","<p>Hey all, looking to reduce the code on my c# if statements as there are several repeating factors and was wondering if a trimmer solution is possible.</p>

<p>I currently have 2 if statements that need to carry out an identical statement, however the only variable is an extra condition on an if statement when a checkbox is not checked. Im just wondering if there is a way to make it one statement or make the condition string variable, heres the compressed version of the code:</p>

<pre><code>if (checkbox.checked)
  {
    if (columnname != a &amp;&amp; columnname != b &amp;&amp; columnname != c)
    {
      ""statement 1""
    }
  }
else
  {
    if (columnname != a &amp;&amp; columnname != b &amp;&amp; columnname != c 
        &amp;&amp; columnname != A2)
    {
      ""statement 1""
    }
  }
</code></pre>

<p>Its like I need to run an if statement within the conditions of an if statement if that makes sense, like this psuedo form:</p>

<pre><code>if (columnname != a 
    &amp;&amp; columnname != b 
    &amp;&amp; columnname != c 
    &amp;&amp; if(checkbox.checked{columnname != A2})
</code></pre>
","<pre><code>if (columnname != a 
  &amp;&amp; columnname != b 
  &amp;&amp; columnname != c
  &amp;&amp; (checkbox.checked || columnname != A2))
{
   ""statement 1""
}
</code></pre>

<p>Should do the trick.</p>
","1341548"
"Why doesn't Console.Writeline, Console.Write work in Visual Studio Express?","160256","","<p>I just open a console application and I type</p>

<pre><code>Console.WriteLine(""Test"");
</code></pre>

<p>But the output window doesn't show this. I go to the output window with Ctrl+W,O</p>

<p>But nothing shows up when I run my program, am I nuts or is this not supported in the visual studio 2010 express?</p>
","<p><a href=""http://msdn.microsoft.com/en-us/library/system.console.writeline.aspx"" rel=""noreferrer""><code>Console.WriteLine</code></a> writes your output to the console window opened by your application (think black window with white text that appears when you open the Command Prompt.) Try <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.writeline.aspx"" rel=""noreferrer""><code>System.Diagnostics.Debug.WriteLine</code></a> instead.</p>
","4480965"
"How to programmatically set the ForeColor of a label to its default?","160240","","<p>I'm using VS2010 C# ASP.NET</p>

<p>To programmatically change the ForeColor of an asp:Label named <code>lblExample</code> to 'Red', I write this:</p>

<pre><code>lblExample.ForeColor = System.Drawing.Color.Red;
</code></pre>

<p>After changing the ForeColor, how do I programmatically set the ForeColor of the label to its default (that comes from the css file)?</p>

<p>Remark:
the label has no CSS entry (class or ID specific style). The color is inherited.</p>
","<p>Easy</p>

<pre><code>if (lblExample.ForeColor != System.Drawing.Color.Red)
{
    lblExample.ForeColor = System.Drawing.Color.Red;
}
else
{
    lblExample.ForeColor = new System.Drawing.Color();
}
</code></pre>
","10441694"
"How to write log file in c#?","160233","","<p>How would I write a log file in c#?</p>

<p>Currently i have a timer with this statement which ticks every 20 secs:</p>

<pre><code>File.WriteAllText(filePath+""log.txt"", log);
</code></pre>

<p>For everything that i want logged i do this: </p>

<pre><code>log += ""stringToBeLogged"";
</code></pre>

<p>As you can assume the string log just grows and grows as the program runs. (I don't even know if there is a maximum chars per string?)</p>

<p>I assume that there must be better ways of doing this. i just thought that it would be heavy to write the whole file again and again for every time something is added to the log.</p>
","<p>From the performance point of view your solution is not optimal. Every time you add another log entry with +=, the whole string is copied to another place in memory. I would recommend using StringBuilder instead:</p>

<pre><code>StringBuilder sb;
...
sb.Append(""log something"");

...
// flush every 20 seconds as you do it
File.AppendAllText(filePath+""log.txt"", sb.ToString());
sb.Clear();
</code></pre>

<p>By the way your timer event is probably executed on another thread. So you may want to use a mutex when accessing your <code>sb</code> object.</p>

<p>Another thing to consider is what happens to the log entries that were added within the last 20 seconds of the execution. You probably want to flush your string to the file right before the app exits.</p>
","20185159"
"How can I get the CheckBoxList selected values, what I have doesn't seem to work C#.NET/VisualWebPart","160161","","<p>I am creating a CheckBoxList in a class file and am using an HTMLTextWriter to render the control. </p>

<p>I'm using the following code to store the selected values in a string:</p>

<pre><code>string YrStr = """";
for (int i = 0; i &lt; YrChkBox.Items.Count; i++)
{
    if (YrChkBox.Items[i].Selected)
    {
        YrStr += YrChkBox.Items[i].Value + "";""; 
    }
}
</code></pre>

<p>I stepped through the code and it doesn't seem to hit the inside of the if statement &amp; the selected value attribute is false every time ... Anyone have an idea of how I can address this?  </p>

<p>I populate it using the following: </p>

<pre><code> YrChkBox.Items.Add(new ListItem(""Item 1"", ""Item1""));
</code></pre>
","<p>In your ASPX page you've got the list like this:</p>

<pre><code>    &lt;asp:CheckBoxList ID=""YrChkBox"" runat=""server"" 
        onselectedindexchanged=""YrChkBox_SelectedIndexChanged""&gt;&lt;/asp:CheckBoxList&gt;
    &lt;asp:Button ID=""button"" runat=""server"" Text=""Submit"" /&gt;
</code></pre>

<p>In your code behind aspx.cs page, you have this:</p>

<pre><code>    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // Populate the CheckBoxList items only when it's not a postback.
            YrChkBox.Items.Add(new ListItem(""Item 1"", ""Item1""));
            YrChkBox.Items.Add(new ListItem(""Item 2"", ""Item2""));
        }
    }

    protected void YrChkBox_SelectedIndexChanged(object sender, EventArgs e)
    {
        // Create the list to store.
        List&lt;String&gt; YrStrList = new List&lt;string&gt;();
        // Loop through each item.
        foreach (ListItem item in YrChkBox.Items)
        {
            if (item.Selected)
            {
                // If the item is selected, add the value to the list.
                YrStrList.Add(item.Value);
            }
            else
            {
                // Item is not selected, do something else.
            }
        }
        // Join the string together using the ; delimiter.
        String YrStr = String.Join("";"", YrStrList.ToArray());

        // Write to the page the value.
        Response.Write(String.Concat(""Selected Items: "", YrStr));
    }
</code></pre>

<p>Ensure you use the <code>if (!IsPostBack) { }</code> condition because if you load it every page refresh, it's actually destroying the data.</p>
","9523471"
"How can I make a ComboBox non-editable in .NET?","160087","","<p>I want to have a ""select-only"" <code>ComboBox</code> that provides a list of items for the user to select from. Typing should be disabled in the text portion of the <code>ComboBox</code> control.</p>

<p>My initial googling of this turned up an overly complex, misguided suggestion to capture the <code>KeyPress</code> event.</p>
","<p>To make the text portion of a ComboBox non-editable, set the DropDownStyle property to ""DropDownList"".  The ComboBox is now essentially select-only for the user. You can do this in the Visual Studio designer, or in C# like this:</p>

<pre><code>stateComboBox.DropDownStyle = ComboBoxStyle.DropDownList;
</code></pre>

<p>Link to the documentation for the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.dropdownstyle.aspx"" rel=""noreferrer"">ComboBox DropDownStyle property</a> on MSDN.</p>
","85706"
"How to check for file lock?","160082","","<p>Is there any way to check whether a file is locked without using a try/catch block?  </p>

<p>Right now, the only way I know of is to just open the file and catch any <code>System.IO.IOException</code>.</p>
","<p>No, unfortunately, and if you think about it, that information would be worthless anyway since the file could become locked the very next second (read: short timespan).</p>

<p>Why specifically do you need to know if the file is locked anyway? Knowing that might give us some other way of giving you good advice.</p>

<p>If your code would look like this:</p>

<pre><code>if not locked then
    open and update file
</code></pre>

<p>Then between the two lines, another process could easily lock the file, giving you the same problem you were trying to avoid to begin with: exceptions.</p>
","1309"
"Why is there no Char.Empty like String.Empty?","159973","","<p>Is there a reason for this? I am asking because if you needed to use lots of empty chars then you get into the same situation as you would when you use lots of empty strings.</p>

<p>Edit: The reason for this usage was this:</p>

<pre><code>myString.Replace ('c', '')
</code></pre>

<p>So remove all instances of 'c's from myString.</p>
","<p>There's no such thing as an empty char. The closest you can get is <code>'\0'</code>, the Unicode ""null"" character. Given that you can embed that within string literals or express it on its own very easily, why would you want a separate field for it? Equally, the ""it's easy to confuse <code>""""</code> and <code>"" ""</code>"" arguments don't apply for <code>'\0'</code>.</p>

<p>If you could give an example of where you'd want to use it and why you think it would be better, that might help...</p>
","3670513"
"Can you get the column names from a SqlDataReader?","159927","","<p>After connecting to the database, can I get the name of all the columns that were returned in my <code>SqlDataReader</code>?</p>
","<pre><code>var reader = cmd.ExecuteReader();

var columns = new List&lt;string&gt;();

for(int i=0;i&lt;reader.FieldCount;i++)
{
   columns.Add(reader.GetName(i));
}
</code></pre>

<p>or </p>

<pre><code>var columns = Enumerable.Range(0, reader.FieldCount).Select(reader.GetName).ToList();
</code></pre>
","681671"
"HTTP POST Returns Error: 417 ""Expectation Failed.""","159913","","<p>When I try to POST to a URL it results in the following exception:</p>

<blockquote>
  <p>The remote server returned an error:
  (417) Expectation Failed.</p>
</blockquote>

<p>Here's a sample code:</p>

<pre><code>var client = new WebClient();

var postData = new NameValueCollection();
postData.Add(""postParamName"", ""postParamValue"");

byte[] responseBytes = client.UploadValues(""http://..."", postData);
string response = Encoding.UTF8.GetString(responseBytes); // (417) Expectation Failed.
</code></pre>

<p>Using an <code>HttpWebRequest/HttpWebResponse</code> pair or an <code>HttpClient</code> doesn't make a difference.</p>

<p>What's causing this exception?</p>
","<p>System.Net.HttpWebRequest adds the header 'HTTP header ""Expect: 100-Continue""' to every request unless you explicitly ask it not to by setting <a href=""http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.expect100continue(VS.80).aspx"" rel=""noreferrer"">this static property</a> to false:</p>

<pre><code>System.Net.ServicePointManager.Expect100Continue = false;
</code></pre>

<p>Some servers choke on that header and send back the 417 error you're seeing. </p>

<p>Give that a shot.</p>
","566847"
"How do I read a specified line in a text file?","159893","","<p>Given a text file, how would I go about reading an arbitrary line and nothing else in the file?</p>

<p>Say, I have a file test.txt.  How would I go about reading line number 15 in the file?</p>

<p>All I've seen is stuff involving storing the entire text file as a String array and then using the value of the line number as the number of the String to use from the array... but there are some complications: The text file is enormously huge and the machine that the application I'm coding isn't exactly a top-notch system. Speed isn't the top priority, but it is definitely a major issue.</p>

<p>Are there any ways to <strong>ONLY</strong> read a specific line of a text file and store the result as a string?</p>

<p>Thanks for your responses:
The file is KINDA structured. It's got 25 lines of info and then <em>X</em> lines of numbers but line 17 of the first 25 has the value of <em>X</em>.</p>

<p>But then, there's 1 blank line and it repeats itself all over as a second record in the file and <em>X</em> can have a different value for each record.</p>

<p>What I want to do is read and store the first 25 lines as independent values and then store the next <em>X</em> (usually around 250) lines as an array. Then I'm going to store it in an SQL database and repeat with the NEXT record until I reach the <em>Y</em>th record (the number of records in the file is in line 3)</p>

<p><strong>EDIT 2</strong>:
Alright, I think I've gotten to a solution based on a combination of your alls' responses.</p>

<p>I'm going to read the first 25 lines and store it as an array. I'll copy the pertinent contents of the array to local variables then I'll delete the first 25 lines. Then, I can use the info to store the next <em>X</em> lines (the value of item 13 in the array) as an array, serialize it, store it in a database then delete the lines that I just read.</p>

<p>I could then repeat the process for each subsequent record.</p>

<p>Of course, this relies on one assumption I'm making, which to be honest, I'm not sure is true. Is it possible to delete the first <em>n</em> lines from a text file from within C# without having to read the entire thing and re-write it without the first <em>n</em> lines?</p>
","<p><strong>.NET 4.0 edit</strong></p>

<p>Since .NET 4.0, it is possible to access a single line of a file directly. For instance, to access line 15:</p>

<pre><code>string line = File.ReadLines(FileName).Skip(14).Take(1).First();
</code></pre>

<p>This will return only the line required</p>

<hr>

<p>Since you can't predict the location (can you?) of the i-th line in the file, you'll have to read all previous lines too. If the line number is small, this can be more efficient than the <code>ReadAllLines</code> method.</p>

<pre><code>string GetLine(string fileName, int line)
{
   using (var sr = new StreamReader(fileName)) {
       for (int i = 1; i &lt; line; i++)
          sr.ReadLine();
       return sr.ReadLine();
   }
}
</code></pre>
","1262985"
"c# datatable to csv","159834","","<p>Could somebody please tell me why the following code is not working.  The data is saved into the csv file, however the data is not separated.  It all exists within the first cell of each row. </p>

<pre><code>StringBuilder sb = new StringBuilder();

foreach (DataColumn col in dt.Columns)
{
    sb.Append(col.ColumnName + ',');
}

sb.Remove(sb.Length - 1, 1);
sb.Append(Environment.NewLine);

foreach (DataRow row in dt.Rows)
{
    for (int i = 0; i &lt; dt.Columns.Count; i++)
    {
        sb.Append(row[i].ToString() + "","");
    }

    sb.Append(Environment.NewLine);
}

File.WriteAllText(""test.csv"", sb.ToString());
</code></pre>

<p>Thanks.</p>
","<p>The following shorter version opens fine in Excel, maybe your issue was the trailing comma</p>

<h2>.net = 3.5</h2>

<pre><code>StringBuilder sb = new StringBuilder(); 

string[] columnNames = dt.Columns.Cast&lt;DataColumn&gt;().
                                  Select(column =&gt; column.ColumnName).
                                  ToArray();
sb.AppendLine(string.Join("","", columnNames));

foreach (DataRow row in dt.Rows)
{
    string[] fields = row.ItemArray.Select(field =&gt; field.ToString()).
                                    ToArray();
    sb.AppendLine(string.Join("","", fields));
}

File.WriteAllText(""test.csv"", sb.ToString());
</code></pre>

<h2>.net >= 4.0</h2>

<p>And as Tim pointed out, if you are on .net>=4, you can make it even shorter:</p>

<pre><code>StringBuilder sb = new StringBuilder(); 

IEnumerable&lt;string&gt; columnNames = dt.Columns.Cast&lt;DataColumn&gt;().
                                  Select(column =&gt; column.ColumnName);
sb.AppendLine(string.Join("","", columnNames));

foreach (DataRow row in dt.Rows)
{
    IEnumerable&lt;string&gt; fields = row.ItemArray.Select(field =&gt; field.ToString());
    sb.AppendLine(string.Join("","", fields));
}

File.WriteAllText(""test.csv"", sb.ToString());
</code></pre>

<p>As suggested by Christian, if you want to handle special characters escaping in fields, replace the loop block by:</p>

<pre><code>foreach (DataRow row in dt.Rows)
{
    IEnumerable&lt;string&gt; fields = row.ItemArray.Select(field =&gt; 
      string.Concat(""\"""", field.ToString().Replace(""\"""", ""\""\""""), ""\""""));
    sb.AppendLine(string.Join("","", fields));
}
</code></pre>

<p>And last suggestion, you could write the csv content line by line instead of as a whole document, to avoid having a big document in memory.</p>
","4959869"
"When to use a Parallel.ForEach loop instead of a regular foreach?","159556","","<p>I am a bit of confused about <code>Parallel.ForEach</code>.<br>
What is <code>Parallel.ForEach</code> and what does it exactly do?<br>
Please don't reference any MSDN link.  </p>

<p>Here's a simple example : </p>

<pre><code>string[] lines = File.ReadAllLines(txtProxyListPath.Text);
List&lt;string&gt; list_lines = new List&lt;string&gt;(lines);

foreach (string line in list_lines)
{
    //My Stuff
}
</code></pre>

<p>How can I rewrite this example with <code>Parallel.ForEach</code>?</p>
","<pre><code>string[] lines = File.ReadAllLines(txtProxyListPath.Text);
List&lt;string&gt; list_lines = new List&lt;string&gt;(lines);
Parallel.ForEach(list_lines, line =&gt;
{
    //Your stuff
});
</code></pre>
","12251890"
"LEFT JOIN in LINQ to entities?","159489","","<p>I'm trying out LINQ to entities.</p>

<p>I have a problem with the following:
I want it to do this:</p>

<pre><code>SELECT 
     T_Benutzer.BE_User
    ,T_Benutzer_Benutzergruppen.BEBG_BE
FROM T_Benutzer

LEFT JOIN T_Benutzer_Benutzergruppen
    ON T_Benutzer_Benutzergruppen.BEBG_BE = T_Benutzer.BE_ID 
</code></pre>

<p>the closest thing I've come to is this:</p>

<pre><code>        var lol = (
            from u in Repo.T_Benutzer

            //where u.BE_ID == 1
            from o in Repo.T_Benutzer_Benutzergruppen.DefaultIfEmpty()
                // on u.BE_ID equals o.BEBG_BE

            where (u.BE_ID == o.BEBG_BE || o.BEBG_BE == null)

            //join bg in Repo.T_Benutzergruppen.DefaultIfEmpty()
            //    on o.BEBG_BG equals bg.ID

            //where bg.ID == 899 

            orderby
                u.BE_Name ascending
                //, bg.Name descending

            //select u 
            select new
            {
                 u.BE_User
                ,o.BEBG_BG
                //, bg.Name 
            }
         ).ToList();
</code></pre>

<p>But this generates the same results as an inner join, and not a left join.<br />
Moreover, it creates this completely  crazy SQL:</p>

<pre><code>SELECT 
     [Extent1].[BE_ID] AS [BE_ID]
    ,[Extent1].[BE_User] AS [BE_User]
    ,[Join1].[BEBG_BG] AS [BEBG_BG]
FROM  [dbo].[T_Benutzer] AS [Extent1]

CROSS JOIN  
(
    SELECT 
         [Extent2].[BEBG_BE] AS [BEBG_BE]
        ,[Extent2].[BEBG_BG] AS [BEBG_BG]
    FROM ( SELECT 1 AS X ) AS [SingleRowTable1]
    LEFT OUTER JOIN [dbo].[T_Benutzer_Benutzergruppen] AS [Extent2] 
        ON 1 = 1 
) AS [Join1]

WHERE [Extent1].[BE_ID] = [Join1].[BEBG_BE] 
OR [Join1].[BEBG_BE] IS NULL

ORDER BY [Extent1].[BE_Name] ASC
</code></pre>

<p>How can I do a left join in LINQ-2-entities in a way where
another person can still understand what's being done in that code ?</p>

<p>and most-preferably where the generated SQL looks like:</p>

<pre><code>SELECT 
     T_Benutzer.BE_User
    ,T_Benutzer_Benutzergruppen.BEBG_BE
FROM T_Benutzer

LEFT JOIN T_Benutzer_Benutzergruppen
    ON T_Benutzer_Benutzergruppen.BEBG_BE = T_Benutzer.BE_ID 
</code></pre>
","<p>Ah, got it myselfs. <br />
The quirks and quarks of LINQ-2-entities.<br />
This looks most understandable:</p>

<pre><code>var query2 = (
    from users in Repo.T_Benutzer
    from mappings in Repo.T_Benutzer_Benutzergruppen
        .Where(mapping =&gt; mapping.BEBG_BE == users.BE_ID).DefaultIfEmpty()
    from groups in Repo.T_Benutzergruppen
        .Where(gruppe =&gt; gruppe.ID == mappings.BEBG_BG).DefaultIfEmpty()
    //where users.BE_Name.Contains(keyword)
    // //|| mappings.BEBG_BE.Equals(666)  
    //|| mappings.BEBG_BE == 666 
    //|| groups.Name.Contains(keyword)

    select new
    {
         UserId = users.BE_ID
        ,UserName = users.BE_User
        ,UserGroupId = mappings.BEBG_BG
        ,GroupName = groups.Name
    }

);


var xy = (query2).ToList();
</code></pre>

<p>Remove the <code>.DefaultIfEmpty()</code>, and you get an inner join.<br />
That was what I was looking for.</p>
","19357132"
"How to read an entire file to a string using C#?","159387","","<p>What is the quickest way to read a text file into a string variable?</p>

<p>I understand it can be done in several ways, such as read individual bytes and then convert those to string. I was looking for a method with minimal coding.</p>
","<p>How about</p>

<pre><code>string contents = File.ReadAllText(@""C:\temp\test.txt"");
</code></pre>
","7387108"
"Casting a variable using a Type variable","159341","","<p>In C# can I cast a variable of type object to a variable of type T where T is defined in a Type variable?</p>
","<p>Sure you can here is both a simple (assume this is a T-type cast) cast and if convenient a (assume we can convert this to a T) convert:</p>

<pre><code>public T CastExamp1&lt;T&gt;(object input) {   
    return (T) input;   
}

public T ConvertExamp1&lt;T&gt;(object input) {
    return (T) Convert.ChangeType(input, typeof(T));
}
</code></pre>

<p><strong>Edit:</strong></p>

<p>Some people in the comments say that this answer doesn't answer the question. But the line <code>(T) Convert.ChangeType(input, typeof(T))</code> provides the solution. The <code>Convert.ChangeType</code> method tries to convert any object to the type provided as the second argument.</p>

<p>I've written the answer with generics, because I think it is a very likely sign of code smell when you want to cast <code>a something</code> to <code>a something else</code> without handling an actual type. With proper interfaces that shouldn't be necessary 99.9% of the times. There are perhaps a few edge cases when it comes to reflection that it makes sense, but I would recommend to avoid those cases.</p>
","1145562"
"Why catch and rethrow an exception in C#?","159203","","<p>I'm looking at the article <em><a href=""http://www.codeproject.com/KB/cs/datatransferobject.aspx"" rel=""noreferrer"">C# - Data Transfer Object</a></em> on serializable DTOs.</p>

<p>The article includes this piece of code:</p>

<pre><code>public static string SerializeDTO(DTO dto) {
    try {
        XmlSerializer xmlSer = new XmlSerializer(dto.GetType());
        StringWriter sWriter = new StringWriter();
        xmlSer.Serialize(sWriter, dto);
        return sWriter.ToString();
    }
    catch(Exception ex) {
        throw ex;
    }
}
</code></pre>

<p>The rest of the article looks sane and reasonable (to a noob), but that try-catch-throw throws a WtfException... <strong>Isn't this exactly equivalent to not handling exceptions at all?</strong></p>

<p>Ergo:</p>

<pre><code>public static string SerializeDTO(DTO dto) {
    XmlSerializer xmlSer = new XmlSerializer(dto.GetType());
    StringWriter sWriter = new StringWriter();
    xmlSer.Serialize(sWriter, dto);
    return sWriter.ToString();
}
</code></pre>

<p>Or am I missing something fundamental about error handling in C#? It's pretty much the same as Java (minus checked exceptions), isn't it? ... That is, they both refined C++.</p>

<p>The Stack Overflow question <em><a href=""https://stackoverflow.com/questions/717489"">The difference between re-throwing parameter-less catch and not doing anything?</a></em> seems to support my contention that try-catch-throw is-a no-op.</p>

<hr>

<p><strong>EDIT:</strong></p>

<p>Just to summarise for anyone who finds this thread in future...</p>

<p><strong>DO NOT</strong></p>

<pre><code>try {
    // Do stuff that might throw an exception
}
catch (Exception e) {
    throw e; // This destroys the strack trace information!
}
</code></pre>

<p>The stack trace information can be crucial to identifying the root cause of the problem!</p>

<p><strong>DO</strong></p>

<pre><code>try {
    // Do stuff that might throw an exception
}
catch (SqlException e) {
    // Log it
    if (e.ErrorCode != NO_ROW_ERROR) { // filter out NoDataFound.
        // Do special cleanup, like maybe closing the ""dirty"" database connection.
        throw; // This preserves the stack trace
    }
}
catch (IOException e) {
    // Log it
    throw;
}
catch (Exception e) {
    // Log it
    throw new DAOException(""Excrement occurred"", e); // wrapped &amp; chained exceptions (just like java).
}
finally {
    // Normal clean goes here (like closing open files).
}
</code></pre>

<p>Catch the more specific exceptions before the less specific ones (just like Java).</p>

<hr>

<p><strong>References:</strong></p>

<ul>
<li><a href=""http://msdn.microsoft.com/en-us/library/ms229005.aspx"" rel=""noreferrer"">MSDN - Exception Handling</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/0yd65esw.aspx"" rel=""noreferrer"">MSDN - try-catch (C# Reference)</a></li>
</ul>
","<p>First; the way that the code in the article does it is evil. <code>throw ex</code> will reset the call stack in the exception to the point where this throw statement is; losing the information about where the exception actually was created.</p>

<p>Second, if you just catch and re-throw like that, I see no added value, the code example above would be just as good (or, given the <code>throw ex</code> bit, even better) without the try-catch.</p>

<p>However, there are cases where you might want to catch and rethrow an exception. Logging could be one of them:</p>

<pre><code>try 
{
    // code that may throw exceptions    
}
catch(Exception ex) 
{
    // add error logging here
    throw;
}
</code></pre>
","881489"
"textarea control, asp.net c#","159169","","<p>i'm using a textarea control to allow the user to input text and then place that text into the body of an e-mail.  in the code behind, what is the syntax for referencing the users input. i thought i could just use ""message.Body = test123.Text;"" but this is not recognized.</p>

<p>code in aspx page ---</p>

<pre><code>&lt;textarea id=""TextArea1"" cols=""20"" rows=""2"" &gt;&lt;/textarea&gt;
</code></pre>

<p>code behind  --- </p>

<pre><code>foreach (string recipient in recipients)
{         
  var message = new System.Net.Mail.MailMessage(""sender@example.com"", recipient);
  message.Subject = ""Hello World!"";         
  message.Body = test123.Text;                
  client.Send(message); 
} 
</code></pre>
","<p>You are not using a .NET control for your text area. Either add <code>runat=""server""</code> to the HTML TextArea control or use a .NET control:</p>

<p>Try this:</p>

<pre><code>&lt;asp:TextBox id=""TextArea1"" TextMode=""multiline"" Columns=""50"" Rows=""5"" runat=""server"" /&gt;
</code></pre>

<p>Then reference it in your codebehind:</p>

<pre><code>message.Body = TextArea1.Text;
</code></pre>
","4508102"
"How to sum up an array of integers in C#","159063","","<p>Is there a <strike>better</strike> shorter way than iterating over the array?</p>

<pre><code>int[] arr = new int[] { 1, 2, 3 };
int sum = 0;
for (int i = 0; i &lt; arr.Length; i++)
{
    sum += arr[i];
}
</code></pre>

<hr>

<p>clarification:</p>

<p>Better primary means cleaner code but hints on performance improvement are also welcome. (Like already mentioned: splitting large arrays).</p>

<hr>

<p>It's not like I was looking for killer performance improvement - I just wondered if this very kind of <strong>syntactic sugar</strong> wasn't already available: ""There's String.Join - what the heck about int[]?"".</p>
","<p>Provided that you can use C# 3.5 and LINQ, try </p>

<pre><code>int sum = arr.Sum();
</code></pre>
","2419351"
"How to make a simple popup box in Visual C#?","159013","","<p>When I click a button, I want a box to popup on the screen and display a simple message.  Nothing fancy really.  How would I do that?</p>
","<pre><code>System.Windows.Forms.MessageBox.Show(""My message here"");
</code></pre>

<p>Make sure the <code>System.Windows.Forms</code> assembly is referenced your project.</p>
","1806255"
"Insert data using Entity Framework model","158907","","<p>I'm trying to insert some data in my database using Entity Framework model, but for some unknown reasons to me, it does nothing.</p>

<p>Am I missing something here?</p>

<pre><code>using (var context = new DatabaseEntities())
{
    var t = new test
    {
        ID = Guid.NewGuid(),
        name = ""blah"",
    };
    context.AddTotest(t);
    context.SaveChanges();
}
</code></pre>
","<p>It should be:</p>

<pre><code>context.TableName.AddObject(TableEntityInstance);
</code></pre>

<p>Where:</p>

<ol>
<li><code>TableName</code>: the name of the table in the database.</li>
<li><code>TableEntityInstance</code>: an instance of the table entity class.</li>
</ol>

<p>If your table is <code>Orders</code>, then:</p>

<pre><code>Order order = new Order();
context.Orders.AddObject(order);
</code></pre>

<p>For example:</p>

<pre><code> var id = Guid.NewGuid();

 // insert
 using (var db = new EfContext(""name=EfSample""))
 {
    var customers = db.Set&lt;Customer&gt;();
    customers.Add( new Customer { CustomerId = id, Name = ""John Doe"" } );

    db.SaveChanges();
 }
</code></pre>

<p>Here is a live example:</p>

<pre><code>public void UpdatePlayerScreen(byte[] imageBytes, string installationKey)
{
  var player = (from p in this.ObjectContext.Players where p.InstallationKey == installationKey select p).FirstOrDefault();

  var current = (from d in this.ObjectContext.Screenshots where d.PlayerID == player.ID select d).FirstOrDefault();

  if (current != null)
  {
    current.Screen = imageBytes;
    current.Refreshed = DateTime.Now;

    this.ObjectContext.SaveChanges();
  }
  else
  {
    Screenshot screenshot = new Screenshot();

    screenshot.ID = Guid.NewGuid();
    screenshot.Interval = 1000;
    screenshot.IsTurnedOn = true;
    screenshot.PlayerID = player.ID;
    screenshot.Refreshed = DateTime.Now;
    screenshot.Screen = imageBytes;

    this.ObjectContext.Screenshots.AddObject(screenshot);
    this.ObjectContext.SaveChanges();
  }
}
</code></pre>
","8835510"
"Removing carriage return and new-line from the end of a string in c#","158775","","<p>How do I remove the carriage return character <code>(\r)</code> and the new line character<code>(\n)</code> from the end of a string?</p>
","<p>This will trim off any combination of carriage returns and newlines from the end of <code>s</code>:</p>

<pre><code>s = s.TrimEnd(new char[] { '\r', '\n' });
</code></pre>

<p><strong>Edit</strong>: Or as JP kindly points out, you can spell that more succinctly as:</p>

<pre><code>s = s.TrimEnd('\r', '\n');
</code></pre>
","873048"
"Check if value exists in dataTable?","158457","","<p>I have DataTable with two columns <em>Author</em> and <em>Bookname</em>.</p>

<p>I want to check if the given string value <em>Author</em> already exists in the DataTable. Is there some built in method to check it, like for Arrays  <code>array.contains</code>?  </p>
","<p>You can use <a href=""http://msdn.microsoft.com/en-us/library/bb386977.aspx""><code>LINQ-to-DataSet</code></a> with <a href=""http://msdn.microsoft.com/en-us/library/bb534972.aspx""><code>Enumerable.Any</code></a>:</p>

<pre><code>String author = ""John Grisham"";
bool contains = tbl.AsEnumerable().Any(row =&gt; author == row.Field&lt;String&gt;(""Author""));
</code></pre>

<p>Another approach is to use <a href=""http://msdn.microsoft.com/en-us/library/det4aw50.aspx""><code>DataTable.Select</code></a>:</p>

<pre><code>DataRow[] foundAuthors = tbl.Select(""Author = '"" + searchAuthor + ""'"");
if(foundAuthors.Length != 0)
{
    // do something...
}
</code></pre>

<hr>

<blockquote>
  <p>Q: what if we do not know the columns Headers and we want to find if any
  cell value <code>PEPSI</code> exist in any rows'c columns? I can loop it all to
  find out but is there a better way? –</p>
</blockquote>

<p>Yes, you can use this query:</p>

<pre><code>DataColumn[] columns = tbl.Columns.Cast&lt;DataColumn&gt;().ToArray();
bool anyFieldContainsPepsi = tbl.AsEnumerable()
    .Any(row =&gt; columns.Any(col =&gt; row[col].ToString() == ""PEPSI""));
</code></pre>
","10703369"
"Hashing a string with Sha256","158449","","<p>I try to hash a string using SHA256, I'm using the following code:</p>

<pre><code>using System;
using System.Security.Cryptography;
using System.Text;
 public class Hash
    {
    public static string getHashSha256(string text)
    {
        byte[] bytes = Encoding.Unicode.GetBytes(text);
        SHA256Managed hashstring = new SHA256Managed();
        byte[] hash = hashstring.ComputeHash(bytes);
        string hashString = string.Empty;
        foreach (byte x in hash)
        {
            hashString += String.Format(""{0:x2}"", x);
        }
        return hashString;
    }
}
</code></pre>

<p>However, this code gives significantly different results compared to my friends php, as well as online generators (such as <a href=""http://hash.online-convert.com/sha256-generator"">This generator</a>)</p>

<p>Does anyone know what the error is? Different bases?</p>
","<p><code>Encoding.Unicode</code> is Microsoft's misleading name for UTF-16 (a double-wide encoding, used in the Windows world for historical reasons but not used by anyone else). <a href=""http://msdn.microsoft.com/en-us/library/system.text.encoding.unicode.aspx"">http://msdn.microsoft.com/en-us/library/system.text.encoding.unicode.aspx</a></p>

<p>If you inspect your <code>bytes</code> array, you'll see that every second byte is <code>0x00</code> (because of the double-wide encoding).</p>

<p>You should be using <code>Encoding.UTF8.GetBytes</code> instead.</p>

<p>But also, you will see different results depending on whether or not you consider the terminating <code>'\0'</code> byte to be part of the data you're hashing. Hashing the two bytes <code>""Hi""</code> will give a different result from hashing the <em>three</em> bytes <code>""Hi""</code>. You'll have to decide which you want to do. (Presumably you want to do whichever one your friend's PHP code is doing.)</p>

<p>For ASCII text, <code>Encoding.UTF8</code> will definitely be suitable. If you're aiming for <em>perfect</em> compatibility with your friend's code, even on non-ASCII inputs, you'd better try a few test cases with non-ASCII characters such as <code>é</code> and <code>家</code> and see whether your results still match up. If not, you'll have to figure out what encoding your friend is really using; it might be one of the 8-bit ""code pages"" that used to be popular before the invention of Unicode. (Again, I think Windows is the main reason that anyone still needs to worry about ""code pages"".)</p>
","12416380"
"""A connection attempt failed because the connected party did not properly respond after a period of time"" using WebClient","158436","","<p>I am using the following code which is working on local machine, but when i tried the same code on server it throws me error </p>

<blockquote>
  <p><em>A connection attempt failed because the connected party did not properly respond after a period of time, or established connection
  failed because connected host has failed to respond</em></p>
</blockquote>

<p>Here is my code:</p>

<pre><code>WebClient client = new WebClient();
// Add a user agent header in case the 
// requested URI contains a query.
//client.Headers.Add (""ID"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)"");
Stream data = client.OpenRead(""http://"" + Request.ServerVariables[""HTTP_HOST""] + Request.ApplicationPath + ""/PageDetails.aspx?ModuleID="" + ID);
StreamReader reader = new StreamReader(data);
string s = reader.ReadToEnd();
Console.WriteLine(s);
data.Close();
reader.Close();
</code></pre>

<p>I am getting error on </p>

<pre><code>Stream data = client.OpenRead(""http://"" + Request.ServerVariables[""HTTP_HOST""] + Request.ApplicationPath + ""/PageDetails.aspx?ModuleID="" + ID);
</code></pre>

<p>is it due any firewall setting?</p>
","<p>I had a similar problem and had to convert the URL from string to Uri object using:</p>

<pre><code>Uri myUri = new Uri(URLInStringFormat, UriKind.Absolute);
</code></pre>

<p>(URLInStringFormat is your URL)
Try to connect using the Uri instead of the string as:</p>

<pre><code>WebClient client = new WebClient();
client.OpenRead(myUri);
</code></pre>
","19516129"
"Split List into Sublists with LINQ","158403","","<p>Is there any way I can separate a <code>List&lt;SomeObject&gt;</code> into several separate lists of <code>SomeObject</code>, using the item index as the delimiter of each split?</p>

<p>Let me exemplify:</p>

<p>I have a <code>List&lt;SomeObject&gt;</code> and I need a <code>List&lt;List&lt;SomeObject&gt;&gt;</code> or <code>List&lt;SomeObject&gt;[]</code>, so that each of these resulting lists will contain a group of 3 items of the original list (sequentially).</p>

<p>eg.:</p>

<ul>
<li><p>Original List: <code>[a, g, e, w, p, s, q, f, x, y, i, m, c]</code></p></li>
<li><p>Resulting lists: <code>[a, g, e], [w, p, s], [q, f, x], [y, i, m], [c]</code></p></li>
</ul>

<p>I'd also need the resulting lists size to be a parameter of this function.</p>
","<p>Try the following code.</p>

<pre><code>public static IList&lt;IList&lt;T&gt;&gt; Split&lt;T&gt;(IList&lt;T&gt; source)
{
    return  source
        .Select((x, i) =&gt; new { Index = i, Value = x })
        .GroupBy(x =&gt; x.Index / 3)
        .Select(x =&gt; x.Select(v =&gt; v.Value).ToList())
        .ToList();
}
</code></pre>

<p>The idea is to first group the elements by indexes.  Dividing by three has the effect of grouping them into groups of 3.  Then convert each group to a list and the <code>IEnumerable</code> of <code>List</code> to a <code>List</code> of <code>List</code>s</p>
","419063"
"Calling stored procedure with return value","158384","","<p>I am trying to call a stored procedure from my C# windows application. The stored procedure is running on a local instance of SQL Server 2008. I am able to call the stored procedure but I am not able to retrieve the value back from the stored procedure. This stored procedure is supposed to return the next number in the sequence. I have done research online and all the sites I've seen have pointed to this solution working.</p>

<p>Stored procedure code:</p>

<pre><code>ALTER procedure [dbo].[usp_GetNewSeqVal]
      @SeqName nvarchar(255)
as
begin
      declare @NewSeqVal int
      set NOCOUNT ON
      update AllSequences
      set @NewSeqVal = CurrVal = CurrVal+Incr
      where SeqName = @SeqName

      if @@rowcount = 0 begin
print 'Sequence does not exist'
            return
      end

      return @NewSeqVal
end
</code></pre>

<p>Code calling the stored procedure:</p>

<pre><code>SqlConnection conn = new SqlConnection(getConnectionString());
conn.Open();

SqlCommand cmd = new SqlCommand(parameterStatement.getQuery(), conn);
cmd.CommandType = CommandType.StoredProcedure;

SqlParameter param = new SqlParameter();

param = cmd.Parameters.Add(""@SeqName"", SqlDbType.NVarChar);
param.Direction = ParameterDirection.Input;
param.Value = ""SeqName"";

SqlDataReader reader = cmd.ExecuteReader();
</code></pre>

<p>I have also tried using a <code>DataSet</code> to retrieve the return value with the same result. What am I missing to get 
the return value from my stored procedure? If more information is needed, please let me know.</p>
","<p>You need to add return parameter to the command:</p>

<pre><code>using (SqlConnection conn = new SqlConnection(getConnectionString()))
using (SqlCommand cmd = conn.CreateCommand())
{
    cmd.CommandText = parameterStatement.getQuery();
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.Parameters.AddWithValue(""SeqName"", ""SeqNameValue"");

    var returnParameter = cmd.Parameters.Add(""@ReturnVal"", SqlDbType.Int);
    returnParameter.Direction = ParameterDirection.ReturnValue;

    conn.Open();
    cmd.ExecuteNonQuery();
    var result = returnParameter.Value;
}
</code></pre>
","6210055"
"How to get a json string from url?","158366","","<p>I'm switching my code form XML to JSON. </p>

<p>But I can't find how to get a JSON string from a given url. </p>

<p>The URL is something like this: ""<a href=""https://api.facebook.com/method/fql.query?query=.....&amp;format=json"" rel=""noreferrer"">https://api.facebook.com/method/fql.query?query=.....&amp;format=json</a>""</p>

<p>I used XDocuments before, there I could use the load method:</p>

<pre><code>XDocument doc = XDocument.load(""URL"");
</code></pre>

<p>What is the equivalent of this method for JSON? I'm using JSON.NET.</p>
","<p>Use the <code>WebClient</code> class in <code>System.Net</code>:</p>

<pre><code>var json = new WebClient().DownloadString(""url"");
</code></pre>

<p>Keep in mind that <code>WebClient</code> is <code>IDisposable</code>, so you would probably add a <code>using</code> statement to this in production code.  This would look like:</p>

<pre><code>using (WebClient wc = new WebClient())
{
   var json = wc.DownloadString(""url"");
}
</code></pre>
","5566981"
"How to write some data to excel file(.xlsx)","158325","","<p>This is what i am trying to do.</p>

<p>1.Create excel file(.xlsx) c://test/files/work1_4.13.14.xlsx with name + value(date) </p>

<p>example: work1_4.13.14.xlsx</p>

<p>2.Set headers to the file example: [Name] [Age] [City]. </p>

<p>3.I have 3 List with names,ages,city that i need to fill into excel sheet.</p>

<p>This is my goal</p>

<pre><code>Name   Age  City
Ben    20   xyz
Jack   25   xyz
Mike   45   zyx
</code></pre>

<p>Any ideas?</p>
","<p>Try this code </p>

<pre><code>Microsoft.Office.Interop.Excel.Application oXL;
Microsoft.Office.Interop.Excel._Workbook oWB;
Microsoft.Office.Interop.Excel._Worksheet oSheet;
Microsoft.Office.Interop.Excel.Range oRng;
object misvalue = System.Reflection.Missing.Value;
try
{
    //Start Excel and get Application object.
    oXL = new Microsoft.Office.Interop.Excel.Application();
    oXL.Visible = true;

    //Get a new workbook.
    oWB = (Microsoft.Office.Interop.Excel._Workbook)(oXL.Workbooks.Add(""""));
    oSheet = (Microsoft.Office.Interop.Excel._Worksheet)oWB.ActiveSheet;

    //Add table headers going cell by cell.
    oSheet.Cells[1, 1] = ""First Name"";
    oSheet.Cells[1, 2] = ""Last Name"";
    oSheet.Cells[1, 3] = ""Full Name"";
    oSheet.Cells[1, 4] = ""Salary"";

    //Format A1:D1 as bold, vertical alignment = center.
    oSheet.get_Range(""A1"", ""D1"").Font.Bold = true;
    oSheet.get_Range(""A1"", ""D1"").VerticalAlignment =
        Microsoft.Office.Interop.Excel.XlVAlign.xlVAlignCenter;

    // Create an array to multiple values at once.
    string[,] saNames = new string[5, 2];

    saNames[0, 0] = ""John"";
    saNames[0, 1] = ""Smith"";
    saNames[1, 0] = ""Tom"";

    saNames[4, 1] = ""Johnson"";

    //Fill A2:B6 with an array of values (First and Last Names).
    oSheet.get_Range(""A2"", ""B6"").Value2 = saNames;

    //Fill C2:C6 with a relative formula (=A2 &amp; "" "" &amp; B2).
    oRng = oSheet.get_Range(""C2"", ""C6"");
    oRng.Formula = ""=A2 &amp; \"" \"" &amp; B2"";

    //Fill D2:D6 with a formula(=RAND()*100000) and apply format.
    oRng = oSheet.get_Range(""D2"", ""D6"");
    oRng.Formula = ""=RAND()*100000"";
    oRng.NumberFormat = ""$0.00"";

    //AutoFit columns A:D.
    oRng = oSheet.get_Range(""A1"", ""D1"");
    oRng.EntireColumn.AutoFit();

    oXL.Visible = false;
    oXL.UserControl = false;
    oWB.SaveAs(""c:\\test\\test505.xls"", Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookDefault, Type.Missing, Type.Missing,
        false, false, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);

    oWB.Close();

    //...
</code></pre>
","23102523"
"Error : Index was outside the bounds of the array.","158222","","<p>I'm aware of what the issue is stating but I am confused to how my program is outputting a value that's outside of the array..</p>

<p>I have an array of ints which is 0 - 8 which means it can hold 9 ints, correct?
I have an int which is checked to make sure the users input value is 1-9. I remove one from the integer (like so)</p>

<pre><code>if (posStatus[intUsersInput-1] == 0) //if pos is empty
{
    posStatus[intUsersInput-1] += 1; 
}//set it to 1
</code></pre>

<p>then I input 9 myself and I get the error. It should access the last int in the array, so I don't see why I'm getting an error. 
Relevant code:</p>

<pre><code>public int[] posStatus;       

public UsersInput()    
{    
    this.posStatus = new int[8];    
}

int intUsersInput = 0; //this gets try parsed + validated that it's 1-9    

if (posStatus[intUsersInput-1] == 0) //if i input 9 it should go to 8?    
{    
    posStatus[intUsersInput-1] += 1; //set it to 1    
} 
</code></pre>

<p>Error:</p>

<pre><code>""Index was outside the bounds of the array."" ""Index was outside the bounds of the array.""
</code></pre>
","<p>You have declared an array that can store 8 elements not 9.</p>

<pre><code>this.posStatus = new int[8]; 
</code></pre>

<p>It means postStatus will contain 8 elements from index 0 to 7.</p>
","21700943"
"Hour from DateTime? in 24 hours format","157941","","<p>So i have this DateTime? and what i want to do is to obtain the hour but show it in 24 hours format.<br>
For example:<br>
If the hour is 2:20:23 p.m. i want to convert it to 14:20 and that's it.</p>

<p>I'm working with Visual C#. 
Any ideas please, thank you.  </p>

<p>I have something like this</p>

<pre><code>public static string FormatearHoraA24(DateTime? fechaHora)
    {
        if (!fechaHora.HasValue)
            return """";

        string retornar = """";
          //here goes what i need
    }
</code></pre>
","<pre><code>return fechaHora.Value.ToString(""HH:mm"");
</code></pre>
","3023696"
"How to ignore the certificate check when ssl","157874","","<p>I am trying find a way to ignore the certificate check when request a Https resource, so far, I found some helpful article in internet. </p>

<p>But i still have some problem. Please review my code . I just don't understand what does the code <code>ServicePointManager.ServerCertificateValidationCallback</code> mean.</p>

<p>When will this delegate method be called? And one more question, in which place should i write this code? Before <code>ServicePointManager.ServerCertificateValidationCallback</code> execute or before <code>Stream stream = request.GetRequestStream()</code>? </p>

<p>Please help me, thanks.</p>

<pre><code>public HttpWebRequest GetRequest()
{
    CookieContainer cookieContainer = new CookieContainer();

    // Create a request to the server
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(_remoteUrl);

    #region Set request parameters

    request.Method = _context.Request.HttpMethod;
    request.UserAgent = _context.Request.UserAgent;
    request.KeepAlive = true;
    request.CookieContainer = cookieContainer;
    request.PreAuthenticate = true;
    request.AllowAutoRedirect = false;

    #endregion

    // For POST, write the post data extracted from the incoming request
    if (request.Method == ""POST"")
    {
        Stream clientStream = _context.Request.InputStream;
        request.ContentType = _context.Request.ContentType;
        request.ContentLength = clientStream.Length;

        ServicePointManager.ServerCertificateValidationCallback = delegate(
            Object obj, X509Certificate certificate, X509Chain chain, 
            SslPolicyErrors errors)
            {
                return (true);
            };

            Stream stream = request.GetRequestStream();

            ....
        }

        ....

        return request;
    }
}   
</code></pre>
","<p>Since there is only one global <a href=""http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.aspx"">ServicePointManager</a>, setting <a href=""http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx"">ServicePointManager.ServerCertificateValidationCallback</a> will yield the result that all subsequent requests will inherit this policy. Since it is a global ""setting"" it would be prefered to set it in the <a href=""http://msdn.microsoft.com/en-us/library/ms178473%28VS.100%29.aspx"">Application_Start</a> method in <a href=""http://msdn.microsoft.com/en-us/library/1xaas8a2%28VS.71%29.aspx"">Global.asax</a>.</p>

<p>Setting the callback overrides the default behaviour and you can yourself create a custom validation routine. </p>
","12507094"
"Check if a value is in an array (C#)","157741","","<p>How do I check if a value is in an array in C#?</p>

<p>Like, I want to create an array with a list of printer names.</p>

<p>These will be fed to a method, which will look at each string in turn, and if the string is the same as a value in an array, do that action.</p>

<p>For example:</p>

<pre><code>string[] printer = {""jupiter"", ""neptune"", ""pangea"", ""mercury"", ""sonic""};
foreach (p in printer)
{
   PrinterSetup(p);     
}
</code></pre>

<p>These are the names of the printers, they are being fed to the PrinterSetup method.</p>

<p>PrinterSetup will look sort of like this (some pseudocode):</p>

<pre><code>public void PrinterSetup(printer)
{
   if (printer == ""jupiter"") 
   {
      Process.Start(""BLAH BLAH CODE TO ADD PRINTER VIA WINDOWS EXEC"");
   }
}
</code></pre>

<p>How do I format <code>if (printer == ""jupiter"")</code> in a way that C# can recognize?</p>
","<p>Add necessary namespace</p>

<pre><code>using System.Linq;
</code></pre>

<p>Then you can use linq <code>Contains()</code> method</p>

<pre><code>string[] printer = {""jupiter"", ""neptune"", ""pangea"", ""mercury"", ""sonic""};
if(printer.Contains(""jupiter""))
{
    Process.Start(""BLAH BLAH CODE TO ADD PRINTER VIA WINDOWS EXEC"""");
}
</code></pre>
","13257521"
"How to convert string to string[]?","157660","","<p>How to convert <code>string</code> type to <code>string[]</code> type in C#?</p>
","<p><code>string[]</code> is an array (vector) of strings
<code>string</code> is just a string (a list/array of characters)</p>

<p>Depending on how you want to convert this, the canonical answer could be:</p>

<h2>string[] -> string</h2>

<pre><code>return String.Join("" "", myStringArray);
</code></pre>

<h2>string -> string[]</h2>

<pre><code>return new []{ myString };
</code></pre>
","11081611"
"How to find Control in TemplateField of GridView?","157610","","<p>How does <code>FindControl</code> method works if I need to find any <code>Control</code> which is inside <code>GridView</code> <code>Template</code>, more specifically <code>ItemTemplate</code>?</p>

<p>I have a <code>hyperlink</code> but it is not able to find the same.</p>

<p><strong>Question updated with code</strong></p>

<p><code>GridView</code> Code is below:</p>

<pre><code>&lt;asp:GridView ID=""grvYourOpportunities"" runat=""server"" AllowPaging=""True"" AutoGenerateColumns=""False""
        DataKeyNames=""ID#,B,H"" PageSize=""20"" CellPadding=""4"" ForeColor=""#333333"" GridLines=""Both""
        OnRowDataBound=""grvYourOpt_RowDataBound""&gt;
        &lt;HeaderStyle BackColor=""#5D7B9D"" Font-Bold=""True"" ForeColor=""White"" /&gt;
        &lt;RowStyle BackColor=""#F7F6F3"" ForeColor=""#333333"" /&gt;
        &lt;Columns&gt;
          &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    i
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""i"") %&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;

            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    H
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;

                    &lt;%--&lt;a href=""javascript:ShowChildGrid('div&lt;%# Eval(""ID#"") %&gt;');""&gt;
                    &lt;img id=""imgdiv&lt;%# Eval(""ID#"") %&gt;"" alt=""Click"" border=""0"" src=""plus.gif"" runat=""server"" /&gt;  &lt;/a&gt;  --%&gt;

                    &lt;asp:HyperLink runat=""server"" ID=""hlPlus"" ImageUrl=""~/plus.gif""&gt;&lt;/asp:HyperLink&gt;

                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    B
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%--&lt;%# Eval(""B"") %&gt;--%&gt;
                    &lt;a href=""javascript:ShowChildGridForBCol('div1&lt;%# Eval(""ID#"") %&gt;');""&gt;
                        &lt;img id=""imgdiv1&lt;%# Eval(""ID#"") %&gt;"" alt=""Click here"" border=""0"" src=""tempY.png"" /&gt;
                    &lt;/a&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    ID.Nr.
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""ID#"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Entry Date
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Entry Date"") %&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField HeaderStyle-Width=""20px"" ItemStyle-Width=""20px""&gt;
                &lt;HeaderTemplate&gt;
                    BU
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""BU"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    BE
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""BE"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Product Family
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Product Family"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Project Name
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Project Name"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    SOP
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""SOP"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Award Date
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Award Date"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Milestone Next Date
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Milestone Next Date"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Contract Status
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Contract Status"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Prob.Of Success
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""ProbSuccess"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Key Account
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Key Account"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Sales SubRegion
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Sales SubRegion"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Growth
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""Growth"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Sales p.a.OE mio$
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""SalesOE"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;asp:TemplateField&gt;
                &lt;HeaderTemplate&gt;
                    Sales p.a.AM mio$
                &lt;/HeaderTemplate&gt;
                &lt;ItemTemplate&gt;
                    &lt;%# Eval(""SalesAM"")%&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
            &lt;%--GridView 2, 3--%&gt;
            &lt;asp:TemplateField&gt;
                &lt;ItemTemplate&gt;
                    &lt;tr&gt;
                        &lt;td align=""left"" style=""margin-left: 10px;"" colspan=""5""&gt;
                            &lt;div id=""div&lt;%# Eval(""ID#"") %&gt;"" style=""display: none; position: relative; left: 110px;""&gt;
                                &lt;asp:GridView ID=""GridView2"" runat=""server"" Width=""40%"" AutoGenerateColumns=""false""
                                    DataKeyNames=""Entry Date"" EmptyDataText=""No orders for this customer."" CellPadding=""0""
                                    ForeColor=""#333333"" GridLines=""Both""&gt;
                                    &lt;HeaderStyle BackColor=""#5D7B9D"" Font-Bold=""True"" ForeColor=""White"" /&gt;
                                    &lt;RowStyle BackColor=""#F7F6F3"" ForeColor=""#333333"" /&gt;
                                    &lt;HeaderStyle CssClass=""header"" /&gt;
                                    &lt;RowStyle CssClass=""row"" /&gt;
                                    &lt;Columns&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""ID#"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Entry Date"") %&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""ID#"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField ItemStyle-Wrap=""false""&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Other Text"") %&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                    &lt;/Columns&gt;
                                &lt;/asp:GridView&gt;
                            &lt;/div&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td align=""left"" colspan=""19""&gt;
                            &lt;div id=""div1&lt;%# Eval(""ID#"") %&gt;"" style=""display: none; position:relative; left: 110px;""&gt;
                                &lt;asp:GridView ID=""GridView3"" runat=""server"" AutoGenerateColumns=""false"" DataKeyNames=""Entry Date""
                                    EmptyDataText=""No orders for this customer."" CellPadding=""0"" ForeColor=""#333333""
                                    GridLines=""Both"" Width=""100%""&gt;
                                    &lt;HeaderStyle BackColor=""#5D7B9D"" Font-Bold=""True"" ForeColor=""White"" /&gt;
                                    &lt;RowStyle BackColor=""#F7F6F3"" ForeColor=""#333333"" /&gt;
                                    &lt;%--&lt;HeaderStyle CssClass=""header"" /&gt;
                                    &lt;RowStyle CssClass=""row"" /&gt;--%&gt;
                                    &lt;Columns&gt;

                                        &lt;%--&lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;--%&gt;

                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""ID#"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                       &lt;%-- &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Entry Date"") %&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField HeaderStyle-Width=""20px"" ItemStyle-Width=""20px""&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""BU"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""BE"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Product Family"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Project Name"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""SOP"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Award Date"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Milestone Next Date"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Contract Status"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""ProbSuccess"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Key Account"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Sales SubRegion"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""Growth"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""SalesOE"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;HeaderTemplate&gt;
                                            &lt;/HeaderTemplate&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;%# Eval(""SalesAM"")%&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;--%&gt;
                                    &lt;/Columns&gt;
                                &lt;/asp:GridView&gt;
                            &lt;/div&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
        &lt;/Columns&gt;
    &lt;/asp:GridView&gt;
</code></pre>

<p>The <code>RowDataBound</code> event of the parent <code>GridView</code> is as below;</p>

<pre><code>Protected void grvYourOpt_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        string colId = grvYourOpportunities.DataKeys[e.Row.RowIndex].Values[0].ToString();
        string colB = grvYourOpportunities.DataKeys[e.Row.RowIndex].Values[1].ToString();
        string colH = grvYourOpportunities.DataKeys[e.Row.RowIndex].Values[2].ToString();

        #region ""Commented Code for Col.B""

        //if (colB == ""Y"")
        //{
        //    e.Row.Cells[2].Text = ""&lt;img src='tempY.png'&gt;"";

        //}
        //else
        //{
        //    e.Row.Cells[2].Text = ""&lt;img src='tempN.png'&gt;"";
        //}
        #endregion

        #region ""Commented code for Col.H""

        if (colH == ""1"")
        {
            e.Row.Cells[1].Text = string.Empty;
            //e.Row.Cells[1].Text = ""&lt;a href=''&gt; &lt;img id='13' alt='Click' border='0' src='plus.gif'/&gt; &lt;/a&gt;"";
            string js = string.Format(""javascript:ShowChildGrid('div{0}');"", colId);
            HyperLink lnk = (HyperLink)e.Row.FindControl(""hlPlus"");
            if (lnk!=null)
            {
                lnk.NavigateUrl = js;
                lnk.ImageUrl = ""plus.gif"";
                lnk.Visible = true;
            }
            //Page.ClientScript.RegisterStartupScript(this.GetType(), ""HCol"", ""ShowChildGrid(""+ colId + "");"", true);
        }
        else
        {
            e.Row.Cells[1].Text = string.Empty;
            e.Row.Cells[1].Text = """";
        }
        #endregion

        DataTable dt1 = new DataTable();
        DataTable dt2 = new DataTable();

        DataRow dr1 = null;
        DataRow dr2 = null;
        DataRow dr3 = null;
        DataRow dr4 = null;
        DataRow dr5 = null;
        DataRow dr7 = null;

        DataRow r = dt1.NewRow();

        DataSet ds1 = new DataSet();
        DataSet ds2 = new DataSet();

        dt1.TableName = ""Opportunity1"";

        dt1.Columns.Add(new System.Data.DataColumn(""ID#"", typeof(System.String)));
        dt1.Columns.Add(new System.Data.DataColumn(""Entry Date"", typeof(System.String)));
        dt1.Columns.Add(new System.Data.DataColumn(""Other Text"", typeof(System.String)));
        ds1.Tables.Add(dt1);

        dt2.Columns.Add(new System.Data.DataColumn(""ID#"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Entry Date"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""BU"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""BE"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Product Family"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Project Name"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""SOP"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Award Date"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Milestone Next Date"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Contract Status"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""ProbSuccess"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Key Account"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Sales SubRegion"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""Growth"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""SalesOE"", typeof(System.String)));
        dt2.Columns.Add(new System.Data.DataColumn(""SalesAM"", typeof(System.String)));
        ds2.Tables.Add(dt2);

        dr2 = dt1.NewRow();
        dr3 = dt1.NewRow();
        dr4 = dt1.NewRow();
        dr5 = dt1.NewRow();

        dr1[""ID#""] = """";
        dr2[""ID#""] = """";
        dr3[""ID#""] = """";
        dr4[""ID#""] = """";
        dr5[""ID#""] = """";

        dr1[""Entry Date""] = ""18/01/2010"";
        dr2[""Entry Date""] = ""19/01/2010"";
        dr3[""Entry Date""] = ""20/01/2010"";
        dr4[""Entry Date""] = ""21/01/2010"";
        dr5[""Entry Date""] = ""14/01/2010"";

        dr1[""Other Text""] = ""17:25CET changed by""; // - product family: ABS, Milestone Date: 23.02.1022, Contract Status: Signed, Probability of success: 100%"";
        dr2[""Other Text""] = ""18:44CET changed by""; //- product family: ABS, Milestone Date: 23.02.1022, Contract Status: Signed, Probability of success: 100%"";
        dr3[""Other Text""] = ""19:25CET changed by""; //- product family: ABS, Milestone Date: 23.02.1022, Contract Status: Signed, Probability of success: 100%"";
        dr4[""Other Text""] = ""14:25CET changed by""; //- product family: ABS, Milestone Date: 23.02.1022, Contract Status: Signed, Probability of success: 100%"";
        dr5[""Other Text""] = ""11:25CET changed by""; //- product family: ABS, Milestone Date: 23.02.1022, Contract Status: Signed, Probability of success: 100%"";

        dt1.Rows.Add(dr1);
        dt1.Rows.Add(dr2);
        dt1.Rows.Add(dr3);
        dt1.Rows.Add(dr4);
        dt1.Rows.Add(dr5);

        GridView gv12 = (GridView)e.Row.FindControl(""GridView2"");
        gv12.DataSource = ds1.Tables[0];
        gv12.DataBind();

        for (int i = 0; i &lt; gv12.Rows.Count; i++)
        {
            gv12.RowStyle.BackColor = System.Drawing.Color.Gray;
        }


        dr7 = dt2.NewRow();

        dr7[""ID#""] = ""11-0101"";
        dr7[""Entry Date""] = ""19/01/2010"";
        dr7[""BU""] = ""VDC"";
        dr7[""BE""] = ""ASES"";
        dr7[""Product Family""] = ""Car Air Systems"";
        dr7[""Project Name""] = ""Example"";
        dr7[""SOP""] = ""09/08/2011"";
        dr7[""Award Date""] = ""10/2011"";
        dr7[""Milestone Next Date""] = System.DateTime.Today.ToString(""dd.MM.yyyy"");
        dr7[""Contract Status""] = ""won"";
        dr7[""ProbSuccess""] = ""70%"";
        dr7[""Key Account""] = ""E-Paccar"";
        dr7[""Sales SubRegion""] = ""North America"";
        dr7[""Growth""] = ""10%"";
        dr7[""SalesOE""] = ""150"";
        dr7[""SalesAM""] = ""18"";

        dt2.Rows.Add(dr7);

        GridView gv13 = (GridView)e.Row.FindControl(""GridView3"");
        gv13.DataSource = ds2.Tables[0];
        gv13.DataBind();
    }
}
</code></pre>

<p>The <code>hyperlink</code> <code>hlPlus</code> is a <code>hyperlink</code> field inside <code>GridView</code>'s Template Field(Item Template).</p>
","<p>Try this:</p>

<pre><code>foreach(GridViewRow row in GridView1.Rows) {
    if(row.RowType == DataControlRowType.DataRow) {
        HyperLink myHyperLink = row.FindControl(""myHyperLinkID"") as HyperLink;
    }
}
</code></pre>

<p>If you are handling RowDataBound event, it's like this:</p>

<pre><code>protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if(e.Row.RowType == DataControlRowType.DataRow)
    {
        HyperLink myHyperLink = e.Row.FindControl(""myHyperLinkID"") as HyperLink;
    }
}
</code></pre>
","6874083"
"Returning IEnumerable<T> vs. IQueryable<T>","157589","","<p>What is the difference between returning <code>IQueryable&lt;T&gt;</code> vs. <code>IEnumerable&lt;T&gt;</code>?</p>

<pre><code>IQueryable&lt;Customer&gt; custs = from c in db.Customers
where c.City == ""&lt;City&gt;""
select c;

IEnumerable&lt;Customer&gt; custs = from c in db.Customers
where c.City == ""&lt;City&gt;""
select c;
</code></pre>

<p>Will both be deferred execution and when should one be preferred over the other?</p>
","<p>Yes, both will give you <a href=""https://msdn.microsoft.com/en-us/library/bb738633(v=vs.110).aspx#Anchor_0"" rel=""noreferrer"">deferred execution</a>.</p>

<p>The difference is that <a href=""https://msdn.microsoft.com/en-us/library/bb351562.aspx"" rel=""noreferrer""><code>IQueryable&lt;T&gt;</code></a> is the interface that allows LINQ-to-SQL (LINQ.-to-anything really) to work. So if you further refine your query on an <a href=""https://msdn.microsoft.com/en-us/library/bb351562.aspx"" rel=""noreferrer""><code>IQueryable&lt;T&gt;</code></a>, that query will be executed in the database, if possible. </p>

<p>For the <a href=""https://msdn.microsoft.com/en-us/library/9eekhta0.aspx"" rel=""noreferrer""><code>IEnumerable&lt;T&gt;</code></a> case, it will be LINQ-to-object, meaning that all objects matching the original query will have to be loaded into memory from the database.</p>

<p>In code:</p>

<pre><code>IQueryable&lt;Customer&gt; custs = ...;
// Later on...
var goldCustomers = custs.Where(c =&gt; c.IsGold);
</code></pre>

<p>That code will execute SQL to only select gold customers. The following code, on the other hand, will execute the original query in the database, then filtering out the non-gold customers in the memory:</p>

<pre><code>IEnumerable&lt;Customer&gt; custs = ...;
// Later on...
var goldCustomers = custs.Where(c =&gt; c.IsGold);
</code></pre>

<p>This is quite an important difference, and working on <a href=""https://msdn.microsoft.com/en-us/library/bb351562.aspx"" rel=""noreferrer""><code>IQueryable&lt;T&gt;</code></a> can in many cases save you from returning too many rows from the database. Another prime example is doing paging: If you use <a href=""https://msdn.microsoft.com/en-us/library/bb300906.aspx"" rel=""noreferrer""><code>Take</code></a> and <a href=""https://msdn.microsoft.com/en-us/library/bb357513.aspx"" rel=""noreferrer""><code>Skip</code></a> on <a href=""https://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx"" rel=""noreferrer""><code>IQueryable</code></a>, you will only get the number of rows requested; doing that on an <a href=""https://msdn.microsoft.com/en-us/library/9eekhta0.aspx"" rel=""noreferrer""><code>IEnumerable&lt;T&gt;</code></a> will cause all of your rows to be loaded in memory.</p>
","2876655"
"Why would you use Expression<Func<T>> rather than Func<T>?","157487","","<p>I understand lambdas and the <code>Func</code> and <code>Action</code> delegates. But expressions stump me. In what circumstances would you use an <code>Expression&lt;Func&lt;T&gt;&gt;</code> rather than a plain old <code>Func&lt;T&gt;</code>?</p>
","<p>When you want to treat lambda expressions as expression trees and look inside them instead of executing them. For example, LINQ to SQL gets the expression and converts it to the equivalent SQL statement and submits it to server (rather than executing the lambda).</p>

<p>Conceptually, <code>Expression&lt;Func&lt;T&gt;&gt;</code> is <em>completely different</em> from <code>Func&lt;T&gt;</code>. <code>Func&lt;T&gt;</code> denotes a <code>delegate</code> which is pretty much a pointer to a method and <code>Expression&lt;Func&lt;T&gt;&gt;</code> denotes a <em>tree data structure</em> for a lambda expression. This tree structure <strong>describes what a lambda expression does</strong> rather than doing the actual thing. It basically holds data about the composition of expressions, variables, method calls, ... (for example it holds information such as this lambda is some constant + some parameter). You can use this description to convert it to an actual method (with <code>Expression.Compile</code>) or do other stuff (like the LINQ to SQL example) with it. The act of treating lambdas as anonymous methods and expression trees is purely a compile time thing.</p>

<pre><code>Func&lt;int&gt; myFunc = () =&gt; 10; // similar to: int myAnonMethod() { return 10; }
</code></pre>

<p>will effectively compile to an IL method that gets nothing and returns 10.</p>

<pre><code>Expression&lt;Func&lt;int&gt;&gt; myExpression = () =&gt; 10;
</code></pre>

<p>will be converted to a data structure that describes an expression that gets no parameters and returns the value 10:</p>

<p><a href=""https://i.stack.imgur.com/gwU0E.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/gwU0E.jpg"" alt=""Expression vs Func""> <em>larger image</em></a></p>

<p>While they both look the same at compile time, what the compiler generates is <strong>totally different</strong>.</p>
","793584"
"Task vs Thread differences","157355","","<p>I'm new to parallel programming. There are two classes available  in .NET: <code>Task</code> and <code>Thread</code>. </p>

<p>So, the question is: What is difference between those classes? When is it better to use <code>Thread</code> and when <code>Task</code>?</p>
","<p><code>Thread</code> is a lower-level concept: if you're directly starting a thread, you <em>know</em> it will be a separate thread, rather than executing on the thread pool etc.</p>

<p><code>Task</code> is more than just an abstraction of ""where to run some code"" though - it's really just ""the promise of a result in the future"". So as some different examples:</p>

<ul>
<li><code>Task.Delay</code> doesn't need any actual CPU time; it's just like setting a timer to go off in the future</li>
<li>A task returned by <code>WebClient.DownloadStringTaskAsync</code> won't take much CPU time locally; it's representing a result which is likely to spend most of its time in network latency or remote work (at the web server)</li>
<li>A task returned by <code>Task.Run()</code> really <em>is</em> saying ""I want you to execute this code separately""; the exact thread on which that code executes depends on a number of factors.</li>
</ul>

<p>Note that the <code>Task&lt;T&gt;</code> abstraction is pivotal to the async support in C# 5.</p>

<p>In general, I'd recommend that you use the higher level abstraction wherever you can: in modern C# code you should rarely need to explicitly start your own thread.</p>
","13429164"
"How to convert a list into data table","157116","","<p>I have a data list with some property. I want to convert that list data into data table. How to convert a list into datable.  </p>
","<p>Just add this function and call it, it will convert <em>List to DataTable</em>.</p>

<pre><code>public static DataTable ToDataTable&lt;T&gt;(List&lt;T&gt; items)
{
        DataTable dataTable = new DataTable(typeof(T).Name);

        //Get all the properties
        PropertyInfo[] Props = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);
        foreach (PropertyInfo prop in Props)
        {
            //Defining type of data column gives proper data table 
            var type = (prop.PropertyType.IsGenericType &amp;&amp; prop.PropertyType.GetGenericTypeDefinition() == typeof(Nullable&lt;&gt;) ? Nullable.GetUnderlyingType(prop.PropertyType) : prop.PropertyType);
            //Setting column names as Property names
            dataTable.Columns.Add(prop.Name, type);
        }
        foreach (T item in items)
        {
           var values = new object[Props.Length];
           for (int i = 0; i &lt; Props.Length; i++)
           {
                //inserting property values to datatable rows
                values[i] = Props[i].GetValue(item, null);
           }
           dataTable.Rows.Add(values);
      }
      //put a breakpoint here and check datatable
      return dataTable;
}
</code></pre>
","18100872"
"nullable object must have a value","157110","","<p>There is paradox in the exception description:
Nullable object must have a value (?!)</p>

<p>This is the problem:</p>

<p>I have a <code>DateTimeExtended</code> class, 
that has </p>

<pre><code>{
  DateTime? MyDataTime;
  int? otherdata;

}
</code></pre>

<p>and a constructor</p>

<pre><code>DateTimeExtended(DateTimeExtended myNewDT)
{
   this.MyDateTime = myNewDT.MyDateTime.Value;
   this.otherdata = myNewDT.otherdata;
}
</code></pre>

<p>running this code</p>

<pre><code>DateTimeExtended res = new DateTimeExtended(oldDTE);
</code></pre>

<p>throws an <code>InvalidOperationException</code> with the message:</p>

<blockquote>
  <p>Nullable object must have a value.</p>
</blockquote>

<p><code>myNewDT.MyDateTime.Value</code> - is valid and contain a regular <code>DateTime</code> object.</p>

<p>What is the meaning of this message and what am I doing wrong?</p>

<p>Note that <code>oldDTE</code> is not <code>null</code>. I've removed the <code>Value</code> from <code>myNewDT.MyDateTime</code> but the same exception is thrown due to a generated setter.</p>
","<p>You should change the line <code>this.MyDateTime = myNewDT.MyDateTime.Value;</code> to just <code>this.MyDateTime = myNewDT.MyDateTime;</code></p>

<p>The exception you were receiving was thrown in the <strong><code>.Value</code></strong> property of the <strong>Nullable</strong> <code>DateTime</code>, as it is required to return a <code>DateTime</code> (since that's what the contract for <code>.Value</code> states), but it can't do so because there's no <code>DateTime</code> to return, so it throws an exception.</p>

<p>In general, it is a bad idea to blindly call <code>.Value</code> on a nullable type, unless you have some prior knowledge that that variable <strong>MUST</strong> contain a value (i.e. through a <strong><code>.HasValue</code></strong> check). </p>

<p><strong>EDIT</strong></p>

<p>Here's the code for <code>DateTimeExtended</code> that does not throw an exception:</p>

<pre><code>class DateTimeExtended
{
    public DateTime? MyDateTime;
    public int? otherdata;

    public DateTimeExtended() { }

    public DateTimeExtended(DateTimeExtended other)
    {
        this.MyDateTime = other.MyDateTime;
        this.otherdata = other.otherdata;
    }
}
</code></pre>

<p>I tested it like this:</p>

<pre><code>DateTimeExtended dt1 = new DateTimeExtended();
DateTimeExtended dt2 = new DateTimeExtended(dt1);
</code></pre>

<p>Adding the <code>.Value</code> on <code>other.MyDateTime</code> causes an exception. Removing it gets rid of the exception. I think you're looking in the wrong place.</p>
","1896201"
"How do I mark a method as obsolete or deprecated?","157046","","<p>How do I mark a method as obsolete or deprecated using C#?</p>
","<p>The shortest way is by adding the <a href=""https://msdn.microsoft.com/en-us/library/system.obsoleteattribute.aspx"" rel=""noreferrer""><code>ObsoleteAttribute</code></a> as an <a href=""https://msdn.microsoft.com/en-us/library/mt653979.aspx"" rel=""noreferrer"">attribute to the method</a>. Make sure to include an appropriate explanation:</p>

<pre><code>[Obsolete(""Method1 is deprecated, please use Method2 instead."")]
public void Method1()
{ … }
</code></pre>

<p>You can also cause the compilation to fail, treating the usage of the method as an error instead of warning, if the method is called from somewhere in code like this:</p>

<pre><code>[Obsolete(""Method1 is deprecated, please use Method2 instead."", true)]
</code></pre>
","1759357"
"List of Timezone ID's for use with FindTimeZoneById() in C#?","156995","","<p>Can someone please point me to a complete list of all the timezones referenced by the id expected in <code>TimeZoneInfo.FindTimeZoneById()</code>? I can't find a list anywhere and I've looked through the .NET documentation.</p>
","<p>Here's a full listing of a program <em>and its results</em>.</p>

<p>The code:</p>

<pre><code>using System;

namespace TimeZoneIds
{
    class Program
    {
        static void Main(string[] args)
        {
            foreach (TimeZoneInfo z in TimeZoneInfo.GetSystemTimeZones())
                Console.WriteLine(z.Id);
        }
    }
}
</code></pre>

<p>The <strong>TimeZoneId</strong> results on my Windows 7 workstation:</p>

<blockquote>
  <p>Dateline Standard Time</p>
  
  <p>UTC-11</p>
  
  <p>Samoa Standard Time</p>
  
  <p>Hawaiian Standard Time</p>
  
  <p>Alaskan Standard Time</p>
  
  <p>Pacific Standard Time (Mexico)</p>
  
  <p>Pacific Standard Time</p>
  
  <p>US Mountain Standard Time</p>
  
  <p>Mountain Standard Time (Mexico)</p>
  
  <p>Mountain Standard Time</p>
  
  <p>Central America Standard Time</p>
  
  <p>Central Standard Time</p>
  
  <p>Central Standard Time (Mexico)</p>
  
  <p>Canada Central Standard Time</p>
  
  <p>SA Pacific Standard Time</p>
  
  <p>Eastern Standard Time</p>
  
  <p>US Eastern Standard Time</p>
  
  <p>Venezuela Standard Time</p>
  
  <p>Paraguay Standard Time</p>
  
  <p>Atlantic Standard Time</p>
  
  <p>Central Brazilian Standard Time</p>
  
  <p>SA Western Standard Time</p>
  
  <p>Pacific SA Standard Time</p>
  
  <p>Newfoundland Standard Time</p>
  
  <p>E. South America Standard Time</p>
  
  <p>Argentina Standard Time</p>
  
  <p>SA Eastern Standard Time</p>
  
  <p>Greenland Standard Time</p>
  
  <p>Montevideo Standard Time</p>
  
  <p>UTC-02</p>
  
  <p>Mid-Atlantic Standard Time</p>
  
  <p>Azores Standard Time</p>
  
  <p>Cape Verde Standard Time</p>
  
  <p>Morocco Standard Time</p>
  
  <p>UTC</p>
  
  <p>GMT Standard Time</p>
  
  <p>Greenwich Standard Time</p>
  
  <p>W. Europe Standard Time</p>
  
  <p>Central Europe Standard Time</p>
  
  <p>Romance Standard Time</p>
  
  <p>Central European Standard Time</p>
  
  <p>W. Central Africa Standard Time</p>
  
  <p>Namibia Standard Time</p>
  
  <p>Jordan Standard Time</p>
  
  <p>GTB Standard Time</p>
  
  <p>Middle East Standard Time</p>
  
  <p>Egypt Standard Time</p>
  
  <p>Syria Standard Time</p>
  
  <p>South Africa Standard Time</p>
  
  <p>FLE Standard Time</p>
  
  <p>Israel Standard Time</p>
  
  <p>E. Europe Standard Time</p>
  
  <p>Arabic Standard Time</p>
  
  <p>Arab Standard Time</p>
  
  <p>Russian Standard Time</p>
  
  <p>E. Africa Standard Time</p>
  
  <p>Iran Standard Time</p>
  
  <p>Arabian Standard Time</p>
  
  <p>Azerbaijan Standard Time</p>
  
  <p>Mauritius Standard Time</p>
  
  <p>Georgian Standard Time</p>
  
  <p>Caucasus Standard Time</p>
  
  <p>Afghanistan Standard Time</p>
  
  <p>Ekaterinburg Standard Time</p>
  
  <p>Pakistan Standard Time</p>
  
  <p>West Asia Standard Time</p>
  
  <p>India Standard Time</p>
  
  <p>Sri Lanka Standard Time</p>
  
  <p>Nepal Standard Time</p>
  
  <p>Central Asia Standard Time</p>
  
  <p>Bangladesh Standard Time</p>
  
  <p>N. Central Asia Standard Time</p>
  
  <p>Myanmar Standard Time</p>
  
  <p>SE Asia Standard Time</p>
  
  <p>North Asia Standard Time</p>
  
  <p>China Standard Time</p>
  
  <p>North Asia East Standard Time</p>
  
  <p>Singapore Standard Time</p>
  
  <p>W. Australia Standard Time</p>
  
  <p>Taipei Standard Time</p>
  
  <p>Ulaanbaatar Standard Time</p>
  
  <p>Tokyo Standard Time</p>
  
  <p>Korea Standard Time</p>
  
  <p>Yakutsk Standard Time</p>
  
  <p>Cen. Australia Standard Time</p>
  
  <p>AUS Central Standard Time</p>
  
  <p>E. Australia Standard Time</p>
  
  <p>AUS Eastern Standard Time</p>
  
  <p>West Pacific Standard Time</p>
  
  <p>Tasmania Standard Time</p>
  
  <p>Vladivostok Standard Time</p>
  
  <p>Central Pacific Standard Time</p>
  
  <p>New Zealand Standard Time</p>
  
  <p>UTC+12</p>
  
  <p>Fiji Standard Time</p>
  
  <p>Kamchatka Standard Time</p>
  
  <p>Tonga Standard Time</p>
</blockquote>
","7908482"
"How do you UrlEncode without using System.Web?","156943","","<p>I am trying to write a windows client application that calls a web site for data. To keep the install to a minimum I am trying only use <a href=""http://msdn.microsoft.com/en-us/library/ff462634.aspx"" rel=""noreferrer"">dlls in the .NET Framework Client Profile</a>. Trouble is that I need to UrlEncode some parameters, is there an easy way to do this without importing System.Web.dll which is not part of the Client Pofile?</p>
","<p><code>System.Uri.EscapeUriString()</code> can be problematic with certain characters, for me it was a number / pound '#' sign in the string.</p>

<p>If that is an issue for you, try:</p>

<pre><code>System.Uri.EscapeDataString() //Works excellent with individual values
</code></pre>

<p>Here is a SO question answer that explains the difference:</p>

<p><a href=""https://stackoverflow.com/questions/4396598/whats-the-difference-between-escapeuristring-and-escapedatastring"">What&#39;s the difference between EscapeUriString and EscapeDataString?</a></p>

<p>and recommends to use <strong><code>Uri.EscapeDataString()</code></strong> in any aspect.</p>
","7878050"
"Using Excel OleDb to get sheet names IN SHEET ORDER","156801","","<p>I'm using OleDb to read from an excel workbook with many sheets. </p>

<p>I need to read the sheet names, but I need them in the order they are defined in the spreadsheet; so If I have a file that looks like this;</p>

<pre><code>|_____|_____|____|____|____|____|____|____|____|
|_____|_____|____|____|____|____|____|____|____|
|_____|_____|____|____|____|____|____|____|____|
\__GERMANY__/\__UK__/\__IRELAND__/
</code></pre>

<p>Then I need to get the dictionary</p>

<pre><code>1=""GERMANY"", 
2=""UK"", 
3=""IRELAND""
</code></pre>

<p>I've tried using <code>OleDbConnection.GetOleDbSchemaTable()</code>, and that gives me the list of names, but it alphabetically sorts them. The alpha-sort means I don't know which sheet number a particular name corresponds to. So I get;</p>

<pre><code>GERMANY, IRELAND, UK
</code></pre>

<p>which has changed the order of <code>UK</code> and <code>IRELAND</code>. </p>

<p>The reason I need it to be sorted is that I have to let the user choose a range of data by name or index; they can ask for 'all the data from GERMANY to IRELAND' or 'data from sheet 1 to sheet 3'.</p>

<p>Any ideas would be greatly appreciated.</p>

<p>if I could use the office interop classes, this would be straightforward. Unfortunately, I can't because the interop classes don't work reliably in non-interactive environments such as windows services and ASP.NET sites, so I needed to use OLEDB.</p>
","<p>Can't find this in actual MSDN documentation, but a moderator in the forums said </p>

<blockquote>
  <p>I am afraid that OLEDB does not preserve the sheet order as they were in Excel</p>
</blockquote>

<p><a href=""http://social.msdn.microsoft.com/Forums/en/adodotnetdataproviders/thread/2f459200-deef-4131-be8a-1b67a41efb97"">Excel Sheet Names in Sheet Order</a></p>

<p>Seems like this would be a common enough requirement that there would be a decent workaround.</p>
","12604357"
"Get all column names of a DataTable into string array using (LINQ/Predicate)","156789","","<p>I know we can easily do this by a simple loop, but I want to persue this LINQ/Predicate?</p>

<pre><code>string[] columnNames = dt.Columns.?

or

string[] columnNames = from DataColumn dc in dt.Columns select dc.name;
</code></pre>
","<p>Try this (LINQ method syntax):  </p>

<pre><code>string[] columnNames = dt.Columns.Cast&lt;DataColumn&gt;()
                                 .Select(x =&gt; x.ColumnName)
                                 .ToArray();  
</code></pre>

<p>or in LINQ Query syntax:  </p>

<pre><code>string[] columnNames = (from dc in dt.Columns.Cast&lt;DataColumn&gt;()
                        select dc.ColumnName).ToArray();
</code></pre>

<p><code>Cast</code> is required, because Columns is of type DataColumnCollection which is a <code>IEnumerable</code>, not <code>IEnumerable&lt;DataColumn&gt;</code>. The other parts should be obvious.</p>
","5026354"
"How to replace part of string by position?","156587","","<p>I have this string: <code>ABCDEFGHIJ</code></p>

<p>I need to replace from position 4 to position 5 with the string <code>ZX</code></p>

<p>It will look like this: <code>ABCZXFGHIJ</code></p>

<p>But not to use with <code>string.replace(""DE"",""ZX"")</code> - I need to use with <strong>position</strong></p>

<p>How can I do it?</p>
","<p>The easiest way to add and remove ranges in a string is to use the <a href=""http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx""><code>StringBuilder</code></a>.</p>

<pre><code>var theString = ""ABCDEFGHIJ"";
var aStringBuilder = new StringBuilder(theString);
aStringBuilder.Remove(3, 2);
aStringBuilder.Insert(3, ""ZX"");
theString = aStringBuilder.ToString();
</code></pre>

<p>An alternative is to use <a href=""http://msdn.microsoft.com/en-us/library/aka44szs.aspx""><code>String.Substring</code></a>, but I think the <code>StringBuilder</code> code gets more readable.</p>
","5015636"
"datetime format to SQL format using C#","156444","","<p>I am trying to save the current date time format from C# and convert it to a SQL Server date format like so <code>yyyy-MM-dd HH:mm:ss</code> so I can use it for my <code>Update</code> query.</p>

<p>This was my first code:</p>

<pre><code>DateTime myDateTime = DateTime.Now;
string sqlFormattedDate = myDateTime.Date.ToString(""yyyy-MM-dd HH:mm:ss"");
</code></pre>

<p>The output on date is ok but time is always ""12:00:00"" so I changed my code to the following:</p>

<pre><code>string sqlFormattedDate = myDateTime.Date.ToString(""yyyy-MM-dd"") + "" "" + 
myDateTime.TimeOfDay.ToString(""HH:mm:ss"");
</code></pre>

<p>It gave me a compile error ""FormatException was unhandled"" and suggested I need to parse. So I tried doing this to my code as per my research here in staackoverflow:</p>

<pre><code>string sqlFormattedDate = myDateTime.Date.ToString(""yyyy-MM-dd"") + "" "" + 
myDateTime.Parse.TimeOfDay.ToString(""HH:mm:ss"");
</code></pre>

<p>or</p>

<pre><code>string sqlFormattedDate = myDateTime.Date.ToString(""yyyy-MM-dd"") + "" "" + 
myDateTime.tryParse.TimeOfDay.ToString(""HH:mm:ss"");
</code></pre>

<p>but it's giving me it's a method which is not valid for given context. I tried searching for solutions to my problem and currently stuck for two hours now. I'm still a bit new in C#, can you help please?</p>
","<p>try this below </p>

<pre><code>DateTime myDateTime = DateTime.Now;
string sqlFormattedDate = myDateTime.ToString(""yyyy-MM-dd HH:mm:ss.fff"");
</code></pre>
","17418301"
"How to cast Object to its actual type?","156296","","<p>If I have:</p>

<pre><code>void MyMethod(Object obj) {   ...   }
</code></pre>

<p>How can I cast <code>obj</code> to what its actual type is?</p>
","<p>If you know the actual type, then just:</p>

<pre><code>SomeType typed = (SomeType)obj;
typed.MyFunction();
</code></pre>

<p>If you don't know the actual type, then: not really, no. You would have to instead use one of:</p>

<ul>
<li>reflection</li>
<li>implementing a well-known interface</li>
<li>dynamic</li>
</ul>

<p>For example:</p>

<pre><code>// reflection
obj.GetType().GetMethod(""MyFunction"").Invoke(obj, null);

// interface
IFoo foo = (IFoo)obj; // where SomeType : IFoo and IFoo declares MyFunction
foo.MyFunction();

// dynamic
dynamic d = obj;
d.MyFunction();
</code></pre>
","12234122"
"Convert List into Comma-Separated String","156200","","<p>My code is as below:</p>

<pre><code>public void ReadListItem()
{
     List&lt;uint&gt; lst = new List&lt;uint&gt;() { 1, 2, 3, 4, 5 };
     string str = string.Empty;
     foreach (var item in lst)
         str = str + item + "","";

     str = str.Remove(str.Length - 1);
     Console.WriteLine(str);
}
</code></pre>

<p>Output: <code>1,2,3,4,5</code></p>

<p>What is the most simple way to convert the <code>List&lt;uint&gt;</code> into a comma-separated string?</p>
","<p>Enjoy!</p>

<pre><code>Console.WriteLine(String.Join("","", new List&lt;uint&gt; { 1, 2, 3, 4, 5 }));
</code></pre>

<p><a href=""http://msdn.microsoft.com/en-us/library/57a79xd0.aspx"" rel=""noreferrer"">String.Join</a> will take a list as a the second parameter and join all of the elements using the string passed as the first parameter into one single string.</p>
","14959865"
"When to use ref vs out","156070","","<p>Someone asked me the other day when they should use the parameter keyword <code>out</code> instead of <code>ref</code>. While I (I think) understand the difference between the <code>ref</code> and <code>out</code> keywords (that has been <a href=""https://stackoverflow.com/questions/388464/c-whats-the-difference-between-the-ref-and-out-keywords"">asked before</a>) and the best explanation seems to be that <code>ref</code> == <code>in</code> and <code>out</code>, what are some (hypothetical or code) examples where I should always use <code>out</code> and not <code>ref</code>. </p>

<p>Since <code>ref</code> is more general, why do you ever want to use <code>out</code>? Is it just syntactic sugar?</p>
","<p>You should use <code>out</code> unless you need <code>ref</code>.</p>

<p>It makes a big difference when the data needs to be marshalled e.g. to another process, which can be costly. So you want to avoid marshalling the initial value when the method doesn't make use of it.</p>

<p>Beyond that, it also shows the reader of the declaration or the call whether the initial value is relevant (and potentially preserved), or thrown away.</p>

<p>As a minor difference, an out parameter needs not be initialized.</p>

<p>Example for <code>out</code>:</p>

<pre><code>string a, b;
person.GetBothNames(out a, out b);
</code></pre>

<p>where GetBothNames is a method to retrieve two values atomically, the method won't change behavior whatever a and b are. If the call goes to a server in Hawaii, copying the initial values from here to Hawaii is a waste of bandwidth. A similar snippet using ref:</p>

<pre><code>string a = String.Empty, b = String.Empty;
person.GetBothNames(ref a, ref b);
</code></pre>

<p>could confuse readers, because it looks like the initial values of a and b are relevant (though the method name would indicate they are not).</p>

<p>Example for <code>ref</code>:</p>

<pre><code>string name = textbox.Text;
bool didModify = validator.SuggestValidName(ref name);
</code></pre>

<p>Here the initial value is relevant to the method.</p>
","1516890"
"Format an Excel column (or cell) as Text in C#?","155850","","<p>I am losing the leading zeros when I copy values from a datatable to an Excel sheet. That's because probably Excel treats the values as a number instead of text.</p>

<p>I created the worksheet in C# and I am copying the values like so:</p>

<pre><code>myWorksheet.Cells[i + 2, j] = dtCustomers.Rows[i][j - 1].ToString();
</code></pre>

<p>How do I format a whole column or each cell as Text? A related question, how to cast <code>myWorksheet.Cells[i + 2, j]</code>  to show a style property in Intellisense? </p>
","<p>Below is some code to format columns A and C as text in <a href=""http://www.spreadsheetgear.com/"" rel=""noreferrer"">SpreadsheetGear for .NET</a> which has an API which is similar to Excel - except for the fact that SpreadsheetGear is frequently more strongly typed. It should not be too hard to figure out how to convert this to work with Excel / COM:</p>

<pre><code>IWorkbook workbook = Factory.GetWorkbook();
IRange cells = workbook.Worksheets[0].Cells;
// Format column A as text.
cells[""A:A""].NumberFormat = ""@"";
// Set A2 to text with a leading '0'.
cells[""A2""].Value = ""01234567890123456789"";
// Format column C as text (SpreadsheetGear uses 0 based indexes - Excel uses 1 based indexes).
cells[0, 2].EntireColumn.NumberFormat = ""@"";
// Set C3 to text with a leading '0'.
cells[2, 2].Value = ""01234567890123456789"";
workbook.SaveAs(@""c:\tmp\TextFormat.xlsx"", FileFormat.OpenXMLWorkbook);
</code></pre>

<p>Disclaimer: I own SpreadsheetGear LLC</p>
","2068060"
"A circular reference was detected while serializing an object of type 'SubSonic.Schema .DatabaseColumn'.","155749","","<p>I am trying to do a simple JSON return but I am having issues I have the following below.</p>

<pre><code>public JsonResult GetEventData()
{
    var data = Event.Find(x =&gt; x.ID != 0);
    return Json(data);
}
</code></pre>

<p>I get a HTTP 500 with the exception as shown in the title of this question. I also tried</p>

<pre><code>var data = Event.All().ToList()
</code></pre>

<p>That gave the same problem.</p>

<p>Is this a bug or my implementation?</p>
","<p>It seems that there are circular references in your object hierarchy which is not supported by the JSON serializer. Do you need all the columns? You could pick up only the properties you need in the view:</p>

<pre><code>return Json(new 
{  
    PropertyINeed1 = data.PropertyINeed1,
    PropertyINeed2 = data.PropertyINeed2
});
</code></pre>

<p>This will make your JSON object lighter and easier to understand. If you have many properties, <a href=""http://www.codeplex.com/AutoMapper"" rel=""noreferrer"">AutoMapper</a> could be used to <a href=""http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/06/29/how-we-do-mvc-view-models.aspx"" rel=""noreferrer"">automatically</a> map between DTO objects and View objects.</p>
","1153396"
"How to check if a windows form is already open, and close it if it is?","155644","","<p>I have a form <strong>""fm""</strong> that is a simple info window that opens every 10 mins (<code>fm.Show();</code>).</p>

<p>How I can make that every 10 mins it will check if the form <strong>""fm""</strong> is open and if it is open it closes it and open it again!</p>

<p>Now the form fm is always created with <code>form fm = new form();</code><br>
so when I try to check if the form is open it will always be false and open a new window even if there is one form before!</p>

<p>I need to have a tool to give it a unique identity and then check if this form with unique identity is opened or not!</p>

<p>I do not want to just update the data on the form (fm), because I have a complicated info with buttons.</p>

<p>The form name is <code>""UpdateWindow""</code></p>

<p><strong>Solved using the following:</strong></p>

<pre><code>Form fc = Application.OpenForms[""UpdateWindow""]; 

if (fc != null) 
   fc.Close(); 

fc.Show();
</code></pre>
","<p>maybe this helps:</p>

<pre><code>FormCollection fc = Application.OpenForms;

foreach (Form frm in fc)
{
//iterate through
}
</code></pre>

<p>Some code in the foreach to detect the specific form and it could be done. Untested though.</p>

<p>Found on <a href=""http://bytes.com/topic/c-sharp/answers/591308-iterating-all-open-forms"" rel=""noreferrer"">http://bytes.com/topic/c-sharp/answers/591308-iterating-all-open-forms</a></p>
","3861622"
"JSON library for C#","155528","","<p>Does Microsoft provide any library to work with JSON in C#? If not, what open source library do you recommend?</p>
","<p><a href=""http://james.newtonking.com/pages/json-net.aspx"" rel=""noreferrer"">JSON.Net</a></p>
","1474395"
"Binding List<T> to DataGridView in WinForm","155484","","<p>I have a class</p>

<pre><code>class Person{
      public string Name {get; set;}
      public string Surname {get; set;}
}
</code></pre>

<p>and a <code>List&lt;Person&gt;</code> to which I add some items. The list is bound to my <code>DataGridView</code>.</p>

<pre><code>List&lt;Person&gt; persons = new List&lt;Person&gt;();
persons.Add(new Person(){Name=""Joe"", Surname=""Black""});
persons.Add(new Person(){Name=""Misha"", Surname=""Kozlov""});
myGrid.DataSource = persons;
</code></pre>

<p>There is no problem. <code>myGrid</code> displays two rows, but when I add new items to my <code>persons</code> list, <code>myGrid</code> does not show new updated list. It only shows the two rows which I added before.</p>

<p>So what is the problem?</p>

<p>Rebinding every time works well. But when I bind a <code>DataTable</code> to the grid when every time when I make some changes to <code>DataTable</code> there is not any need to ReBind <code>myGrid</code>.  </p>

<p>How to solve it without rebinding every time?</p>
","<p>List does not implement <code>IBindingList</code> so the grid does not know about your new items.</p>

<p>Bind your DataGridView to a <code>BindingList&lt;T&gt;</code> instead.</p>

<pre><code>var list = new BindingList&lt;Person&gt;(persons);
myGrid.DataSource = list;
</code></pre>

<p>But I would even go further and bind your grid to a <code>BindingSource</code></p>

<pre><code>var list = new List&lt;Person&gt;()
{
    new Person { Name = ""Joe"", },
    new Person { Name = ""Misha"", },
};
var bindingList = new BindingList&lt;Person&gt;(list);
var source = new BindingSource(bindingList, null);
grid.DataSource = source;
</code></pre>
","16695971"
"What is C# analog of C++ std::pair?","155474","","<p>I am interested what is C# analog of C++ std::pair? I have found System.Web.UI.Pair class, but wanted something template based.</p>

<p>Thank you!</p>
","<p>Tuples <a href=""http://msdn.microsoft.com/en-us/library/system.tuple(v=vs.110).aspx"" rel=""noreferrer"">are available since .NET4.0</a> and support generics:</p>

<pre><code>Tuple&lt;string, int&gt; t = new Tuple&lt;string, int&gt;(""Hello"", 4);
</code></pre>

<hr>

<p>In previous versions you can use <code>System.Collections.Generic.KeyValuePair&lt;K, V&gt;</code> or a solution like the following:</p>

<pre><code>public class Pair&lt;T, U&gt; {
    public Pair() {
    }

    public Pair(T first, U second) {
        this.First = first;
        this.Second = second;
    }

    public T First { get; set; }
    public U Second { get; set; }
};
</code></pre>

<p>And use it like this:</p>

<pre><code>Pair&lt;String, int&gt; pair = new Pair&lt;String, int&gt;(""test"", 2);
Console.WriteLine(pair.First);
Console.WriteLine(pair.Second);
</code></pre>

<p>This outputs:</p>

<pre><code>test
2
</code></pre>

<p>Or even this chained pairs:</p>

<pre><code>Pair&lt;Pair&lt;String, int&gt;, bool&gt; pair = new Pair&lt;Pair&lt;String, int&gt;, bool&gt;();
pair.First = new Pair&lt;String, int&gt;();
pair.First.First = ""test"";
pair.First.Second = 12;
pair.Second = true;

Console.WriteLine(pair.First.First);
Console.WriteLine(pair.First.Second);
Console.WriteLine(pair.Second);
</code></pre>

<p>That outputs:</p>

<pre><code>test
12
true
</code></pre>
","166094"
"Return anonymous type results?","155357","","<p>Using the simple example below, what is the best way to return results from multiple tables using Linq to SQL?</p>

<p>Say I have two tables:</p>

<pre><code>Dogs:   Name, Age, BreedId
Breeds: BreedId, BreedName
</code></pre>

<p>I want to return all dogs with their <code>BreedName</code>.  I should get all dogs using something like this with no problems:</p>

<pre><code>public IQueryable&lt;Dog&gt; GetDogs()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select d;
    return result;
}
</code></pre>

<p>But if I want dogs with breeds and try this I have problems:</p>

<pre><code>public IQueryable&lt;Dog&gt; GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new
                        {
                            Name = d.Name,
                            BreedName = b.BreedName
                        };
    return result;
}
</code></pre>

<p>Now I realize that the compiler won't let me return a set of anonymous types since it's expecting Dogs, but is there a way to return this without having to create a custom type?  Or do I have to create my own class for <code>DogsWithBreedNames</code> and specify that type in the select?  Or is there another easier way?</p>
","<p>I tend to go for this pattern:</p>

<pre><code>public class DogWithBreed
{
    public Dog Dog { get; set; }
    public string BreedName  { get; set; }
}

public IQueryable&lt;DogWithBreed&gt; GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new DogWithBreed()
                        {
                            Dog = d,
                            BreedName = b.BreedName
                        };
    return result;
}
</code></pre>

<p>It means you have an extra class, but it's quick and easy to code, easily extensible, reusable and type-safe.</p>
","534794"
"What is the C# Using block and why should I use it?","155313","","<p>What is the purpose of the Using block in C#? How is it different from a local variable?</p>
","<p>If the type implements IDisposable, it automatically disposes it.</p>

<p>Given:</p>

<pre><code>public class SomeDisposableType : IDisposable
{
   ...implmentation details...
}
</code></pre>

<p>These are equivalent:</p>

<pre><code>SomeDisposableType t = new SomeDisposableType();
try {
    OperateOnType(t);
}
finally {
   t.Dispose();
}
</code></pre>

<p> </p>

<pre><code>using (SomeDisposableType u = new SomeDisposableType()) {
    OperateOnType(u);
}
</code></pre>

<p>The second is easier to read and maintain.</p>
","212210"
"Can I convert long to int?","155212","","<p>I want to convert <code>long</code> to <code>int</code>. </p>

<p>If the value of <code>long</code> > <code>int.MaxValue</code>, I am happy to let it wrap around. </p>

<p>What is the best way?</p>
","<p>Just do <code>(int)myLongValue</code>. It'll do exactly what you want (discarding MSBs and taking LSBs) in <code>unchecked</code> context (which is the compiler default). It'll throw <code>OverflowException</code> in <code>checked</code> context if the value doesn't fit in an <code>int</code>:</p>

<pre><code>int myIntValue = unchecked((int)myLongValue);
</code></pre>
","858909"
"Getting value of selected item in list box as string","155210","","<p>I am trying to get the value of the selected item in the listbox using the code below, but it is always returning null string.</p>

<pre><code>DataSet ds = searchforPrice(Convert.ToString(listBox1.SelectedItem));
</code></pre>

<p>Here I am trying to pass the value of selected item as string to method searchforPrice to retrive dataset from the database.</p>

<p>How can i retrive the value of selected item as string?</p>

<p>I am adding items to listbox from combo box which in turn loads the items from the database.</p>

<pre><code> listBox1.Items.Add(comboBox2.Text);
</code></pre>

<p><img src=""https://i.stack.imgur.com/bPNrK.png"" alt=""enter image description here""></p>

<p>Anybody has answer for this..</p>
","<p>If you want to retrieve the display text of the item, use the <a href=""http://msdn.microsoft.com/fr-fr/library/system.windows.forms.listcontrol.getitemtext.aspx""><code>GetItemText</code></a> method:</p>

<pre><code>string text = listBox1.GetItemText(listBox1.SelectedItem);
</code></pre>
","15003160"
"Best C# API to create PDF","154994","","<p>Can you recomend any PDF API for C#. Free is the best, but i dont mind paying for it.</p>
","<p><strong>Update:</strong></p>

<p>I'm not sure when or if the license changed for the <a href=""https://github.com/itext/itextsharp"" rel=""nofollow noreferrer"">iText# library</a>, but it is licensed under <a href=""https://github.com/itext/itextsharp/blob/develop/LICENSE.md"" rel=""nofollow noreferrer"">AGPL</a> which means it must be licensed if included with a closed-source product. The question does not (currently) require free or open-source libraries. One should always investigate the license type of any library used in a project.</p>

<hr>

<p>I have used <a href=""https://github.com/itext/itextsharp"" rel=""nofollow noreferrer"">iText#</a> with success in .NET C# 3.5; it is a port of the open source Java library for PDF generation and it's free.</p>

<p>There is a <a href=""https://www.nuget.org/packages/itextsharp/"" rel=""nofollow noreferrer"">NuGet package</a> available for iTextSharp version 5 and the <a href=""http://developers.itextpdf.com/developers-home"" rel=""nofollow noreferrer"">official developer documentation</a>, as well as C# <a href=""http://developers.itextpdf.com/examples-itext5"" rel=""nofollow noreferrer"">examples</a>, can be found at itextpdf.com</p>
","2937805"
"How to auto resize and adjust Form controls with change in resolution","154866","","<p>I have noticed that some applications change their controls position to adjust them as much as possible in the resolution as possible, If window is maximized they set themselves in such a way that over all GUI looks balanced.
My question is that is it possible to make or implement this functionality in Visual studio 2010 C#?</p>
","<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx"" rel=""noreferrer"">Dock</a> and <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.control.anchor.aspx"" rel=""noreferrer"">Anchor</a> properties.  <a href=""http://www.techrepublic.com/article/manage-winform-controls-using-the-anchor-and-dock-properties/"" rel=""noreferrer"">Here</a> is a good article.  Note that these will handle changes when maximizing/minimizing.  That is a little different that if the screen resolution changes, but it will be along the same idea.</p>
","4248705"
"How to convert char to int?","154701","","<p>What is the proper way to convert a <code>char</code> to <code>int</code>?
This gives <code>49</code>:</p>

<pre><code>int val = Convert.ToInt32('1');
//int val = Int32.Parse(""1""); // Works
</code></pre>

<p>I don't want to convert to string and then parse it.</p>
","<p>I'm surprised nobody has mentioned the static method built right into <code>System.Char</code>...</p>

<pre><code>int val = (int)Char.GetNumericValue('8');
// val == 8
</code></pre>
","3666138"
"How can I validate a string to only allow alphanumeric characters in it?","154693","","<p>How can I validate a string using Regular Expressions to only allow alphanumeric characters in it?</p>

<p>(I don't want to allow for any spaces either).</p>
","<p>Use the expression:</p>

<pre><code>^[a-zA-Z0-9]*$
</code></pre>

<p>ie:
    using System.Text.RegularExpressions;</p>

<pre><code>Regex r = new Regex(""^[a-zA-Z0-9]*$"");
if (r.IsMatch(SomeString)) {
  ...
}
</code></pre>
","1046743"
"Wait one second in running program","154678","","<pre><code>dataGridView1.Rows[x1].Cells[y1].Style.BackColor = System.Drawing.Color.Red;
System.Threading.Thread.Sleep(1000);
</code></pre>

<p>İ want to wait one second before printing my grid cells with this code, but it isn't working. What can i do?</p>
","<p>Is it pausing, but you don't see your red color appear in the cell?  Try this:</p>

<pre><code>dataGridView1.Rows[x1].Cells[y1].Style.BackColor = System.Drawing.Color.Red;
dataGridView1.Refresh();
System.Threading.Thread.Sleep(1000);
</code></pre>
","10458135"
"Create web service proxy in Visual Studio from a WSDL file","154613","","<p>My application needs to talk to a web service that hasn't got an online WSDL definition. The developers however supplied me with a WSDL file.</p>

<p>With a public WSDL Visual Studio can generate this code for me using the Service Reference wizard. But it doesn't seem to work without a public WSDL.</p>

<p>How do I generate the code for talking to this web service using this WSDL file?</p>
","<p>Try using <a href=""http://msdn.microsoft.com/en-us/library/7h3ystb6%28VS.80%29.aspx"" rel=""noreferrer"">WSDL.exe</a> and then including the generated file (.cs) into your project.</p>

<p>Fire up the Visual Studio Command prompt (under visual studio/tools in the start menu) then type</p>

<pre><code>&gt;wsdl.exe [path To Your WSDL File]
</code></pre>

<p>That'll spit out a file, which you copy/move and include in your project. That file contains a class which is a proxy to your sevice, Fire up an instance of that class, and it'll have a URL property you can set on the fly, and a bunch of methods that you can call. It'll also generate classes for all/any complex objects passed across the service interface.</p>
","4304356"
"GridView must be placed inside a form tag with runat=""server"" even after the GridView is within a form tag","154601","","<pre><code>&lt;form runat=""server"" id=""f1""&gt;
    &lt;div runat=""server"" id=""d""&gt;
        grid view:
        &lt;asp:GridView runat=""server"" ID=""g""&gt;
        &lt;/asp:GridView&gt;
    &lt;/div&gt;

    &lt;asp:TextBox runat=""server"" ID=""t"" TextMode=""MultiLine"" Rows=""20"" Columns=""50""&gt;&lt;/asp:TextBox&gt;
&lt;/form&gt;
</code></pre>

<p>Code behind:</p>

<pre><code>public partial class ScriptTest : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        g.DataSource = new string[] { ""a"", ""b"", ""c"" };
        g.DataBind();

        TextWriter tw = new StringWriter();
        HtmlTextWriter h = new HtmlTextWriter(tw);    
        d.RenderControl(h);
        t.Text = tw.ToString();
    }
}
</code></pre>

<p>Even the GridView is within a from tag with runat=""server"", still I am getting this error.</p>

<p>Any clues please ?</p>
","<p>You are calling <code>GridView.RenderControl(htmlTextWriter)</code>, hence the page raises an exception that a Server-Control was rendered outside of a Form. </p>

<p>You could avoid this execption by overriding <a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.page.verifyrenderinginserverform.aspx"" rel=""noreferrer"">VerifyRenderingInServerForm</a></p>

<pre><code>public override void VerifyRenderingInServerForm(Control control)
{
  /* Confirms that an HtmlForm control is rendered for the specified ASP.NET
     server control at run time. */
}
</code></pre>

<p>See <a href=""http://forums.asp.net/t/1016960.aspx/1?Problem%20with%20GridView%20s%20RenderControl"" rel=""noreferrer"">here</a> and <a href=""http://aspalliance.com/771_CodeSnip_Exporting_GridView_to_Excel"" rel=""noreferrer"">here</a>.</p>
","6343859"
"How to open the second form?","154470","","<p>I have Form1 and Form2 in my project. Form2 is just a form with settings for Form1. What is the command to open the Form2 from the Form1 and also what's the command to close it please?</p>
","<p>You need to handle an <em>event</em> on Form1 that is raised as a result of user interaction. For example, if you have a ""Settings"" button that the user clicks in order to show the settings form (Form2), you should handle the <code>Click</code> event for that button:</p>

<pre><code>private void settingsButton_Click(Object sender, EventArgs e)
{
    // Create a new instance of the Form2 class
    Form2 settingsForm = new Form2();

    // Show the settings form
    settingsForm.Show();
}
</code></pre>

<p>In addition to the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.show.aspx"" rel=""noreferrer""><code>Show</code> method</a>, you could also choose to use the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.showdialog.aspx"" rel=""noreferrer""><code>ShowDialog</code> method</a>. The difference is that the latter shows the form as a <em>modal dialog</em>, meaning that the user cannot interact with the other forms in your application until they close the modal form. This is the same way that a message box works. The <code>ShowDialog</code> method also returns a value indicating how the form was closed. </p>

<hr>

<p>When the user closes the settings form (by clicking the ""X"" in the title bar, for example), Windows will automatically take care of closing it.</p>

<p>If you want to close it yourself before the user asks to close it, you can call the form's <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.close.aspx"" rel=""noreferrer""><code>Close</code> method</a>:</p>

<pre><code>this.Close();
</code></pre>
","5718233"
"Number of occurrences of a character in a string","154352","","<p>I am trying to get the number of occurrences of a certain character such as <code>&amp;</code> in the following string.</p>

<pre><code>string test = ""key1=value1&amp;key2=value2&amp;key3=value3"";
</code></pre>

<p>How do I determine that there are 2 ampersands (&amp;) in the above test string variable?</p>
","<p>You could do this:</p>

<pre><code>int count = test.Split('&amp;').Length - 1;
</code></pre>

<p>Or with LINQ:</p>

<pre><code>test.Count(x =&gt; x == '&amp;');
</code></pre>
","10391499"
"Creating a LINQ select from multiple tables","154327","","<p>This query works great:</p>

<pre><code>var pageObject = (from op in db.ObjectPermissions
                  join pg in db.Pages on op.ObjectPermissionName equals page.PageName
                  where pg.PageID == page.PageID
                  select op)
                 .SingleOrDefault();
</code></pre>

<p>I get a new type with my 'op' fields.  Now I want to retrieve my 'pg' fields as well, but</p>

<pre><code>select op, pg).SingleOrDefault();
</code></pre>

<p>doesn't work.</p>

<p>How can I select everything from both tables so that they appear in my new pageObject type?</p>
","<p>You can use anonymous types for this, i.e.:</p>

<pre><code>var pageObject = (from op in db.ObjectPermissions
                  join pg in db.Pages on op.ObjectPermissionName equals page.PageName
                  where pg.PageID == page.PageID
                  select new { pg, op }).SingleOrDefault();
</code></pre>

<p>This will make pageObject into an IEnumerable of an anonymous type so AFAIK you won't be able to pass it around to other methods, however if you're simply obtaining data to play with in the method you're currently in it's perfectly fine. You can also name properties in your anonymous type, i.e.:-</p>

<pre><code>var pageObject = (from op in db.ObjectPermissions
                  join pg in db.Pages on op.ObjectPermissionName equals page.PageName
                  where pg.PageID == page.PageID
                  select new
                  {
                      PermissionName = pg, 
                      ObjectPermission = op
                  }).SingleOrDefault();
</code></pre>

<p>This will enable you to say:-</p>

<pre><code>if (pageObject.PermissionName.FooBar == ""golden goose"") Application.Exit();
</code></pre>

<p>For example :-)</p>
","32465"
"Check/Uncheck a checkbox on datagridview","154260","","<p>Can someone help me why it doesn't work?
I have a <code>checkbox</code> and if I click on it, 
this should uncheck all the checkbox inside the datagridview which were checked before including the user selected checkbox.</p>

<p>Here is the code:</p>

<pre><code>        private void chkItems_CheckedChanged(object sender, EventArgs e)
        {
            foreach (DataGridViewRow row in datagridview1.Rows)
            {
                DataGridViewCheckBoxCell chk = (DataGridViewCheckBoxCell)row.Cells[1];
                if (chk.Selected == true)
                {
                    chk.Selected = false;
                }
                else
                {
                    chk.Selected = true;
                }
            }
        }
</code></pre>

<p>the checkbox should not be selected. it should be checked.</p>

<p>here is the added column</p>

<pre><code>            DataGridViewCheckBoxColumn CheckboxColumn = new DataGridViewCheckBoxColumn();
            CheckBox chk = new CheckBox();
            CheckboxColumn.Width = 20;
            datagridview1.Columns.Add(CheckboxColumn);
</code></pre>
","<p>Looking at this <a href=""http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/74df79a9-87ad-4cec-8502-3a357015558d"">MSDN Forum Posting</a> it suggests comparing the Cell's value with  <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcheckboxcell.truevalue.aspx"">Cell.TrueValue</a>.</p>

<p>So going by its example your code should looks something like this:(<em>this is completely untested</em>)</p>

<p>Edit: it seems that the Default for Cell.TrueValue for an Unbound DataGridViewCheckBox is null you will need to set it in the Column definition.</p>

<pre><code>private void chkItems_CheckedChanged(object sender, EventArgs e)
{
    foreach (DataGridViewRow row in dataGridView1.Rows)
    {
        DataGridViewCheckBoxCell chk = (DataGridViewCheckBoxCell)row.Cells[1];
        if (chk.Value  == chk.TrueValue)
        {
            chk.Value = chk.FalseValue;
        }
        else
        {
            chk.Value = chk.TrueValue;
        }
    }
}
</code></pre>

<hr>

<p>This code is working note setting the TrueValue and FalseValue in the Constructor plus also checking for null:</p>

<pre><code>public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        DataGridViewCheckBoxColumn CheckboxColumn = new DataGridViewCheckBoxColumn();
        CheckboxColumn.TrueValue = true;
        CheckboxColumn.FalseValue = false;
        CheckboxColumn.Width = 100;
        dataGridView1.Columns.Add(CheckboxColumn);
        dataGridView1.Rows.Add(4);
    }

    private void chkItems_CheckedChanged(object sender, EventArgs e)
    {
        foreach (DataGridViewRow row in dataGridView1.Rows)
        {
            DataGridViewCheckBoxCell chk = (DataGridViewCheckBoxCell)row.Cells[0];
            if (chk.Value == chk.FalseValue || chk.Value == null)
            {
                chk.Value = chk.TrueValue;
            }
            else
            {
                chk.Value = chk.FalseValue;
            }

        }
        dataGridView1.EndEdit();
    }
}
</code></pre>
","13339133"
"Most efficient way to concatenate strings?","154253","","<p>What's the most efficient way to concatenate strings?</p>
","<p>The <code>StringBuilder.Append()</code> method is much better than using the + operator.  But I've found that, when executing 1000 concatenations or less, <code>String.Join()</code> is even more efficient than <code>StringBuilder</code>.</p>

<pre><code>StringBuilder sb = new StringBuilder();
sb.Append(someString);
</code></pre>

<p>The only problem with <code>String.Join</code> is that you have to concatenate the strings with a common delimiter.  (Edit:) as @ryanversaw pointed out, you can make the delimiter string.Empty.</p>

<pre><code>string key = String.Join(""_"", new String[] 
{ ""Customers_Contacts"", customerID, database, SessionID });
</code></pre>
","21093"
"Unable to read data from the transport connection : An existing connection was forcibly closed by the remote host","154247","","<p>I have a server app and sometimes, when the client tries to connect, I get the following error: </p>

<p><img src=""https://i.stack.imgur.com/z8LND.jpg"" alt=""enter image description here""></p>

<p><em>NOTE: the ""couldn't get stream from client or login failed"" is a text that's added by me in catch statement</em></p>

<p>and the line at which it stops ( sThread : line 96 ) is : </p>

<pre><code>tcpClient = (TcpClient)client;
clientStream = tcpClient.GetStream();
sr = new StreamReader(clientStream);
sw = new StreamWriter(clientStream);

// line 96:                 
a = sr.ReadLine();
</code></pre>

<p>What may be causing this problem? Note that it doesn't happen all the time</p>
","<p>This error usually means that the target machine is running, but the service that you're trying to connect to is not available.  (Either it stopped, crashed, or is busy with another request.)</p>

<p>In English:
The connection to the <em>machine</em> (remote host/server/PC that the service runs at) was made but since the service was not available <strong>on</strong> that machine, the machine didn't know what to do with the request.</p>

<p>If the connection to the machine was not available, you'd see a different error.  I forget what it is, but it's along the lines of ""Service Unreachable""  or ""Unavailable"".</p>

<p><strong>Edit - added</strong></p>

<p>It IS possible that this is being caused by a firewall blocking the port, but given that you say it's intermittent (""sometimes when the client tries to connect""), that's very unlikely.  I didn't include that originally because I had ruled it out mentally before replying.</p>
","5420788"
"How do you convert epoch time in C#?","154227","","<p>How do you convert Unix <a href=""http://en.wikipedia.org/wiki/Unix_time"" rel=""noreferrer"">epoch time</a> into real time in C#? (Epoch beginning 1/1/1970)</p>
","<p>I presume that you mean <a href=""http://en.wikipedia.org/wiki/Unix_time"" rel=""noreferrer"">Unix time</a>, which is defined as the number of seconds since midnight (UTC) on 1st January 1970.</p>

<pre><code>public static DateTime FromUnixTime(long unixTime)
{
    return epoch.AddSeconds(unixTime);
}
private static readonly DateTime epoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);
</code></pre>
","2883645"
"WPF checkbox binding","154177","","<p>While it is trivial to store a checkbox's checked state in a variable using the checkbox's Click event, how would I do it via databinding?  All the examples I have found have the UI updated from some datasource, or bind one control to another; I want to update a member variable when the checkbox is clicked.</p>

<p>TIA for any pointers...</p>
","<p>You need a dependency property for this:</p>

<pre><code>public BindingList&lt;User&gt; Users
    {
        get { return (BindingList&lt;User&gt;)GetValue(UsersProperty); }
        set { SetValue(UsersProperty, value); }
    }

public static readonly DependencyProperty UsersProperty =
    DependencyProperty.Register(""Users"", typeof(BindingList&lt;User&gt;), 
      typeof(OptionsDialog));
</code></pre>

<p>Once that is done, you bind the checkbox to the dependency property:</p>

<pre><code>&lt;CheckBox x:Name=""myCheckBox"" IsChecked=""{Binding ElementName=window1,
     Path=CheckBoxIsChecked}"" /&gt;
</code></pre>

<p>For that to work you have to name your Window or UserControl in its openning tag, and use that name in the ElementName parameter.</p>

<p>With this code, whenever you change the property on the code side, you will change the textbox. Also, whenever you check/uncheck the textbox, the Dependency Property will change too.</p>

<p>EDIT:</p>

<p>An easy way to create a dependency property is typing the snippet propdp, which will give you the general code for Dependency Properties.</p>

<p>All the code:</p>

<p>XAML:</p>

<pre><code>&lt;Window x:Class=""StackOverflowTests.Window1""
    xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
    xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""
    Title=""Window1"" x:Name=""window1"" Height=""300"" Width=""300""&gt;
    &lt;Grid&gt;
     &lt;StackPanel Orientation=""Vertical""&gt;
         &lt;CheckBox Margin=""10"" x:Name=""myCheckBox"" 
               IsChecked=""{Binding ElementName=window1, Path=IsCheckBoxChecked}""
               &gt;Bound CheckBox&lt;/CheckBox&gt;
         &lt;Label Content=""{Binding ElementName=window1, Path=IsCheckBoxChecked}"" 
               ContentStringFormat=""Is checkbox checked? {0}""&gt;&lt;/Label&gt;
      &lt;/StackPanel&gt;     
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>

<p>C#:</p>

<pre><code>using System.Windows;

namespace StackOverflowTests
{
    /// &lt;summary&gt;
    /// Interaction logic for Window1.xaml
    /// &lt;/summary&gt;
    public partial class Window1 : Window
    {
        public bool IsCheckBoxChecked
        {
           get { return (bool)GetValue(IsCheckBoxCheckedProperty); }
           set { SetValue(IsCheckBoxCheckedProperty, value); }
        }

       // Using a DependencyProperty as the backing store for 
         //IsCheckBoxChecked.  This enables animation, styling, binding, etc...
       public static readonly DependencyProperty IsCheckBoxCheckedProperty =
           DependencyProperty.Register(""IsCheckBoxChecked"", typeof(bool), 
             typeof(Window1), new UIPropertyMetadata(false));

      public Window1()
      {             
            InitializeComponent();
      }
    }
}
</code></pre>

<p>Notice how the only code behind is the Dependency Property. Both the label and the checkbox are bound to it. If the checkbox changes, the label changes too.</p>
","870743"
"Control cannot fall through from one case label","154107","","<p>I am trying to write a switch statement that would type the search term in the search field depending on whichever search textbox is present. I have the following code. But I am getting a ""Control cannot fall through from one case label"" error. Please let me know how to fix this. Thanks in advance!</p>

<pre><code>switch (searchType)
{
case ""SearchBooks"":
    Selenium.Type(""//*[@id='SearchBooks_TextInput']"", searchText);
    Selenium.Click(""//*[@id='SearchBooks_SearchBtn']"");

case ""SearchAuthors"":
    Selenium.Type(""//*[@id='SearchAuthors_TextInput']"", searchText);
    Selenium.Click(""//*[@id='SearchAuthors_SearchBtn']"");
}
</code></pre>

<blockquote>
  <p>Control cannot fall through from one case label ('case ""SearchBooks"":') to another</p>
  
  <p>Control cannot fall through from one case label ('case ""SearchAuthors"":') to another</p>
</blockquote>
","<p>You missed some breaks there:</p>

<pre><code>switch (searchType)
{
    case ""SearchBooks"":
        Selenium.Type(""//*[@id='SearchBooks_TextInput']"", searchText);
        Selenium.Click(""//*[@id='SearchBooks_SearchBtn']"");
        break;

    case ""SearchAuthors"":
        Selenium.Type(""//*[@id='SearchAuthors_TextInput']"", searchText);
        Selenium.Click(""//*[@id='SearchAuthors_SearchBtn']"");
        break;
}
</code></pre>

<p>Without them, the compiler thinks you're trying to execute the lines below <code>case ""SearchAuthors"":</code> immediately after the lines under <code>case ""SearchBooks"":</code> have been executed, which isn't allowed in C#.</p>

<p>By adding the <code>break</code> statements at the end of each case, the program exits each case after it's done, for whichever value of <code>searchType</code>.</p>
","6696709"
"Freely convert between List<T> and IEnumerable<T>","154101","","<p>How can I convert a <code>List&lt;MyObject&gt;</code> to an <code>IEnumerable&lt;MyObject&gt;</code> and then back again?</p>

<p>I want to do this in order to run a series of LINQ statements on the List, e. g. <code>Sort()</code></p>
","<pre><code>List&lt;string&gt; myList = new List&lt;string&gt;();
IEnumerable&lt;string&gt; myEnumerable = myList;
List&lt;string&gt; listAgain = myEnumerable.ToList();
</code></pre>
","472671"
"How do I fix a .NET windows application crashing at startup with Exception code: 0xE0434352?","154001","","<p>I've built a .NET <a href=""http://en.wikipedia.org/wiki/Windows_Forms"" rel=""noreferrer"">Windows Forms</a> application in Visual Studio 2010. I also built a corresponding setup/install package via Visual&nbsp;Studio&nbsp;2010. This is built as a 32-bit (x86) application. (We make use of third-party Windows Forms controls that are 32-bit only).</p>

<p>I am able to run the setup package and deploy successfully to other Windows&nbsp;7 64-bit environments and 32 bit Windows&nbsp;XP boxes. The installed application runs fine on these.</p>

<p>However, when I attempt to run <a href=""http://en.wikipedia.org/wiki/Windows_Server_2008"" rel=""noreferrer"">Windows Server 2008</a> R2 - 64 bit, the application crashes at startup. It installed successfully via the installer without any errors.</p>

<p>It appears to crash when loading the application. I put a message box as the first line in the application to see if it got past loading. The message box doesn't show up, so I assume that it occurs during loading/init of the application.</p>

<p>So far I haven't found much to go on. From the Details I see the following:</p>

<pre><code>Exception Code: E0434352
</code></pre>

<p>I've fished around/googled to see if there was anything obvious, but I saw nothing. I saw some references to a possible stack overflow in the <a href=""http://en.wikipedia.org/wiki/Common_Language_Runtime"" rel=""noreferrer"">CLR</a>.</p>

<p>The Windows Forms application is built with the following references:</p>

<ul>
<li>DevExpress</li>
<li>Infragistics Winforms controls</li>
<li>ORACLE DataAccess DLL</li>
<li>RabbitMQ</li>
</ul>

<p>What is the issue?
How do I approach figuring this out?
How do I debug to get more useful information?</p>
","<p>0xE0434352 is <a href=""http://ig2600.blogspot.com/2011/01/why-do-i-keep-getting-exception-code.html"">the exception code for all .NET exceptions</a> so that won't tell you much. How did you got this exception code? The event log?</p>

<p>Your best bet is to use a debugger to get more information. If the Visual Studio debugger won't help you, then you might need to check out <a href=""http://en.wikipedia.org/wiki/WinDbg"">WinDbg</a> with <a href=""http://SOS.dll%20(SOS%20Debugging%20Extension)"">SOS</a>. See <a href=""http://blog.coryfoy.com/2010/02/debugging-net-applications-with-windbg-and-sos/"">here</a> and <a href=""http://ig2600.blogspot.com/2009/07/finding-clr-exceptions-with-visual.html"">here</a> for an introduction. Let it break on the exception, and see if you can get more information on the why.</p>

<p>If you suspect it is an issue when loading assemblies you might want to check out the <a href=""http://msdn.microsoft.com/en-us/library/e74a18c4%28v=VS.100%29.aspx"">Fusion Log</a>.</p>
","6245146"
"Download file from an ASP.NET Web API method using AngularJS","153970","","<p>In my Angular JS project, I've an <code>&lt;a&gt;</code> anchor tag, which when clicked makes an HTTP <code>GET</code> request to a WebAPI method that returns a file. </p>

<p>Now, I want the file to be downloaded to the user once the request is successful. How do I do that?</p>

<p>The anchor tag: </p>

<pre><code>&lt;a href=""#"" ng-click=""getthefile()""&gt;Download img&lt;/a&gt;
</code></pre>

<p>AngularJS:</p>

<pre><code>$scope.getthefile = function () {        
    $http({
        method: 'GET',
        cache: false,
        url: $scope.appPath + 'CourseRegConfirm/getfile',            
        headers: {
            'Content-Type': 'application/json; charset=utf-8'
        }
    }).success(function (data, status) {
        console.log(data); // Displays text data if the file is a text file, binary if it's an image            
        // What should I write here to download the file I receive from the WebAPI method?
    }).error(function (data, status) {
        // ...
    });
}
</code></pre>

<p>My WebAPI method:</p>

<pre class=""lang-cs prettyprint-override""><code>[Authorize]
[Route(""getfile"")]
public HttpResponseMessage GetTestFile()
{
    HttpResponseMessage result = null;
    var localFilePath = HttpContext.Current.Server.MapPath(""~/timetable.jpg"");

    if (!File.Exists(localFilePath))
    {
        result = Request.CreateResponse(HttpStatusCode.Gone);
    }
    else
    {
        // Serve the file to the client
        result = Request.CreateResponse(HttpStatusCode.OK);
        result.Content = new StreamContent(new FileStream(localFilePath, FileMode.Open, FileAccess.Read));
        result.Content.Headers.ContentDisposition = new System.Net.Http.Headers.ContentDispositionHeaderValue(""attachment"");
        result.Content.Headers.ContentDisposition.FileName = ""SampleImg"";                
    }

    return result;
}
</code></pre>
","<p>Support for downloading binary files in using ajax is not great, it is very much still <a href=""http://caniuse.com/#search=blob"">under development as working drafts</a>. </p>

<h1>Simple download method:</h1>

<p>You can have the browser download the requested file simply by using the code below, and this is supported in all browsers, and will obviously trigger the WebApi request just the same.</p>

<pre class=""lang-js prettyprint-override""><code>$scope.downloadFile = function(downloadPath) { 
    window.open(downloadPath, '_blank', '');  
}
</code></pre>

<h1>Ajax binary download method:</h1>

<p>Using ajax to download the binary file can be done in some browsers and below is an implementation that will work in the latest flavours of Chrome, Internet Explorer, FireFox and Safari.</p>

<p>It uses an <code>arraybuffer</code> response type, which is then converted into a JavaScript <code>blob</code>, which is then either presented to save using the <code>saveBlob</code> method - though this is only currently present in Internet Explorer - or turned into a blob data URL which is opened by the browser, triggering the download dialog if the mime type is supported for viewing in the browser.</p>

<h3>Internet Explorer 11 Support (Fixed)</h3>

<p><em>Note: Internet Explorer 11 did not like using the <code>msSaveBlob</code> function if it had been aliased - perhaps a security feature, but more likely a flaw, So using <code>var saveBlob = navigator.msSaveBlob || navigator.webkitSaveBlob ... etc.</code> to determine the available <code>saveBlob</code> support caused an exception; hence why the code below now tests for <code>navigator.msSaveBlob</code> separately. Thanks? Microsoft</em></p>

<pre class=""lang-js prettyprint-override""><code>// Based on an implementation here: web.student.tuwien.ac.at/~e0427417/jsdownload.html
$scope.downloadFile = function(httpPath) {
    // Use an arraybuffer
    $http.get(httpPath, { responseType: 'arraybuffer' })
    .success( function(data, status, headers) {

        var octetStreamMime = 'application/octet-stream';
        var success = false;

        // Get the headers
        headers = headers();

        // Get the filename from the x-filename header or default to ""download.bin""
        var filename = headers['x-filename'] || 'download.bin';

        // Determine the content type from the header or default to ""application/octet-stream""
        var contentType = headers['content-type'] || octetStreamMime;

        try
        {
            // Try using msSaveBlob if supported
            console.log(""Trying saveBlob method ..."");
            var blob = new Blob([data], { type: contentType });
            if(navigator.msSaveBlob)
                navigator.msSaveBlob(blob, filename);
            else {
                // Try using other saveBlob implementations, if available
                var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;
                if(saveBlob === undefined) throw ""Not supported"";
                saveBlob(blob, filename);
            }
            console.log(""saveBlob succeeded"");
            success = true;
        } catch(ex)
        {
            console.log(""saveBlob method failed with the following exception:"");
            console.log(ex);
        }

        if(!success)
        {
            // Get the blob url creator
            var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;
            if(urlCreator)
            {
                // Try to use a download link
                var link = document.createElement('a');
                if('download' in link)
                {
                    // Try to simulate a click
                    try
                    {
                        // Prepare a blob URL
                        console.log(""Trying download link method with simulated click ..."");
                        var blob = new Blob([data], { type: contentType });
                        var url = urlCreator.createObjectURL(blob);
                        link.setAttribute('href', url);

                        // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)
                        link.setAttribute(""download"", filename);

                        // Simulate clicking the download link
                        var event = document.createEvent('MouseEvents');
                        event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
                        link.dispatchEvent(event);
                        console.log(""Download link method with simulated click succeeded"");
                        success = true;

                    } catch(ex) {
                        console.log(""Download link method with simulated click failed with the following exception:"");
                        console.log(ex);
                    }
                }

                if(!success)
                {
                    // Fallback to window.location method
                    try
                    {
                        // Prepare a blob URL
                        // Use application/octet-stream when using window.location to force download
                        console.log(""Trying download link method with window.location ..."");
                        var blob = new Blob([data], { type: octetStreamMime });
                        var url = urlCreator.createObjectURL(blob);
                        window.location = url;
                        console.log(""Download link method with window.location succeeded"");
                        success = true;
                    } catch(ex) {
                        console.log(""Download link method with window.location failed with the following exception:"");
                        console.log(ex);
                    }
                }

            }
        }

        if(!success)
        {
            // Fallback to window.open method
            console.log(""No methods worked for saving the arraybuffer, using last resort window.open"");
            window.open(httpPath, '_blank', '');
        }
    })
    .error(function(data, status) {
        console.log(""Request failed with status: "" + status);

        // Optionally write the error out to scope
        $scope.errorDetails = ""Request failed with status: "" + status;
    });
};
</code></pre>

<h2>Usage:</h2>

<pre class=""lang-js prettyprint-override""><code>var downloadPath = ""/files/instructions.pdf"";
$scope.downloadFile(downloadPath);
</code></pre>

<h3>Notes:</h3>

<p>You should modify your WebApi method to return the following headers:</p>

<ul>
<li><p>I have used the <code>x-filename</code> header to send the filename. This is a custom header for convenience, you could however extract the filename from the <code>content-disposition</code> header using regular expressions.</p></li>
<li><p>You should set the <code>content-type</code> mime header for your response too, so the browser knows the data format.</p></li>
</ul>

<p>I hope this helps.</p>
","24129082"
"Remove file extension from a file name string","153966","","<p>If I have a string saying <code>""abc.txt""</code>, is there a quick way to get a substring that is just <code>""abc""</code>?</p>

<p>I can't do an <code>fileName.IndexOf('.')</code> because the file name could be <code>""abc.123.txt""</code> or something and I obviously just want to get rid of the extension (i.e. <code>""abc.123""</code>).</p>
","<p>The <a href=""http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx"" rel=""noreferrer""><code>Path.GetFileNameWithoutExtension</code></a> method gives you the filename you pass as an argument without the extension, as should be obvious from the name.</p>
","7356223"
"Command to close an application of console?","153835","","<p>I need to close the console when the user selects a menu option.</p>

<p>I tried using <code>close()</code> but it did not work..</p>

<p>how can I do this?</p>
","<p><code>Environment.Exit</code> and <code>Application.Exit</code></p>

<p><code>Environment.Exit(0)</code> is cleaner.</p>

<p><a href=""http://geekswithblogs.net/mtreadwell/archive/2004/06/06/6123.aspx"">http://geekswithblogs.net/mtreadwell/archive/2004/06/06/6123.aspx</a></p>
","5682419"
"Hash and salt passwords in C#","153724","","<p>I was just going through one of DavidHayden's articles on <a href=""http://web.archive.org/web/20120413180026/http://davidhayden.com/blog/dave/archive/2004/02/16/157.aspx"" rel=""noreferrer"">Hashing User Passwords</a>.</p>

<p>Really I can't get what he is trying to achieve.</p>

<p>Here is his code:</p>

<pre><code>private static string CreateSalt(int size)
{
    //Generate a cryptographic random number.
    RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
    byte[] buff = new byte[size];
    rng.GetBytes(buff);

    // Return a Base64 string representation of the random number.
    return Convert.ToBase64String(buff);
}

private static string CreatePasswordHash(string pwd, string salt)
{
    string saltAndPwd = String.Concat(pwd, salt);
    string hashedPwd =
        FormsAuthentication.HashPasswordForStoringInConfigFile(
        saltAndPwd, ""sha1"");
    return hashedPwd;
}
</code></pre>

<p>Is there any other C# method for hashing passwords and adding salt to it?</p>
","<p>Actually this is kind of strange, with the string conversions - which the membership provider does to put them into config files. Hashes and salts are binary blobs, you don't need to convert them to strings unless you want to put them into text files. </p>

<p>In my book, <a href=""http://www.wrox.com/WileyCDA/WroxTitle/Beginning-ASP-NET-Security.productCd-0470743654.html"" rel=""noreferrer"">Beginning ASP.NET Security</a>, (oh finally, an excuse to pimp the book) I do the following</p>

<pre><code>static byte[] GenerateSaltedHash(byte[] plainText, byte[] salt)
{
  HashAlgorithm algorithm = new SHA256Managed();

  byte[] plainTextWithSaltBytes = 
    new byte[plainText.Length + salt.Length];

  for (int i = 0; i &lt; plainText.Length; i++)
  {
    plainTextWithSaltBytes[i] = plainText[i];
  }
  for (int i = 0; i &lt; salt.Length; i++)
  {
    plainTextWithSaltBytes[plainText.Length + i] = salt[i];
  }

  return algorithm.ComputeHash(plainTextWithSaltBytes);            
}
</code></pre>

<p>The salt generation is as the example in the question. You can convert text to byte arrays using <code>Encoding.UTF8.GetBytes(string)</code>. If you must convert a hash to its string representation you can use <code>Convert.ToBase64String</code> and <code>Convert.FromBase64String</code> to convert it back.</p>

<p>You should note that you cannot use the equality operator on byte arrays, it checks references and so you should simply loop through both arrays checking each byte thus</p>

<pre><code>public static bool CompareByteArrays(byte[] array1, byte[] array2)
{
  if (array1.Length != array2.Length)
  {
    return false;
  }

  for (int i = 0; i &lt; array1.Length; i++)
  {
    if (array1[i] != array2[i])
    {
      return false;
    }
  }

  return true;
}
</code></pre>

<p><strong>Always</strong> use a new salt per password. Salts do not have to be kept secret and can be stored alongside the hash itself.</p>
","2138588"
"Check if a string contains an element from a list (of strings)","153668","","<p>For the following block of code:</p>

<pre><code>For I = 0 To listOfStrings.Count - 1
    If myString.Contains(lstOfStrings.Item(I)) Then
        Return True
    End If
Next
Return False
</code></pre>

<p>The output is:</p>

<p><strong>Case 1:</strong></p>

<pre class=""lang-none prettyprint-override""><code>myString: C:\Files\myfile.doc
listOfString: C:\Files\, C:\Files2\
Result: True
</code></pre>

<p><strong>Case 2:</strong></p>

<pre class=""lang-none prettyprint-override""><code>myString: C:\Files3\myfile.doc
listOfString: C:\Files\, C:\Files2\
Result: False
</code></pre>

<p>The list (listOfStrings) may contain several items (minimum 20) and it has to be checked against a thousands of strings (like myString).</p>

<p>Is there a better (more efficient) way to write this code?</p>
","<p>With LINQ, and using C# (I don't know VB much these days):</p>

<pre><code>bool b = listOfStrings.Any(s=&gt;myString.Contains(s));
</code></pre>

<p>or (shorter and more efficient, but arguably less clear):</p>

<pre><code>bool b = listOfStrings.Any(myString.Contains);
</code></pre>

<p>If you were testing equality, it would be worth looking at <code>HashSet</code> etc, but this won't help with partial matches unless you split it into fragments and add an order of complexity.</p>

<hr>

<p>update: if you really mean ""StartsWith"", then you could sort the list and place it into an array ; then use <code>Array.BinarySearch</code> to find each item - check by lookup to see if it is a full or partial match.</p>
","500930"
"An existing connection was forcibly closed by the remote host","153432","","<p>I am working with a commercial application which is throwing a SocketException with the message,</p>

<blockquote>
  <p>An existing connection was forcibly closed by the remote host</p>
</blockquote>

<p>This happens with a socket connection between client and server. The connection is alive and well, and heaps of data is being transferred, but it then becomes disconnected out of nowhere.</p>

<p>Has anybody seen this before? What could the causes be? I can kind of guess a few causes, but also is there any way to add more into this code to work out what the cause could be?</p>

<p>Any comments / ideas are welcome.</p>

<p>... The latest ...</p>

<p>I have some logging from some .NET tracing,</p>

<pre><code>System.Net.Sockets Verbose: 0 : [8188] Socket#30180123::Send() DateTime=2010-04-07T20:49:48.6317500Z

System.Net.Sockets Error: 0 : [8188] Exception in the Socket#30180123::Send - An existing connection was forcibly closed by the remote host DateTime=2010-04-07T20:49:48.6317500Z 

System.Net.Sockets Verbose: 0 : [8188] Exiting Socket#30180123::Send() -&gt; 0#0
</code></pre>

<p>Based on other parts of the logging I have seen the fact that it says '0#0' means a packet of 0 bytes length is being sent. But what does that really mean?</p>

<p>One of two possibilities is occuring, and I am not sure which,</p>

<p>1) The connection is being closed, but data is then being written to the socket, thus creating the exception above. The 0#0 simply means that nothing was sent because the socket was already closed.</p>

<p>2) The connection is still open, and a packet of zero bytes is being sent (i.e. the code has a bug) and the 0#0 means that a packet of zero bytes is trying to be sent.</p>

<p>What do you reckon? It might be inconclusive I guess, but perhaps someone else has seen this kind of thing?</p>
","<p>This generally means that the remote side closed the connection (usually by sending a TCP/IP <code>RST</code> packet). If you're working with a third-party application, the likely causes are:</p>

<ul>
<li>You are sending malformed data to the application</li>
<li>The network link between the client and server is going down for some reason</li>
<li>You have triggered a bug in the third-party application that caused it to crash</li>
<li>The third-party application has exhausted system resources</li>
</ul>

<p>It's likely that the first case is what's happening.</p>

<p>You can fire up <a href=""http://www.wireshark.org/"" rel=""noreferrer"">Wireshark</a> to see exactly what is happening on the wire to narrow down the problem.</p>

<p>Without more specific information, it's unlikely that anyone here can really help you much.</p>
","2582070"
"Enum ToString with user friendly strings","153423","","<p>My enum consists of the following values:</p>

<pre><code>private enum PublishStatusses{
    NotCompleted,
    Completed,
    Error
};
</code></pre>

<p>I want to be able to output these values in a user friendly way though.<br>
I don't need to be able to go from string to value again.  </p>
","<p>I use the <a href=""http://msdn.microsoft.com/en-us/library/system.componentmodel.descriptionattribute.aspx"" rel=""noreferrer""><code>Description</code></a> attribute from the System.ComponentModel namespace. Simply decorate the enum:</p>

<pre><code>private enum PublishStatusValue
{
    [Description(""Not Completed"")]
    NotCompleted,
    Completed,
    Error
};
</code></pre>

<p>Then use this code to retrieve it:</p>

<pre><code>public static string GetDescription&lt;T&gt;(this T enumerationValue)
    where T : struct
{
    Type type = enumerationValue.GetType();
    if (!type.IsEnum)
    {
        throw new ArgumentException(""EnumerationValue must be of Enum type"", ""enumerationValue"");
    }

    //Tries to find a DescriptionAttribute for a potential friendly name
    //for the enum
    MemberInfo[] memberInfo = type.GetMember(enumerationValue.ToString());
    if (memberInfo != null &amp;&amp; memberInfo.Length &gt; 0)
    {
        object[] attrs = memberInfo[0].GetCustomAttributes(typeof(DescriptionAttribute), false);

        if (attrs != null &amp;&amp; attrs.Length &gt; 0)
        {
            //Pull out the description value
            return ((DescriptionAttribute)attrs[0]).Description;
        }
    }
    //If we have no description attribute, just return the ToString of the enum
    return enumerationValue.ToString();
}
</code></pre>
","479417"
"Passing arguments to C# generic new() of templated type","153319","","<p>I'm trying to create a new object of type T via its constructor when adding to the list.</p>

<p>I'm getting a compile error: The error message is:</p>

<blockquote>
  <p>'T': cannot provide arguments when creating an instance of a variable</p>
</blockquote>

<p>But my classes do have a constructor argument! How can I make this work?</p>

<pre><code>public static string GetAllItems&lt;T&gt;(...) where T : new()
{
   ...
   List&lt;T&gt; tabListItems = new List&lt;T&gt;();
   foreach (ListItem listItem in listCollection) 
   {
       tabListItems.Add(new T(listItem)); // error here.
   } 
   ...
}
</code></pre>
","<p>In order to create an instance of a generic type in a function you must constrain it with the ""new"" flag.  </p>

<pre><code>public static string GetAllItems&lt;T&gt;(...) where T : new()
</code></pre>

<p>However that will only work when you want to call the constructor which has no parameters.  Not the case here.  Instead you'll have to provide another parameter which allows for the creation of object based on parameters.  The easiest is a function.  </p>

<pre><code>public static string GetAllItems&lt;T&gt;(..., Func&lt;ListItem,T&gt; del) {
  ...
  List&lt;T&gt; tabListItems = new List&lt;T&gt;();
  foreach (ListItem listItem in listCollection) 
  {
    tabListItems.Add(del(listItem));
  }
  ...
}
</code></pre>

<p>You can then call it like so</p>

<pre><code>GetAllItems&lt;Foo&gt;(..., l =&gt; new Foo(l));
</code></pre>
","840299"
"Adding placeholder text to textbox","153308","","<p>I am looking for a way to add placeholder text to a textbox like you can with a textbox in html5. </p>

<p>I.e. if the textbox has no text, then it adds the text <code>Enter some text here</code>, when the user clicks on it the placeholder text disappears and allows the user to enter their own text, and if the textbox loses focus and there is still no text then the placeholder is added back to the textbox.</p>
","<p>Wouldn't that just be something like this:</p>

<pre><code>Textbox myTxtbx = new Textbox();
myTxtbx.Text = ""Enter text here..."";

myTxtbx.GotFocus += GotFocus.EventHandle(RemoveText);
myTxtbx.LostFocus += LostFocus.EventHandle(AddText);

public RemoveText(object sender, EventArgs e)
{
     myTxtbx.Text = """";
}

public AddText(object sender, EventArgs e)
{
     if(String.IsNullOrWhiteSpace(myTxtbx.Text))
        myTxtbx.Text = ""Enter text here..."";
}
</code></pre>

<p>Thats just pseudocode but the concept is there.</p>
","11873521"
"Wait until a process ends","153159","","<p>I've an application which does</p>

<pre><code>Process.Start()
</code></pre>

<p>to start another application 'ABC'. I want to wait till that application ends (process dies) and continue my execution. How can I do it?</p>

<p>There may be multiple instances of the application 'ABC' running at the same time.</p>
","<p>I think you just want this:</p>

<pre><code>var process = Process.Start(...);
process.WaitForExit();
</code></pre>

<p>See the <a href=""http://msdn.microsoft.com/en-us/library/ty0d8k56.aspx"" rel=""noreferrer"">MSDN page</a> for the method. It also has an overload where you can specify the timeout, so you're not potentially waiting forever.</p>
","3147920"
"How to Exit a Method without Exiting the Program?","152836","","<p>I am still pretty new to C# and am having a difficult time getting used to it compared to C/CPP. </p>

<p>How do you exit a function on C# without exiting the program like this function would?</p>

<pre><code>if (textBox1.Text == """" || textBox1.Text == String.Empty || textBox1.TextLength == 0)
    textBox3.Text += ""[-] Listbox is Empty!!!!\r\n"";
System.Environment.Exit(0);
</code></pre>

<p>This will not allow return types and if left alone it will keep going on through the function unstopped. Which is undesirable.</p>
","<p>There are two ways to exit a method early (without quitting the program):</p>

<ul>
<li>Use the <a href=""http://msdn.microsoft.com/en-us/library/1h3swy84.aspx"" rel=""noreferrer""><code>return</code></a> keyword.</li>
<li>Throw an exception.</li>
</ul>

<p>Exceptions should only be used for exceptional circumstances - when the method cannot continue and it cannot return a reasonable value that would make sense to the caller. Usually though you should just return when you are done.</p>

<p>If your method returns void then you can write return without a value:</p>

<pre><code>return;
</code></pre>

<hr>

<p>Specifically about your code:</p>

<ul>
<li>There is no need to write the same test three times. All those conditions are equivalent. </li>
<li><p>You should also use curly braces when you write an if statement so that it is clear which statements are inside the body of the if statement:</p>

<pre><code>if (textBox1.Text == String.Empty)
{
    textBox3.Text += ""[-] Listbox is Empty!!!!\r\n"";
}
return; // Are you sure you want the return to be here??
</code></pre></li>
<li><p>If you are using .NET 4 there is a useful method that depending on your requirements you might want to consider using here: <a href=""http://msdn.microsoft.com/en-us/library/system.string.isnullorwhitespace.aspx"" rel=""noreferrer"">String.IsNullOrWhitespace</a>.</p></li>
<li>You <a href=""https://stackoverflow.com/questions/1751371/how-to-use-n-in-a-textbox"">might</a> want to use <a href=""http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx"" rel=""noreferrer""><code>Environment.Newline</code></a> instead of <code>""\r\n""</code>.</li>
<li>You might want to consider another way to display invalid input other than writing messages to a text box.</li>
</ul>
","3314308"
"Add an Image in a WPF button","152808","","<p>I tried this solution:</p>

<pre><code>&lt;Button&gt;
    &lt;StackPanel&gt;
        &lt;Image Source=""Pictures/img.jpg"" /&gt;
        &lt;TextBlock&gt;Blablabla&lt;/TextBlock&gt;
    &lt;/StackPanel&gt;
&lt;/Button&gt;
</code></pre>

<p>But I can see the image only in the project window, when I launch the program it disappears.</p>

<p>If I try this:</p>

<pre><code>  Image img = new Image();
  img.Source = new BitmapImage(new Uri(""foo.png""));

  StackPanel stackPnl = new StackPanel();
  stackPnl.Orientation = Orientation.Horizontal;
  stackPnl.Margin = new Thickness(10);
  stackPnl.Children.Add(img);

  Button btn = new Button();
  btn.Content = stackPnl;
</code></pre>

<p>I get a ""'System.Windows.Markup.XamlParseException' in PresentationFramework.dll"" exception.</p>

<p>Can you help me find a solution?
Thanks.</p>
","<p>In the case of a 'missing' image there are several things to consider:</p>

<ol>
<li><p>When Xaml can't locate a resource it might ignore it (when it won't throw a <code>XamlParseException</code>)</p></li>
<li><p>The Resource must be properly added and defined:</p>

<ul>
<li><p><strong>make sure it exists in your project where expected.</strong></p></li>
<li><p><strong>Make sure it is built with your project as a Resource.</strong></p>

<p><em>(Right click -> Properties -> BuildAction='Resource')</em></p></li>
</ul></li>
</ol>

<p><img src=""https://i.stack.imgur.com/jXTNv.jpg"" alt=""Snippet""></p>

<p>Another thing to try in similar cases, which is also useful for reusing of the image (or any other resource):</p>

<p><strong>Define your Image as a Resource in your Xaml:</strong></p>

<pre class=""lang-xml prettyprint-override""><code>&lt;UserControl.Resources&gt;
     &lt;Image x:Key=""MyImage"" Source.../&gt;
&lt;/UserControl.Resources&gt;
</code></pre>

<p>And later use it in your desired control(s):</p>

<pre class=""lang-xml prettyprint-override""><code>&lt;Button Content=""{StaticResource MyImage}"" /&gt;
</code></pre>
","17515867"
"Get Enum from Description attribute","152705","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/3422407/finding-an-enum-value-by-its-description-attribute"">Finding an enum value by its Description Attribute</a>  </p>
</blockquote>



<p>I have a generic extension method which gets the <code>Description</code> attribute from an <code>Enum</code>:</p>

<pre><code>enum Animal
{
    [Description("""")]
    NotSet = 0,

    [Description(""Giant Panda"")]
    GiantPanda = 1,

    [Description(""Lesser Spotted Anteater"")]
    LesserSpottedAnteater = 2
}

public static string GetDescription(this Enum value)
{            
    FieldInfo field = value.GetType().GetField(value.ToString());

    DescriptionAttribute attribute
            = Attribute.GetCustomAttribute(field, typeof(DescriptionAttribute))
                as DescriptionAttribute;

    return attribute == null ? value.ToString() : attribute.Description;
}
</code></pre>

<p>so I can do...</p>

<pre><code>string myAnimal = Animal.GiantPanda.GetDescription(); // = ""Giant Panda""
</code></pre>

<p>now, I'm trying to work out the equivalent function in the other direction, something like...</p>

<pre><code>Animal a = (Animal)Enum.GetValueFromDescription(""Giant Panda"", typeof(Animal));
</code></pre>
","<pre><code>public static class EnumEx
{
    public static T GetValueFromDescription&lt;T&gt;(string description)
    {
        var type = typeof(T);
        if(!type.IsEnum) throw new InvalidOperationException();
        foreach(var field in type.GetFields())
        {
            var attribute = Attribute.GetCustomAttribute(field,
                typeof(DescriptionAttribute)) as DescriptionAttribute;
            if(attribute != null)
            {
                if(attribute.Description == description)
                    return (T)field.GetValue(null);
            }
            else
            {
                if(field.Name == description)
                    return (T)field.GetValue(null);
            }
        }
        throw new ArgumentException(""Not found."", ""description"");
        // or return default(T);
    }
}
</code></pre>

<p>Usage:</p>

<pre><code>var panda = EnumEx.GetValueFromDescription&lt;Animal&gt;(""Giant Panda"");
</code></pre>
","4367868"
"When do you use the ""this"" keyword?","152636","","<p>I was curious about how other people use the <strong>this</strong> keyword. I tend to use it in constructors, but I may also use it throughout the class in other methods. Some examples:</p>

<p>In a constructor:</p>

<pre><code>public Light(Vector v)
{
    this.dir = new Vector(v);
}
</code></pre>

<p>Elsewhere</p>

<pre><code>public void SomeMethod()
{
    Vector vec = new Vector();
    double d = (vec * vec) - (this.radius * this.radius);
}
</code></pre>
","<p>There are several usages of <a href=""http://msdn.microsoft.com/en-us/library/dk1507sz.aspx"" rel=""noreferrer"">this</a> keyword in C#.</p>

<ol>
<li><a href=""http://msdn.microsoft.com/en-us/library/vstudio/dk1507sz%28v=vs.100%29.aspx"" rel=""noreferrer"">To qualify members hidden by similar name</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/vstudio/dk1507sz%28v=vs.100%29.aspx"" rel=""noreferrer"">To have an object pass itself as a parameter to other methods</a></li>
<li>To have an object return itself from a method</li>
<li><a href=""http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx"" rel=""noreferrer"">To declare indexers</a></li>
<li><a href=""http://msdn.microsoft.com/en-us/library/bb383977.aspx"" rel=""noreferrer"">To declare extension methods</a></li>
<li><a href=""http://www.codeproject.com/Articles/7011/An-Intro-to-Constructors-in-C%29"" rel=""noreferrer"">To pass parameters between constructors</a></li>
<li><a href=""https://stackoverflow.com/questions/194484/whats-the-strangest-corner-case-youve-seen-in-c-or-net/1800162#1800162"">To internally reassign value type (struct) value</a>.</li>
<li>To invoke an extension method on the current instance</li>
<li>To cast itself to another type</li>
<li><a href=""https://stackoverflow.com/questions/1814953/c-sharp-constructor-chaining-how-to-do-it"">To chain constructors defined in the same class</a></li>
</ol>

<p>You can avoid the first usage by not having member and local variables with the same name in scope, for example by following common naming conventions and using properties (Pascal case) instead of fields (camel case) to avoid colliding with local variables (also camel case). In C# 3.0 fields can be converted to properties easily by using <a href=""https://msdn.microsoft.com/en-us/library/bb384054.aspx"" rel=""noreferrer"">auto-implemented properties</a>.</p>
","23502"
"how to read all files inside particular folder","152562","","<p>I want to read all xml files inside a particular folder in c# .net</p>

<pre><code>XDocument doc2 = XDocument.Load((PG.SMNR.XMLDataSourceUtil.GetXMLFilePath(Locale, ""Products/category/product.xml"")));
</code></pre>

<p>i have multiple products in category folder.. want loop the folder and should get all product xml file names.</p>

<pre><code>XDocument doc2 = XDocument.Load((PG.SMNR.XMLDataSourceUtil.GetXMLFilePath(Locale, ""Products/category/x1.xml"")));
</code></pre>
","<pre><code>using System.IO;
...
foreach (string file in Directory.EnumerateFiles(folderPath, ""*.xml""))
{
    string contents = File.ReadAllText(file);
}
</code></pre>

<p>Note the above uses a .NET 4.0 feature; in previous versions replace <code>EnumerateFiles</code> with <code>GetFiles</code>). Also, replace <code>File.ReadAllText</code> with your preferred way of reading xml files - perhaps <code>XDocument</code>, <code>XmlDocument</code> or an <code>XmlReader</code>.</p>
","5840478"
"Escape double quotes in string","152471","","<p>Double quotes can be escaped like this:</p>

<pre><code>string test = @""He said to me, """"Hello World"""". How are you?"";
</code></pre>

<p>But this involves adding character <code>""</code> to the string. Is there a C# function or other method to escape double quotes so that no changing in string is required?</p>
","<p>No.</p>

<p>Either use verbatim string literals as you have, or escape the <code>""</code> using backslash.</p>

<pre><code>string test = ""He said to me, \""Hello World\"" . How are you?"";
</code></pre>

<p>The string has not changed in either case - there is a single <em>escaped</em> <code>""</code> in it. This is just a way to tell C# that the character is part of the string and not a string terminator.</p>
","14480750"
"How to wait for async method to complete?","152212","","<p>I'm writing a WinForms application that transfers data to a USB HID class device.  My application uses the excellent Generic HID library v6.0 which can be found <a href=""http://janaxelson.com/hidpage.htm#MyExampleCode"" rel=""noreferrer"">here</a>.  In a nutshell, when I need to write data to the device, this is the code that gets called:</p>

<pre><code>private async void RequestToSendOutputReport(List&lt;byte[]&gt; byteArrays)
{
    foreach (byte[] b in byteArrays)
    {
        while (condition)
        {
            // we'll typically execute this code many times until the condition is no longer met
            Task t = SendOutputReportViaInterruptTransfer();
            await t;
        }

        // read some data from device; we need to wait for this to return
        RequestToGetInputReport();
    }
}
</code></pre>

<p>When my code drops out of the while loop, I need to read some data from the device.  However, the device isn't able to respond right away so I need to wait for this call to return before I continue.  As it currently exists, RequestToGetInputReport() is declared like this:</p>

<pre><code>private async void RequestToGetInputReport()
{
    // lots of code prior to this
    int bytesRead = await GetInputReportViaInterruptTransfer();
}
</code></pre>

<p>For what it's worth, the declaration for GetInputReportViaInterruptTransfer() looks like this:</p>

<pre><code>internal async Task&lt;int&gt; GetInputReportViaInterruptTransfer()
</code></pre>

<p>Unfortunately, I'm not very familiar with the workings of the new async/await technologies in .NET 4.5.  I did a little reading earlier about the await keyword and that gave me the impression that the call to GetInputReportViaInterruptTransfer() inside of RequestToGetInputReport() would wait (and maybe it does?) but it doesn't seem like the call to RequestToGetInputReport() itself is waiting because I seem to be re-entering the while loop almost immediately?</p>

<p>Can anyone clarify the behavior that I'm seeing?</p>
","<p>Avoid <code>async void</code>. Have your methods return <a href=""https://msdn.microsoft.com/en-us/library/system.threading.tasks.task(v=vs.110).aspx""><code>Task</code></a> instead of <code>void</code>. Then you can <a href=""https://msdn.microsoft.com/en-GB/library/hh156528.aspx""><code>await</code></a> them.</p>

<p>Like this:</p>

<pre><code>private async Task RequestToSendOutputReport(List&lt;byte[]&gt; byteArrays)
{
    foreach (byte[] b in byteArrays)
    {
        while (condition)
        {
            // we'll typically execute this code many times until the condition is no longer met
            Task t = SendOutputReportViaInterruptTransfer();
            await t;
        }

        // read some data from device; we need to wait for this to return
        await RequestToGetInputReport();
    }
}

private async Task RequestToGetInputReport()
{
    // lots of code prior to this
    int bytesRead = await GetInputReportViaInterruptTransfer();
}
</code></pre>
","15149840"
"LINQ to SQL: Multiple joins ON multiple Columns. Is this possible?","152196","","<p><strong>Given:</strong></p>

<p>A table named <code>TABLE_1</code> with the following columns:</p>

<ul>
<li><code>ID</code></li>
<li><code>ColumnA</code></li>
<li><code>ColumnB</code></li>
<li><code>ColumnC</code></li>
</ul>

<p>I have SQL query where <code>TABLE_1</code> joins on itself twice based off of <code>ColumnA</code>, <code>ColumnB</code>, <code>ColumnC</code>. The query might look something like this:</p>

<pre><code>Select t1.ID, t2.ID, t3.ID
  From TABLE_1 t1
  Left Join TABLE_1 t2 On
       t1.ColumnA = t2.ColumnA
   And t1.ColumnB = t2.ColumnB
   And t1.ColumnC = t2.ColumnC
  Left Join TABLE_1 t3 On
       t2.ColumnA = t3.ColumnA
   And t2.ColumnB = t3.ColumnB
   And t2.ColumnC = t3.ColumnC
... and query continues on etc.
</code></pre>

<p><strong>Problem:</strong></p>

<p>I need that Query to be rewritten in LINQ. I've tried taking a stab at it:</p>

<pre><code>var query =
    from t1 in myTABLE1List // List&lt;TABLE_1&gt;
    join t2 in myTABLE1List
      on t1.ColumnA equals t2.ColumnA
      &amp;&amp; t1.ColumnB equals t2.ColumnA
    // ... and at this point intellisense is making it very obvious
    // I am doing something wrong :(
</code></pre>

<p>How do I write my query in LINQ? What am I doing wrong?</p>
","<p>Joining on multiple columns in Linq to SQL is a little different.</p>

<pre><code>var query =
    from t1 in myTABLE1List // List&lt;TABLE_1&gt;
    join t2 in myTABLE1List
      on new { t1.ColumnA, t1.ColumnB } equals new { t2.ColumnA, t2.ColumnB }
    ...
</code></pre>

<p>You have to take advantage of anonymous types and compose a type for the multiple columns you wish to compare against.</p>

<p>This seems confusing at first but once you get acquainted with the way the SQL is composed from the expressions it will make a lot more sense, under the covers this will generate the type of join you are looking for.</p>

<p><strong>EDIT</strong> Adding example for second join based on comment.</p>

<pre><code>var query =
    from t1 in myTABLE1List // List&lt;TABLE_1&gt;
    join t2 in myTABLE1List
      on new { A = t1.ColumnA, B = t1.ColumnB } equals new { A = t2.ColumnA, B = t2.ColumnB }
    join t3 in myTABLE1List
      on new { A = t2.ColumnA, B =  t2.ColumnB } equals new { A = t3.ColumnA, B = t3.ColumnB }
    ...
</code></pre>
","5307742"
"How to select min and max values of a column in a datatable?","152120","","<p>For the following datatable column, what is the fastest way to get the min and max values?</p>

<pre><code>AccountLevel  
0  
1  
2  
3 
</code></pre>
","<pre><code>int minAccountLevel = int.MaxValue;
int maxAccountLevel = int.MinValue;
foreach (DataRow dr in table.Rows)
{
    int accountLevel = dr.Field&lt;int&gt;(""AccountLevel"");
    minAccountLevel = Math.Min(minAccountLevel, accountLevel);
    maxAccountLevel = Math.Max(maxAccountLevel, accountLevel);
}
</code></pre>

<p>Yes, this really is the fastest way.  Using the Linq <code>Min</code> and <code>Max</code> extensions will always be slower because you have to iterate twice.  You could potentially use Linq <code>Aggregate</code>, but the syntax isn't going to be much prettier than this already is.</p>
","2442717"
"How can I change property names when serializing with Json.net?","152082","","<p>I have some data in a C# DataSet object. I can serialize it right now using a Json.net converter like this</p>

<pre><code>DataSet data = new DataSet();
// do some work here to populate 'data'
string output = JsonConvert.SerializeObject(data);
</code></pre>

<p>However, this uses the property names from <code>data</code> when printing to the .json file. I would like to change the property names to be something different (say, change 'foo' to 'bar').</p>

<p>In the <a href=""http://james.newtonking.com/projects/json/help/"" rel=""noreferrer"">Json.net documentation</a>, under 'Serializing and Deserializing JSON' → 'Serialization Attributes' it says ""JsonPropertyAttribute... allows the name to be customized"". But there is no example. <strong>Does anyone know how to use a JsonPropertyAttribute to change the property name to something else?</strong></p>

<p>(<a href=""http://james.newtonking.com/json/help/?topic=html/SerializationAttributes.htm"" rel=""noreferrer"">Direct link to documentation</a>)</p>

<p>Json.net's documentation seems to be sparse. If you have a great example I'll try to get it added to the official documentation.
Thanks!</p>
","<p>You could decorate the property you wish controlling its name with the <code>[JsonProperty]</code> attribute which allows you to specify a different name:</p>

<pre><code>[JsonProperty(PropertyName = ""FooBar"")]
public string Foo { get; set; }
</code></pre>

<p>Documentation: <strong><a href=""http://www.newtonsoft.com/json/help/html/SerializationAttributes.htm"" rel=""noreferrer"">Serialization Attributes</a></strong></p>
","8796648"
"c#: getter/setter","152064","","<p>I saw something like the following somewhere, and was wondering what it meant. I know they are getters and setters, but want to know why the string Type is defined like this. Thanks for helping me.</p>

<pre><code>public string Type { get; set; }
</code></pre>
","<p>Those are <a href=""http://msdn.microsoft.com/en-us/library/bb384054.aspx"">Auto-Implemented Properties</a> (Auto Properties for short).</p>

<p>The compiler will auto-generate the equivalent of the following simple implementation:</p>

<pre><code>private string _type;

public string Type
{
    get { return _type; }
    set { _type = value; }
}
</code></pre>
","6709104"
"What is the difference between task and thread?","152028","","<p>In C# 4.0, we have <code>Task</code> in the <em>System.Threading.Tasks</em> namespace. What is the true difference between <code>Thread</code> and <code>Task</code>. I did some sample program(help taken from MSDN)  for my own sake of learning with </p>

<pre><code>Parallel.Invoke 
Parallel.For 
Parallel.ForEach 
</code></pre>

<p>but have many doubts as the idea is not so clear. </p>

<p>I have initially searched in Stackoverflow for a similar type of question but may be with this question title I was not able to get the same. If anyone knows about the same type of question being posted here earlier, kindly give the reference of the link.</p>
","<p>A task is something you want done.</p>

<p>A thread is one of the many possible workers which performs that task.</p>

<p>In .NET 4.0 terms, a <a href=""http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx"">Task</a> represents an asynchronous operation. Thread(s) are used to complete that operation by breaking the work up into chunks and assigning to separate threads.</p>
","4130204"
"C# Using .Select and .Where in a single LINQ Statement","152015","","<p>I need to gather Distinct Id's from a particular table using LINQ. The catch is I also need a WHERE statement that should filter the results based only from the requirements I've set. Relatively new to having to use LINQ so much, but I'm using the following code more or less:</p>

<pre><code>`private void WriteStuff(SqlHelper db, EmployeeHelper emp)
    {
        String checkFieldChange;
        AnIList tableClass = new AnIList(db, (int)emp.PersonId);
        var linq = tableClass.Items
            .Where(x =&gt; x.UserId == emp.UserId &amp;&amp; x.Date &gt; DateBeforeChanges &amp;&amp; x.Date &lt; DateAfterEffective &amp;&amp; ((x.Field == Inserted)
                || (x.Field == Deleted)))

)).OrderByDescending(x =&gt; x.Id);
        if (linq != null)
        {
            foreach (TableClassChanges item in linq)
            {
                    AnotherIList payTxn = new AnotherIList(db, item.Id);
                    checkFieldChange = GetChangeType(item.FieldName);
                    //Other codes that will retrieve data from each item and write it into a text file
            }
        }
    }
</code></pre>

<p>I tried to add .Distinct for var linq but it's still returning duplicate items (meaning having the same Id's). I've read through a lot of sites and have tried adding a .Select into the query but the .Where clause breaks instead. There are other articles where the query is somehow different with the way it retrieves the values and place it in a var. I also tried to use .GroupBy but I get an ""At least one object must implement IComparable"" when using Id as a key.</p>

<p>The query actually works and I'm able to output the data from the columns with the specifications I require, but I just can't seem to make .Distinct work (which is the only thing really missing). I tried to create two vars with one triggering a distinct call then have a nested foreach to ensure the values are just unique, but will thousands of records to gather the performance impact is just too much.</p>

<p>I'm unsure as well if I'd have to override or use IEnumerable for my requirement, and thought I'd ask the question around just in case there's an easier way, or if it's possible to have both .Select and .Where working in just one statement?</p>
","<p>In order for <a href=""http://msdn.microsoft.com/en-us/library/bb348436.aspx""><code>Enumerable.Distinct</code></a> to work for your type, you can implement <code>IEquatable&lt;T&gt;</code> and provide suitable definitions for <code>Equals</code> and <code>GetHashCode</code>, otherwise it will use the default implementation: comparing for reference equality (assuming that you are using a reference type).</p>

<p>From the manual:</p>

<blockquote>
  <p>The Distinct(IEnumerable) method returns an unordered sequence that contains no duplicate values. It uses the default equality comparer, Default, to compare values.</p>
  
  <p>The default equality comparer, Default, is used to compare values of the types that implement the IEquatable generic interface. To compare a custom data type, you need to implement this interface and provide your own GetHashCode and Equals methods for the type.</p>
</blockquote>

<p>In your case it looks like you might just need to compare the IDs, but you may also want to compare other fields too depending on what it means for you that two objects are ""the same"".</p>

<p>You can also consider using <a href=""http://code.google.com/p/morelinq/source/browse/trunk/MoreLinq/DistinctBy.cs""><code>DistinctBy</code></a> from <a href=""http://code.google.com/p/morelinq/"">morelinq</a>.</p>

<p>Note that this is LINQ to Objects only, but I assume that's what you are using.</p>

<p>Yet another option is to combine <code>GroupBy</code> and <code>First</code>:</p>

<pre><code> var query = // your query here...
    .GroupBy(x =&gt; x.Id)
    .Select(g =&gt; g.First());
</code></pre>

<p>This would also work in LINQ to SQL, for example.</p>
","9410361"
"Parsing JSON using Json.net","151901","","<p>I'm trying to parse some JSON using the JSon.Net library.  The documentation seems a little sparse and I'm confused as to how to accomplish what I need.  Here is the format for the JSON I need to parse through.</p>

<pre><code>{
    ""displayFieldName"" : ""OBJECT_NAME"", 
    ""fieldAliases"" : {
        ""OBJECT_NAME"" : ""OBJECT_NAME"", 
        ""OBJECT_TYPE"" : ""OBJECT_TYPE""
    }, 
    ""positionType"" : ""point"", 
    ""reference"" : {
        ""id"" : 1111
    }, 
    ""objects"" : [ {
        ""attributes"" : {
            ""OBJECT_NAME"" : ""test name"", 
            ""OBJECT_TYPE"" : ""test type""
        }, 
        ""position"" : {
            ""x"" : 5, 
            ""y"" : 7
        }
    } ]
}
</code></pre>

<p>The only data I really need from this is the stuff in the objects array.  Is it possible for me to parse through that with something like the JSonTextReader and just pull out the things I want, like OBJECT_TYPE and the x and y position?  I can't seem to get <code>JSonTextReader</code> to work the way I want it to and I find little to no examples of usage for it. </p>

<p>It seems like serializing first then using LINQ with my object would be ideal and every example I find discusses serializing the JSON first, but I'm not sure how I would build an object for this structure.  Particularly the objects array which would need to be something like a list of Pairs of attribute and position objects.  I have no idea how I would code my object so JSon.Net would know how to serialize that.</p>

<p>I thought I could write my own simple parser to just pull out everything I need into an attributes object that I created, but I'm having little luck.  </p>

<p>Hopefully this all makes sense, any ideas?</p>
","<p>I don't know about JSON.NET, but it works fine with <code>JavaScriptSerializer</code> from <code>System.Web.Extensions.dll</code> (.NET 3.5 SP1):</p>

<pre><code>using System.Collections.Generic;
using System.Web.Script.Serialization;
public class NameTypePair
{
    public string OBJECT_NAME { get; set; }
    public string OBJECT_TYPE { get; set; }
}
public enum PositionType { none, point }
public class Ref
{
    public int id { get; set; }
}
public class SubObject
{
    public NameTypePair attributes { get; set; }
    public Position position { get; set; }
}
public class Position
{
    public int x { get; set; }
    public int y { get; set; }
}
public class Foo
{
    public Foo() { objects = new List&lt;SubObject&gt;(); }
    public string displayFieldName { get; set; }
    public NameTypePair fieldAliases { get; set; }
    public PositionType positionType { get; set; }
    public Ref reference { get; set; }
    public List&lt;SubObject&gt; objects { get; set; }
}
static class Program
{

    const string json = @""{
  """"displayFieldName"""" : """"OBJECT_NAME"""", 
  """"fieldAliases"""" : {
    """"OBJECT_NAME"""" : """"OBJECT_NAME"""", 
    """"OBJECT_TYPE"""" : """"OBJECT_TYPE""""
  }, 
  """"positionType"""" : """"point"""", 
  """"reference"""" : {
    """"id"""" : 1111
  }, 
  """"objects"""" : [
    {
      """"attributes"""" : {
        """"OBJECT_NAME"""" : """"test name"""", 
        """"OBJECT_TYPE"""" : """"test type""""
      }, 
      """"position"""" : 
      {
        """"x"""" : 5, 
        """"y"""" : 7
      }
    }
  ]
}"";


    static void Main()
    {
        JavaScriptSerializer ser = new JavaScriptSerializer();
        Foo foo = ser.Deserialize&lt;Foo&gt;(json);
    }


}
</code></pre>

<p><strong>Edit:</strong></p>

<p>Json.NET works using the same JSON and classes.</p>

<pre><code>Foo foo = JsonConvert.DeserializeObject&lt;Foo&gt;(json);
</code></pre>

<p>Link: <a href=""http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm"" rel=""noreferrer"">Serializing and Deserializing JSON with Json.NET</a></p>
","402694"
"Exact time measurement for performance testing","151873","","<p>What is the most exact way of seeing how long something, for example a method call, took in code?</p>

<p>The easiest and quickest I would guess is this:</p>

<pre><code>DateTime start = DateTime.Now;
{
    // Do some work
}
TimeSpan timeItTook = DateTime.Now - start;
</code></pre>

<p>But how exact is this? Are there better ways?</p>
","<p>A better way is to use the Stopwatch class:</p>

<pre><code>using System.Diagnostics;
// ...

Stopwatch sw = new Stopwatch();

sw.Start();

// ...

sw.Stop();

Console.WriteLine(""Elapsed={0}"",sw.Elapsed);
</code></pre>
","969303"
"Best way to call a JSON WebService from a .NET Console","151871","","<p>I am hosting a web service in ASP.Net MVC3 which returns a Json string. What is the best way to call the webservice from a c# console application, and parse the return into a .NET object?</p>

<p>Should I reference MVC3 in my console app?</p>

<p>Json.Net has some nice methods for serializing and deserializing .NET objects, but I don't see that it has ways for POSTing and GETing values from a webservice.</p>

<p>Or should I just create my own helper method for POSTing and GETing to the web service? How would I serialize my .net object to key value pairs?</p>
","<p>I use HttpWebRequest to GET from the web service, which returns me a JSON string. It looks something like this for a GET:</p>

<pre><code>// Returns JSON string
string GET(string url) 
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
    try {
        WebResponse response = request.GetResponse();
        using (Stream responseStream = response.GetResponseStream()) {
            StreamReader reader = new StreamReader(responseStream, Encoding.UTF8);
            return reader.ReadToEnd();
        }
    }
    catch (WebException ex) {
        WebResponse errorResponse = ex.Response;
        using (Stream responseStream = errorResponse.GetResponseStream())
        {
            StreamReader reader = new StreamReader(responseStream, Encoding.GetEncoding(""utf-8""));
            String errorText = reader.ReadToEnd();
            // log errorText
        }
        throw;
    }
}
</code></pre>

<p>I then use <a href=""http://json.codeplex.com/"">JSON.Net</a> to dynamically parse the string.
Alternatively, you can generate the C# class statically from sample JSON output using this codeplex tool: <a href=""http://jsonclassgenerator.codeplex.com/"">http://jsonclassgenerator.codeplex.com/</a></p>

<p>POST looks like this:</p>

<pre><code>// POST a JSON string
void POST(string url, string jsonContent) 
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
    request.Method = ""POST"";

    System.Text.UTF8Encoding encoding = new System.Text.UTF8Encoding();
    Byte[] byteArray = encoding.GetBytes(jsonContent);

    request.ContentLength = byteArray.Length;
    request.ContentType = @""application/json"";

    using (Stream dataStream = request.GetRequestStream()) {
        dataStream.Write(byteArray, 0, byteArray.Length);
    }
    long length = 0;
    try {
        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse()) {
            length = response.ContentLength;
        }
    }
    catch (WebException ex) {
        // Log exception and throw as for GET example above
    }
}
</code></pre>

<p>I use code like this in automated tests of our web service.</p>
","8270654"
"async/await - when to return a Task vs void?","151788","","<p>Under what scenarios would one want to use </p>

<pre><code>public async Task AsyncMethod(int num)
</code></pre>

<p>instead of </p>

<pre><code>public async void AsyncMethod(int num)
</code></pre>

<p>The only scenario that I can think of is if you need the task to be able to track it's progress. </p>

<p>Additionally, in the following method, are the async and await keywords unnecessary?</p>

<pre><code>  public static async void AsyncMethod2(int num)
    {
        await Task.Factory.StartNew(() =&gt; Thread.Sleep(num));
    }
</code></pre>
","<p>1) Normally, you would want to return a <code>Task</code>. The main exception should be when you <em>need</em> to have a <code>void</code> return type (for events). If there's no reason to disallow having the caller <code>await</code> your task, why disallow it?</p>

<p>2) <code>async</code> methods that return <code>void</code> are special in another aspect: they represent <em>top-level async operations</em>, and have additional rules that come into play when your task returns an exception. The easiest way is to show the difference is with an example:</p>

<pre><code>static async void f()
{
    await h();
}

static async Task g()
{
    await h();
}

static async Task h()
{
    throw new NotImplementedException();
}

private void button1_Click(object sender, EventArgs e)
{
    f();
}

private void button2_Click(object sender, EventArgs e)
{
    g();
}

private void button3_Click(object sender, EventArgs e)
{
    GC.Collect();
}
</code></pre>

<p><code>f</code>'s exception is always ""observed"". An exception that leaves a top-level asynchronous method is simply treated like any other unhandled exception. <code>g</code>'s exception is never observed. When the garbage collector comes to clean up the task, it sees that the task resulted in an exception, and nobody handled the exception. When that happens, the <code>TaskScheduler.UnobservedTaskException</code> handler runs. You should never let this happen. To use your example,</p>

<pre><code>public static async void AsyncMethod2(int num)
{
    await Task.Factory.StartNew(() =&gt; Thread.Sleep(num));
}
</code></pre>

<p>Yes, use <code>async</code> and <code>await</code> here, they make sure your method still works correctly if an exception is thrown.</p>

<p>for more information see: <a href=""http://msdn.microsoft.com/en-us/magazine/jj991977.aspx"">http://msdn.microsoft.com/en-us/magazine/jj991977.aspx</a></p>
","12144426"
"How to get the groups of a user in Active Directory? (c#, asp.net)","151783","","<p>I use this code to get the groups of the current user. But I want to manually give the user and then get his groups. How can I do this?</p>

<pre><code>using System.Security.Principal;

public ArrayList Groups()
{
    ArrayList groups = new ArrayList();

    foreach (IdentityReference group in System.Web.HttpContext.Current.Request.LogonUserIdentity.Groups)
    {
        groups.Add(group.Translate(typeof(NTAccount)).ToString());
    }

    return groups;
}
</code></pre>
","<p>If you're on .NET 3.5 or up, you can use the new <code>System.DirectoryServices.AccountManagement</code> (S.DS.AM) namespace which makes this a lot easier than it used to be.</p>

<p>Read all about it here: <strike><a href=""http://msdn.microsoft.com/en-us/magazine/cc135979.aspx"" rel=""noreferrer"">Managing Directory Security Principals in the .NET Framework 3.5</a></strike></p>

<p><strong>Update:</strong> older MSDN magazine articles aren't online anymore, unfortunately - you'll need to <a href=""http://download.microsoft.com/download/3/A/7/3A7FA450-1F33-41F7-9E6D-3AA95B5A6AEA/MSDNMagazineJanuary2008en-us.chm"" rel=""noreferrer"">download the CHM for the January 2008 MSDN magazine</a> from Microsoft and read the article in there.</p>

<p>Basically, you need to have a ""principal context"" (typically your domain), a user principal, and then you get its groups very easily:</p>

<pre><code>public List&lt;GroupPrincipal&gt; GetGroups(string userName)
{
   List&lt;GroupPrincipal&gt; result = new List&lt;GroupPrincipal&gt;();

   // establish domain context
   PrincipalContext yourDomain = new PrincipalContext(ContextType.Domain);

   // find your user
   UserPrincipal user = UserPrincipal.FindByIdentity(yourDomain, userName);

   // if found - grab its groups
   if(user != null)
   {
      PrincipalSearchResult&lt;Principal&gt; groups = user.GetAuthorizationGroups();

      // iterate over all groups
      foreach(Principal p in groups)
      {
         // make sure to add only group principals
         if(p is GroupPrincipal)
         {
             result.Add((GroupPrincipal)p);
         }
      }
   }

   return result;
}
</code></pre>

<p>and that's all there is! You now have a result (a list) of authorization groups that user belongs to - iterate over them, print out their names or whatever you need to do.</p>

<p><em>Update:</em> In order to access certain properties, which are not surfaced on the <code>UserPrincipal</code> object, you need to dig into the underlying <code>DirectoryEntry</code>:</p>

<pre><code>public string GetDepartment(Principal principal)
{
    string result = string.Empty;

    DirectoryEntry de = (principal.GetUnderlyingObject() as DirectoryEntry);

    if (de != null)
    {
       if (de.Properties.Contains(""department""))
       {
          result = de.Properties[""department""][0].ToString();
       }
    }

    return result;
}
</code></pre>

<p><em>Update #2:</em> seems shouldn't be too hard to put these two snippets of code together.... but ok - here it goes:</p>

<pre><code>public string GetDepartment(string username)
{
    string result = string.Empty;

    // if you do repeated domain access, you might want to do this *once* outside this method, 
    // and pass it in as a second parameter!
    PrincipalContext yourDomain = new PrincipalContext(ContextType.Domain);

    // find the user
    UserPrincipal user = UserPrincipal.FindByIdentity(yourDomain, username);

    // if user is found
    if(user != null)
    {
       // get DirectoryEntry underlying it
       DirectoryEntry de = (user.GetUnderlyingObject() as DirectoryEntry);

       if (de != null)
       {
          if (de.Properties.Contains(""department""))
          {
             result = de.Properties[""department""][0].ToString();
          }
       }
    }

    return result;
}
</code></pre>
","5310317"
"Difference between RegisterStartupScript and RegisterClientScriptBlock?","151511","","<p>Is the only difference between the <code>RegisterStartupScript</code> and the <code>RegisterClientScriptBlock</code> is that RegisterStartupScript puts the javascript before the closing <code>&lt;/form&gt;</code> tag of the page and RegisterClientScriptBlock puts it right after the starting <code>&lt;form&gt;</code> tag of the page?  </p>

<p>Also, when would you choose one over the other?  I wrote up a quick sample page where I had an issue and I am not sure the exact reason of why it is happening.  </p>

<h3>Here is the aspx markup:</h3>

<pre class=""lang-html prettyprint-override""><code>&lt;html xmlns=""http://www.w3.org/1999/xhtml""&gt;
    &lt;head runat=""server""&gt;
        &lt;title&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;form id=""form1"" runat=""server""&gt;
            &lt;div&gt;
                &lt;asp:Label ID=""lblDisplayDate"" runat=""server""
                           Text=""Label"" /&gt;&lt;br /&gt;
                &lt;asp:Button ID=""btnPostback"" runat=""server"" 
                            Text=""Register Startup Script""
                            onclick=""btnPostback_Click"" /&gt;&lt;br /&gt;
                &lt;asp:Button ID=""btnPostBack2"" runat=""server"" 
                            Text=""Register""
                            onclick=""btnPostBack2_Click"" /&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h3>Here is the Code Behind:</h3>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{
    lblDisplayDate.Text = DateTime.Now.ToString(""T"");
}

protected void btnPostback_Click(object sender, EventArgs e)
{
    System.Text.StringBuilder sb = new System.Text.StringBuilder();
    sb.Append(@""&lt;script language='javascript'&gt;"");
    sb.Append(@""var lbl = document.getElementById('lblDisplayDate');"");
    sb.Append(@""lbl.style.color='red';"");
    sb.Append(@""&lt;/script&gt;"");

    if(!ClientScript.IsStartupScriptRegistered(""JSScript""))
    {
        ClientScript.RegisterStartupScript(this.GetType(),""JSScript"",
        sb.ToString());
    }
}

protected void btnPostBack2_Click(object sender, EventArgs e)
{
    System.Text.StringBuilder sb = new System.Text.StringBuilder();
    sb.Append(@""&lt;script language='javascript'&gt;"");
    sb.Append(@""var lbl = document.getElementById('lblDisplayDate');"");
    sb.Append(@""lbl.style.color='red';"");
    sb.Append(@""&lt;/script&gt;"");

    if (!ClientScript.IsClientScriptBlockRegistered(""JSScriptBlock""))
    {
        ClientScript.RegisterClientScriptBlock(this.GetType(), ""JSScriptBlock"",  
        sb.ToString());
    } 
 }
</code></pre>

<p>The problem is when I click the <code>btnPostBack</code> button, it does a postback and changes the label to red, but when I click the <code>btnPostBack2</code>, it does a postback, but the label color does not change to red.  Why is this?  Is it because the label is not initialized?</p>

<p>I also read that if you are using an <code>UpdatePanel</code>, you need to use <code>ScriptManager.RegisterStartupScript</code>, but if I have a <code>MasterPage</code>, would I use <code>ScriptManagerProxy</code>?</p>
","<p><a href=""http://groups.google.com/group/DotNetDevelopment/browse_thread/thread/402d2c0be6c904c5/"" rel=""noreferrer"">Here's an old discussion thread</a> where I listed the main differences and the conditions in which you should use each of these methods. I think you may find it useful to go through the discussion.</p>

<p>To explain the differences as relevant to your posted example:</p>

<p>a. When you use <code>RegisterStartupScript</code>, it will render your script <em>after</em> all the elements in the page (right before the form's end tag). This enables the script to call or reference page elements without the possibility of it not finding them in the Page's DOM.</p>

<p>Here is the rendered source of the page when you invoke the <code>RegisterStartupScript</code> method:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;html xmlns=""http://www.w3.org/1999/xhtml""&gt;
&lt;head id=""Head1""&gt;&lt;title&gt;&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;form name=""form1"" method=""post"" action=""StartupScript.aspx"" id=""form1""&gt;
        &lt;div&gt;
            &lt;input type=""hidden"" name=""__VIEWSTATE"" id=""__VIEWSTATE"" value=""someViewstategibberish"" /&gt;
        &lt;/div&gt;
        &lt;div&gt; &lt;span id=""lblDisplayDate""&gt;Label&lt;/span&gt;
            &lt;br /&gt;
            &lt;input type=""submit"" name=""btnPostback"" value=""Register Startup Script"" id=""btnPostback"" /&gt;
            &lt;br /&gt;
            &lt;input type=""submit"" name=""btnPostBack2"" value=""Register"" id=""btnPostBack2"" /&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;input type=""hidden"" name=""__EVENTVALIDATION"" id=""__EVENTVALIDATION"" value=""someViewstategibberish"" /&gt;
        &lt;/div&gt;
        &lt;!-- Note this part --&gt;
        &lt;script language='javascript'&gt;
            var lbl = document.getElementById('lblDisplayDate');
            lbl.style.color = 'red';
        &lt;/script&gt;
    &lt;/form&gt;
    &lt;!-- Note this part --&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>b. When you use <code>RegisterClientScriptBlock</code>, the script is rendered right after the Viewstate tag, but before any of the page elements. Since this is a direct script (not a function that can be <em>called</em>, it will immediately be executed by the browser. But the browser does not find the label in the Page's DOM at this stage and hence you should receive an ""Object not found"" error.</p>

<p>Here is the rendered source of the page when you invoke the <code>RegisterClientScriptBlock</code> method:</p>

<pre class=""lang-html prettyprint-override""><code>&lt;html xmlns=""http://www.w3.org/1999/xhtml""&gt;
&lt;head id=""Head1""&gt;&lt;title&gt;&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;form name=""form1"" method=""post"" action=""StartupScript.aspx"" id=""form1""&gt;
        &lt;div&gt;
            &lt;input type=""hidden"" name=""__VIEWSTATE"" id=""__VIEWSTATE"" value=""someViewstategibberish"" /&gt;
        &lt;/div&gt;
        &lt;script language='javascript'&gt;
            var lbl = document.getElementById('lblDisplayDate');
            // Error is thrown in the next line because lbl is null.
            lbl.style.color = 'green';
</code></pre>

<p>Therefore, to summarize, you should call the latter method if you intend to render a function definition. You can then render the <em>call to that function</em> using the former method (or add a client side attribute). </p>

<p>Edit after comments:</p>

<hr>

<p>For instance, the following function would work:</p>

<pre><code>protected void btnPostBack2_Click(object sender, EventArgs e) 
{ 
  System.Text.StringBuilder sb = new System.Text.StringBuilder(); 
  sb.Append(""&lt;script language='javascript'&gt;function ChangeColor() {""); 
  sb.Append(""var lbl = document.getElementById('lblDisplayDate');""); 
  sb.Append(""lbl.style.color='green';""); 
  sb.Append(""}&lt;/script&gt;""); 

  //Render the function definition. 
  if (!ClientScript.IsClientScriptBlockRegistered(""JSScriptBlock"")) 
  {
    ClientScript.RegisterClientScriptBlock(this.GetType(), ""JSScriptBlock"", sb.ToString()); 
  }

  //Render the function invocation. 
  string funcCall = ""&lt;script language='javascript'&gt;ChangeColor();&lt;/script&gt;""; 

  if (!ClientScript.IsStartupScriptRegistered(""JSScript""))
  { 
    ClientScript.RegisterStartupScript(this.GetType(), ""JSScript"", funcCall); 
  } 
} 
</code></pre>
","666560"
"Getting path relative to the current working directory?","151448","","<p>I'm writing a console utility to do some processing on files specified on the commandline, but I've run into a problem I can't solve through Google/Stack&nbsp;Overflow. If a full path, including drive letter, is specified, how do I reformat that path to be relative to the current working directory?  </p>

<p>There must be something similar to the VirtualPathUtility.MakeRelative function, but if there is, it eludes me.</p>
","<p>If you don't mind the slashes being switched, you could [ab]use <code>Uri</code>:</p>

<pre><code>Uri file = new Uri(@""c:\foo\bar\blop\blap.txt"");
// Must end in a slash to indicate folder
Uri folder = new Uri(@""c:\foo\bar\"");
string relativePath = 
Uri.UnescapeDataString(
    folder.MakeRelativeUri(file)
        .ToString()
        .Replace('/', Path.DirectorySeparatorChar)
    );
</code></pre>

<h2>As a function/method:</h2>

<pre><code>string GetRelativePath(string filespec, string folder)
{
    Uri pathUri = new Uri(filespec);
    // Folders must end in a slash
    if (!folder.EndsWith(Path.DirectorySeparatorChar.ToString()))
    {
        folder += Path.DirectorySeparatorChar;
    }
    Uri folderUri = new Uri(folder);
    return Uri.UnescapeDataString(folderUri.MakeRelativeUri(pathUri).ToString().Replace('/', Path.DirectorySeparatorChar));
}
</code></pre>
","703292"
"Elevating process privilege programmatically?","151121","","<p>I'm trying to install a service using InstallUtil.exe but invoked through <code>Process.Start</code>. Here's the code:</p>

<pre><code>ProcessStartInfo startInfo = new ProcessStartInfo (m_strInstallUtil, strExePath);
System.Diagnostics.Process.Start (startInfo);
</code></pre>

<p>where <code>m_strInstallUtil</code> is the fully qualified path and exe to ""InstallUtil.exe"" and <code>strExePath</code> is the fully qualified path/name to my service.</p>

<p>Running the command line syntax from an elevated command prompt works; running from my app (using the above code) does not. I assume I'm dealing with some process elevation issue, so how would I run my process in an elevated state? Do I need to look at <code>ShellExecute</code> for this?</p>

<p>This is all on Windows Vista. I am running the process in the VS2008 debugger elevated to admin privilege.</p>

<p>I also tried setting <code>startInfo.Verb = ""runas"";</code> but it didn't seem to solve the problem.</p>
","<p>You can indicate the new process should be started with elevated permissions by setting the Verb property of your startInfo object to 'runas', as follows:</p>

<pre><code>startInfo.Verb = ""runas"";
</code></pre>

<p>This will cause Windows to behave as if the process has been started from Explorer with the ""Run as Administrator"" menu command.</p>

<p>This does mean the UAC prompt will come up and will need to be acknowledged by the user: if this is undesirable (for example because it would happen in the middle of a lengthy process), you'll need to run your entire host process with elevated permissions by <a href=""https://msdn.microsoft.com/en-us/library/bb756929.aspx"" rel=""noreferrer"">Create and Embed an Application Manifest (UAC)</a> to require the 'highestAvailable' execution level: this will cause the UAC prompt to appear as soon as your app is started, and cause all child processes to run with elevated permissions without additional prompting.</p>

<p>Edit: I see you just edited your question to state that ""runas"" didn't work for you. That's really strange, as it should (and does for me in several production apps). Requiring the parent process to run with elevated rights by embedding the manifest should definitely work, though.</p>
","133500"
"Replace Multiple Characters in a String","151121","","<p>Is there a better way to replace strings?</p>

<p>I am surprised that Replace does not take in a character array or string array.  I guess that I could write my own extension but I was curious if there is a better built in way to do the following?  Notice the last Replace is a string not a character.</p>

<pre><code>myString.Replace(';', '\n').Replace(',', '\n').Replace('\r', '\n').Replace('\t', '\n').Replace(' ', '\n').Replace(""\n\n"", ""\n"");
</code></pre>

<p>Thanks.</p>
","<p>You can use a replace regular expression.</p>

<pre><code>s/[;,\t\r ]|[\n]{2}/\n/g
</code></pre>

<ul>
<li><code>s/</code> at the beginning means a search</li>
<li>The characters between <code>[</code> and <code>]</code> are the characters to search for (in any order)</li>
<li>The second <code>/</code> delimits the search-for text and the replace text</li>
</ul>

<p>In English, this reads:</p>

<p>""Search for <code>;</code> or <code>,</code> or <code>\t</code> or <code>\r</code> or <code></code> (space) or exactly two sequential <code>\n</code> and replace it with <code>\n</code>""</p>

<p>In C#, you could do the following: (after importing <code>System.Text.RegularExpressions</code>)</p>

<pre><code>Regex pattern = new Regex(""[;,\t\r ]|[\n]{2}"");
pattern.Replace(myString, ""\n"");
</code></pre>
","7265336"
"What are the Default Access Modifiers in C#?","151109","","<p>What is the default access modifier for classes, methods, members, constructors, delegates and interfaces?</p>
","<p>The default access for everything in C# is <strong>""the most restricted access you could declare for that member""</strong>.</p>

<p>So for example:</p>

<pre><code>namespace MyCompany
{
    class Outer
    {
        void Foo() {}
        class Inner {}
    }
}
</code></pre>

<p>is equivalent to</p>

<pre><code>namespace MyCompany
{
    internal class Outer
    {
        private void Foo() {}
        private class Inner {}
    }
}
</code></pre>

<p>The one sort of exception to this is making one part of a property (usually the setter) more restricted than the declared accessibility of the property itself:</p>

<pre><code>public string Name
{
    get { ... }
    private set { ... } // This isn't the default, have to do it explicitly
}
</code></pre>

<hr>

<p>This is what the C# 3.0 specification has to say (section 3.5.1):</p>

<blockquote>
  <p>Depending on the context in which a
  member declaration takes place, only
  certain types of declared
  accessibility are permitted.
  Furthermore, when a member declaration
  does not include any access modifiers,
  the context in which the declaration
  takes place determines the default
  declared accessibility.</p>
  
  <ul>
  <li>Namespaces implicitly have public declared accessibility. No access
  modifiers are allowed on namespace
  declarations.</li>
  <li>Types declared in compilation units or namespaces can have public or
  internal declared accessibility and
  default to internal declared
  accessibility.</li>
  <li>Class members can have any of the five kinds of declared accessibility
  and default to private declared
  accessibility. (Note that a type
  declared as a member of a class can
  have any of the five kinds of declared
  accessibility, whereas a type declared
  as a member of a namespace can have
  only public or internal declared
  accessibility.)</li>
  <li>Struct members can have public, internal, or private declared
  accessibility and default to private
  declared accessibility because structs
  are implicitly sealed. Struct members
  introduced in a struct (that is, not
  inherited by that struct) cannot have
  protected or protected internal
  declared accessibility. (Note that a
  type declared as a member of a struct
  can have public, internal, or private
  declared accessibility, whereas a type
  declared as a member of a namespace
  can have only public or internal
  declared accessibility.)</li>
  <li>Interface members implicitly have public declared accessibility. No
  access modifiers are allowed on
  interface member declarations.</li>
  <li>Enumeration members implicitly have public declared accessibility. No
  access modifiers are allowed on
  enumeration member declarations.</li>
  </ul>
</blockquote>

<p>(Note that nested types would come under the ""class members"" or ""struct members"" parts - and therefore default to private visibility.)</p>
","2521492"
"Send a file via HTTP POST with C#","151102","","<p>I've been searching and reading around to that and couldn't fine anything really useful.</p>

<p>I'm writing an small C# win app that allows user to send files to a web server, not by FTP, but by HTTP using POST. Think of it like a web form but running on a windows application.</p>

<p>I have my HttpWebRequest object created using something like this </p>

<pre><code>HttpWebRequest req = WebRequest.Create(uri) as HttpWebRequest 
</code></pre>

<p>and also set the <code>Method</code>, <code>ContentType</code> and <code>ContentLength</code> properties. But thats the far I can go.</p>

<p>This is my piece of code:</p>

<pre><code>HttpWebRequest req = WebRequest.Create(uri) as HttpWebRequest;
req.KeepAlive = false;
req.Method = ""POST"";
req.Credentials = new NetworkCredential(user.UserName, user.UserPassword);
req.PreAuthenticate = true;
req.ContentType = file.ContentType;
req.ContentLength = file.Length;
HttpWebResponse response = null;

try
{
    response = req.GetResponse() as HttpWebResponse;
}
catch (Exception e) 
{
}
</code></pre>

<p>So my question is basically how can I send a fie (text file, image, audio, etc) with C# via HTTP POST.</p>

<p>Thanks!</p>
","<p>Using .NET 4.5 (or .NET 4.0 by adding the <a href=""http://nuget.org/Packages/Microsoft.Net.Http"">Microsoft.Net.Http</a> package from NuGet) there is an easier way to simulate form requests. Here is an example:</p>

<pre><code>private System.IO.Stream Upload(string actionUrl, string paramString, Stream paramFileStream, byte [] paramFileBytes)
{
    HttpContent stringContent = new StringContent(paramString);
    HttpContent fileStreamContent = new StreamContent(paramFileStream);
    HttpContent bytesContent = new ByteArrayContent(paramFileBytes);
    using (var client = new HttpClient())
    using (var formData = new MultipartFormDataContent())
    {
        formData.Add(stringContent, ""param1"", ""param1"");
        formData.Add(fileStreamContent, ""file1"", ""file1"");
        formData.Add(bytesContent, ""file2"", ""file2"");
        var response = client.PostAsync(actionUrl, formData).Result;
        if (!response.IsSuccessStatusCode)
        {
            return null;
        }
        return response.Content.ReadAsStreamAsync().Result;
    }
}
</code></pre>
","19664927"
"In C#, should I use string.Empty or String.Empty or """" to intitialize a string?","150998","","<p>In C#, I want to initialize a string value with an empty string.</p>

<p>How should I do this? 
What is the right way, and why?</p>

<pre><code>string willi = string.Empty;
</code></pre>

<p>or</p>

<pre><code>string willi = String.Empty;
</code></pre>

<p>or</p>

<pre><code>string willi = """";
</code></pre>

<p>or what?</p>
","<p><strong>Use whatever you and your team find the most readable.</strong></p>

<p>Other answers have suggested that a new string is created every time you use <code>""""</code>. This is not true - due to string interning, it will be created either once per assembly or once per AppDomain (or possibly once for the whole process - not sure on that front). This difference is negligible - massively, <em>massively</em> insignificant.</p>

<p>Which you find more readable is a different matter, however. It's subjective and will vary from person to person - so I suggest you find out what most people on your team like, and all go with that for consistency. Personally I find <code>""""</code> easier to read.</p>

<p>The argument that <code>""""</code> and <code>"" ""</code> are easily mistaken for each other doesn't really wash with me. Unless you're using a proportional font (and I haven't worked with <em>any</em> developers who do) it's pretty easy to tell the difference.</p>
","263257"
"How can I know if a process is running?","150983","","<p>When I get a reference to a <code>System.Diagnostics.Process</code>, how can I know if a process is currently running?</p>
","<p>This is a way to do it with the name:</p>

<pre><code>Process[] pname = Process.GetProcessesByName(""notepad"");
if (pname.Length == 0)
  MessageBox.Show(""nothing"");
else
  MessageBox.Show(""run"");
</code></pre>

<p>You can loop all process to get the ID for later manipulation:</p>

<pre><code>Process[] processlist = Process.GetProcesses();
foreach(Process theprocess in processlist){
   Console.WriteLine(""Process: {0} ID: {1}"", theprocess.ProcessName, theprocess.Id);
}
</code></pre>
","262291"
"adding child nodes in treeview","150917","","<p>I'm new to C# and don't have any programming experience. But I've finish a C# basics.
Now I would like to design a simple tree view by adding parent node and child node.</p>

<p>I would like to add a second child for the Second node, I'm quite stuck here and don't know what's next.</p>

<p>Any ideas?</p>

<p>Here is the code:</p>

<pre><code>    private void addParentNode_Click(object sender, EventArgs e)
    {
        string yourParentNode;
        yourParentNode = textBox1.Text.Trim();
        treeView2.Nodes.Add(yourParentNode);
    }

    private void addChildNode_Click(object sender, EventArgs e)
    {
        string yourChildNode;
        yourChildNode = textBox1.Text.Trim();
        treeView2.Nodes[0].Nodes.Add(yourChildNode);
    }
</code></pre>

<p>Sorry I wasn't clear, I'm not sure if I really need this one here: </p>

<pre><code>  //treeView1.BeginUpdate(); 
  //treeView1.Nodes.Clear();
</code></pre>

<p>What I'm trying to do, is to add Parent Nodes and child node. In my code, I can add several Parent Nodes, but if I want to add a child node, it only add in the first parent node. 
I want that if I add a child node, I want to add it to the second parent or third parent.</p>

<p>In my code I only use one treeview here which names as treeview2
Here is the <a href=""http://www.mypicx.com/05192009/error/"" rel=""noreferrer""><strong>screenshot</strong></a></p>

<p>this is how my final code looks like:
Before I put the else, I'm getting an error if I don't select anything. So I made it that way that if there is nothing selected it will add the ""child node"" to the ""default node"" or (parent1 node). It seems to work good. Thanks guys;-)</p>

<pre><code>    //This is for adding a parent node
    private void addParentNode_Click(object sender, EventArgs e)
    {
        treeView2.BeginUpdate();

        string yourParentNode;
        yourParentNode = textBox1.Text.Trim();
        treeView2.Nodes.Add(yourParentNode);
        treeView2.EndUpdate();
    }

    //This is for adding child node
    private void addChildNode_Click(object sender, EventArgs e)
    {
        if (treeView2.SelectedNode != null)
        {
            string yourChildNode;
            yourChildNode = textBox1.Text.Trim();

            treeView2.SelectedNode.Nodes.Add(yourChildNode);
            treeView2.ExpandAll();
        }
        //This is for adding the child node to the default node(parent 1 node)
        else
        {
            string yourChildNode;
            yourChildNode = textBox1.Text.Trim();
            treeView2.Nodes[0].Nodes.Add(yourChildNode);
        }
</code></pre>

<p>Additional question: Are there any other ways on how the code be better? Because here, I declare the string ""yourChildNode"" twice. One in the if and other one in the else, are there any simplification? </p>
","<p>It's not that bad, but you forgot to call <code>treeView2.EndUpdate()</code> in your <code>addParentNode_Click()</code> method.<br>
You can also call <code>treeView2.ExpandAll()</code> at the end of your <code>addChildNode_Click()</code> method to see your child node directly.  </p>

<pre><code>private void addParentNode_Click(object sender, EventArgs e) {
  treeView2.BeginUpdate();
  //treeView2.Nodes.Clear();
  string yourParentNode;
  yourParentNode = textBox1.Text.Trim();
  treeView2.Nodes.Add(yourParentNode);
  treeView2.EndUpdate();
}

private void addChildNode_Click(object sender, EventArgs e) {
  if (treeView2.SelectedNode != null) {
    string yourChildNode;
    yourChildNode = textBox1.Text.Trim();
    treeView2.SelectedNode.Nodes.Add(yourChildNode);
    treeView2.ExpandAll();
  }
}
</code></pre>

<p>I don't know if it was a mistake or not but there was 2 TreeViews. I changed it to only 1 TreeView...</p>

<p>EDIT: Answer to the additional question:<br>
You can declare the variable holding the child node name outside of the if clause:</p>

<pre><code>private void addChildNode_Click(object sender, EventArgs e) {
  var childNode = textBox1.Text.Trim();
  if (!string.IsNullOrEmpty(childNode)) {
    TreeNode parentNode = treeView2.SelectedNode ?? treeView2.Nodes[0];
    if (parentNode != null) {
      parentNode.Nodes.Add(childNode);
      treeView2.ExpandAll();
    }
  }
}
</code></pre>

<p>Note: see <a href=""http://www.yoda.arachsys.com/csharp/csharp2/nullable.html"" rel=""noreferrer"">http://www.yoda.arachsys.com/csharp/csharp2/nullable.html</a> for info about the ?? operator.</p>
","881629"
"Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints","150916","","<p>I make an outer join and executed successfully in the <code>informix</code> database but I get the following exception in my code:</p>

<pre><code>DataTable dt = TeachingLoadDAL.GetCoursesWithEvalState(i, bat);
</code></pre>

<blockquote>
  <p>Failed to enable constraints. One or more rows contain values
  violating non-null, unique, or foreign-key constraints.</p>
</blockquote>

<p>I know the problem, but I don't know how to fix it.</p>

<p>The second table I make the outer join on contains a composite primary key which are null in the previous outer join query.</p>

<p><strong>EDIT:</strong></p>

<pre><code>    SELECT UNIQUE a.crs_e,  a.crs_e  || '/ ' || a.crst crs_name, b.period,
           b.crscls, c.crsday, c.from_lect, c.to_lect,
           c.to_lect - c.from_lect + 1 Subtraction, c.lect_kind, e.eval, e.batch_no,
           e.crsnum, e.lect_code, e.prof_course
    FROM rlm1course a, rfc14crsgrp b, ckj1table c, mnltablelectev d,
         OUTER(cc1assiscrseval e)  
    WHERE a.crsnum = b.crsnum 
    AND b.crsnum = c.crsnum 
    AND b.crscls = c.crscls 
    AND b.batch_no = c.batch_no 
    AND c.serial_key = d.serial_key  
    AND c.crsnum = e.crsnum  
    AND c.batch_no = e.batch_no  
    AND d.lect_code= e.lect_code 
    AND d.lect_code = .... 
    AND b.batch_no = ....
</code></pre>

<p>The problem happens with the table <code>cc1assiscrseval</code>. The primary key is (batch_no, crsnum, lect_code).</p>

<p>How to fix this problem?</p>

<hr>

<p><strong>EDIT:</strong></p>

<p>According to <code>@PaulStock</code> advice:
I do what he said, and i get:</p>

<blockquote>
  <p>? dt.GetErrors()[0] {System.Data.DataRow} HasErrors: true ItemArray:
  {object[10]} RowError: ""Column 'eval' does not allow DBNull.Value.""</p>
</blockquote>

<p>So I solve my problem by replacing  <code>e.eval</code> to ,<code>NVL (e.eval,'') eval</code>.and this solves my problem.
Thanks a lot.</p>
","<p>This problem is usually caused by one of the following</p>

<ul>
<li>null values being returned for columns not set to AllowDBNull</li>
<li>duplicate rows being returned with the same primary key.</li>
<li>a mismatch in column definition (e.g. size of char fields) between the database and the dataset</li>
</ul>

<p>Try running your query natively and look at the results, if the resultset is not too large. If you've eliminated null values, then my guess is that the primary key columns is being duplicated.</p>

<p>Or, to see the exact error, you can manually add a Try/Catch block to the generated code like so and then breaking when the exception is raised:</p>

<p><img src=""https://i.stack.imgur.com/HQrHa.png"" alt=""enter image description here""></p>

<p>Then within the command window, call <code>GetErrors</code> method on the table getting the error.<br>
For C#, the command would be <code>? dataTable.GetErrors()</code><br>
For VB, the command is <code>? dataTable.GetErrors</code></p>

<p><img src=""https://i.stack.imgur.com/ekNb5.png"" alt=""enter image description here""></p>

<p>This will show you all datarows which have an error. You can get then look at the <code>RowError</code> for each of these, which should tell you the column that's invalid along with the problem. So, to see the error of the first datarow in error the command is:<br>
<code>? dataTable.GetErrors(0).RowError</code><br>
or in C# it would be <code>? dataTable.GetErrors()[0].RowError</code></p>

<p><img src=""https://i.stack.imgur.com/Ynmlf.png"" alt=""enter image description here""></p>
","7029713"
"How to set username and password for SmtpClient object in .NET?","150637","","<p>I see different versions of the constructor, one uses info from web.config, one specifies the host, and one the host and port. But how do I set the username and password to something different from the web.config? We have the issue where our internal smtp is blocked by some high security clients and we want to use their smtp server, is there a way to do this from the code instead of web.config?</p>

<p>In this case how would I use the web.config credentials if none is available from the database, for example?</p>

<pre><code>public static void CreateTestMessage1(string server, int port)
{
    string to = ""jane@contoso.com"";
    string from = ""ben@contoso.com"";
    string subject = ""Using the new SMTP client."";
    string body = @""Using this new feature, you can send an e-mail message from an application very easily."";
    MailMessage message = new MailMessage(from, to, subject, body);
    SmtpClient client = new SmtpClient(server, port);
    // Credentials are necessary if the server requires the client 
    // to authenticate before it will send e-mail on the client's behalf.
    client.Credentials = CredentialCache.DefaultNetworkCredentials;

    try {
        client.Send(message);
    }
    catch (Exception ex) {
        Console.WriteLine(""Exception caught in CreateTestMessage1(): {0}"", 
                    ex.ToString());
    }              
}
</code></pre>
","<p>The SmtpClient can be used by code:</p>

<pre><code>SmtpClient mailer = new SmtpClient();
mailer.Host = ""mail.youroutgoingsmtpserver.com"";
mailer.Credentials = new System.Net.NetworkCredential(""yourusername"", ""yourpassword"");
</code></pre>
","2766967"
"How to remove new line characters from a string?","150619","","<p>I have a string in the following format</p>

<pre><code>string s = ""This is a Test String.\n   This is a next line.\t This is a tab.\n'
</code></pre>

<p>I want to remove all the occurrences of <code>\n</code> and <code>\r</code> from the string above.</p>

<p>I have tried <code>string s = s.Trim(new char[] {'\n', '\r'});</code> but it didn't help.</p>
","<p>I like to use regular expressions. In this case you could do:</p>

<pre><code>string replacement = Regex.Replace(s, @""\t|\n|\r"", """");
</code></pre>

<p>Regular expressions aren't as popular in the .NET world as they are in the dynamic languages, but they provide a lot of power to manipulate strings.</p>
","4140802"
"Write string to text file and ensure it always overwrites the existing content.","150605","","<p>I have a string with a C# program that I want to write to a file and always overwrite the existing content.  If the file isn't there, the program should create a new file instead of throwing an exception.</p>
","<pre><code>System.IO.File.WriteAllText (@""D:\path.txt"", contents);
</code></pre>

<p>Please make sure you have appropriate privileges to write at the location, otherwise you will get an exception.</p>
","1225869"
"Accessing MVC's model property from Javascript","150590","","<p>I have the following model which is wrapped in my view model</p>

<pre><code>public class FloorPlanSettingsModel
{
    public int Id { get; set; }
    public int? MainFloorPlanId { get; set; }
    public string ImageDirectory { get; set; }
    public string ThumbnailDirectory { get; set; }
    public string IconsDirectory { get; set; }
}
</code></pre>

<p>How do I access one of the above properties from Javascript?</p>

<p>I tried this, but I got ""undefined""</p>

<pre><code>var floorplanSettings = ""@Model.FloorPlanSettings"";
alert(floorplanSettings.IconsDirectory);
</code></pre>
","<p>You could take your entire server-side model and turn it into a Javascript object by doing the following:</p>

<pre><code>var model = @Html.Raw(Json.Encode(Model));
</code></pre>

<p>In your case if you just want the FloorPlanSettings object, simply pass the <code>Encode</code> method that property:</p>

<pre><code>var floorplanSettings = @Html.Raw(Json.Encode(Model.FloorPlanSettings));
</code></pre>
","16361388"
"What are major differences between C# and Java?","150586","","<p>I just want to clarify one thing. This is not a question on which one is better, that part I leave to someone else to discuss. I don't care about it.
I've been asked this question on my job interview and I thought it might be useful to learn a bit more.</p>

<p>These are the ones I could come up with:</p>

<ul>
<li>Java is ""platform independent"". Well nowadays you could say there is the <a href=""http://en.wikipedia.org/wiki/Mono_%28software%29"" rel=""noreferrer"">Mono</a> project so C# could be considered too but
I believe it is a bit exaggerating. Why? Well, when a new release of Java is done it is simultaneously available on all platforms it supports, on the other hand how many features of C# 3.0 are still missing in the Mono implementation? Or is it really <a href=""http://en.wikipedia.org/wiki/Common_Language_Runtime"" rel=""noreferrer"">CLR</a> vs. <a href=""http://en.wikipedia.org/wiki/JRE"" rel=""noreferrer"">JRE</a> that we should compare here?</li>
<li>Java doesn't support events and delegates. As far as I know.</li>
<li>In Java all methods are virtual</li>
<li>Development tools: I believe there isn't such a tool yet as Visual Studio. Especially if you've worked with team editions you'll know what I mean.</li>
</ul>

<p>Please add others you think are relevant.</p>

<p>Update:
Just popped up my mind, Java doesn't have something like custom attributes on classes, methods etc. Or does it?</p>
","<p><strong>Comparing Java 7 and C# 3</strong></p>

<p>(Some features of Java 7 aren't mentioned here, but the <code>using</code> statement advantage of all versions of C# over Java 1-6 has been removed.)</p>

<p>Not all of your summary is correct:</p>

<ul>
<li>In Java methods are virtual <em>by default</em> but you can make them final. (In C# they're sealed by default, but you can make them virtual.)</li>
<li>There are plenty of IDEs for Java, both free (e.g. Eclipse, Netbeans) and commercial (e.g. IntelliJ IDEA)</li>
</ul>

<p>Beyond that (and what's in your summary already):</p>

<ul>
<li>Generics are completely different between the two; Java generics are just a compile-time ""trick"" (but a useful one at that). In C# and .NET generics are maintained at execution time too, and work for value types as well as reference types, keeping the appropriate efficiency (e.g. a <code>List&lt;byte&gt;</code> as a <code>byte[]</code> backing it, rather than an array of boxed bytes.)</li>
<li>C# doesn't have checked exceptions</li>
<li>Java doesn't allow the creation of user-defined value types</li>
<li>Java doesn't have operator and conversion overloading</li>
<li>Java doesn't have iterator blocks for simple implemetation of iterators</li>
<li>Java doesn't have anything like LINQ</li>
<li>Partly due to not having delegates, Java doesn't have anything quite like anonymous methods and lambda expressions. Anonymous inner classes usually fill these roles, but clunkily.</li>
<li>Java doesn't have expression trees</li>
<li>C# doesn't have anonymous inner classes</li>
<li>C# doesn't have Java's inner classes at all, in fact - all nested classes in C# are like Java's static nested classes</li>
<li>Java doesn't have static classes (which don't have <em>any</em> instance constructors, and can't be used for variables, parameters etc)</li>
<li>Java doesn't have any equivalent to the C# 3.0 anonymous types</li>
<li>Java doesn't have implicitly typed local variables</li>
<li>Java doesn't have extension methods</li>
<li>Java doesn't have object and collection initializer expressions</li>
<li>The access modifiers are somewhat different - in Java there's (currently) no direct equivalent of an assembly, so no idea of ""internal"" visibility; in C# there's no equivalent to the ""default"" visibility in Java which takes account of namespace (and inheritance)</li>
<li>The order of initialization in Java and C# is subtly different (C# executes variable initializers before the chained call to the base type's constructor)</li>
<li>Java doesn't have properties as part of the language; they're a convention of get/set/is methods</li>
<li>Java doesn't have the equivalent of ""unsafe"" code</li>
<li>Interop is easier in C# (and .NET in general) than Java's JNI</li>
<li>Java and C# have somewhat different ideas of enums. Java's are much more object-oriented.</li>
<li>Java has no preprocessor directives (#define, #if etc in C#).</li>
<li>Java has no equivalent of C#'s <code>ref</code> and <code>out</code> for passing parameters by reference</li>
<li>Java has no equivalent of partial types</li>
<li>C# interfaces cannot declare fields</li>
<li>Java has no unsigned integer types</li>
<li>Java has no <em>language</em> support for a decimal type. (java.math.BigDecimal provides something <em>like</em> System.Decimal - with differences - but there's no language support)</li>
<li>Java has no equivalent of nullable value types</li>
<li>Boxing in Java uses predefined (but ""normal"") reference types with particular operations on them. Boxing in C# and .NET is a more transparent affair, with a reference type being created for boxing by the CLR for any value type.</li>
</ul>

<p>This is not exhaustive, but it covers everything I can think of off-hand.</p>
","295248"
"Class is inaccessible due to its protection level","150407","","<p>I have three classes. all are part of the same namespace. here are the basics of the three classes.</p>

<pre><code>//FBlock.cs
namespace StubGenerator.PropGenerator
{
    class FBlock : IDesignRegionInserts, IFormRegionInserts, IAPIRegionInserts,  IConfigurationInserts, ISoapProxyClientInserts, ISoapProxyServiceInserts
    {
        private List&lt;Property&gt; pProperties;
        private List&lt;Method&gt; pMethods;
        public FBlock(string aFBlockName)
        { 
            pProperties = new List&lt;Property&gt;();
            pMethods = new List&lt;Method&gt;();
        }

        public Property AddProperty(string aName)
        {
            Property loProp = new Property(this, aName, pProperties.Count);
            pProperties.Add(loProp);
            return loProp;
         }

         public Method AddMethod(string aName)
         {
             Method loMeth = new Method(this, aName);
             pMethods.Add(loMeth);
             return loMeth;
         }
     }

 //Method.cs
 namespace StubGenerator.PropGenerator
 {
     class Method : IPropertyName
     {
         private List&lt;StubGenerator.PropGenerator.PropertyAttribute&gt; pPropertyAttributes;
         private string pName;
         private string pFBlockName;

         public Method(FBlock aFBlock,string aName)
         {
             pPropertyAttributes = new List&lt;PropertyAttribute&gt;();
             pName = aName;
             pFBlockName = aFBlock.Name;
         }
      }
 }

 //Property.cs
 namespace StubGenerator.PropGenerator
 {
    class Property : StubGenerator.PropGenerator.IPropertyName, StubGenerator.PropGenerator.IDesignRegionInserts, StubGenerator.PropGenerator.IFormRegionInserts, IAPIRegionInserts, IConfigurationInserts, ISoapProxyClientInserts, ISoapProxyServiceInserts
    {
        private string pName;
        private string pExpandedName;
        private string pFBlockInitials;

        private Group pPropertyGroup;
        private FlowLayoutPanel pGroupFlowPanel;
        private Button pUpdateButton;
        private CheckBox pShowProperty;


         private string pFBlockName;


         public Property(FBlock aFBlock, string aName, int aIndex)
         {
             pPropertyAttributes = new List&lt;PropertyAttribute&gt;();
             pFBlockName = aFBlock.FBlockName;

             ExpandName();
             GetInitials();

             pShowProperty = new CheckBox(this, 10, (aIndex + 1) * 20, aIndex);
             pPropertyGroup = new Group(this);
             pGroupFlowPanel = new FlowLayoutPanel(this);

             pUpdateButton = new Button(this, 10, 18, aIndex);
         }
     }
}
</code></pre>

<p>I'm getting the following errors</p>

<blockquote>
  <p>'StubGenerator.PropGenerator.Method' is inaccessible due to its protection level </p>
</blockquote>

<p>which refers to the following line in the FBlock.cs file</p>

<pre><code>private List&lt;Method&gt; pMethods;
</code></pre>

<p>and</p>

<blockquote>
  <p>'StubGenerator.PropGenerator.Method' is inaccessible due to its protection level </p>
</blockquote>

<p>which refers to the following line in the FBlock.cs file</p>

<pre><code> public Method AddMethod(string aName)
</code></pre>

<p>and</p>

<blockquote>
  <p>Inconsistent accessibility: return type 'StubGenerator.PropGenerator.Method' is less accessible than method 'StubGenerator.PropGenerator.FBlock.AddMethod(string)' </p>
</blockquote>

<p>which refers to the following line in the FBlock.cs file</p>

<pre><code> public Method AddMethod(string aName)
</code></pre>

<p>making the class Method public does not resolve the errors.  I can't figure out why I don't get the errors when calling the Property class. And I don't understand why making the Method class public doesn't fix the problem.</p>

<p>Any ideas?</p>

<p>Edited to ask. could there be some setting on the file that causes this?</p>
","<p>There was a project that used linked files.  I needed to add the method.cs file to that project as a linked file as well, since the FBlock.cs file was there.  I've never heard of linked files before, I didn't even know that was possible. </p>
","3668846"
"Datagridview: How to set a cell in editing mode?","150319","","<p>I need to programmatically set a cell in editing mode. I know that setting that cell as CurrentCell and then call the method BeginEdit(bool), it should happen, but in my case, it doesn't.</p>

<p>I really want that, with my DGV with several columns, the user can ONLY select and also edit the first two. The other columns are already read-only, but the user can select them, and that is what I don't want.</p>

<p>So I was thinking, tell the user to TAB everytime it has finished writing on the cell, then select the second cell, then tab again and it select and begin edit the next row's first cell...</p>

<p>How can I do this?</p>
","<p>Setting the <code>CurrentCell</code> and then calling <code>BeginEdit(true)</code> works well for me.</p>

<p>The following code shows an eventHandler for the <code>KeyDown</code> event that sets a cell to be editable. </p>

<p>My example only implements one of the required key press overrides but in theory the others should work the same. (and I'm always setting the [0][0] cell to be editable but any other cell should work)</p>

<pre><code>    private void dataGridView1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Tab &amp;&amp; dataGridView1.CurrentCell.ColumnIndex == 1)
        {
            e.Handled = true;
            DataGridViewCell cell = dataGridView1.Rows[0].Cells[0];
            dataGridView1.CurrentCell = cell;
            dataGridView1.BeginEdit(true);               
        }
    }
</code></pre>

<p>If you haven't found it previously, the <a href=""https://www.google.de/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CCwQFjAA&amp;url=http%3A%2F%2Fdownload.microsoft.com%2Fdownload%2F5%2F6%2F4%2F5646742C-3EB7-48F7-BFB3-CC295D618CF9%2FDataGridView%2520FAQ.doc&amp;ei=FFgTUrW2HYfChAeMnYDwCg&amp;usg=AFQjCNHE0C79uGnD14VrXWm07wvfhzPWUQ&amp;bvm=bv.50952593,d.ZG4"" rel=""noreferrer"">DataGridView FAQ</a> is a great resource, written by the program manager for the DataGridView control, which covers most of what you could want to do with the control.</p>
","1814525"
"How to round up the result of integer division?","150152","","<p>I'm thinking in particular of how to display pagination controls, when using a language such as C# or Java.</p>

<p>If I have <em>x</em> items which I want to display in chunks of <em>y</em> per page, how many pages will be needed?</p>
","<p>Found an elegant solution:</p>

<pre><code>int pageCount = (records + recordsPerPage - 1) / recordsPerPage;
</code></pre>

<p>Source: <a href=""http://www.cs.nott.ac.uk/~rcb/G51MPC/slides/NumberLogic.pdf"" rel=""noreferrer"">Number Conversion, Roland Backhouse, 2001</a></p>
","17974"
"Associating enums with strings in C#","150031","","<p>I know the following is not possible because it has to be an int</p>

<pre><code>enum GroupTypes
{
    TheGroup = ""OEM"",
    TheOtherGroup = ""CMB""
}
</code></pre>

<p>From my database I get a field with incomprehensive codes (the OEM and CMB's). I would want to make this field into an enum or something else understandable. Because the target is readability the solution should be terse.<br>
What other options do I have? </p>
","<p>I like to use <strong>properties in a class</strong> instead of methods, since they look more enum-like.</p>

<p>Here's a example for a Logger:</p>

<pre><code>public class LogCategory
{
 private LogCategory(string value) { Value = value; }

 public string Value { get; set; }

 public static LogCategory Trace { get { return new LogCategory(""Trace""); } }
 public static LogCategory Debug { get { return new LogCategory(""Debug""); } }
 public static LogCategory Info { get { return new LogCategory(""Info""); } }
 public static LogCategory Warning { get { return new LogCategory(""Warning""); } }
 public static LogCategory Error { get { return new LogCategory(""Error""); } }
}
</code></pre>

<p>Pass in <strong>type-safe string values</strong> as a parameter:</p>

<pre><code>public static void Write(string message, LogCategory logCategory)
{
   var log = new LogEntry { Message = message };
   Logger.Write(log, logCategory.Value);
}
</code></pre>

<p>Usage:</p>

<pre><code>Logger.Write(""This is almost like an enum."", LogCategory.Info);
</code></pre>
","1343517"
"DbEntityValidationException - How can I easily tell what caused the error?","150031","","<p>I have a project that uses Entity Framework. While calling <code>SaveChanges</code> on my <code>DbContext</code>, I get the following exception:</p>

<blockquote>
  <p>System.Data.Entity.Validation.DbEntityValidationException: Validation
  failed for one or more entities. See 'EntityValidationErrors' property
  for more details.</p>
</blockquote>

<p>This is all fine and dandy, but I don't want to attach a debugger every time this exception occurs. More over, in production environments I cannot easily attach a debugger so I have to go to great lengths to reproduce these errors. </p>

<p>How can I see the details hidden within the <code>DbEntityValidationException</code>?</p>
","<p>The easiest solution is to override <code>SaveChanges</code> on your entities class. You can catch the <code>DbEntityValidationException</code>, unwrap the actual errors and create a new <code>DbEntityValidationException</code> with the improved message.</p>

<ol>
<li>Create a partial class next to your SomethingSomething.Context.cs file.</li>
<li>Use the code at the bottom of this post. </li>
<li>That's it. Your implementation will automatically use the overriden SaveChanges without any refactor work.</li>
</ol>

<p>Your exception message will now look like this:</p>

<blockquote>
  <p>System.Data.Entity.Validation.DbEntityValidationException: Validation
  failed for one or more entities. See 'EntityValidationErrors' property
  for more details. The validation errors are: The field PhoneNumber
  must be a string or array type with a maximum length of '12'; The
  LastName field is required.</p>
</blockquote>

<p>You can drop the overridden SaveChanges in any class that inherits from <code>DbContext</code>:</p>

<pre><code>public partial class SomethingSomethingEntities
{
    public override int SaveChanges()
    {
        try
        {
            return base.SaveChanges();
        }
        catch (DbEntityValidationException ex)
        {
            // Retrieve the error messages as a list of strings.
            var errorMessages = ex.EntityValidationErrors
                    .SelectMany(x =&gt; x.ValidationErrors)
                    .Select(x =&gt; x.ErrorMessage);
    
            // Join the list to a single string.
            var fullErrorMessage = string.Join(""; "", errorMessages);
    
            // Combine the original exception message with the new one.
            var exceptionMessage = string.Concat(ex.Message, "" The validation errors are: "", fullErrorMessage);
    
            // Throw a new DbEntityValidationException with the improved exception message.
            throw new DbEntityValidationException(exceptionMessage, ex.EntityValidationErrors);
        }
    }
}
</code></pre>

<p>The <code>DbEntityValidationException</code> also contains the entities that caused the validation errors. So if you require even more information, you can change the above code to output information about these entities.</p>

<p><strong>See also: <a href=""http://devillers.nl/improving-dbentityvalidationexception/"">http://devillers.nl/improving-dbentityvalidationexception/</a></strong></p>
","15820506"
"Collection was modified; enumeration operation may not execute in ArrayList","150012","","<p>I'm trying to remove an item from an <code>ArrayList</code> and I get this Exception:<br>
<code>Collection was modified; enumeration operation may not execute.</code> </p>

<p>Any ideas?</p>
","<p>You are removing the item during a <code>foreach</code>, yes? Simply, you can't. There are a few common options here:</p>

<ul>
<li>use <code>List&lt;T&gt;</code> and <code>RemoveAll</code> with a predicate</li>
<li><p>iterate backwards by index, removing matching items</p>

<pre><code>for(int i = list.Count - 1; i &gt;= 0; i--) {
    if({some test}) list.RemoveAt(i);
}
</code></pre></li>
<li><p>use <code>foreach</code>, and put matching items into a second list; now enumerate the second list and remove those items from the first (if you see what I mean)</p></li>
</ul>
","2024194"
"How can I create a temp file with a specific extension with .NET?","149968","","<p>I need to generate a unique temporary file with a .csv extension.</p>

<p>What I do right now is </p>

<pre><code>string filename = System.IO.Path.GetTempFileName().Replace("".tmp"", "".csv"");
</code></pre>

<p>However, this doesn't guarantee that my .csv file will be unique.</p>

<p>I know the chances I ever got a collision are very low (especially if you consider that I don't delete the .tmp files), but this code doesn't looks good to me.</p>

<p>Of course I could manually generate random file names until I eventually find a unique one (which shouldn't be a problem), but I'm curious to know if others have found a nice way to deal with this problem.</p>
","<p>Guaranteed to be (statistically) unique:</p>

<pre><code>string fileName = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + "".csv""; 
</code></pre>

<p>(To quote from the wiki article on the probabilty of a collision:</p>

<blockquote>
  <p>...one's annual risk of being hit by a
  meteorite is estimated to be one
  chance in 17 billion [19], that means
  the probability is about 0.00000000006
  (6 × 10−11), equivalent to the odds of
  creating a few tens of trillions of
  UUIDs in a year and having one
  duplicate. In other words, only after
  generating 1 billion UUIDs every
  second for the next 100 years, the
  probability of creating just one
  duplicate would be about 50%. The
  probability of one duplicate would be
  about 50% if every person on earth
  owns 600 million UUIDs</p>
</blockquote>

<p>EDIT: Please also see JaredPar's comments.</p>
","581574"
"Convert any object to a byte[]","149482","","<p>I am writing a prototype TCP connection and I am having some trouble homogenizing the data to be sent.</p>

<p>At the moment, I am sending nothing but strings, but in the future we want to be able to send any object. </p>

<p>The code is quite simple at the moment, because I thought everything could be cast into a byte array:</p>

<pre><code>void SendData(object headerObject, object bodyObject)
{
  byte[] header = (byte[])headerObject;  //strings at runtime, 
  byte[] body = (byte[])bodyObject;      //invalid cast exception

  // Unable to cast object of type 'System.String' to type 'System.Byte[]'.
  ...
}
</code></pre>

<p>This of course is easily enough solved with a </p>

<pre><code>if( state.headerObject is System.String ){...}
</code></pre>

<p>The problem is, if I do it that way, I need to check for EVERY type of object that can't be cast to a byte[] at runtime.</p>

<p>Since I do not know every object that can't be cast into a byte[] at runtime, this really isn't an option.</p>

<p>How does one convert any object at all into a byte array in C# .NET 4.0?</p>
","<p>Use the <a href=""http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx"" rel=""noreferrer""><code>BinaryFormatter</code></a>:</p>

<pre><code>byte[] ObjectToByteArray(object obj)
{
    if(obj == null)
        return null;
    BinaryFormatter bf = new BinaryFormatter();
    using (MemoryStream ms = new MemoryStream())
    {
        bf.Serialize(ms, obj);
        return ms.ToArray();
    }
}
</code></pre>

<p>Note that <code>obj</code> and any properties/fields within <code>obj</code> (and so-on for all of their properties/fields) will all need to be tagged with the <a href=""https://msdn.microsoft.com/en-us/library/system.serializableattribute(v=vs.110).aspx"" rel=""noreferrer""><code>Serializable</code> attribute</a> to successfully be serialized with this.</p>
","4865123"
"What is the C# equivalent of friend?","149447","","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/203616/why-does-c-sharp-not-provide-the-c-style-friend-keyword"">Why does C# not provide the C++ style ‘friend’ keyword?</a>  </p>
</blockquote>



<p>I'd like the private member variables of a class to be accessible to a Tester class without exposing them to other classes. </p>

<p>In C++ I'd just declare the Tester class as a friend, how do I do this in C#? Can someone give me an example?</p>
","<p>There's no direct equivalent of ""friend"" - the closest that's available (and it isn't very close) is <a href=""http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx"" rel=""noreferrer"">InternalsVisibleTo</a>. I've only ever used this attribute for testing - where it's very handy!</p>

<p><strong>Example:</strong> To be placed in <code>AssemblyInfo.cs</code></p>

<pre><code>[assembly: InternalsVisibleTo(""OtherAssembly"")]
</code></pre>
","204744"
"Creating an XmlNode/XmlElement in C# without an XmlDocument?","149411","","<p>I have a simple class that essentially just holds some values. I have overridden the <code>ToString()</code> method to return a nice string representation.</p>

<p>Now, I want to create a <code>ToXml()</code> method, that will return something like this:</p>

<pre><code>&lt;Song&gt;
    &lt;Artist&gt;Bla&lt;/Artist&gt;
    &lt;Title&gt;Foo&lt;/Title&gt;
&lt;/Song&gt;
</code></pre>

<p>Of course, I could just use a <code>StringBuilder</code> here, but I would like to return an <code>XmlNode</code> or <code>XmlElement</code>, to be used with <code>XmlDocument.AppendChild</code>.</p>

<p>I do not seem to be able to create an <code>XmlElement</code> other than calling <code>XmlDocument.CreateElement</code>, so I wonder if I have just overlooked anything, or if I really either have to pass in either a <code>XmlDocument</code> or <code>ref XmlElement</code> to work with, or have the function return a String that contains the XML I want?</p>
","<p>You may want to look at how you can use the built-in features of .NET to serialize and deserialize an object into XML, rather than creating a <code>ToXML()</code> method on every class that is essentially just a Data Transfer Object.</p>

<p>I have used these techniques successfully on a couple of projects but don’t have the implementation details handy right now. I will try to update my answer with my own examples sometime later.</p>

<p>Here's a couple of examples that Google returned:</p>

<p>XML Serialization in .NET by Venkat Subramaniam <a href=""http://www.agiledeveloper.com/articles/XMLSerialization.pdf"" rel=""noreferrer"">http://www.agiledeveloper.com/articles/XMLSerialization.pdf</a></p>

<p>How to Serialize and Deserialize an object into XML  <a href=""http://www.dotnetfunda.com/articles/article98.aspx"" rel=""noreferrer"">http://www.dotnetfunda.com/articles/article98.aspx</a></p>

<p>Customize your .NET object XML serialization with .NET XML attributes <a href=""http://blogs.microsoft.co.il/blogs/rotemb/archive/2008/07/27/customize-your-net-object-xml-serialization-with-net-xml-attributes.aspx"" rel=""noreferrer"">http://blogs.microsoft.co.il/blogs/rotemb/archive/2008/07/27/customize-your-net-object-xml-serialization-with-net-xml-attributes.aspx</a></p>
","215659"
"Find a row in dataGridView based on column and value","149304","","<p>I have a dataGridView that has 3 columns: SystemId, FirstName, LastName that is bound using database information.  I would like to highlight a certain row, which I would do using:</p>

<pre><code>dataGridView1.Rows[????].Selected = true;
</code></pre>

<p>The row ID I however do not know and the bindingsource keeps changing, thus row 10 could be ""John Smith"" in one instance but not even exist in another (I have a filter that filters out the source based on what user enters, so typing in ""joh"" would yield all rows where first / last name have ""joh"" in them, thus my list can go from 50 names to 3 in a click).  </p>

<p>I want to find a way how I can select a row based on SystemId and a corresponding number.  I can get the system ID using the following method:</p>

<pre><code>systemId = dataGridView1.Rows[dataGridView1.CurrentRow.Index].Cells[""SystemId""].Value.ToString();
</code></pre>

<p>Now I just need to apply it to the row selector.  Something like dataGridView1.Columns[""SystemId""].IndexOf(systemId} but that does not work (nor does such method exist).  Any help is greatly appreciated.</p>
","<p>This will give you the gridview row index for the value:</p>

<pre><code>String searchValue = ""somestring"";
int rowIndex = -1;
foreach(DataGridViewRow row in DataGridView1.Rows)
{
    if(row.Cells[1].Value.ToString().Equals(searchValue))
    {
        rowIndex = row.Index;
        break;
    }
}
</code></pre>

<p>Or a LINQ query</p>

<pre><code>int rowIndex = -1;

        DataGridViewRow row = dgv.Rows
            .Cast&lt;DataGridViewRow&gt;()
            .Where(r =&gt; r.Cells[""SystemId""].Value.ToString().Equals(searchValue))
            .First();

        rowIndex = row.Index;
</code></pre>

<p>then you can do:</p>

<pre><code>dataGridView1.Rows[rowIndex].Selected = true;
</code></pre>
","10179299"
"Disable Resizing of a Windows Form","149253","","<p>Does anyone know how to turn off the user's ability to resize a Windows form?
I'm having it resize itself on a click.</p>
","<p>Take a look at the <a href=""http://msdn.microsoft.com/en-us/library/system.windows.forms.form.formborderstyle.aspx"">FormBorderStyle property</a></p>

<pre><code>form1.FormBorderStyle = FormBorderStyle.FixedSingle;
</code></pre>

<p>You may also want to remove the minimize and maximize buttons:</p>

<pre><code>form1.MaximizeBox = false;
form1.MinimizeBox = false;
</code></pre>
","7970319"
"Best Timer for using in a Windows service","149150","","<p>I need to create some windows service which will execute every N period of time.<br>
The question is:<br>
Which timer control should I use: <code>System.Timers.Timer</code> or <code>System.Threading.Timer</code> one? Does it influence on something?  </p>

<p>I am asking because I heard many evidences to non correct work of <code>System.Timers.Timer</code> in windows services.<br>
Thank you.</p>
","<p>Both <a href=""http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx"" rel=""noreferrer""><code>System.Timers.Timer</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx"" rel=""noreferrer""><code>System.Threading.Timer</code></a> will work for services.</p>

<p>The timers you want to avoid are <a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx"" rel=""noreferrer""><code>System.Web.UI.Timer</code></a> and <a href=""http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx"" rel=""noreferrer""><code>System.Windows.Forms.Timer</code></a>, which are respectively for ASP applications and WinForms. Using those will cause the service to load an additional assembly which is not really needed for the type of application you are building.</p>

<p>Use <a href=""http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx"" rel=""noreferrer""><code>System.Timers.Timer</code></a> like the following example (also, make sure that you use a class level variable to prevent garbage collection, as stated in Tim Robinson's answer):</p>

<pre><code>using System;
using System.Timers;

public class Timer1
{
    private static System.Timers.Timer aTimer;

    public static void Main()
    {
        // Normally, the timer is declared at the class level,
        // so that it stays in scope as long as it is needed.
        // If the timer is declared in a long-running method,  
        // KeepAlive must be used to prevent the JIT compiler 
        // from allowing aggressive garbage collection to occur 
        // before the method ends. (See end of method.)
        //System.Timers.Timer aTimer;

        // Create a timer with a ten second interval.
        aTimer = new System.Timers.Timer(10000);

        // Hook up the Elapsed event for the timer.
        aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

        // Set the Interval to 2 seconds (2000 milliseconds).
        aTimer.Interval = 2000;
        aTimer.Enabled = true;

        Console.WriteLine(""Press the Enter key to exit the program."");
        Console.ReadLine();

        // If the timer is declared in a long-running method, use
        // KeepAlive to prevent garbage collection from occurring
        // before the method ends.
        //GC.KeepAlive(aTimer);
    }

    // Specify what you want to happen when the Elapsed event is 
    // raised.
    private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        Console.WriteLine(""The Elapsed event was raised at {0}"", e.SignalTime);
    }
}

/* This code example produces output similar to the following:

Press the Enter key to exit the program.
The Elapsed event was raised at 5/20/2007 8:42:27 PM
The Elapsed event was raised at 5/20/2007 8:42:29 PM
The Elapsed event was raised at 5/20/2007 8:42:31 PM
...
 */
</code></pre>

<p>If you choose <a href=""http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx"" rel=""noreferrer""><code>System.Threading.Timer</code></a>, you can use as follows:</p>

<pre><code>using System;
using System.Threading;

class TimerExample
{
    static void Main()
    {
        AutoResetEvent autoEvent     = new AutoResetEvent(false);
        StatusChecker  statusChecker = new StatusChecker(10);

        // Create the delegate that invokes methods for the timer.
        TimerCallback timerDelegate = 
            new TimerCallback(statusChecker.CheckStatus);

        // Create a timer that signals the delegate to invoke 
        // CheckStatus after one second, and every 1/4 second 
        // thereafter.
        Console.WriteLine(""{0} Creating timer.\n"", 
            DateTime.Now.ToString(""h:mm:ss.fff""));
        Timer stateTimer = 
                new Timer(timerDelegate, autoEvent, 1000, 250);

        // When autoEvent signals, change the period to every 
        // 1/2 second.
        autoEvent.WaitOne(5000, false);
        stateTimer.Change(0, 500);
        Console.WriteLine(""\nChanging period.\n"");

        // When autoEvent signals the second time, dispose of 
        // the timer.
        autoEvent.WaitOne(5000, false);
        stateTimer.Dispose();
        Console.WriteLine(""\nDestroying timer."");
    }
}

class StatusChecker
{
    int invokeCount, maxCount;

    public StatusChecker(int count)
    {
        invokeCount  = 0;
        maxCount = count;
    }

    // This method is called by the timer delegate.
    public void CheckStatus(Object stateInfo)
    {
        AutoResetEvent autoEvent = (AutoResetEvent)stateInfo;
        Console.WriteLine(""{0} Checking status {1,2}."", 
            DateTime.Now.ToString(""h:mm:ss.fff""), 
            (++invokeCount).ToString());

        if(invokeCount == maxCount)
        {
            // Reset the counter and signal Main.
            invokeCount  = 0;
            autoEvent.Set();
        }
    }
}
</code></pre>

<p>Both examples comes from the MSDN pages.</p>
","246719"
"Using Linq to group a list of objects into a new grouped list of list of objects","149066","","<p>I don't know if this is possible in Linq but here goes...</p>

<p>I have an object:</p>

<pre><code>public class User
{
  public int UserID { get; set; }
  public string UserName { get; set; }
  public int GroupID { get; set; }
}
</code></pre>

<p>I return a list that may look like the following:</p>

<pre><code>List&lt;User&gt; userList = new List&lt;User&gt;();
userList.Add( new User { UserID = 1, UserName = ""UserOne"", GroupID = 1 } );
userList.Add( new User { UserID = 2, UserName = ""UserTwo"", GroupID = 1 } );
userList.Add( new User { UserID = 3, UserName = ""UserThree"", GroupID = 2 } );
userList.Add( new User { UserID = 4, UserName = ""UserFour"", GroupID = 1 } );
userList.Add( new User { UserID = 5, UserName = ""UserFive"", GroupID = 3 } );
userList.Add( new User { UserID = 6, UserName = ""UserSix"", GroupID = 3 } );
</code></pre>

<p>I want to be able to run a Linq query on the above list that groups all the users by GroupID. So the output will be a list of user lists that contains user (if that makes sense?). Something like:</p>

<pre><code>GroupedUserList
    UserList
        UserID = 1, UserName = ""UserOne"", GroupID = 1
        UserID = 2, UserName = ""UserTwo"", GroupID = 1
        UserID = 4, UserName = ""UserFour"", GroupID = 1
    UserList
        UserID = 3, UserName = ""UserThree"", GroupID = 2
    UserList
        UserID = 5, UserName = ""UserFive"", GroupID = 3
        UserID = 6, UserName = ""UserSix"", GroupID = 3
</code></pre>

<p>I've tried using the groupby linq clause but this seems to return a list of keys and its not grouped by correctly:</p>

<pre><code>var groupedCustomerList = userList.GroupBy( u =&gt; u.GroupID ).ToList();
</code></pre>

<p>Any help would be much appreciated.</p>

<p>Thanks</p>
","<pre><code>var groupedCustomerList = userList
    .GroupBy(u =&gt; u.GroupID)
    .Select(grp =&gt; grp.ToList())
    .ToList();
</code></pre>
","2697280"
"Convert string[] to int[] in one line of code using LINQ","148956","","<p>I have an array of integers in string form:</p>

<pre><code>var arr = new string[] { ""1"", ""2"", ""3"", ""4"" };
</code></pre>

<p>I need to an array of 'real' integers to push it further:</p>

<pre><code>void Foo(int[] arr) { .. }
</code></pre>

<p>I tried to cast int and it of course failed:</p>

<pre><code>Foo(arr.Cast&lt;int&gt;.ToArray());
</code></pre>

<p>I can do next:</p>

<pre><code>var list = new List&lt;int&gt;(arr.Length);
arr.ForEach(i =&gt; list.Add(Int32.Parse(i))); // maybe Convert.ToInt32() is better?
Foo(list.ToArray());
</code></pre>

<p>or</p>

<pre><code>var list = new List&lt;int&gt;(arr.Length);
arr.ForEach(i =&gt;
{
   int j;
   if (Int32.TryParse(i, out j)) // TryParse is faster, yeah
   {
      list.Add(j);
   }
 }
 Foo(list.ToArray());
</code></pre>

<p>but both looks ugly.</p>

<p>Is there any other ways to complete the task?</p>
","<p>Given an array you can use the <a href=""http://msdn.microsoft.com/en-us/library/exc45z53.aspx"" rel=""noreferrer""><code>Array.ConvertAll</code> method</a>:</p>

<pre><code>int[] myInts = Array.ConvertAll(arr, s =&gt; int.Parse(s));
</code></pre>

<p>Thanks to Marc Gravell for pointing out that the lambda can be omitted, yielding a shorter version shown below:</p>

<pre><code>int[] myInts = Array.ConvertAll(arr, int.Parse);
</code></pre>

<p>A LINQ solution is similar, except you would need the extra <code>ToArray</code> call to get an array:</p>

<pre><code>int[] myInts = arr.Select(int.Parse).ToArray();
</code></pre>
","1297250"
"Switch statement fallthrough in C#?","148946","","<p>Switch statement fallthrough is one of my personal major reasons for loving <code>switch</code> vs. <code>if/else if</code> constructs. An example is in order here:</p>

<pre><code>static string NumberToWords(int number)
{
    string[] numbers = new string[] 
        { """", ""one"", ""two"", ""three"", ""four"", ""five"", 
          ""six"", ""seven"", ""eight"", ""nine"" };
    string[] tens = new string[] 
        { """", """", ""twenty"", ""thirty"", ""forty"", ""fifty"", 
          ""sixty"", ""seventy"", ""eighty"", ""ninety"" };
    string[] teens = new string[]
        { ""ten"", ""eleven"", ""twelve"", ""thirteen"", ""fourteen"", ""fifteen"",
          ""sixteen"", ""seventeen"", ""eighteen"", ""nineteen"" };

    string ans = """";
    switch (number.ToString().Length)
    {
        case 3:
            ans += string.Format(""{0} hundred and "", numbers[number / 100]);
        case 2:
            int t = (number / 10) % 10;
            if (t == 1)
            {
                ans += teens[number % 10];
                break;
            }
            else if (t &gt; 1)
                ans += string.Format(""{0}-"", tens[t]);
        case 1:
            int o = number % 10;
            ans += numbers[o];

            break;
        default:
            throw new ArgumentException(""number"");
    }
    return ans;
}
</code></pre>

<p>The smart people are cringing because the <code>string[]</code>s should be declared outside the function: well, they are, this is just an example.</p>

<p>The compiler fails with the following error:</p>

<pre>
Control cannot fall through from one case label ('case 3:') to another
Control cannot fall through from one case label ('case 2:') to another
</pre>

<p>Why? And is there any way to get this sort of behaviour without having three <code>if</code>s?</p>
","<p>(Copy/paste of an <a href=""https://stackoverflow.com/questions/9033/hidden-features-of-c?answer=90432#90432"">answer I provided elsewhere</a>)</p>

<p>Falling through <code>switch</code>-<code>case</code>s can be achieved by having no code in a <code>case</code> (see <code>case 0</code>), or using the special <code>goto case</code> (see <code>case 1</code>) or <code>goto default</code> (see <code>case 2</code>) forms:</p>

<pre><code>switch (/*...*/) {
    case 0: // shares the exact same code as case 1
    case 1:
        // do something
        goto case 2;
    case 2:
        // do something else
        goto default;
    default:
        // do something entirely different
        break;
}
</code></pre>
","174223"
"Nullable type as a generic parameter possible?","148690","","<p>I want to do something like this :</p>

<pre><code>myYear = record.GetValueOrNull&lt;int?&gt;(""myYear""),
</code></pre>

<p>Notice the nullable type as the generic parameter. </p>

<p>Since the <code>GetValueOrNull</code> function could return null my first attempt was this: </p>

<pre><code>public static T GetValueOrNull&lt;T&gt;(this DbDataRecord reader, string columnName)
  where T : class
{
    object columnValue = reader[columnName];

    if (!(columnValue is DBNull))
    {
        return (T)columnValue;
    }
    return null;
}
</code></pre>

<p>But the error I'm getting now is:</p>

<blockquote>
  <p>The type 'int?' must be a reference type in order to use it as parameter 'T' in the generic type or method</p>
</blockquote>

<p>Right! <code>Nullable&lt;int&gt;</code> is a <code>struct</code>! So I tried changing the class constraint to a <code>struct</code> constraint (and as a side effect can't return <code>null</code> any more):</p>

<pre><code>public static T GetValueOrNull&lt;T&gt;(this DbDataRecord reader, string columnName)
  where T : struct
</code></pre>

<p>Now the assignment:</p>

<pre><code>myYear = record.GetValueOrNull&lt;int?&gt;(""myYear"");
</code></pre>

<p>Gives the following error:</p>

<blockquote>
  <p>The type 'int?' must be a non-nullable value type in order to use it as parameter 'T' in the generic type or method</p>
</blockquote>

<p>Is specifying a nullable type as a generic parameter at all possible?</p>
","<p>Change the return type to Nullable, and call the method with the non nullable parameter</p>

<pre><code>static void Main(string[] args)
{
    int? i = GetValueOrNull&lt;int&gt;(null, string.Empty);
}


public static Nullable&lt;T&gt; GetValueOrNull&lt;T&gt;(DbDataRecord reader, string columnName) where T : struct
{
    object columnValue = reader[columnName];

    if (!(columnValue is DBNull))
        return (T)columnValue;

    return null;
}
</code></pre>
","209219"